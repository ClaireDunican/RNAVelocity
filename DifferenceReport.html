
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>

<head>
    <meta http-equiv="Content-Type"
          content="text/html; charset=utf-8" />
    <title></title>
    <style type="text/css">
        table.diff {font-family:Courier; border:medium;}
        .diff_header {background-color:#e0e0e0}
        td.diff_header {text-align:right}
        .diff_next {background-color:#c0c0c0}
        .diff_add {background-color:#aaffaa}
        .diff_chg {background-color:#ffff77}
        .diff_sub {background-color:#ffaaaa}
    </style>
</head>

<body>
    
    <table class="diff" id="difflib_chg_to0__top"
           cellspacing="0" cellpadding="0" rules="groups" >
        <colgroup></colgroup> <colgroup></colgroup> <colgroup></colgroup>
        <colgroup></colgroup> <colgroup></colgroup> <colgroup></colgroup>
        <thead><tr><th class="diff_next"><br /></th><th colspan="2" class="diff_header">/home/claired/CompareFiles/velocyto.txt</th><th class="diff_next"><br /></th><th colspan="2" class="diff_header">/home/claired/CompareFiles/MyVelocyto.txt</th></tr></thead>
        <tbody>
            <tr><td class="diff_next" id="difflib_chg_to0__0"><a href="#difflib_chg_to0__0">f</a></td><td class="diff_header" id="from0_1">1</td><td nowrap="nowrap">from&nbsp;copy&nbsp;import&nbsp;deepcopy</td><td class="diff_next"><a href="#difflib_chg_to0__0">f</a></td><td class="diff_header" id="to0_1">1</td><td nowrap="nowrap">from&nbsp;copy&nbsp;import&nbsp;deepcopy</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2">2</td><td nowrap="nowrap">import&nbsp;warnings</td><td class="diff_next"></td><td class="diff_header" id="to0_2">2</td><td nowrap="nowrap">import&nbsp;warnings</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_3">3</td><td nowrap="nowrap">import&nbsp;logging</td><td class="diff_next"></td><td class="diff_header" id="to0_3">3</td><td nowrap="nowrap">import&nbsp;logging</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_4">4</td><td nowrap="nowrap">import&nbsp;numpy&nbsp;as&nbsp;np</td><td class="diff_next"></td><td class="diff_header" id="to0_4">4</td><td nowrap="nowrap">import&nbsp;numpy&nbsp;as&nbsp;np</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__1">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to0__1">n</a></td><td class="diff_header" id="to0_5">5</td><td nowrap="nowrap"><span class="diff_add">import&nbsp;pandas&nbsp;as&nbsp;pd</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_6">6</td><td nowrap="nowrap"><span class="diff_add">import&nbsp;matplotlib.cm&nbsp;as&nbsp;cm</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_7">7</td><td nowrap="nowrap"><span class="diff_add">import&nbsp;IPython.display&nbsp;as&nbsp;IPdisplay</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_8">8</td><td nowrap="nowrap"><span class="diff_add">import&nbsp;glob</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_9">9</td><td nowrap="nowrap"><span class="diff_add">import&nbsp;re</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__1"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_10">10</td><td nowrap="nowrap"><span class="diff_add">from&nbsp;numpy.random&nbsp;import&nbsp;randn</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_5">5</td><td nowrap="nowrap">from&nbsp;scipy.spatial.distance&nbsp;import&nbsp;pdist,&nbsp;squareform</td><td class="diff_next"></td><td class="diff_header" id="to0_11">11</td><td nowrap="nowrap">from&nbsp;scipy.spatial.distance&nbsp;import&nbsp;pdist,&nbsp;squareform</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_6">6</td><td nowrap="nowrap">from&nbsp;scipy.stats&nbsp;import&nbsp;norm&nbsp;as&nbsp;normal</td><td class="diff_next"></td><td class="diff_header" id="to0_12">12</td><td nowrap="nowrap">from&nbsp;scipy.stats&nbsp;import&nbsp;norm&nbsp;as&nbsp;normal</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__2"></td><td class="diff_header" id="from0_7">7</td><td nowrap="nowrap">import&nbsp;scipy.stats</td><td class="diff_next"></td><td class="diff_header" id="to0_13">13</td><td nowrap="nowrap">import&nbsp;scipy.stats</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_8">8</td><td nowrap="nowrap">from&nbsp;scipy&nbsp;import&nbsp;sparse</td><td class="diff_next"></td><td class="diff_header" id="to0_14">14</td><td nowrap="nowrap">from&nbsp;scipy&nbsp;import&nbsp;sparse</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__2">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to0__2">n</a></td><td class="diff_header" id="to0_15">15</td><td nowrap="nowrap"><span class="diff_add">from&nbsp;operator&nbsp;import&nbsp;itemgetter,&nbsp;attrgetter</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_9">9</td><td nowrap="nowrap">import&nbsp;matplotlib</td><td class="diff_next"></td><td class="diff_header" id="to0_16">16</td><td nowrap="nowrap">import&nbsp;matplotlib</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__3"></td><td class="diff_header" id="from0_10">10</td><td nowrap="nowrap">import&nbsp;matplotlib.pyplot&nbsp;as&nbsp;plt</td><td class="diff_next"></td><td class="diff_header" id="to0_17">17</td><td nowrap="nowrap">import&nbsp;matplotlib.pyplot&nbsp;as&nbsp;plt</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__3">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to0__3">n</a></td><td class="diff_header" id="to0_18">18</td><td nowrap="nowrap"><span class="diff_add">import&nbsp;matplotlib.animation&nbsp;as&nbsp;animation</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_19">19</td><td nowrap="nowrap"><span class="diff_add">from&nbsp;mpl_toolkits.mplot3d&nbsp;import&nbsp;Axes3D</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__4"></td><td class="diff_header" id="from0_11">11</td><td nowrap="nowrap">from&nbsp;sklearn.svm&nbsp;import&nbsp;SVR</td><td class="diff_next"></td><td class="diff_header" id="to0_20">20</td><td nowrap="nowrap">from&nbsp;sklearn.svm&nbsp;import&nbsp;SVR</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_12">12</td><td nowrap="nowrap">from&nbsp;sklearn.decomposition&nbsp;import&nbsp;PCA</td><td class="diff_next"></td><td class="diff_header" id="to0_21">21</td><td nowrap="nowrap">from&nbsp;sklearn.decomposition&nbsp;import&nbsp;PCA</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__4">n</a></td><td class="diff_header" id="from0_13">13</td><td nowrap="nowrap"><span class="diff_sub">from&nbsp;sklearn.manifold&nbsp;import&nbsp;TSNE</span></td><td class="diff_next"><a href="#difflib_chg_to0__4">n</a></td><td class="diff_header" id="to0_22">22</td><td nowrap="nowrap"><span class="diff_add">from&nbsp;sklearn.manifold&nbsp;import&nbsp;TSNE&nbsp;#Barnes&nbsp;hut&nbsp;approximation</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_14">14</td><td nowrap="nowrap">from&nbsp;sklearn.neighbors&nbsp;import&nbsp;NearestNeighbors</td><td class="diff_next"></td><td class="diff_header" id="to0_23">23</td><td nowrap="nowrap">from&nbsp;sklearn.neighbors&nbsp;import&nbsp;NearestNeighbors</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__5"></td><td class="diff_header" id="from0_15">15</td><td nowrap="nowrap">from&nbsp;numba&nbsp;import&nbsp;jit</td><td class="diff_next"></td><td class="diff_header" id="to0_24">24</td><td nowrap="nowrap">from&nbsp;numba&nbsp;import&nbsp;jit</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__5">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to0__5">n</a></td><td class="diff_header" id="to0_25">25</td><td nowrap="nowrap"><span class="diff_add">import&nbsp;umap</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_26">26</td><td nowrap="nowrap"><span class="diff_add">import&nbsp;seaborn&nbsp;as&nbsp;sns</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_27">27</td><td nowrap="nowrap"><span class="diff_add">#pip&nbsp;install&nbsp;-U&nbsp;loompy</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_16">16</td><td nowrap="nowrap">import&nbsp;loompy</td><td class="diff_next"></td><td class="diff_header" id="to0_28">28</td><td nowrap="nowrap">import&nbsp;loompy</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__6">n</a></td><td class="diff_header" id="from0_17">17</td><td nowrap="nowrap">from&nbsp;.neighbors&nbsp;import&nbsp;knn_distance_matrix,&nbsp;connectivity_to_weights,&nbsp;convolve_by_sparse_weights,&nbsp;BalancedKNN</td><td class="diff_next"><a href="#difflib_chg_to0__6">n</a></td><td class="diff_header" id="to0_29">29</td><td nowrap="nowrap">from&nbsp;<span class="diff_add">velocyto</span>.neighbors&nbsp;import&nbsp;knn_distance_matrix,&nbsp;connectivity_to_weights,&nbsp;convolve_by_sparse_weights,&nbsp;BalancedKNN</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_18">18</td><td nowrap="nowrap"><span class="diff_sub">from&nbsp;.estimation&nbsp;import&nbsp;fit_slope,&nbsp;fit_slope_offset,&nbsp;fit_slope_weighted,&nbsp;fit_slope_weighted_offset</span></td><td class="diff_next"></td><td class="diff_header" id="to0_30">30</td><td nowrap="nowrap"><span class="diff_add">from&nbsp;velocyto.estimation&nbsp;import&nbsp;fit_slope,&nbsp;fit_slope_offset,&nbsp;fit_slope_weighted,&nbsp;fit_slope_weighted_offset&nbsp;#if&nbsp;introduce&nbsp;own&nbsp;version&nbsp;of&nbsp;the&nbsp;model&nbsp;fit&nbsp;remove&nbsp;this&nbsp;line&nbsp;and&nbsp;add&nbsp;below</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_19">19</td><td nowrap="nowrap"><span class="diff_sub">from&nbsp;.estimation&nbsp;import&nbsp;clusters_stats</span></td><td class="diff_next"></td><td class="diff_header" id="to0_31">31</td><td nowrap="nowrap"><span class="diff_add">from&nbsp;velocyto.estimation&nbsp;import&nbsp;clusters_stats&nbsp;#if&nbsp;introduce&nbsp;own&nbsp;version&nbsp;of&nbsp;the&nbsp;model&nbsp;fit&nbsp;remove&nbsp;this&nbsp;line&nbsp;and&nbsp;add&nbsp;below</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_20">20</td><td nowrap="nowrap">from&nbsp;.estimation&nbsp;import&nbsp;colDeltaCor,&nbsp;colDeltaCorSqrt,&nbsp;colDeltaCorLog10,&nbsp;colDeltaCorpartial,&nbsp;colDeltaCorSqrtpartial,&nbsp;colDeltaCorLog10partial</td><td class="diff_next"></td><td class="diff_header" id="to0_32">32</td><td nowrap="nowrap">from&nbsp;<span class="diff_add">velocyto</span>.estimation&nbsp;import&nbsp;colDeltaCor,&nbsp;colDeltaCorSqrt,&nbsp;colDeltaCorLog10,&nbsp;colDeltaCorpartial,&nbsp;colDeltaCorSqrtpartial,&nbsp;colDeltaCorLog10partial<span class="diff_add">&nbsp;#if&nbsp;introduce&nbsp;own&nbsp;version&nbsp;of&nbsp;the&nbsp;model&nbsp;fit&nbsp;remove&nbsp;this&nbsp;line&nbsp;and&nbsp;add&nbsp;below</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_33">33</td><td nowrap="nowrap"><span class="diff_add">#import&nbsp;sys</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_34">34</td><td nowrap="nowrap"><span class="diff_add">#sys.path.insert(0,&nbsp;'/home/cdunican/PhD/')</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__6"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_35">35</td><td nowrap="nowrap"><span class="diff_add">#import&nbsp;py_file_name_wo_py_at_end&nbsp;as&nbsp;estimation</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_36">36</td><td nowrap="nowrap"><span class="diff_add">#print&nbsp;(estimation.get_set1())&nbsp;#add&nbsp;estimation.&nbsp;onto&nbsp;the&nbsp;names&nbsp;of:&nbsp;fit_slope,&nbsp;fit_slope_offset,&nbsp;fit_slope_weighted,&nbsp;fit_slope_weighted_offset,&nbsp;clusters_stats,&nbsp;colDeltaCor,&nbsp;colDeltaCorSqrt,&nbsp;colDeltaCorLog10,&nbsp;colDeltaCorpartial,&nbsp;colDeltaCorSqrtpartial,&nbsp;colDeltaCorLog10partial&nbsp;functions</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_21">21</td><td nowrap="nowrap">from&nbsp;.diffusion&nbsp;import&nbsp;Diffusion</td><td class="diff_next"></td><td class="diff_header" id="to0_37">37</td><td nowrap="nowrap">from&nbsp;<span class="diff_add">velocyto</span>.diffusion&nbsp;import&nbsp;Diffusion</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_22">22</td><td nowrap="nowrap">from&nbsp;.serialization&nbsp;import&nbsp;dump_hdf5,&nbsp;load_hdf5</td><td class="diff_next"></td><td class="diff_header" id="to0_38">38</td><td nowrap="nowrap">from&nbsp;<span class="diff_add">velocyto</span>.serialization&nbsp;import&nbsp;dump_hdf5,&nbsp;load_hdf5</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_23">23</td><td nowrap="nowrap">from&nbsp;typing&nbsp;import&nbsp;*</td><td class="diff_next"></td><td class="diff_header" id="to0_39">39</td><td nowrap="nowrap">from&nbsp;typing&nbsp;import&nbsp;*</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__7">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to0__7">n</a></td><td class="diff_header" id="to0_40">40</td><td nowrap="nowrap"><span class="diff_add">import&nbsp;h5py</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_41">41</td><td nowrap="nowrap"><span class="diff_add">import&nbsp;pickle</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_42">42</td><td nowrap="nowrap"><span class="diff_add">import&nbsp;zlib</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_43">43</td><td nowrap="nowrap"><span class="diff_add">import&nbsp;os</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_44">44</td><td nowrap="nowrap"><span class="diff_add">from&nbsp;matplotlib&nbsp;import&nbsp;cm</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_45">45</td><td nowrap="nowrap"><span class="diff_add">from&nbsp;collections&nbsp;import&nbsp;OrderedDict</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_46">46</td><td nowrap="nowrap"><span class="diff_add">import&nbsp;sys</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_47">47</td><td nowrap="nowrap"><span class="diff_add">from&nbsp;sklearn.linear_model&nbsp;import&nbsp;LinearRegression</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_48">48</td><td nowrap="nowrap"><span class="diff_add">from&nbsp;statsmodels.nonparametric.smoothers_lowess&nbsp;import&nbsp;lowess</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_49">49</td><td nowrap="nowrap"><span class="diff_add">from&nbsp;scipy.interpolate&nbsp;import&nbsp;interp1d</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_50">50</td><td nowrap="nowrap"><span class="diff_add">from&nbsp;matplotlib.lines&nbsp;import&nbsp;Line2D</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_51">51</td><td nowrap="nowrap"><span class="diff_add">from&nbsp;numpy&nbsp;import&nbsp;*</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_52">52</td><td nowrap="nowrap"><span class="diff_add">from&nbsp;pandas&nbsp;import&nbsp;*</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_53">53</td><td nowrap="nowrap"><span class="diff_add">from&nbsp;rpy2.robjects.packages&nbsp;import&nbsp;importr</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_54">54</td><td nowrap="nowrap"><span class="diff_add">import&nbsp;rpy2.robjects&nbsp;as&nbsp;ro</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_55">55</td><td nowrap="nowrap"><span class="diff_add">import&nbsp;rpy2.robjects.packages&nbsp;as&nbsp;rpackages</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_56">56</td><td nowrap="nowrap"><span class="diff_add">import&nbsp;rpy2.robjects&nbsp;as&nbsp;robjects</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_57">57</td><td nowrap="nowrap"><span class="diff_add">from&nbsp;rpy2.rinterface&nbsp;import&nbsp;SexpVector</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_58">58</td><td nowrap="nowrap"><span class="diff_add">import&nbsp;seaborn&nbsp;as&nbsp;sns</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_59">59</td><td nowrap="nowrap"><span class="diff_add">from&nbsp;numpy_groupies&nbsp;import&nbsp;aggregate,&nbsp;aggregate_np</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__7"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_60">60</td><td nowrap="nowrap"><span class="diff_add">from&nbsp;rpy2.robjects&nbsp;import&nbsp;pandas2ri</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_61">61</td><td nowrap="nowrap"><span class="diff_add">#warnings.filterwarnings("ignore")&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_62">62</td><td nowrap="nowrap"><span class="diff_add">#import&nbsp;pandas.rpy.common&nbsp;as&nbsp;com</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_63">63</td><td nowrap="nowrap"><span class="diff_add">#Make&nbsp;sense&nbsp;of&nbsp;the&nbsp;last&nbsp;plot&nbsp;-&nbsp;email&nbsp;the&nbsp;authors&nbsp;because&nbsp;no&nbsp;indication&nbsp;of&nbsp;how&nbsp;it&nbsp;picks&nbsp;which&nbsp;point&nbsp;to&nbsp;circle&nbsp;and&nbsp;add&nbsp;an&nbsp;arrow&nbsp;to.</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_24">24</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_64">64</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__8">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to0__8">n</a></td><td class="diff_header" id="to0_65">65</td><td nowrap="nowrap"><span class="diff_add">#low&nbsp;priority:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_66">66</td><td nowrap="nowrap"><span class="diff_add">#look&nbsp;at&nbsp;the&nbsp;non-default&nbsp;plots&nbsp;in:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_67">67</td><td nowrap="nowrap"><span class="diff_add">#https://github.com/velocyto-team/velocyto-notebooks/blob/master/python/DentateGyrus.ipynb</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__8"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_68">68</td><td nowrap="nowrap"><span class="diff_add">#plot&nbsp;in&nbsp;3D&nbsp;tSNE,&nbsp;add&nbsp;arrows&nbsp;to&nbsp;3D&nbsp;PCA,&nbsp;add&nbsp;arrows&nbsp;to&nbsp;2D&nbsp;and&nbsp;3D&nbsp;diffusion&nbsp;maps</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_69">69</td><td nowrap="nowrap"><span class="diff_add">#plot&nbsp;in&nbsp;3d&nbsp;tSNE</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_70">70</td><td nowrap="nowrap"><span class="diff_add">#add&nbsp;arrows&nbsp;to&nbsp;3d&nbsp;pca</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_71">71</td><td nowrap="nowrap"><span class="diff_add">#add&nbsp;arrows&nbsp;to&nbsp;3d&nbsp;diffusion&nbsp;maps</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_25">25</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_72">72</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__9">n</a></td><td class="diff_header" id="from0_26">26</td><td nowrap="nowrap"><span class="diff_sub">[docs]</span>class&nbsp;VelocytoLoom:</td><td class="diff_next"><a href="#difflib_chg_to0__9">n</a></td><td class="diff_header" id="to0_73">73</td><td nowrap="nowrap">class&nbsp;VelocytoLoom:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_74">74</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__init__(self,&nbsp;loom_filepath:&nbsp;str)&nbsp;-&gt;&nbsp;None:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_75">75</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.loom_filepath&nbsp;=&nbsp;loom_filepath</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_76">76</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ds&nbsp;=&nbsp;loompy.connect(self.loom_filepath)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_77">77</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ds.layers["spliced"]&nbsp;=&nbsp;spl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#has&nbsp;to&nbsp;be&nbsp;a&nbsp;matrix&nbsp;full&nbsp;of&nbsp;integers,&nbsp;rows:&nbsp;cells,&nbsp;columns:&nbsp;genes&nbsp;i.e.</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_78">78</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ds.layers["unspliced"]&nbsp;=&nbsp;unspl&nbsp;#np.array([[0,0,0,0],&nbsp;[0,0,0,0],&nbsp;[1,1,1,1]])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_79">79</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ds.layers["ambiguous"]&nbsp;=&nbsp;ambig</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_80">80</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_81">81</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.S&nbsp;=&nbsp;ds.layer["spliced"][:,&nbsp;:]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_82">82</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.U&nbsp;=&nbsp;ds.layer["unspliced"][:,&nbsp;:]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_83">83</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.A&nbsp;=&nbsp;ds.layer["ambiguous"][:,&nbsp;:]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_84">84</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ca&nbsp;=&nbsp;dict(ds.col_attrs.items())</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_85">85</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ra&nbsp;=&nbsp;dict(ds.row_attrs.items())</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_86">86</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#ds.close()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_87">87</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.initial_cell_size&nbsp;=&nbsp;self.S.sum(0)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_88">88</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.initial_Ucell_size&nbsp;=&nbsp;self.U.sum(0)&nbsp;#sum(0)&nbsp;axis&nbsp;=&nbsp;0&nbsp;(sums&nbsp;all&nbsp;row&nbsp;values&nbsp;in&nbsp;each&nbsp;colum)&nbsp;[8.&nbsp;8.&nbsp;8.&nbsp;8.&nbsp;8.&nbsp;8.]&nbsp;8&nbsp;genes,&nbsp;6&nbsp;samples,&nbsp;all&nbsp;6&nbsp;have&nbsp;all&nbsp;the&nbsp;spliced&nbsp;and&nbsp;unspliced&nbsp;counts</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_89">89</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_90">90</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;np.mean(self.ca["_Valid"])&nbsp;&lt;&nbsp;1:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_91">91</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warn(f"fraction&nbsp;of&nbsp;_Valid&nbsp;cells&nbsp;is&nbsp;{np.mean(self.ca['_Valid'])}&nbsp;but&nbsp;all&nbsp;will&nbsp;be&nbsp;taken&nbsp;in&nbsp;consideration")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_92">92</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except&nbsp;KeyError:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_93">93</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pass</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_94">94</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;logging.debug("The&nbsp;file&nbsp;did&nbsp;not&nbsp;specify&nbsp;the&nbsp;_Valid&nbsp;column&nbsp;attribute")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_95">95</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.norm_factor&nbsp;=&nbsp;1</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_96">96</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.S_sz&nbsp;=&nbsp;self.norm_factor&nbsp;*&nbsp;self.S</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_97">97</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.S_norm&nbsp;=&nbsp;self.S</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_98">98</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.U_sz&nbsp;=&nbsp;self.norm_factor&nbsp;*&nbsp;self.U</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_99">99</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.U_norm&nbsp;=&nbsp;self.U</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_100">100</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_101">101</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_102">102</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_27">27</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;"""A&nbsp;convenient&nbsp;object&nbsp;to&nbsp;store&nbsp;the&nbsp;data&nbsp;of&nbsp;a&nbsp;velocyto&nbsp;loom&nbsp;file.</td><td class="diff_next"></td><td class="diff_header" id="to0_103">103</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;"""A&nbsp;convenient&nbsp;object&nbsp;to&nbsp;store&nbsp;the&nbsp;data&nbsp;of&nbsp;a&nbsp;velocyto&nbsp;loom&nbsp;file.</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_28">28</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_104">104</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_29">29</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;Data&nbsp;will&nbsp;be&nbsp;stored&nbsp;in&nbsp;memory</td><td class="diff_next"></td><td class="diff_header" id="to0_105">105</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;Data&nbsp;will&nbsp;be&nbsp;stored&nbsp;in&nbsp;memory</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_30">30</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_106">106</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_31">31</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;Examples</td><td class="diff_next"></td><td class="diff_header" id="to0_107">107</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;Examples</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_32">32</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;--------</td><td class="diff_next"></td><td class="diff_header" id="to0_108">108</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;--------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_33">33</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;usage&nbsp;examples&nbsp;consult&nbsp;the&nbsp;documentation</td><td class="diff_next"></td><td class="diff_header" id="to0_109">109</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;usage&nbsp;examples&nbsp;consult&nbsp;the&nbsp;documentation</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_34">34</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_110">110</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_35">35</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;Attributes</td><td class="diff_next"></td><td class="diff_header" id="to0_111">111</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;Attributes</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_36">36</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;----------</td><td class="diff_next"></td><td class="diff_header" id="to0_112">112</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;----------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_37">37</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;S:&nbsp;np.ndarray</td><td class="diff_next"></td><td class="diff_header" id="to0_113">113</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;S:&nbsp;np.ndarray</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_38">38</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Expressed&nbsp;spliced&nbsp;molecules</td><td class="diff_next"></td><td class="diff_header" id="to0_114">114</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Expressed&nbsp;spliced&nbsp;molecules</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_39">39</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;U:&nbsp;np.ndarray</td><td class="diff_next"></td><td class="diff_header" id="to0_115">115</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;U:&nbsp;np.ndarray</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_40">40</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unspliced&nbsp;molecule&nbsp;count</td><td class="diff_next"></td><td class="diff_header" id="to0_116">116</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unspliced&nbsp;molecule&nbsp;count</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_41">41</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;A:&nbsp;np.ndarray</td><td class="diff_next"></td><td class="diff_header" id="to0_117">117</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;A:&nbsp;np.ndarray</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_42">42</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ambiguous&nbsp;molecule&nbsp;count</td><td class="diff_next"></td><td class="diff_header" id="to0_118">118</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ambiguous&nbsp;molecule&nbsp;count</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_43">43</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;ca:&nbsp;dict</td><td class="diff_next"></td><td class="diff_header" id="to0_119">119</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;ca:&nbsp;dict</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_44">44</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Column&nbsp;attributes&nbsp;of&nbsp;the&nbsp;loom&nbsp;file</td><td class="diff_next"></td><td class="diff_header" id="to0_120">120</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Column&nbsp;attributes&nbsp;of&nbsp;the&nbsp;loom&nbsp;file</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_45">45</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;ra:&nbsp;dict</td><td class="diff_next"></td><td class="diff_header" id="to0_121">121</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;ra:&nbsp;dict</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_46">46</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Row&nbsp;attributes&nbsp;of&nbsp;the&nbsp;loom&nbsp;file</td><td class="diff_next"></td><td class="diff_header" id="to0_122">122</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Row&nbsp;attributes&nbsp;of&nbsp;the&nbsp;loom&nbsp;file</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_47">47</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;loom_filepath:&nbsp;str</td><td class="diff_next"></td><td class="diff_header" id="to0_123">123</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;loom_filepath:&nbsp;str</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__9"></td><td class="diff_header" id="from0_48">48</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;original&nbsp;path&nbsp;the&nbsp;loom&nbsp;files&nbsp;has&nbsp;been&nbsp;read&nbsp;from</td><td class="diff_next"></td><td class="diff_header" id="to0_124">124</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;original&nbsp;path&nbsp;the&nbsp;loom&nbsp;files&nbsp;has&nbsp;been&nbsp;read&nbsp;from</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_49">49</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;initial_cell_size:&nbsp;int</td><td class="diff_next"></td><td class="diff_header" id="to0_125">125</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;initial_cell_size:&nbsp;int</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_50">50</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;sum&nbsp;of&nbsp;spliced&nbsp;molecules</td><td class="diff_next"></td><td class="diff_header" id="to0_126">126</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;sum&nbsp;of&nbsp;spliced&nbsp;molecules</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__10"></td><td class="diff_header" id="from0_51">51</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;initial_Ucell_size:&nbsp;int</td><td class="diff_next"></td><td class="diff_header" id="to0_127">127</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;initial_Ucell_size:&nbsp;int</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_52">52</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;sum&nbsp;of&nbsp;unspliced&nbsp;molecules</td><td class="diff_next"></td><td class="diff_header" id="to0_128">128</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;sum&nbsp;of&nbsp;unspliced&nbsp;molecules</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__10">n</a></td><td class="diff_header" id="from0_53">53</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__10">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_54">54</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_129">129</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_55">55</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_130">130</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__11">n</a></td><td class="diff_header" id="from0_56">56</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__init__(self,&nbsp;loom_filepath:&nbsp;str)&nbsp;-&gt;&nbsp;None:</span></td><td class="diff_next"><a href="#difflib_chg_to0__11">n</a></td><td class="diff_header" id="to0_131">131</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;plot_fractions(self,&nbsp;save2file:&nbsp;str=None)&nbsp;-&gt;&nbsp;None:&nbsp;#to&nbsp;improve:&nbsp;yaxis:&nbsp;number&nbsp;of&nbsp;molecules,&nbsp;xaxis:&nbsp;cells/patients&nbsp;currently&nbsp;gives&nbsp;a&nbsp;weird&nbsp;not&nbsp;that&nbsp;useful&nbsp;graph&nbsp;so&nbsp;needs&nbsp;improving&nbsp;-cd2514/4/12/2018</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_57">57</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.loom_filepath&nbsp;=&nbsp;loom_filepath</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_58">58</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ds&nbsp;=&nbsp;loompy.connect(self.loom_filepath)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_59">59</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.S&nbsp;=&nbsp;ds.layer["spliced"][:,&nbsp;:]</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_60">60</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.U&nbsp;=&nbsp;ds.layer["unspliced"][:,&nbsp;:]</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_61">61</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.A&nbsp;=&nbsp;ds.layer["ambiguous"][:,&nbsp;:]</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_62">62</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ca&nbsp;=&nbsp;dict(ds.col_attrs.items())</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_63">63</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ra&nbsp;=&nbsp;dict(ds.row_attrs.items())</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_64">64</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ds.close()</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_65">65</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_66">66</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.initial_cell_size&nbsp;=&nbsp;self.S.sum(0)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_67">67</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.initial_Ucell_size&nbsp;=&nbsp;self.U.sum(0)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_68">68</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_69">69</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_70">70</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;np.mean(self.ca["_Valid"])&nbsp;&lt;&nbsp;1:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_71">71</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warn(f"fraction&nbsp;of&nbsp;_Valid&nbsp;cells&nbsp;is&nbsp;{np.mean(self.ca['_Valid'])}&nbsp;but&nbsp;all&nbsp;will&nbsp;be&nbsp;taken&nbsp;in&nbsp;consideration")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_72">72</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except&nbsp;KeyError:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_73">73</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pass</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_74">74</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;logging.debug("The&nbsp;file&nbsp;did&nbsp;not&nbsp;specify&nbsp;the&nbsp;_Valid&nbsp;column&nbsp;attribute")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_75">75</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_76">76</td><td nowrap="nowrap"><span class="diff_sub">[docs]&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;to_hdf5(self,&nbsp;filename:&nbsp;str,&nbsp;**kwargs:&nbsp;Dict[str,&nbsp;Any])&nbsp;-&gt;&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_77">77</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Serialize&nbsp;the&nbsp;VelocytoLoom&nbsp;object&nbsp;in&nbsp;its&nbsp;current&nbsp;state</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_78">78</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_79">79</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_80">80</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_81">81</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_82">82</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;file&nbsp;that&nbsp;will&nbsp;be&nbsp;generated&nbsp;(the&nbsp;suffix&nbsp;hdf5&nbsp;is&nbsp;suggested&nbsp;but&nbsp;not&nbsp;enforced)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_83">83</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**kwargs:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_84">84</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;function&nbsp;accepts&nbsp;the&nbsp;arguments&nbsp;of&nbsp;`dump_hdf5`</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_85">85</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_86">86</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_87">87</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_88">88</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing.&nbsp;It&nbsp;saves&nbsp;a&nbsp;file&nbsp;that&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;recreate&nbsp;the&nbsp;object&nbsp;in&nbsp;another&nbsp;session.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_89">89</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_90">90</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_91">91</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_92">92</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;object&nbsp;can&nbsp;be&nbsp;reloaded&nbsp;calling&nbsp;``load_velocyto_hdf5(filename)``</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_93">93</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_94">94</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dump_hdf5(self,&nbsp;filename,&nbsp;**kwargs)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_95">95</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_96">96</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_97">97</td><td nowrap="nowrap"><span class="diff_sub">[docs]&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;plot_fractions(self,&nbsp;save2file:&nbsp;str=None)&nbsp;-&gt;&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_98">98</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Plots&nbsp;a&nbsp;barplot&nbsp;showing&nbsp;the&nbsp;abundance&nbsp;of&nbsp;spliced/unspliced&nbsp;molecules&nbsp;in&nbsp;the&nbsp;dataset</td><td class="diff_next"></td><td class="diff_header" id="to0_132">132</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Plots&nbsp;a&nbsp;barplot&nbsp;showing&nbsp;the&nbsp;abundance&nbsp;of&nbsp;spliced/unspliced&nbsp;molecules&nbsp;in&nbsp;the&nbsp;dataset</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_99">99</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_133">133</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_100">100</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td><td class="diff_next"></td><td class="diff_header" id="to0_134">134</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_101">101</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td><td class="diff_next"></td><td class="diff_header" id="to0_135">135</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_102">102</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;save2file:&nbsp;str&nbsp;(default:&nbsp;None)</td><td class="diff_next"></td><td class="diff_header" id="to0_136">136</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;save2file:&nbsp;str&nbsp;(default:&nbsp;None)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_103">103</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;not&nbsp;None&nbsp;specifies&nbsp;the&nbsp;file&nbsp;path&nbsp;to&nbsp;which&nbsp;plots&nbsp;get&nbsp;saved</td><td class="diff_next"></td><td class="diff_header" id="to0_137">137</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;not&nbsp;None&nbsp;specifies&nbsp;the&nbsp;file&nbsp;path&nbsp;to&nbsp;which&nbsp;plots&nbsp;get&nbsp;saved</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_104">104</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_138">138</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_105">105</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td><td class="diff_next"></td><td class="diff_header" id="to0_139">139</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__11"></td><td class="diff_header" id="from0_106">106</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td><td class="diff_next"></td><td class="diff_header" id="to0_140">140</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_107">107</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing,&nbsp;it&nbsp;plots&nbsp;a&nbsp;barplot</td><td class="diff_next"></td><td class="diff_header" id="to0_141">141</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing,&nbsp;it&nbsp;plots&nbsp;a&nbsp;barplot</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__12"></td><td class="diff_header" id="from0_108">108</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_142">142</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_109">109</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(figsize=(3.2,&nbsp;5))</td><td class="diff_next"></td><td class="diff_header" id="to0_143">143</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(figsize=(3.2,&nbsp;5))</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_110">110</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:</td><td class="diff_next"></td><td class="diff_header" id="to0_144">144</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__12">n</a></td><td class="diff_header" id="from0_111">111</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chips,&nbsp;chip_ix&nbsp;=&nbsp;np.unique(self.ca["<span class="diff_chg">S</span>a<span class="diff_chg">mpl</span>e<span class="diff_chg">ID</span>"],&nbsp;return_inverse=1)</td><td class="diff_next"><a href="#difflib_chg_to0__12">n</a></td><td class="diff_header" id="to0_145">145</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chips,&nbsp;chip_ix&nbsp;=&nbsp;np.unique(self.ca["<span class="diff_chg">P</span>a<span class="diff_chg">ti</span>e<span class="diff_chg">nts</span>"],&nbsp;return_inverse=1)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_112">112</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except&nbsp;KeyError:</td><td class="diff_next"></td><td class="diff_header" id="to0_146">146</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except&nbsp;KeyError:</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__13">n</a></td><td class="diff_header" id="from0_113">113</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chips,&nbsp;chip_ix&nbsp;=&nbsp;np.unique([i.split(":")[0]&nbsp;for&nbsp;i&nbsp;in&nbsp;self.ca["<span class="diff_chg">C</span>e<span class="diff_chg">llID</span>"]],&nbsp;return_inverse=1)</td><td class="diff_next"><a href="#difflib_chg_to0__13">n</a></td><td class="diff_header" id="to0_147">147</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chips,&nbsp;chip_ix&nbsp;=&nbsp;np.unique([i.split(":")[0]&nbsp;for&nbsp;i&nbsp;in&nbsp;self.ca["<span class="diff_chg">Pati</span>e<span class="diff_chg">nts</span>"]],&nbsp;return_inverse=1)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_114">114</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;=&nbsp;len(chips)</td><td class="diff_next"></td><td class="diff_header" id="to0_148">148</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;=&nbsp;len(chips)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_115">115</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;np.unique(chip_ix):</td><td class="diff_next"></td><td class="diff_header" id="to0_149">149</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;np.unique(chip_ix):</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_116">116</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tot_mol_cell_submatrixes&nbsp;=&nbsp;[X[:,&nbsp;chip_ix&nbsp;==&nbsp;i].sum(0)&nbsp;for&nbsp;X&nbsp;in&nbsp;[self.S,&nbsp;self.A,&nbsp;self.U]]</td><td class="diff_next"></td><td class="diff_header" id="to0_150">150</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tot_mol_cell_submatrixes&nbsp;=&nbsp;[X[:,&nbsp;chip_ix&nbsp;==&nbsp;i].sum(0)&nbsp;for&nbsp;X&nbsp;in&nbsp;[self.S,&nbsp;self.A,&nbsp;self.U]]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_117">117</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total&nbsp;=&nbsp;np.sum(tot_mol_cell_submatrixes,&nbsp;0)</td><td class="diff_next"></td><td class="diff_header" id="to0_151">151</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total&nbsp;=&nbsp;np.sum(tot_mol_cell_submatrixes,&nbsp;0)</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__13"></td><td class="diff_header" id="from0_118">118</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_mean&nbsp;=&nbsp;[np.mean(j&nbsp;/&nbsp;total)&nbsp;for&nbsp;j&nbsp;in&nbsp;tot_mol_cell_submatrixes]</td><td class="diff_next"></td><td class="diff_header" id="to0_152">152</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_mean&nbsp;=&nbsp;[np.mean(j&nbsp;/&nbsp;total)&nbsp;for&nbsp;j&nbsp;in&nbsp;tot_mol_cell_submatrixes]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_119">119</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_std&nbsp;=&nbsp;[np.std(j&nbsp;/&nbsp;total)&nbsp;for&nbsp;j&nbsp;in&nbsp;tot_mol_cell_submatrixes]</td><td class="diff_next"></td><td class="diff_header" id="to0_153">153</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_std&nbsp;=&nbsp;[np.std(j&nbsp;/&nbsp;total)&nbsp;for&nbsp;j&nbsp;in&nbsp;tot_mol_cell_submatrixes]</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__14"></td><td class="diff_header" id="from0_120">120</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.ylabel("Fraction")</td><td class="diff_next"></td><td class="diff_header" id="to0_154">154</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.ylabel("Fraction")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_121">121</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.bar(np.linspace(-0.2,&nbsp;0.2,&nbsp;n)[i]&nbsp;+&nbsp;np.arange(3),&nbsp;_mean,&nbsp;0.5&nbsp;/&nbsp;(n&nbsp;*&nbsp;1.05),&nbsp;label=chips[i])</td><td class="diff_next"></td><td class="diff_header" id="to0_155">155</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.bar(np.linspace(-0.2,&nbsp;0.2,&nbsp;n)[i]&nbsp;+&nbsp;np.arange(3),&nbsp;_mean,&nbsp;0.5&nbsp;/&nbsp;(n&nbsp;*&nbsp;1.05),&nbsp;label=chips[i])</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_122">122</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.errorbar(np.linspace(-0.2,&nbsp;0.2,&nbsp;n)[i]&nbsp;+&nbsp;np.arange(3),&nbsp;_mean,&nbsp;_std,&nbsp;c="k",&nbsp;fmt="none",&nbsp;lw=1,&nbsp;capsize=2)</td><td class="diff_next"></td><td class="diff_header" id="to0_156">156</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.errorbar(np.linspace(-0.2,&nbsp;0.2,&nbsp;n)[i]&nbsp;+&nbsp;np.arange(3),&nbsp;_mean,&nbsp;_std,&nbsp;c="k",&nbsp;fmt="none",&nbsp;lw=1,&nbsp;capsize=2)</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__14">n</a></td><td class="diff_header" id="from0_123">123</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__14">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_124">124</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Hide&nbsp;the&nbsp;right&nbsp;and&nbsp;top&nbsp;spines</td><td class="diff_next"></td><td class="diff_header" id="to0_157">157</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Hide&nbsp;the&nbsp;right&nbsp;and&nbsp;top&nbsp;spines</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__15">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to0__15">n</a></td><td class="diff_header" id="to0_158">158</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#plt.gca().axison&nbsp;=&nbsp;False</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_159">159</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#plt.gca().stale&nbsp;=&nbsp;True</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_160">160</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#for&nbsp;k&nbsp;in&nbsp;plt.gca().spines.keys():</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_161">161</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;plt.gca().spines['right'].set_visible(False)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_162">162</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;plt.gca().spines['top'].set_visible(False)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_125">125</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.gca().spines['right'].set_visible(False)</td><td class="diff_next"></td><td class="diff_header" id="to0_163">163</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.gca().spines['right'].set_visible(False)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_126">126</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.gca().spines['top'].set_visible(False)</td><td class="diff_next"></td><td class="diff_header" id="to0_164">164</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.gca().spines['top'].set_visible(False)</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__15"></td><td class="diff_header" id="from0_127">127</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Only&nbsp;show&nbsp;ticks&nbsp;on&nbsp;the&nbsp;left&nbsp;and&nbsp;bottom&nbsp;spines</td><td class="diff_next"></td><td class="diff_header" id="to0_165">165</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Only&nbsp;show&nbsp;ticks&nbsp;on&nbsp;the&nbsp;left&nbsp;and&nbsp;bottom&nbsp;spines</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_128">128</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.gca().yaxis.set_ticks_position('left')</td><td class="diff_next"></td><td class="diff_header" id="to0_166">166</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.gca().yaxis.set_ticks_position('left')</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_129">129</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.gca().xaxis.set_ticks_position('bottom')</td><td class="diff_next"></td><td class="diff_header" id="to0_167">167</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.gca().xaxis.set_ticks_position('bottom')</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_130">130</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.gca().spines['left'].set_bounds(0,&nbsp;0.8)</td><td class="diff_next"></td><td class="diff_header" id="to0_168">168</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.gca().spines['left'].set_bounds(0,&nbsp;0.8)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_131">131</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.legend()</td><td class="diff_next"></td><td class="diff_header" id="to0_169">169</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.legend()</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__16"><a href="#difflib_chg_to0__16">n</a></td><td class="diff_header" id="from0_132">132</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__16">n</a></td><td class="diff_header" id="to0_170">170</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_133">133</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.xticks(np.arange(3),&nbsp;["spliced",&nbsp;"ambiguous",&nbsp;"unspliced"])</td><td class="diff_next"></td><td class="diff_header" id="to0_171">171</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.xticks(np.arange(3),&nbsp;["spliced",&nbsp;"ambiguous",&nbsp;"unspliced"])</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_134">134</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.tight_layout()</td><td class="diff_next"></td><td class="diff_header" id="to0_172">172</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.tight_layout()</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__17"></td><td class="diff_header" id="from0_135">135</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;save2file:</td><td class="diff_next"></td><td class="diff_header" id="to0_173">173</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;save2file:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_136">136</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(save2file,&nbsp;bbox_inches="tight")</td><td class="diff_next"></td><td class="diff_header" id="to0_174">174</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(save2file,&nbsp;bbox_inches="tight")</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__17">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to0__17">n</a></td><td class="diff_header" id="to0_175">175</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_137">137</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_176">176</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_138">138</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_177">177</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__18">n</a></td><td class="diff_header" id="from0_139">139</td><td nowrap="nowrap"><span class="diff_sub">[docs]&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;filter_cells(self,&nbsp;bool_array:&nbsp;np.ndarray)&nbsp;-&gt;&nbsp;None:</span></td><td class="diff_next"><a href="#difflib_chg_to0__18">n</a></td><td class="diff_header" id="to0_178">178</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;set_clusters(self,&nbsp;cluster_labels:&nbsp;np.ndarray,&nbsp;cluster_colors_dict:&nbsp;Dict[str,&nbsp;List[float]]=None,&nbsp;colormap:&nbsp;Any=True)&nbsp;-&gt;&nbsp;None:&nbsp;#this&nbsp;assigns&nbsp;the&nbsp;coloration&nbsp;for&nbsp;the&nbsp;points&nbsp;used&nbsp;later&nbsp;therefore&nbsp;this&nbsp;will&nbsp;later&nbsp;be&nbsp;changed&nbsp;for&nbsp;the&nbsp;phenotypes</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_140">140</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Filter&nbsp;cells&nbsp;using&nbsp;a&nbsp;boolean&nbsp;array.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_141">141</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_142">142</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_143">143</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_144">144</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool_array:&nbsp;np.ndarray&nbsp;(size&nbsp;)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_145">145</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array&nbsp;describing&nbsp;the&nbsp;cells&nbsp;to&nbsp;keep&nbsp;(True).</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_146">146</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_147">147</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_148">148</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_149">149</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;but&nbsp;it&nbsp;removes&nbsp;some&nbsp;cells&nbsp;from&nbsp;S&nbsp;and&nbsp;U.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_150">150</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_151">151</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.S,&nbsp;self.U,&nbsp;self.A&nbsp;=&nbsp;(X[:,&nbsp;bool_array]&nbsp;for&nbsp;X&nbsp;in&nbsp;(self.S,&nbsp;self.U,&nbsp;self.A))</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_152">152</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.initial_cell_size&nbsp;=&nbsp;self.initial_cell_size[bool_array]</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_153">153</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.initial_Ucell_size&nbsp;=&nbsp;self.initial_Ucell_size[bool_array]</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_154">154</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_155">155</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ts&nbsp;=&nbsp;self.ts[bool_array]&nbsp;&nbsp;#&nbsp;type:&nbsp;np.ndarray</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_156">156</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_157">157</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pass</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_158">158</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_159">159</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.size_factor&nbsp;=&nbsp;self.size_factor[bool_array]&nbsp;&nbsp;#&nbsp;type:&nbsp;np.ndarray</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_160">160</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_161">161</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pass</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_162">162</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ca&nbsp;=&nbsp;{k:&nbsp;v[bool_array]&nbsp;for&nbsp;k,&nbsp;v&nbsp;in&nbsp;self.ca.items()}</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_163">163</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_164">164</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.cluster_labels&nbsp;=&nbsp;self.cluster_labels[bool_array]&nbsp;&nbsp;#&nbsp;type:&nbsp;np.ndarray</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_165">165</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.colorandum&nbsp;=&nbsp;self.colorandum[bool_array,&nbsp;:]&nbsp;&nbsp;#&nbsp;type:&nbsp;np.ndarray</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_166">166</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except&nbsp;AttributeError:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_167">167</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pass</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_168">168</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_169">169</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_170">170</td><td nowrap="nowrap"><span class="diff_sub">[docs]&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;set_clusters(self,&nbsp;cluster_labels:&nbsp;np.ndarray,&nbsp;cluster_colors_dict:&nbsp;Dict[str,&nbsp;List[float]]=None,&nbsp;colormap:&nbsp;Any=None)&nbsp;-&gt;&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_171">171</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Utility&nbsp;function&nbsp;to&nbsp;set&nbsp;cluster&nbsp;labels,&nbsp;names&nbsp;and&nbsp;colormap</td><td class="diff_next"></td><td class="diff_header" id="to0_179">179</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Utility&nbsp;function&nbsp;to&nbsp;set&nbsp;cluster&nbsp;labels,&nbsp;names&nbsp;and&nbsp;colormap<span class="diff_add">this&nbsp;will&nbsp;lat</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_172">172</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_180">180</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_173">173</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td><td class="diff_next"></td><td class="diff_header" id="to0_181">181</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_174">174</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td><td class="diff_next"></td><td class="diff_header" id="to0_182">182</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_175">175</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cluster_labels:&nbsp;np.ndarray</td><td class="diff_next"></td><td class="diff_header" id="to0_183">183</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cluster_labels:&nbsp;np.ndarray</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_176">176</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;vector&nbsp;of&nbsp;strings&nbsp;containing&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;cluster&nbsp;for&nbsp;each&nbsp;cells</td><td class="diff_next"></td><td class="diff_header" id="to0_184">184</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;vector&nbsp;of&nbsp;strings&nbsp;containing&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;cluster&nbsp;for&nbsp;each&nbsp;cells</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_177">177</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cluster_colors_dict:&nbsp;dict[str,&nbsp;List[float]]</td><td class="diff_next"></td><td class="diff_header" id="to0_185">185</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cluster_colors_dict:&nbsp;dict[str,&nbsp;List[float]]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_178">178</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;mapping&nbsp;&nbsp;cluster_name&nbsp;-&gt;&nbsp;rgb_color_triplet&nbsp;for&nbsp;example&nbsp;"StemCell":[0.65,0.1,0.4]</td><td class="diff_next"></td><td class="diff_header" id="to0_186">186</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;mapping&nbsp;&nbsp;cluster_name&nbsp;-&gt;&nbsp;rgb_color_triplet&nbsp;for&nbsp;example&nbsp;"StemCell":[0.65,0.1,0.4]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_179">179</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colormap:</td><td class="diff_next"></td><td class="diff_header" id="to0_187">187</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colormap:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_180">180</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(optional)</td><td class="diff_next"></td><td class="diff_header" id="to0_188">188</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(optional)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_181">181</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;In&nbsp;alternative&nbsp;to&nbsp;cluster_colors_dict&nbsp;a&nbsp;colormap&nbsp;object&nbsp;(e.g.&nbsp;from&nbsp;matplotlib&nbsp;or&nbsp;similar&nbsp;callable)&nbsp;can&nbsp;be&nbsp;passed</td><td class="diff_next"></td><td class="diff_header" id="to0_189">189</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;In&nbsp;alternative&nbsp;to&nbsp;cluster_colors_dict&nbsp;a&nbsp;colormap&nbsp;object&nbsp;(e.g.&nbsp;from&nbsp;matplotlib&nbsp;or&nbsp;similar&nbsp;callable)&nbsp;can&nbsp;be&nbsp;passed</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_182">182</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_190">190</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_183">183</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td><td class="diff_next"></td><td class="diff_header" id="to0_191">191</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_184">184</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td><td class="diff_next"></td><td class="diff_header" id="to0_192">192</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_185">185</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing,&nbsp;the&nbsp;attributes&nbsp;`cluster_labels,&nbsp;colorandum,&nbsp;cluster_ix,&nbsp;cluster_uid`&nbsp;are&nbsp;created.</td><td class="diff_next"></td><td class="diff_header" id="to0_193">193</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing,&nbsp;the&nbsp;attributes&nbsp;`cluster_labels,&nbsp;colorandum,&nbsp;cluster_ix,&nbsp;cluster_uid`&nbsp;are&nbsp;created.</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__18"></td><td class="diff_header" id="from0_186">186</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_194">194</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_187">187</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_195">195</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_188">188</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.cluster_labels&nbsp;=&nbsp;np.array(cluster_labels)</td><td class="diff_next"></td><td class="diff_header" id="to0_196">196</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.cluster_labels&nbsp;=&nbsp;np.array(cluster_labels)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_189">189</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.cluster_labels.dtype&nbsp;==&nbsp;"O":&nbsp;&nbsp;#&nbsp;Fixes&nbsp;a&nbsp;bug&nbsp;when&nbsp;importing&nbsp;from&nbsp;pandas</td><td class="diff_next"></td><td class="diff_header" id="to0_197">197</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.cluster_labels.dtype&nbsp;==&nbsp;"O":&nbsp;&nbsp;#&nbsp;Fixes&nbsp;a&nbsp;bug&nbsp;when&nbsp;importing&nbsp;from&nbsp;pandas</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_190">190</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.cluster_labels&nbsp;=&nbsp;self.cluster_labels.astype(np.string_)</td><td class="diff_next"></td><td class="diff_header" id="to0_198">198</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.cluster_labels&nbsp;=&nbsp;self.cluster_labels.astype(np.string_)</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__19">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to0__19">n</a></td><td class="diff_header" id="to0_199">199</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#print(self.cluster_labels)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_200">200</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#for&nbsp;label&nbsp;in&nbsp;self.cluster_labels):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_201">201</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;str(label,'utf-8')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_191">191</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;cluster_colors_dict:</td><td class="diff_next"></td><td class="diff_header" id="to0_202">202</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;cluster_colors_dict:</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__19"></td><td class="diff_header" id="from0_192">192</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.colorandum&nbsp;=&nbsp;np.array([cluster_colors_dict[i]&nbsp;for&nbsp;i&nbsp;in&nbsp;cluster_labels])</td><td class="diff_next"></td><td class="diff_header" id="to0_203">203</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.colorandum&nbsp;=&nbsp;np.array([cluster_colors_dict[i]&nbsp;for&nbsp;i&nbsp;in&nbsp;cluster_labels])</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_193">193</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.cluster_colors_dict&nbsp;=&nbsp;cluster_colors_dict</td><td class="diff_next"></td><td class="diff_header" id="to0_204">204</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.cluster_colors_dict&nbsp;=&nbsp;cluster_colors_dict</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_194">194</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.colormap&nbsp;=&nbsp;None</td><td class="diff_next"></td><td class="diff_header" id="to0_205">205</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.colormap&nbsp;=&nbsp;None</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_195">195</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_206">206</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_196">196</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;colormap&nbsp;is&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_207">207</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;colormap&nbsp;is&nbsp;None:</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__20">n</a></td><td class="diff_header" id="from0_197">197</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.colorandum&nbsp;=&nbsp;colormap_fun<span class="diff_chg">(</span>self.cluster_ix<span class="diff_chg">)</span></td><td class="diff_next"><a href="#difflib_chg_to0__20">n</a></td><td class="diff_header" id="to0_208">208</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.colorandum&nbsp;=&nbsp;colormap_fun<span class="diff_chg">[</span>self.cluster_ix<span class="diff_chg">]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_198">198</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cluster_uid&nbsp;=&nbsp;self.cluster_uid</td><td class="diff_next"></td><td class="diff_header" id="to0_209">209</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cluster_uid&nbsp;=&nbsp;self.cluster_uid</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_199">199</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.cluster_colors_dict&nbsp;=&nbsp;{cluster_uid[i]:&nbsp;colormap_fun(i)&nbsp;for&nbsp;i&nbsp;in&nbsp;range(len(cluster_uid))}</td><td class="diff_next"></td><td class="diff_header" id="to0_210">210</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.cluster_colors_dict&nbsp;=&nbsp;{cluster_uid[i]:&nbsp;colormap_fun(i)&nbsp;for&nbsp;i&nbsp;in&nbsp;range(len(cluster_uid))}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_200">200</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_211">211</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__20"></td><td class="diff_header" id="from0_201">201</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.colormap&nbsp;=&nbsp;colormap</td><td class="diff_next"></td><td class="diff_header" id="to0_212">212</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.colormap&nbsp;=&nbsp;colormap</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_202">202</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.colorandum&nbsp;=&nbsp;self.colormap(self.cluster_ix)</td><td class="diff_next"></td><td class="diff_header" id="to0_213">213</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.colorandum&nbsp;=&nbsp;self.colormap(self.cluster_ix)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_203">203</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cluster_uid&nbsp;=&nbsp;self.cluster_uid</td><td class="diff_next"></td><td class="diff_header" id="to0_214">214</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cluster_uid&nbsp;=&nbsp;self.cluster_uid</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_204">204</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.cluster_colors_dict&nbsp;=&nbsp;{cluster_uid[i]:&nbsp;self.colormap(i)&nbsp;for&nbsp;i&nbsp;in&nbsp;range(len(cluster_uid))}</td><td class="diff_next"></td><td class="diff_header" id="to0_215">215</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.cluster_colors_dict&nbsp;=&nbsp;{cluster_uid[i]:&nbsp;self.colormap(i)&nbsp;for&nbsp;i&nbsp;in&nbsp;range(len(cluster_uid))}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_205">205</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_216">216</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__21">n</a></td><td class="diff_header" id="from0_206">206</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__21">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_207">207</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;@property</td><td class="diff_next"></td><td class="diff_header" id="to0_217">217</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;@property</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_208">208</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;cluster_uid(self)&nbsp;-&gt;&nbsp;np.ndarray:</td><td class="diff_next"></td><td class="diff_header" id="to0_218">218</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;cluster_uid(self)&nbsp;-&gt;&nbsp;np.ndarray:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_209">209</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clusters_uid&nbsp;=&nbsp;np.unique(self.cluster_labels)</td><td class="diff_next"></td><td class="diff_header" id="to0_219">219</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clusters_uid&nbsp;=&nbsp;np.unique(self.cluster_labels)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_210">210</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;clusters_uid</td><td class="diff_next"></td><td class="diff_header" id="to0_220">220</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;clusters_uid</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_211">211</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_221">221</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__21"></td><td class="diff_header" id="from0_212">212</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;@property</td><td class="diff_next"></td><td class="diff_header" id="to0_222">222</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;@property</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_213">213</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;cluster_ix(self)&nbsp;-&gt;&nbsp;np.ndarray:</td><td class="diff_next"></td><td class="diff_header" id="to0_223">223</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;cluster_ix(self)&nbsp;-&gt;&nbsp;np.ndarray:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_214">214</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_,&nbsp;cluster_ix&nbsp;=&nbsp;np.unique(self.cluster_labels,&nbsp;return_inverse=True)</td><td class="diff_next"></td><td class="diff_header" id="to0_224">224</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_,&nbsp;cluster_ix&nbsp;=&nbsp;np.unique(self.cluster_labels,&nbsp;return_inverse=True)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_215">215</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;cluster_ix</td><td class="diff_next"></td><td class="diff_header" id="to0_225">225</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;cluster_ix</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_216">216</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_226">226</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__22">n</a></td><td class="diff_header" id="from0_217">217</td><td nowrap="nowrap"><span class="diff_sub">[docs]&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;score_cv_vs_mean(self,&nbsp;N:&nbsp;int=3000,&nbsp;min_expr_cells:&nbsp;int=2,&nbsp;max_expr_avg:&nbsp;float=20,&nbsp;min_expr_avg:&nbsp;int=0,&nbsp;svr_gamma:&nbsp;float=None,</span></td><td class="diff_next"><a href="#difflib_chg_to0__22">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_218">218</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;winsorize:&nbsp;bool=False,&nbsp;winsor_perc:&nbsp;Tuple[float,&nbsp;float]=(1,&nbsp;99.5),&nbsp;sort_inverse:&nbsp;bool=False,&nbsp;which:&nbsp;str="S",</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_219">219</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plot:&nbsp;bool=False)&nbsp;-&gt;&nbsp;np.ndarray:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_220">220</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Rank&nbsp;genes&nbsp;on&nbsp;the&nbsp;basis&nbsp;of&nbsp;a&nbsp;CV&nbsp;vs&nbsp;mean&nbsp;fit,&nbsp;it&nbsp;uses&nbsp;a&nbsp;nonparametric&nbsp;fit&nbsp;(Support&nbsp;Vector&nbsp;Regression)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_221">221</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_222">222</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_223">223</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_224">224</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N:&nbsp;int</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_225">225</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;number&nbsp;to&nbsp;select</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_226">226</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_expr_cells:&nbsp;int,&nbsp;(default=2)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_227">227</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimum&nbsp;number&nbsp;of&nbsp;cells&nbsp;that&nbsp;express&nbsp;that&nbsp;gene&nbsp;for&nbsp;it&nbsp;to&nbsp;be&nbsp;considered&nbsp;in&nbsp;the&nbsp;fit</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_228">228</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_expr_avg:&nbsp;int,&nbsp;(default=0)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_229">229</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;minimum&nbsp;average&nbsp;accepted&nbsp;before&nbsp;discarding&nbsp;from&nbsp;the&nbsp;the&nbsp;gene&nbsp;as&nbsp;not&nbsp;expressed</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_230">230</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max_expr_avg:&nbsp;float,&nbsp;(default=20)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_231">231</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;maximum&nbsp;average&nbsp;accepted&nbsp;before&nbsp;discarding&nbsp;from&nbsp;the&nbsp;the&nbsp;gene&nbsp;as&nbsp;house-keeping/outlier</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_232">232</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;svr_gamma:&nbsp;float</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_233">233</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;gamma&nbsp;hyper-parameter&nbsp;of&nbsp;the&nbsp;SVR</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_234">234</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;winsorize:&nbsp;bool</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_235">235</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Wether&nbsp;to&nbsp;winsorize&nbsp;the&nbsp;data&nbsp;for&nbsp;the&nbsp;cv&nbsp;vs&nbsp;mean&nbsp;model</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_236">236</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;winsor_perc:&nbsp;tuple,&nbsp;default=(1,&nbsp;99.5)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_237">237</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;up&nbsp;and&nbsp;lower&nbsp;bound&nbsp;of&nbsp;the&nbsp;winsorization</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_238">238</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort_inverse:&nbsp;bool,&nbsp;(default=False)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_239">239</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;True&nbsp;it&nbsp;sorts&nbsp;genes&nbsp;from&nbsp;less&nbsp;noisy&nbsp;to&nbsp;more&nbsp;noisy&nbsp;(to&nbsp;use&nbsp;for&nbsp;size&nbsp;estimation&nbsp;not&nbsp;for&nbsp;feature&nbsp;selection)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_240">240</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;which:&nbsp;bool,&nbsp;(default="S")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_241">241</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it&nbsp;performs&nbsp;the&nbsp;same&nbsp;cv_vs&nbsp;mean&nbsp;procedure&nbsp;on&nbsp;spliced&nbsp;"S"&nbsp;or&nbsp;unspliced&nbsp;"U"&nbsp;count</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_242">242</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"both"&nbsp;is&nbsp;NOT&nbsp;supported&nbsp;here&nbsp;because&nbsp;most&nbsp;often&nbsp;S&nbsp;the&nbsp;two&nbsp;procedure&nbsp;would&nbsp;have&nbsp;different&nbsp;parameters</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_243">243</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(notice&nbsp;that&nbsp;default&nbsp;parameters&nbsp;are&nbsp;good&nbsp;heuristics&nbsp;only&nbsp;for&nbsp;S)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_244">244</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plot:&nbsp;bool,&nbsp;default=False</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_245">245</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whether&nbsp;to&nbsp;show&nbsp;a&nbsp;plot</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_246">246</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_247">247</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_248">248</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_249">249</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;but&nbsp;it&nbsp;creates&nbsp;the&nbsp;attributes</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_250">250</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_mean_score:&nbsp;np.ndarray</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_251">251</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;How&nbsp;much&nbsp;the&nbsp;observed&nbsp;CV&nbsp;is&nbsp;higher&nbsp;than&nbsp;the&nbsp;one&nbsp;predicted&nbsp;by&nbsp;a&nbsp;noise&nbsp;model&nbsp;fit&nbsp;to&nbsp;the&nbsp;data</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_252">252</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_mean_selected:&nbsp;np.ndarray&nbsp;bool</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_253">253</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;on&nbsp;the&nbsp;basis&nbsp;of&nbsp;the&nbsp;N&nbsp;parameter</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_254">254</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_255">255</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note:&nbsp;genes&nbsp;excluded&nbsp;from&nbsp;the&nbsp;fit&nbsp;will&nbsp;have&nbsp;in&nbsp;the&nbsp;output&nbsp;the&nbsp;same&nbsp;score&nbsp;as&nbsp;the&nbsp;lowest&nbsp;scoring&nbsp;gene&nbsp;in&nbsp;the&nbsp;dataset.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_256">256</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_257">257</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To&nbsp;perform&nbsp;the&nbsp;filtering&nbsp;use&nbsp;the&nbsp;method&nbsp;`filter_genes`</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_258">258</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_259">259</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;which&nbsp;==&nbsp;"S":</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_260">260</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;winsorize:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_261">261</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;min_expr_cells&nbsp;&lt;=&nbsp;((100&nbsp;-&nbsp;winsor_perc[1])&nbsp;*&nbsp;self.S.shape[1]&nbsp;*&nbsp;0.01):</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_262">262</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_expr_cells&nbsp;=&nbsp;int(np.ceil((100&nbsp;-&nbsp;winsor_perc[1])&nbsp;*&nbsp;self.S.shape[0]&nbsp;*&nbsp;0.01))&nbsp;+&nbsp;2</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_263">263</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"min_expr_cells&nbsp;is&nbsp;too&nbsp;low&nbsp;for&nbsp;winsorization&nbsp;with&nbsp;upper_perc&nbsp;={winsor_perc[1]},&nbsp;upgrading&nbsp;to&nbsp;min_expr_cells&nbsp;={min_expr_cells}")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_264">264</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_265">265</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;detected_bool&nbsp;=&nbsp;((self.S&nbsp;&gt;&nbsp;0).sum(1)&nbsp;&gt;&nbsp;min_expr_cells)&nbsp;&amp;&nbsp;(self.S.mean(1)&nbsp;&lt;&nbsp;max_expr_avg)&nbsp;&amp;&nbsp;(self.S.mean(1)&nbsp;&gt;&nbsp;min_expr_avg)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_266">266</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sf&nbsp;=&nbsp;self.S[detected_bool,&nbsp;:]</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_267">267</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;winsorize:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_268">268</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;down,&nbsp;up&nbsp;=&nbsp;np.percentile(Sf,&nbsp;winsor_perc,&nbsp;1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_269">269</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sfw&nbsp;=&nbsp;np.clip(Sf,&nbsp;down[:,&nbsp;None],&nbsp;up[:,&nbsp;None])</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_270">270</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu&nbsp;=&nbsp;Sfw.mean(1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_271">271</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma&nbsp;=&nbsp;Sfw.std(1,&nbsp;ddof=1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_272">272</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_273">273</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu&nbsp;=&nbsp;Sf.mean(1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_274">274</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma&nbsp;=&nbsp;Sf.std(1,&nbsp;ddof=1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_275">275</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_276">276</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv&nbsp;=&nbsp;sigma&nbsp;/&nbsp;mu</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_277">277</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log_m&nbsp;=&nbsp;np.log2(mu)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_278">278</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log_cv&nbsp;=&nbsp;np.log2(cv)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_279">279</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_280">280</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;svr_gamma&nbsp;is&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_281">281</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;svr_gamma&nbsp;=&nbsp;150.&nbsp;/&nbsp;len(mu)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_282">282</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"svr_gamma&nbsp;set&nbsp;to&nbsp;{svr_gamma}")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_283">283</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Fit&nbsp;the&nbsp;Support&nbsp;Vector&nbsp;Regression</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_284">284</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clf&nbsp;=&nbsp;SVR(gamma=svr_gamma)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_285">285</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clf.fit(log_m[:,&nbsp;None],&nbsp;log_cv)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_286">286</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fitted_fun&nbsp;=&nbsp;clf.predict</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_287">287</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ff&nbsp;=&nbsp;fitted_fun(log_m[:,&nbsp;None])</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_288">288</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;score&nbsp;=&nbsp;log_cv&nbsp;-&nbsp;ff</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_289">289</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;sort_inverse:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_290">290</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;score&nbsp;=&nbsp;-&nbsp;score</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_291">291</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nth_score&nbsp;=&nbsp;np.sort(score)[::-1][N]</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_292">292</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;plot:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_293">293</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scatter_viz(log_m[score&nbsp;&gt;&nbsp;nth_score],&nbsp;log_cv[score&nbsp;&gt;&nbsp;nth_score],&nbsp;s=3,&nbsp;alpha=0.4,&nbsp;c="tab:red")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_294">294</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scatter_viz(log_m[score&nbsp;&lt;=&nbsp;nth_score],&nbsp;log_cv[score&nbsp;&lt;=&nbsp;nth_score],&nbsp;s=3,&nbsp;alpha=0.4,&nbsp;c="tab:blue")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_295">295</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu_linspace&nbsp;=&nbsp;np.linspace(np.min(log_m),&nbsp;np.max(log_m))</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_296">296</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.plot(mu_linspace,&nbsp;fitted_fun(mu_linspace[:,&nbsp;None]),&nbsp;c="k")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_297">297</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.xlabel("log2&nbsp;mean&nbsp;S")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_298">298</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.ylabel("log2&nbsp;CV&nbsp;S")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_299">299</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.cv_mean_score&nbsp;=&nbsp;np.zeros(detected_bool.shape)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_300">300</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.cv_mean_score[~detected_bool]&nbsp;=&nbsp;np.min(score)&nbsp;-&nbsp;1e-16</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_301">301</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.cv_mean_score[detected_bool]&nbsp;=&nbsp;score</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_302">302</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.cv_mean_selected&nbsp;=&nbsp;self.cv_mean_score&nbsp;&gt;=&nbsp;nth_score</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_303">303</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_304">304</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;winsorize:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_305">305</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;min_expr_cells&nbsp;&lt;=&nbsp;((100&nbsp;-&nbsp;winsor_perc[1])&nbsp;*&nbsp;self.U.shape[1]&nbsp;*&nbsp;0.01):</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_306">306</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_expr_cells&nbsp;=&nbsp;int(np.ceil((100&nbsp;-&nbsp;winsor_perc[1])&nbsp;*&nbsp;self.U.shape[0]&nbsp;*&nbsp;0.01))&nbsp;+&nbsp;2</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_307">307</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"min_expr_cells&nbsp;is&nbsp;too&nbsp;low&nbsp;for&nbsp;winsorization&nbsp;with&nbsp;upper_perc&nbsp;={winsor_perc[1]},&nbsp;upgrading&nbsp;to&nbsp;min_expr_cells&nbsp;={min_expr_cells}")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_308">308</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_309">309</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;detected_bool&nbsp;=&nbsp;((self.U&nbsp;&gt;&nbsp;0).sum(1)&nbsp;&gt;&nbsp;min_expr_cells)&nbsp;&amp;&nbsp;(self.U.mean(1)&nbsp;&lt;&nbsp;max_expr_avg)&nbsp;&amp;&nbsp;(self.U.mean(1)&nbsp;&gt;&nbsp;min_expr_avg)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_310">310</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Uf&nbsp;=&nbsp;self.U[detected_bool,&nbsp;:]</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_311">311</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;winsorize:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_312">312</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;down,&nbsp;up&nbsp;=&nbsp;np.percentile(Uf,&nbsp;winsor_perc,&nbsp;1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_313">313</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ufw&nbsp;=&nbsp;np.clip(Uf,&nbsp;down[:,&nbsp;None],&nbsp;up[:,&nbsp;None])</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_314">314</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu&nbsp;=&nbsp;Ufw.mean(1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_315">315</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma&nbsp;=&nbsp;Ufw.std(1,&nbsp;ddof=1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_316">316</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_317">317</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu&nbsp;=&nbsp;Uf.mean(1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_318">318</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma&nbsp;=&nbsp;Uf.std(1,&nbsp;ddof=1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_319">319</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_320">320</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv&nbsp;=&nbsp;sigma&nbsp;/&nbsp;mu</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_321">321</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log_m&nbsp;=&nbsp;np.log2(mu)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_322">322</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log_cv&nbsp;=&nbsp;np.log2(cv)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_323">323</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_324">324</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;svr_gamma&nbsp;is&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_325">325</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;svr_gamma&nbsp;=&nbsp;150.&nbsp;/&nbsp;len(mu)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_326">326</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"svr_gamma&nbsp;set&nbsp;to&nbsp;{svr_gamma}")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_327">327</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Fit&nbsp;the&nbsp;Support&nbsp;Vector&nbsp;Regression</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_328">328</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clf&nbsp;=&nbsp;SVR(gamma=svr_gamma)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_329">329</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clf.fit(log_m[:,&nbsp;None],&nbsp;log_cv)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_330">330</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fitted_fun&nbsp;=&nbsp;clf.predict</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_331">331</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ff&nbsp;=&nbsp;fitted_fun(log_m[:,&nbsp;None])</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_332">332</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;score&nbsp;=&nbsp;log_cv&nbsp;-&nbsp;ff</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_333">333</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;sort_inverse:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_334">334</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;score&nbsp;=&nbsp;-&nbsp;score</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_335">335</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nth_score&nbsp;=&nbsp;np.sort(score)[::-1][N]</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_336">336</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;plot:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_337">337</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scatter_viz(log_m[score&nbsp;&gt;&nbsp;nth_score],&nbsp;log_cv[score&nbsp;&gt;&nbsp;nth_score],&nbsp;s=3,&nbsp;alpha=0.4,&nbsp;c="tab:red")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_338">338</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scatter_viz(log_m[score&nbsp;&lt;=&nbsp;nth_score],&nbsp;log_cv[score&nbsp;&lt;=&nbsp;nth_score],&nbsp;s=3,&nbsp;alpha=0.4,&nbsp;c="tab:blue")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_339">339</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu_linspace&nbsp;=&nbsp;np.linspace(np.min(log_m),&nbsp;np.max(log_m))</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_340">340</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.plot(mu_linspace,&nbsp;fitted_fun(mu_linspace[:,&nbsp;None]),&nbsp;c="k")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_341">341</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.xlabel("log2&nbsp;mean&nbsp;U")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_342">342</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.ylabel("log2&nbsp;CV&nbsp;U")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_343">343</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Ucv_mean_score&nbsp;=&nbsp;np.zeros(detected_bool.shape)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_344">344</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Ucv_mean_score[~detected_bool]&nbsp;=&nbsp;np.min(score)&nbsp;-&nbsp;1e-16</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_345">345</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Ucv_mean_score[detected_bool]&nbsp;=&nbsp;score</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_346">346</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Ucv_mean_selected&nbsp;=&nbsp;self.Ucv_mean_score&nbsp;&gt;=&nbsp;nth_score</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_347">347</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_348">348</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_349">349</td><td nowrap="nowrap"><span class="diff_sub">[docs]&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;robust_size_factor(self,&nbsp;pc:&nbsp;float=0.1,&nbsp;which:&nbsp;str="both")&nbsp;-&gt;&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_350">350</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Calculates&nbsp;a&nbsp;size&nbsp;factor&nbsp;in&nbsp;a&nbsp;similar&nbsp;way&nbsp;of&nbsp;Anders&nbsp;and&nbsp;Huber&nbsp;2010</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_351">351</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_352">352</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_353">353</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_354">354</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pc:&nbsp;float,&nbsp;default=0.1</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_355">355</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;pseudocount&nbsp;to&nbsp;add&nbsp;to&nbsp;the&nbsp;expression&nbsp;before&nbsp;taking&nbsp;the&nbsp;log&nbsp;for&nbsp;the&nbsp;purpose&nbsp;of&nbsp;the&nbsp;size&nbsp;factor&nbsp;calculation</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_356">356</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;which:&nbsp;str,&nbsp;default="both"</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_357">357</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;which&nbsp;counts&nbsp;estimate&nbsp;the&nbsp;normalization&nbsp;size&nbsp;factor.&nbsp;It&nbsp;can&nbsp;be&nbsp;"both",&nbsp;"S"&nbsp;or&nbsp;"U"</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_358">358</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_359">359</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_360">360</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_361">361</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;but&nbsp;it&nbsp;creates&nbsp;the&nbsp;attribute&nbsp;`self.size_factor`&nbsp;and&nbsp;`self.Usize_factor`</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_362">362</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;normalization&nbsp;is&nbsp;self.S&nbsp;/&nbsp;self.size_factor&nbsp;and&nbsp;is&nbsp;performed&nbsp;by&nbsp;using&nbsp;`self.normalize(relative_size=self.size_factor)`</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_363">363</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_364">364</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_365">365</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_366">366</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Before&nbsp;running&nbsp;this&nbsp;method&nbsp;`score_cv_vs_mean`&nbsp;need&nbsp;to&nbsp;be&nbsp;run&nbsp;with&nbsp;sort_inverse=True,&nbsp;since&nbsp;only&nbsp;lowly&nbsp;variable&nbsp;genes&nbsp;are&nbsp;used&nbsp;for&nbsp;this&nbsp;size&nbsp;estimation</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_367">367</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_368">368</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;which&nbsp;==&nbsp;"both":</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_369">369</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y&nbsp;=&nbsp;np.log2(self.S[self.cv_mean_selected,&nbsp;:]&nbsp;+&nbsp;pc)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_370">370</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y_avg&nbsp;=&nbsp;Y.mean(1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_371">371</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.size_factor:&nbsp;np.ndarray&nbsp;=&nbsp;np.median(2**(Y&nbsp;-&nbsp;Y_avg[:,&nbsp;None]),&nbsp;axis=0)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_372">372</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.size_factor&nbsp;=&nbsp;self.size_factor&nbsp;/&nbsp;np.mean(self.size_factor)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_373">373</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_374">374</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y&nbsp;=&nbsp;np.log2(self.U[self.Ucv_mean_selected,&nbsp;:]&nbsp;+&nbsp;pc)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_375">375</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y_avg&nbsp;=&nbsp;Y.mean(1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_376">376</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Usize_factor:&nbsp;np.ndarray&nbsp;=&nbsp;np.median(2**(Y&nbsp;-&nbsp;Y_avg[:,&nbsp;None]),&nbsp;axis=0)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_377">377</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Usize_factor&nbsp;=&nbsp;self.Usize_factor&nbsp;/&nbsp;np.mean(self.Usize_factor)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_378">378</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;which&nbsp;==&nbsp;"S":</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_379">379</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y&nbsp;=&nbsp;np.log2(self.S[self.cv_mean_selected,&nbsp;:]&nbsp;+&nbsp;pc)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_380">380</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y_avg&nbsp;=&nbsp;Y.mean(1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_381">381</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.size_factor:&nbsp;np.ndarray&nbsp;=&nbsp;np.median(2**(Y&nbsp;-&nbsp;Y_avg[:,&nbsp;None]),&nbsp;axis=0)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_382">382</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.size_factor&nbsp;=&nbsp;self.size_factor&nbsp;/&nbsp;np.mean(self.size_factor)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_383">383</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;which&nbsp;==&nbsp;"U":</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_384">384</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y&nbsp;=&nbsp;np.log2(self.U[self.Ucv_mean_selected,&nbsp;:]&nbsp;+&nbsp;pc)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_385">385</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y_avg&nbsp;=&nbsp;Y.mean(1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_386">386</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Usize_factor:&nbsp;np.ndarray&nbsp;=&nbsp;np.median(2**(Y&nbsp;-&nbsp;Y_avg[:,&nbsp;None]),&nbsp;axis=0)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_387">387</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Usize_factor&nbsp;=&nbsp;self.Usize_factor&nbsp;/&nbsp;np.mean(self.Usize_factor)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_388">388</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_389">389</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_390">390</td><td nowrap="nowrap"><span class="diff_sub">[docs]</span>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;score_cluster_expression(self,&nbsp;min_avg_U:&nbsp;float=0.02,&nbsp;min_avg_S:&nbsp;float=0.08)&nbsp;-&gt;&nbsp;np.ndarray:</td><td class="diff_next"></td><td class="diff_header" id="to0_227">227</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;score_cluster_expression(self,&nbsp;min_avg_U:&nbsp;float=0.02,&nbsp;min_avg_S:&nbsp;float=0.08)&nbsp;-&gt;&nbsp;np.ndarray:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_391">391</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Prepare&nbsp;filtering&nbsp;genes&nbsp;on&nbsp;the&nbsp;basis&nbsp;of&nbsp;cluster-wise&nbsp;expression&nbsp;threshold</td><td class="diff_next"></td><td class="diff_header" id="to0_228">228</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Prepare&nbsp;filtering&nbsp;genes&nbsp;on&nbsp;the&nbsp;basis&nbsp;of&nbsp;cluster-wise&nbsp;expression&nbsp;threshold</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_392">392</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_229">229</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_393">393</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td><td class="diff_next"></td><td class="diff_header" id="to0_230">230</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_394">394</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td><td class="diff_next"></td><td class="diff_header" id="to0_231">231</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_395">395</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_avg_U:&nbsp;float</td><td class="diff_next"></td><td class="diff_header" id="to0_232">232</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_avg_U:&nbsp;float</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_396">396</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Include&nbsp;genes&nbsp;that&nbsp;have&nbsp;unspliced&nbsp;average&nbsp;bigger&nbsp;than&nbsp;`min_avg_U`&nbsp;in&nbsp;at&nbsp;least&nbsp;one&nbsp;of&nbsp;the&nbsp;clusters</td><td class="diff_next"></td><td class="diff_header" id="to0_233">233</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Include&nbsp;genes&nbsp;that&nbsp;have&nbsp;unspliced&nbsp;average&nbsp;bigger&nbsp;than&nbsp;`min_avg_U`&nbsp;in&nbsp;at&nbsp;least&nbsp;one&nbsp;of&nbsp;the&nbsp;clusters</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_397">397</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_avg_S:&nbsp;float</td><td class="diff_next"></td><td class="diff_header" id="to0_234">234</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_avg_S:&nbsp;float</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_398">398</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Include&nbsp;genes&nbsp;that&nbsp;have&nbsp;spliced&nbsp;average&nbsp;bigger&nbsp;than&nbsp;`min_avg_U`&nbsp;in&nbsp;at&nbsp;least&nbsp;one&nbsp;of&nbsp;the&nbsp;clusters</td><td class="diff_next"></td><td class="diff_header" id="to0_235">235</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Include&nbsp;genes&nbsp;that&nbsp;have&nbsp;spliced&nbsp;average&nbsp;bigger&nbsp;than&nbsp;`min_avg_U`&nbsp;in&nbsp;at&nbsp;least&nbsp;one&nbsp;of&nbsp;the&nbsp;clusters</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_399">399</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note:&nbsp;the&nbsp;two&nbsp;conditions&nbsp;are&nbsp;combined&nbsp;by&nbsp;and&nbsp;"&amp;"&nbsp;logical&nbsp;operator</td><td class="diff_next"></td><td class="diff_header" id="to0_236">236</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note:&nbsp;the&nbsp;two&nbsp;conditions&nbsp;are&nbsp;combined&nbsp;by&nbsp;and&nbsp;"&amp;"&nbsp;logical&nbsp;operator</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_400">400</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_237">237</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_401">401</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td><td class="diff_next"></td><td class="diff_header" id="to0_238">238</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_402">402</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td><td class="diff_next"></td><td class="diff_header" id="to0_239">239</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_403">403</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;but&nbsp;it&nbsp;creates&nbsp;the&nbsp;attribute</td><td class="diff_next"></td><td class="diff_header" id="to0_240">240</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;but&nbsp;it&nbsp;creates&nbsp;the&nbsp;attribute</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_404">404</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clu_avg_selected:&nbsp;np.ndarray&nbsp;bool</td><td class="diff_next"></td><td class="diff_header" id="to0_241">241</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clu_avg_selected:&nbsp;np.ndarray&nbsp;bool</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_405">405</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;gene&nbsp;cluster&nbsp;that&nbsp;is&nbsp;selected</td><td class="diff_next"></td><td class="diff_header" id="to0_242">242</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;gene&nbsp;cluster&nbsp;that&nbsp;is&nbsp;selected</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__22"></td><td class="diff_header" id="from0_406">406</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To&nbsp;perform&nbsp;the&nbsp;filtering&nbsp;use&nbsp;the&nbsp;method&nbsp;`filter_genes`</td><td class="diff_next"></td><td class="diff_header" id="to0_243">243</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To&nbsp;perform&nbsp;the&nbsp;filtering&nbsp;use&nbsp;the&nbsp;method&nbsp;`filter_genes`</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_407">407</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_244">244</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_408">408</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.U_avgs,&nbsp;self.S_avgs&nbsp;=&nbsp;clusters_stats(self.U,&nbsp;self.S,&nbsp;self.cluster_uid,&nbsp;self.cluster_ix,&nbsp;size_limit=40)</td><td class="diff_next"></td><td class="diff_header" id="to0_245">245</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.U_avgs,&nbsp;self.S_avgs&nbsp;=&nbsp;clusters_stats(self.U,&nbsp;self.S,&nbsp;self.cluster_uid,&nbsp;self.cluster_ix,&nbsp;size_limit=40)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_409">409</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.clu_avg_selected&nbsp;=&nbsp;(self.U_avgs.max(1)&nbsp;&gt;&nbsp;min_avg_U)&nbsp;&amp;&nbsp;(self.S_avgs.max(1)&nbsp;&gt;&nbsp;min_avg_S)</td><td class="diff_next"></td><td class="diff_header" id="to0_246">246</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.clu_avg_selected&nbsp;=&nbsp;(self.U_avgs.max(1)&nbsp;&gt;&nbsp;min_avg_U)&nbsp;&amp;&nbsp;(self.S_avgs.max(1)&nbsp;&gt;&nbsp;min_avg_S)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_410">410</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_247">247</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__23">n</a></td><td class="diff_header" id="from0_411">411</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__23">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_412">412</td><td nowrap="nowrap"><span class="diff_sub">[docs]&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;score_detection_levels(self,&nbsp;min_expr_counts:&nbsp;int=&nbsp;50,&nbsp;min_cells_express:&nbsp;int=&nbsp;20,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_413">413</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_expr_counts_U:&nbsp;int=&nbsp;0,&nbsp;min_cells_express_U:&nbsp;int=&nbsp;0)&nbsp;-&gt;&nbsp;np.ndarray:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_414">414</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Prepare&nbsp;basic&nbsp;filtering&nbsp;of&nbsp;genes&nbsp;on&nbsp;the&nbsp;basis&nbsp;of&nbsp;their&nbsp;detection&nbsp;levels</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_415">415</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_416">416</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_417">417</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_418">418</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_expr_counts:&nbsp;float</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_419">419</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;minimum&nbsp;number&nbsp;of&nbsp;spliced&nbsp;molecules&nbsp;detected&nbsp;considering&nbsp;all&nbsp;the&nbsp;cells</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_420">420</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_cells_express:&nbsp;float</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_421">421</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;minimum&nbsp;number&nbsp;of&nbsp;cells&nbsp;that&nbsp;express&nbsp;spliced&nbsp;molecules&nbsp;of&nbsp;a&nbsp;gene</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_422">422</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_expr_counts_U:&nbsp;float</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_423">423</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;minimum&nbsp;number&nbsp;of&nbsp;unspliced&nbsp;molecules&nbsp;detected&nbsp;considering&nbsp;all&nbsp;the&nbsp;cells</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_424">424</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_cells_express_U:&nbsp;float</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_425">425</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;minimum&nbsp;number&nbsp;of&nbsp;cells&nbsp;that&nbsp;express&nbsp;unspliced&nbsp;molecules&nbsp;of&nbsp;a&nbsp;gene</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_426">426</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note:&nbsp;the&nbsp;conditions&nbsp;are&nbsp;combined&nbsp;by&nbsp;and&nbsp;"&amp;"&nbsp;logical&nbsp;operator</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_427">427</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_428">428</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_429">429</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_430">430</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;but&nbsp;an&nbsp;attribute&nbsp;self.detection_level_selected&nbsp;is&nbsp;created</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_431">431</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To&nbsp;perform&nbsp;the&nbsp;filtering&nbsp;by&nbsp;detection&nbsp;levels&nbsp;use&nbsp;the&nbsp;method&nbsp;`filter_genes`</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_432">432</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_433">433</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Some&nbsp;basic&nbsp;filtering</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_434">434</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S_sum&nbsp;=&nbsp;self.S.sum(1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_435">435</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S_ncells_express&nbsp;=&nbsp;(self.S&nbsp;&gt;&nbsp;0).sum(1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_436">436</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;U_sum&nbsp;=&nbsp;self.U.sum(1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_437">437</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;U_ncells_express&nbsp;=&nbsp;(self.U&nbsp;&gt;&nbsp;0).sum(1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_438">438</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filter_bool&nbsp;=&nbsp;(S_sum&nbsp;&gt;=&nbsp;min_expr_counts)&nbsp;&amp;&nbsp;(S_ncells_express&nbsp;&gt;=&nbsp;min_cells_express)&nbsp;&amp;&nbsp;(U_sum&nbsp;&gt;=&nbsp;min_expr_counts_U)&nbsp;&amp;&nbsp;(U_ncells_express&nbsp;&gt;=&nbsp;min_cells_express_U)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_439">439</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.detection_level_selected&nbsp;=&nbsp;filter_bool</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_440">440</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_441">441</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_442">442</td><td nowrap="nowrap"><span class="diff_sub">[docs]&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;filter_genes(self,&nbsp;by_detection_levels:&nbsp;bool=False,&nbsp;by_cluster_expression:&nbsp;bool=False,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_443">443</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by_cv_vs_mean:&nbsp;bool=False,&nbsp;by_custom_array:&nbsp;Any=None,&nbsp;keep_unfiltered:&nbsp;bool=False)&nbsp;-&gt;&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_444">444</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Filter&nbsp;genes&nbsp;taking&nbsp;care&nbsp;that&nbsp;all&nbsp;the&nbsp;matrixes&nbsp;and&nbsp;all&nbsp;the&nbsp;connected&nbsp;annotation&nbsp;get&nbsp;filtered&nbsp;accordingly</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_445">445</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_446">446</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Attributes&nbsp;affected:&nbsp;.U,&nbsp;.S,&nbsp;.ra</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_447">447</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_448">448</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_449">449</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_450">450</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by_detection_levels:&nbsp;bool,&nbsp;default=False</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_451">451</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filter&nbsp;genes&nbsp;by&nbsp;the&nbsp;score_detection_levels&nbsp;result</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_452">452</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_453">453</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by_cluster_expression:&nbsp;bool,&nbsp;default=False</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_454">454</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filter&nbsp;genes&nbsp;by&nbsp;the&nbsp;score_cluster_expression&nbsp;result</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_455">455</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_456">456</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by_cv_vs_mean:&nbsp;bool,&nbsp;default=False</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_457">457</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filter&nbsp;genes&nbsp;by&nbsp;the&nbsp;score_cluster_expression&nbsp;result</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_458">458</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_459">459</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by_custom_array,&nbsp;np.ndarray,&nbsp;default=None</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_460">460</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;provide&nbsp;a&nbsp;boolean&nbsp;or&nbsp;index&nbsp;array</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_461">461</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_462">462</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keep_unfiltered:&nbsp;bool,&nbsp;default=False</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_463">463</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whether&nbsp;to&nbsp;create&nbsp;attributes&nbsp;self.S_prefilter,&nbsp;self.U_prefilter,&nbsp;self.ra_prefilter,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_464">464</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(array&nbsp;will&nbsp;be&nbsp;made&nbsp;sparse&nbsp;to&nbsp;minimize&nbsp;memory&nbsp;footprint)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_465">465</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;just&nbsp;overwrite&nbsp;the&nbsp;previous&nbsp;arrays</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_466">466</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_467">467</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_468">468</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_469">469</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;but&nbsp;it&nbsp;updates&nbsp;the&nbsp;self.S,&nbsp;self.U,&nbsp;self.ra&nbsp;attributes</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_470">470</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_471">471</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assert&nbsp;np.any([by_detection_levels,&nbsp;by_cluster_expression,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_472">472</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by_cv_vs_mean,&nbsp;(type(by_custom_array)&nbsp;is&nbsp;np.ndarray)]),&nbsp;"At&nbsp;least&nbsp;one&nbsp;of&nbsp;the&nbsp;filtering&nbsp;methods&nbsp;needs&nbsp;to&nbsp;be&nbsp;True"</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_473">473</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_filter&nbsp;=&nbsp;np.ones(self.S.shape[0],&nbsp;dtype=bool)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_474">474</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;by_cluster_expression:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_475">475</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assert&nbsp;hasattr(self,&nbsp;"clu_avg_selected"),&nbsp;"clu_avg_selected&nbsp;was&nbsp;not&nbsp;found"</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_476">476</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug("Filtering&nbsp;by&nbsp;cluster&nbsp;expression")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_477">477</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_filter&nbsp;=&nbsp;tmp_filter&nbsp;&amp;&nbsp;self.clu_avg_selected</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_478">478</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;by_cv_vs_mean:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_479">479</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assert&nbsp;hasattr(self,&nbsp;"cv_mean_selected"),&nbsp;"cv_mean_selected&nbsp;was&nbsp;not&nbsp;found"</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_480">480</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug("Filtering&nbsp;by&nbsp;cv&nbsp;vs&nbsp;mean")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_481">481</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_filter&nbsp;=&nbsp;tmp_filter&nbsp;&amp;&nbsp;self.cv_mean_selected</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_482">482</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;by_detection_levels:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_483">483</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assert&nbsp;hasattr(self,&nbsp;"detection_level_selected"),&nbsp;"detection_level_selected&nbsp;was&nbsp;not&nbsp;found"</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_484">484</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug("Filtering&nbsp;by&nbsp;detection&nbsp;level")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_485">485</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_filter&nbsp;=&nbsp;tmp_filter&nbsp;&amp;&nbsp;self.detection_level_selected</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_486">486</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;type(by_custom_array)&nbsp;is&nbsp;np.ndarray:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_487">487</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;by_custom_array.dtype&nbsp;==&nbsp;bool:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_488">488</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug("Filtering&nbsp;by&nbsp;custom&nbsp;boolean&nbsp;array")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_489">489</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_filter&nbsp;=&nbsp;tmp_filter&nbsp;&amp;&nbsp;by_custom_array</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_490">490</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;by_custom_array.dtype&nbsp;==&nbsp;int:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_491">491</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug("Filtering&nbsp;by&nbsp;custom&nbsp;index&nbsp;array")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_492">492</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool_negative&nbsp;=&nbsp;~np.in1d(np.arange(len(tmp_filter)),&nbsp;by_custom_array)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_493">493</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_filter[bool_negative]&nbsp;=&nbsp;False</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_494">494</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_495">495</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;keep_unfiltered:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_496">496</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;hasattr(self,&nbsp;"U_prefilter"):</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_497">497</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug("Attributes&nbsp;*_prefilter&nbsp;are&nbsp;already&nbsp;present&nbsp;and&nbsp;were&nbsp;overwritten")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_498">498</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.U_prefilter&nbsp;=&nbsp;sparse.csr_matrix(self.U)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_499">499</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.S_prefilter&nbsp;=&nbsp;sparse.csr_matrix(self.S)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_500">500</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ra_prefilter&nbsp;=&nbsp;deepcopy(self.ra)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_501">501</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_502">502</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.U&nbsp;=&nbsp;self.U[tmp_filter,&nbsp;:]</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_503">503</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.S&nbsp;=&nbsp;self.S[tmp_filter,&nbsp;:]</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__23"></td><td class="diff_header" id="from0_504">504</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ra&nbsp;=&nbsp;{k:&nbsp;v[tmp_filter]&nbsp;for&nbsp;k,&nbsp;v&nbsp;in&nbsp;self.ra.items()}</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_505">505</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_506">506</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_507">507</td><td nowrap="nowrap"><span class="diff_sub">[docs]</span>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;custom_filter_attributes(self,&nbsp;attr_names:&nbsp;List[str],&nbsp;bool_filter:&nbsp;np.ndarray)&nbsp;-&gt;&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_248">248</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;custom_filter_attributes(self,&nbsp;attr_names:&nbsp;List[str],&nbsp;bool_filter:&nbsp;np.ndarray)&nbsp;-&gt;&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_508">508</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Filter&nbsp;attributes&nbsp;given&nbsp;a&nbsp;boolean&nbsp;array.&nbsp;attr_names&nbsp;can&nbsp;be&nbsp;dictionaries&nbsp;or&nbsp;numpy&nbsp;arrays</td><td class="diff_next"></td><td class="diff_header" id="to0_249">249</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Filter&nbsp;attributes&nbsp;given&nbsp;a&nbsp;boolean&nbsp;array.&nbsp;attr_names&nbsp;can&nbsp;be&nbsp;dictionaries&nbsp;or&nbsp;numpy&nbsp;arrays</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__24">n</a></td><td class="diff_header" id="from0_509">509</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__24">n</a></td><td class="diff_header" id="to0_250">250</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_510">510</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td><td class="diff_next"></td><td class="diff_header" id="to0_251">251</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_511">511</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td><td class="diff_next"></td><td class="diff_header" id="to0_252">252</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_512">512</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;attr_names:&nbsp;List[str]</td><td class="diff_next"></td><td class="diff_header" id="to0_253">253</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;attr_names:&nbsp;List[str]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_513">513</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;list&nbsp;of&nbsp;the&nbsp;attributes&nbsp;to&nbsp;be&nbsp;modified.&nbsp;The&nbsp;can&nbsp;be</td><td class="diff_next"></td><td class="diff_header" id="to0_254">254</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;list&nbsp;of&nbsp;the&nbsp;attributes&nbsp;to&nbsp;be&nbsp;modified.&nbsp;The&nbsp;can&nbsp;be</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_514">514</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1d&nbsp;arrays,&nbsp;dictionary&nbsp;of&nbsp;1d&nbsp;arrays,&nbsp;ndarrays,&nbsp;will&nbsp;be&nbsp;filtered&nbsp;by&nbsp;axis=0</td><td class="diff_next"></td><td class="diff_header" id="to0_255">255</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1d&nbsp;arrays,&nbsp;dictionary&nbsp;of&nbsp;1d&nbsp;arrays,&nbsp;ndarrays,&nbsp;will&nbsp;be&nbsp;filtered&nbsp;by&nbsp;axis=0</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_515">515</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;.T&nbsp;is&nbsp;specified&nbsp;by&nbsp;axis=-1</td><td class="diff_next"></td><td class="diff_header" id="to0_256">256</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;.T&nbsp;is&nbsp;specified&nbsp;by&nbsp;axis=-1</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_516">516</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool_filter:</td><td class="diff_next"></td><td class="diff_header" id="to0_257">257</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool_filter:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_517">517</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;boolean&nbsp;filter&nbsp;to&nbsp;be&nbsp;applied</td><td class="diff_next"></td><td class="diff_header" id="to0_258">258</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;boolean&nbsp;filter&nbsp;to&nbsp;be&nbsp;applied</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_518">518</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_259">259</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_519">519</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td><td class="diff_next"></td><td class="diff_header" id="to0_260">260</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_520">520</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td><td class="diff_next"></td><td class="diff_header" id="to0_261">261</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_521">521</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;it&nbsp;filters&nbsp;the&nbsp;specified&nbsp;attributes</td><td class="diff_next"></td><td class="diff_header" id="to0_262">262</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;it&nbsp;filters&nbsp;the&nbsp;specified&nbsp;attributes</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_522">522</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_263">263</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_523">523</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;transpose_flag&nbsp;=&nbsp;False</td><td class="diff_next"></td><td class="diff_header" id="to0_264">264</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;transpose_flag&nbsp;=&nbsp;False</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_524">524</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;attr&nbsp;in&nbsp;attr_names:</td><td class="diff_next"></td><td class="diff_header" id="to0_265">265</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;attr&nbsp;in&nbsp;attr_names:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_525">525</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;attr[-2:]&nbsp;==&nbsp;".T":</td><td class="diff_next"></td><td class="diff_header" id="to0_266">266</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;attr[-2:]&nbsp;==&nbsp;".T":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_526">526</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obj&nbsp;=&nbsp;getattr(self,&nbsp;attr[:-2])</td><td class="diff_next"></td><td class="diff_header" id="to0_267">267</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obj&nbsp;=&nbsp;getattr(self,&nbsp;attr[:-2])</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_527">527</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;transpose_flag&nbsp;=&nbsp;True</td><td class="diff_next"></td><td class="diff_header" id="to0_268">268</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;transpose_flag&nbsp;=&nbsp;True</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_528">528</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_269">269</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_529">529</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obj&nbsp;=&nbsp;getattr(self,&nbsp;attr)</td><td class="diff_next"></td><td class="diff_header" id="to0_270">270</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obj&nbsp;=&nbsp;getattr(self,&nbsp;attr)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_530">530</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;transpose_flag&nbsp;=&nbsp;False</td><td class="diff_next"></td><td class="diff_header" id="to0_271">271</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;transpose_flag&nbsp;=&nbsp;False</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_531">531</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;type(obj)&nbsp;is&nbsp;dict:</td><td class="diff_next"></td><td class="diff_header" id="to0_272">272</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;type(obj)&nbsp;is&nbsp;dict:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_532">532</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setattr(self,&nbsp;attr,&nbsp;{k:&nbsp;v[bool_filter]&nbsp;for&nbsp;k,&nbsp;v&nbsp;in&nbsp;obj.items()})</td><td class="diff_next"></td><td class="diff_header" id="to0_273">273</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setattr(self,&nbsp;attr,&nbsp;{k:&nbsp;v[bool_filter]&nbsp;for&nbsp;k,&nbsp;v&nbsp;in&nbsp;obj.items()})</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_533">533</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;type(obj)&nbsp;is&nbsp;np.ndarray:</td><td class="diff_next"></td><td class="diff_header" id="to0_274">274</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;type(obj)&nbsp;is&nbsp;np.ndarray:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_534">534</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;len(obj.shape)&nbsp;&gt;&nbsp;1:</td><td class="diff_next"></td><td class="diff_header" id="to0_275">275</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;len(obj.shape)&nbsp;&gt;&nbsp;1:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_535">535</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;transpose_flag:</td><td class="diff_next"></td><td class="diff_header" id="to0_276">276</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;transpose_flag:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_536">536</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setattr(self,&nbsp;attr,&nbsp;obj[...,&nbsp;bool_filter])</td><td class="diff_next"></td><td class="diff_header" id="to0_277">277</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setattr(self,&nbsp;attr,&nbsp;obj[...,&nbsp;bool_filter])</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_537">537</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_278">278</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_538">538</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setattr(self,&nbsp;attr,&nbsp;obj[bool_filter,&nbsp;:])</td><td class="diff_next"></td><td class="diff_header" id="to0_279">279</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setattr(self,&nbsp;attr,&nbsp;obj[bool_filter,&nbsp;:])</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_539">539</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_280">280</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__24"></td><td class="diff_header" id="from0_540">540</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setattr(self,&nbsp;attr,&nbsp;obj[bool_filter])</td><td class="diff_next"></td><td class="diff_header" id="to0_281">281</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setattr(self,&nbsp;attr,&nbsp;obj[bool_filter])</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_541">541</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_282">282</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_542">542</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;NotImplementedError(f"The&nbsp;filtering&nbsp;of&nbsp;an&nbsp;object&nbsp;of&nbsp;type&nbsp;{type(obj)}&nbsp;is&nbsp;not&nbsp;defined")</td><td class="diff_next"></td><td class="diff_header" id="to0_283">283</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;NotImplementedError(f"The&nbsp;filtering&nbsp;of&nbsp;an&nbsp;object&nbsp;of&nbsp;type&nbsp;{type(obj)}&nbsp;is&nbsp;not&nbsp;defined")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_543">543</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_284">284</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_544">544</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_285">285</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__25">n</a></td><td class="diff_header" id="from0_545">545</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;_normalize_S(self,&nbsp;size:&nbsp;bool=True,&nbsp;log:&nbsp;bool=True,&nbsp;pcount:&nbsp;float=1,&nbsp;relative_size:&nbsp;Any=None,&nbsp;target_size:&nbsp;Any=None)&nbsp;-&gt;&nbsp;np.ndarray:</span></td><td class="diff_next"><a href="#difflib_chg_to0__25">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_546">546</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Internal&nbsp;function&nbsp;for&nbsp;the&nbsp;spliced&nbsp;molecule&nbsp;filtering.&nbsp;The&nbsp;`normalize`&nbsp;method&nbsp;should&nbsp;be&nbsp;used&nbsp;as&nbsp;a&nbsp;standard&nbsp;interface"""</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_547">547</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;size:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_548">548</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;type(relative_size)&nbsp;is&nbsp;np.ndarray:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_549">549</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.cell_size&nbsp;=&nbsp;relative_size</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_550">550</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_551">551</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.cell_size&nbsp;=&nbsp;self.S.sum(0)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_552">552</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;target_size&nbsp;is&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_553">553</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.avg_size&nbsp;=&nbsp;self.cell_size.mean()</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_554">554</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_555">555</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.avg_size&nbsp;=&nbsp;target_size</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_556">556</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.norm_factor&nbsp;=&nbsp;self.avg_size&nbsp;/&nbsp;self.cell_size</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_557">557</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_558">558</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.norm_factor&nbsp;=&nbsp;1</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_559">559</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.S_sz&nbsp;=&nbsp;self.norm_factor&nbsp;*&nbsp;self.S</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_560">560</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;log:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_561">561</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.S_norm&nbsp;=&nbsp;np.log2(self.S_sz&nbsp;+&nbsp;pcount)&nbsp;&nbsp;#&nbsp;np.sqrt(S_sz&nbsp;)#&nbsp;np.log2(S_sz&nbsp;+&nbsp;1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_562">562</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_563">563</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;_normalize_U(self,&nbsp;size:&nbsp;bool=True,&nbsp;log:&nbsp;bool=True,&nbsp;pcount:&nbsp;float=1,&nbsp;use_S_size:&nbsp;bool=False,&nbsp;relative_size:&nbsp;np.ndarray=None,&nbsp;target_size:&nbsp;Any=None)&nbsp;-&gt;&nbsp;np.ndarray:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_564">564</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Internal&nbsp;function&nbsp;for&nbsp;the&nbsp;unspliced&nbsp;molecule&nbsp;filtering.&nbsp;The&nbsp;`normalize`&nbsp;method&nbsp;should&nbsp;be&nbsp;used&nbsp;as&nbsp;a&nbsp;standard&nbsp;interface"""</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_565">565</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;size:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_566">566</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;use_S_size:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_567">567</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;hasattr(self,&nbsp;"cell_size"):</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_568">568</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cell_size&nbsp;=&nbsp;self.cell_size</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_569">569</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_570">570</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cell_size&nbsp;=&nbsp;self.S.sum(0)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_571">571</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;type(relative_size)&nbsp;is&nbsp;np.ndarray:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_572">572</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cell_size&nbsp;=&nbsp;relative_size</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_573">573</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_574">574</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cell_size&nbsp;=&nbsp;self.U.sum(0)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_575">575</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Ucell_size&nbsp;=&nbsp;cell_size</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_576">576</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;target_size&nbsp;is&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_577">577</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;avg_size&nbsp;=&nbsp;cell_size.mean()</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_578">578</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_579">579</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;avg_size&nbsp;=&nbsp;target_size</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_580">580</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Uavg_size&nbsp;=&nbsp;avg_size</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_581">581</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;warnings.catch_warnings():</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_582">582</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warnings.simplefilter("ignore")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_583">583</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;norm_factor&nbsp;=&nbsp;avg_size&nbsp;/&nbsp;cell_size</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_584">584</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_585">585</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;norm_factor&nbsp;=&nbsp;1</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_586">586</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Unorm_factor&nbsp;=&nbsp;norm_factor</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_587">587</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;warnings.catch_warnings():</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_588">588</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warnings.simplefilter("ignore")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_589">589</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.U_sz&nbsp;=&nbsp;norm_factor&nbsp;*&nbsp;self.U</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_590">590</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.U_sz[~np.isfinite(self.U_sz)]&nbsp;=&nbsp;0&nbsp;&nbsp;#&nbsp;it&nbsp;happened&nbsp;only&nbsp;once&nbsp;but&nbsp;it&nbsp;is&nbsp;here&nbsp;as&nbsp;a&nbsp;precaution</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_591">591</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;log:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_592">592</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.U_norm&nbsp;=&nbsp;np.log2(self.U_sz&nbsp;+&nbsp;pcount)&nbsp;&nbsp;#&nbsp;np.sqrt(S_sz&nbsp;)#&nbsp;np.log2(S_sz&nbsp;+&nbsp;1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_593">593</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_594">594</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;_normalize_Sx(self,&nbsp;size:&nbsp;bool=True,&nbsp;log:&nbsp;bool=True,&nbsp;pcount:&nbsp;float=1,&nbsp;relative_size:&nbsp;Any=None,&nbsp;target_size:&nbsp;Any=None)&nbsp;-&gt;&nbsp;np.ndarray:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_595">595</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Internal&nbsp;function&nbsp;for&nbsp;the&nbsp;smoothed&nbsp;spliced&nbsp;molecule&nbsp;filtering.&nbsp;The&nbsp;`normalize`&nbsp;method&nbsp;should&nbsp;be&nbsp;used&nbsp;as&nbsp;a&nbsp;standard&nbsp;interface"""</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_596">596</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;size:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_597">597</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;relative_size:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_598">598</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.xcell_size&nbsp;=&nbsp;relative_size</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_599">599</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_600">600</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.xcell_size&nbsp;=&nbsp;self.Sx.sum(0)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_601">601</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;target_size&nbsp;is&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_602">602</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.xavg_size&nbsp;=&nbsp;self.xcell_size.mean()</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_603">603</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_604">604</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.xavg_size&nbsp;=&nbsp;target_size</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_605">605</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.xnorm_factor&nbsp;=&nbsp;self.xavg_size&nbsp;/&nbsp;self.xcell_size</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_606">606</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_607">607</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.xnorm_factor&nbsp;=&nbsp;1</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_608">608</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Sx_sz&nbsp;=&nbsp;self.xnorm_factor&nbsp;*&nbsp;self.Sx</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_609">609</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;log:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_610">610</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Sx_norm&nbsp;=&nbsp;np.log2(self.Sx_sz&nbsp;+&nbsp;pcount)&nbsp;&nbsp;#&nbsp;np.sqrt(S_sz&nbsp;)#&nbsp;np.log2(S_sz&nbsp;+&nbsp;1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_611">611</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_612">612</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;_normalize_Ux(self,&nbsp;size:&nbsp;bool=True,&nbsp;log:&nbsp;bool=True,&nbsp;pcount:&nbsp;float=1,&nbsp;use_Sx_size:&nbsp;bool=False,&nbsp;relative_size:&nbsp;Any=None,&nbsp;target_size:&nbsp;Any=None)&nbsp;-&gt;&nbsp;np.ndarray:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_613">613</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Internal&nbsp;function&nbsp;for&nbsp;the&nbsp;smoothed&nbsp;unspliced&nbsp;molecule&nbsp;filtering.&nbsp;The&nbsp;`normalize`&nbsp;method&nbsp;should&nbsp;be&nbsp;used&nbsp;as&nbsp;a&nbsp;standard&nbsp;interface"""</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_614">614</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;size:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_615">615</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;use_Sx_size:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_616">616</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;hasattr(self,&nbsp;"cell_size"):</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_617">617</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cell_size&nbsp;=&nbsp;self.xcell_size</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_618">618</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_619">619</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cell_size&nbsp;=&nbsp;self.Sx.sum(0)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_620">620</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;type(relative_size)&nbsp;is&nbsp;np.ndarray:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_621">621</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cell_size&nbsp;=&nbsp;relative_size</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_622">622</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_623">623</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cell_size&nbsp;=&nbsp;self.Ux.sum(0)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_624">624</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.xUcell_size&nbsp;=&nbsp;cell_size</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_625">625</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;target_size&nbsp;is&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_626">626</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;avg_size&nbsp;=&nbsp;cell_size.mean()</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_627">627</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_628">628</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;avg_size&nbsp;=&nbsp;target_size</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_629">629</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.xUavg_size&nbsp;=&nbsp;avg_size</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_630">630</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;warnings.catch_warnings():</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_631">631</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warnings.simplefilter("ignore")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_632">632</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;norm_factor&nbsp;=&nbsp;avg_size&nbsp;/&nbsp;cell_size</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_633">633</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_634">634</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;norm_factor&nbsp;=&nbsp;1</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_635">635</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.xUnorm_factor&nbsp;=&nbsp;norm_factor</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_636">636</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;warnings.catch_warnings():</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_637">637</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warnings.simplefilter("ignore")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_638">638</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Ux_sz&nbsp;=&nbsp;norm_factor&nbsp;*&nbsp;self.Ux</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_639">639</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Ux_sz[~np.isfinite(self.Ux_sz)]&nbsp;=&nbsp;0&nbsp;&nbsp;#&nbsp;it&nbsp;happened&nbsp;only&nbsp;once&nbsp;but&nbsp;it&nbsp;is&nbsp;here&nbsp;as&nbsp;a&nbsp;precaution</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_640">640</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;log:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_641">641</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Ux_norm&nbsp;=&nbsp;np.log2(self.Ux_sz&nbsp;+&nbsp;pcount)&nbsp;&nbsp;#&nbsp;np.sqrt(S_sz&nbsp;)#&nbsp;np.log2(S_sz&nbsp;+&nbsp;1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_642">642</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_643">643</td><td nowrap="nowrap"><span class="diff_sub">[docs]&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;normalize(self,&nbsp;which:&nbsp;str="both",&nbsp;size:&nbsp;bool=True,&nbsp;log:&nbsp;bool=True,&nbsp;pcount:&nbsp;float=1,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_644">644</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;relative_size:&nbsp;np.ndarray=None,&nbsp;use_S_size_for_U:&nbsp;bool=False,&nbsp;target_size:&nbsp;Tuple[float,&nbsp;float]=(None,&nbsp;None))&nbsp;-&gt;&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_645">645</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Normalization&nbsp;interface</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_646">646</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_647">647</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_648">648</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_649">649</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;which:&nbsp;either&nbsp;'both',&nbsp;'S',&nbsp;'U',&nbsp;"imputed",&nbsp;"Sx",&nbsp;"Ux"</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_650">650</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;which&nbsp;attributes&nbsp;to&nbsp;normalize.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_651">651</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"both"&nbsp;corresponds&nbsp;to&nbsp;"S"&nbsp;and&nbsp;"U"</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_652">652</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"imputed"&nbsp;corresponds&nbsp;to&nbsp;"Sx"&nbsp;and&nbsp;"Ux"</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_653">653</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size:&nbsp;bool</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_654">654</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;perform&nbsp;size&nbsp;normalization</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_655">655</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log:&nbsp;bool</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_656">656</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;perform&nbsp;log&nbsp;normalization&nbsp;(if&nbsp;size==True,&nbsp;this&nbsp;comes&nbsp;after&nbsp;the&nbsp;size&nbsp;normalization)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_657">657</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pcount:&nbsp;int,&nbsp;default:&nbsp;1</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_658">658</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;extra&nbsp;count&nbsp;added&nbsp;when&nbsp;logging&nbsp;(log2)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_659">659</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;relative_size:&nbsp;np.ndarray,&nbsp;default=None</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_660">660</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;None&nbsp;it&nbsp;calculate&nbsp;the&nbsp;sums&nbsp;the&nbsp;molecules&nbsp;per&nbsp;cell&nbsp;(self.S.sum(0))</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_661">661</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;an&nbsp;array&nbsp;is&nbsp;provided&nbsp;it&nbsp;is&nbsp;used&nbsp;for&nbsp;the&nbsp;normalization</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_662">662</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;use_S_size_for_U:&nbsp;bool</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_663">663</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;U&nbsp;is&nbsp;size&nbsp;normalized&nbsp;using&nbsp;the&nbsp;sum&nbsp;of&nbsp;molecules&nbsp;of&nbsp;S</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_664">664</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target_size:&nbsp;float&nbsp;or&nbsp;Tuple[float,&nbsp;float]&nbsp;(depending&nbsp;if&nbsp;the&nbsp;which&nbsp;parameter&nbsp;implies&nbsp;1&nbsp;or&nbsp;more&nbsp;normalizations)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_665">665</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;cells&nbsp;after&nbsp;normalization&nbsp;will&nbsp;be&nbsp;set&nbsp;to.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_666">666</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;tuple&nbsp;the&nbsp;order&nbsp;is&nbsp;(S,&nbsp;U)&nbsp;or&nbsp;(Sx,&nbsp;Ux)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_667">667</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;None&nbsp;the&nbsp;target&nbsp;size&nbsp;is&nbsp;the&nbsp;average&nbsp;of&nbsp;the&nbsp;cell&nbsp;sizes</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_668">668</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_669">669</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_670">670</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;but&nbsp;creates&nbsp;the&nbsp;attributes&nbsp;`U_norm`,&nbsp;`U_sz`&nbsp;and&nbsp;`S_norm`,&nbsp;"S_sz"</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_671">671</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;`Ux_norm`,&nbsp;`Ux_sz`&nbsp;and&nbsp;`Sx_norm`,&nbsp;"Sx_sz"</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_672">672</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_673">673</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;which&nbsp;==&nbsp;"both":</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_674">674</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._normalize_S(size=size,&nbsp;log=log,&nbsp;pcount=pcount,&nbsp;relative_size=relative_size,&nbsp;target_size=target_size[0])</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_675">675</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._normalize_U(size=size,&nbsp;log=log,&nbsp;pcount=pcount,&nbsp;use_S_size=use_S_size_for_U,&nbsp;relative_size=relative_size,&nbsp;target_size=target_size[1])</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_676">676</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;"S"&nbsp;==&nbsp;which:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_677">677</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._normalize_S(size=size,&nbsp;log=log,&nbsp;pcount=pcount,&nbsp;relative_size=relative_size,&nbsp;target_size=target_size[0])</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_678">678</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;"U"&nbsp;==&nbsp;which:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_679">679</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._normalize_U(size=size,&nbsp;log=log,&nbsp;pcount=pcount,&nbsp;use_S_size=use_S_size_for_U,&nbsp;relative_size=relative_size,&nbsp;target_size=target_size[1])</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_680">680</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;which&nbsp;==&nbsp;"imputed":</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_681">681</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._normalize_Sx(size=size,&nbsp;log=log,&nbsp;pcount=pcount,&nbsp;relative_size=relative_size,&nbsp;target_size=target_size[0])</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_682">682</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._normalize_Ux(size=size,&nbsp;log=log,&nbsp;pcount=pcount,&nbsp;use_Sx_size=use_S_size_for_U,&nbsp;relative_size=relative_size,&nbsp;target_size=target_size[1])</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_683">683</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;"Sx"&nbsp;==&nbsp;which:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_684">684</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._normalize_Sx(size=size,&nbsp;log=log,&nbsp;pcount=pcount,&nbsp;relative_size=relative_size,&nbsp;target_size=target_size[0])</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_685">685</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;"Ux"&nbsp;==&nbsp;which:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_686">686</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._normalize_Ux(size=size,&nbsp;log=log,&nbsp;pcount=pcount,&nbsp;use_Sx_size=use_S_size_for_U,&nbsp;relative_size=relative_size,&nbsp;target_size=target_size[1])</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_687">687</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_688">688</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_689">689</td><td nowrap="nowrap"><span class="diff_sub">[docs]</span>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;perform_PCA(self,&nbsp;which:&nbsp;str="S_norm",&nbsp;n_components:&nbsp;int=None,&nbsp;div_by_std:&nbsp;bool=False)&nbsp;-&gt;&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_286">286</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;perform_PCA(self,&nbsp;which:&nbsp;str="S_norm",&nbsp;n_components:&nbsp;int=None,&nbsp;div_by_std:&nbsp;bool=False)&nbsp;-&gt;&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_690">690</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Perform&nbsp;PCA&nbsp;(cells&nbsp;as&nbsp;samples)</span></td><td class="diff_next"></td><td class="diff_header" id="to0_287">287</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Perform&nbsp;PCA&nbsp;(cells&nbsp;as&nbsp;samples)&nbsp;uses&nbsp;the&nbsp;self.pcs&nbsp;for&nbsp;the&nbsp;tSNE</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_691">691</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_288">288</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_692">692</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td><td class="diff_next"></td><td class="diff_header" id="to0_289">289</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_693">693</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td><td class="diff_next"></td><td class="diff_header" id="to0_290">290</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_694">694</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;which:&nbsp;str,&nbsp;default="S_norm"</td><td class="diff_next"></td><td class="diff_header" id="to0_291">291</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;which:&nbsp;str,&nbsp;default="S_norm"</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_695">695</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;attribute&nbsp;to&nbsp;use&nbsp;for&nbsp;the&nbsp;calculation&nbsp;(e.g.&nbsp;S_norm&nbsp;or&nbsp;Sx_norm)</td><td class="diff_next"></td><td class="diff_header" id="to0_292">292</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;attribute&nbsp;to&nbsp;use&nbsp;for&nbsp;the&nbsp;calculation&nbsp;(e.g.&nbsp;S_norm&nbsp;or&nbsp;Sx_norm)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_696">696</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_components:&nbsp;int,&nbsp;default=None</td><td class="diff_next"></td><td class="diff_header" id="to0_293">293</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_components:&nbsp;int,&nbsp;default=None</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_697">697</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number&nbsp;of&nbsp;components&nbsp;to&nbsp;keep.&nbsp;If&nbsp;None&nbsp;all&nbsp;the&nbsp;components&nbsp;will&nbsp;be&nbsp;kept.</td><td class="diff_next"></td><td class="diff_header" id="to0_294">294</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number&nbsp;of&nbsp;components&nbsp;to&nbsp;keep.&nbsp;If&nbsp;None&nbsp;all&nbsp;the&nbsp;components&nbsp;will&nbsp;be&nbsp;kept.</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_698">698</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div_by_std:&nbsp;bool,&nbsp;default=False</td><td class="diff_next"></td><td class="diff_header" id="to0_295">295</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div_by_std:&nbsp;bool,&nbsp;default=False</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_699">699</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Wether&nbsp;to&nbsp;divide&nbsp;by&nbsp;standard&nbsp;deviation</td><td class="diff_next"></td><td class="diff_header" id="to0_296">296</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Wether&nbsp;to&nbsp;divide&nbsp;by&nbsp;standard&nbsp;deviation</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_700">700</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_297">297</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_701">701</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td><td class="diff_next"></td><td class="diff_header" id="to0_298">298</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_702">702</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td><td class="diff_next"></td><td class="diff_header" id="to0_299">299</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_703">703</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns&nbsp;nothing&nbsp;but&nbsp;it&nbsp;creates&nbsp;the&nbsp;attributes:</td><td class="diff_next"></td><td class="diff_header" id="to0_300">300</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns&nbsp;nothing&nbsp;but&nbsp;it&nbsp;creates&nbsp;the&nbsp;attributes:</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__25"></td><td class="diff_header" id="from0_704">704</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pca:&nbsp;np.ndarray</td><td class="diff_next"></td><td class="diff_header" id="to0_301">301</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pca:&nbsp;np.ndarray</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_705">705</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;numpy&nbsp;array&nbsp;of&nbsp;shape&nbsp;(cells,&nbsp;npcs)</td><td class="diff_next"></td><td class="diff_header" id="to0_302">302</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;numpy&nbsp;array&nbsp;of&nbsp;shape&nbsp;(cells,&nbsp;npcs)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_706">706</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_303">303</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_707">707</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_304">304</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_708">708</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X&nbsp;=&nbsp;getattr(self,&nbsp;which)</td><td class="diff_next"></td><td class="diff_header" id="to0_305">305</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X&nbsp;=&nbsp;getattr(self,&nbsp;which)</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__26"><a href="#difflib_chg_to0__26">n</a></td><td class="diff_header" id="from0_709">709</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.pca&nbsp;=&nbsp;PCA(n_components=n_components)</span></td><td class="diff_next"><a href="#difflib_chg_to0__26">n</a></td><td class="diff_header" id="to0_306">306</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.pca&nbsp;=&nbsp;PCA(n_components=n_components)&nbsp;#n_components&nbsp;experiment&nbsp;with&nbsp;2&nbsp;or&nbsp;3</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_710">710</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;div_by_std:</td><td class="diff_next"></td><td class="diff_header" id="to0_307">307</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;div_by_std:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_711">711</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.pcs&nbsp;=&nbsp;self.pca.fit_transform(X.T&nbsp;/&nbsp;X.std(0))</td><td class="diff_next"></td><td class="diff_header" id="to0_308">308</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.pcs&nbsp;=&nbsp;self.pca.fit_transform(X.T&nbsp;/&nbsp;X.std(0))</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_712">712</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_309">309</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_713">713</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.pcs&nbsp;=&nbsp;self.pca.fit_transform(X.T)</td><td class="diff_next"></td><td class="diff_header" id="to0_310">310</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.pcs&nbsp;=&nbsp;self.pca.fit_transform(X.T)</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__27">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to0__27">n</a></td><td class="diff_header" id="to0_311">311</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pcs_inte&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_312">312</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.percentages&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__27"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_313">313</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;per_variance&nbsp;in&nbsp;self.pca.explained_variance_ratio_:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_314">314</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.percentages.append(round(per_variance,&nbsp;2)*100)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_315">315</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#print(self.pca.explained_variance_ratio_)&nbsp;#[0.51368745&nbsp;0.18150776&nbsp;0.08213185]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_316">316</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#print(np.cumsum(np.round(self.pca.explained_variance_ratio_,&nbsp;decimals=4)*100))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_714">714</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_317">317</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__28">n</a></td><td class="diff_header" id="from0_715">715</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__28">n</a></td><td class="diff_header" id="to0_318">318</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;plot_pca(self,&nbsp;dim:&nbsp;List[int]=[0,&nbsp;1,&nbsp;2],&nbsp;elev:&nbsp;float=60,&nbsp;azim:&nbsp;float=-140,&nbsp;make_gify:&nbsp;bool=True,&nbsp;Filename:&nbsp;str="Original",&nbsp;typegroup:&nbsp;str="integers")&nbsp;-&gt;&nbsp;None:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_716">716</td><td nowrap="nowrap"><span class="diff_sub">[docs]&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;normalize_by_total(self,&nbsp;min_perc_U:&nbsp;float=0.5,&nbsp;plot:&nbsp;bool=False,&nbsp;skip_low_U_pop:&nbsp;bool=True,&nbsp;same_size_UnS:&nbsp;bool=False)&nbsp;-&gt;&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_717">717</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Normalize&nbsp;the&nbsp;cells&nbsp;using&nbsp;the&nbsp;(initial)&nbsp;total&nbsp;molecules&nbsp;as&nbsp;size&nbsp;estimate</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_718">718</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_719">719</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_720">720</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_721">721</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_perc_U:&nbsp;float</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_722">722</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;percentile&nbsp;to&nbsp;use&nbsp;as&nbsp;a&nbsp;minimum&nbsp;value&nbsp;allowed&nbsp;for&nbsp;the&nbsp;size&nbsp;normalization</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_723">723</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plot:&nbsp;bool,&nbsp;default=False</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_724">724</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whether</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_725">725</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip_low_U_pop:&nbsp;bool,&nbsp;default=True</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_726">726</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;population&nbsp;with&nbsp;very&nbsp;low&nbsp;unspliced&nbsp;will&nbsp;not&nbsp;be&nbsp;multiplied&nbsp;by&nbsp;the&nbsp;scaling&nbsp;factor&nbsp;to&nbsp;avoid&nbsp;predicting&nbsp;very&nbsp;strong</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_727">727</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;velocity&nbsp;just&nbsp;as&nbsp;a&nbsp;consequence&nbsp;of&nbsp;low&nbsp;detection</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_728">728</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;same_size_UnS:&nbsp;bool,&nbsp;default=False</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_729">729</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Each&nbsp;cell&nbsp;is&nbsp;set&nbsp;tot&nbsp;have&nbsp;the&nbsp;same&nbsp;total&nbsp;number&nbsp;of&nbsp;spliced&nbsp;and&nbsp;unspliced&nbsp;molecules</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_730">730</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_731">731</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_732">732</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_733">733</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns&nbsp;nothing&nbsp;but&nbsp;it&nbsp;creates&nbsp;the&nbsp;attributes:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_734">734</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;small_U_pop:&nbsp;np.ndarray</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_735">735</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cells&nbsp;with&nbsp;extremely&nbsp;low&nbsp;unspliced&nbsp;count</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_736">736</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_737">737</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_738">738</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target_cell_size&nbsp;=&nbsp;np.median(self.initial_cell_size)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_739">739</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_Ucell_size&nbsp;=&nbsp;np.percentile(self.initial_Ucell_size,&nbsp;min_perc_U)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_740">740</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;min_Ucell_size&nbsp;&lt;&nbsp;2:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_741">741</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;ValueError(f"min_perc_U={min_perc_U}&nbsp;corresponds&nbsp;to&nbsp;total&nbsp;Unspliced&nbsp;of&nbsp;1&nbsp;molecule&nbsp;of&nbsp;less.&nbsp;Please&nbsp;choose&nbsp;higher&nbsp;value&nbsp;or&nbsp;filter&nbsp;our&nbsp;these&nbsp;cell")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_742">742</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool_f&nbsp;=&nbsp;self.initial_Ucell_size&nbsp;&lt;&nbsp;min_Ucell_size</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_743">743</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.small_U_pop&nbsp;=&nbsp;bool_f</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_744">744</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;same_size_UnS:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_745">745</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target_Ucell_size&nbsp;=&nbsp;target_cell_size&nbsp;&nbsp;#&nbsp;0.15&nbsp;*&nbsp;target_cell_size</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_746">746</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_747">747</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target_Ucell_size&nbsp;=&nbsp;np.median(self.initial_Ucell_size[~self.small_U_pop])&nbsp;&nbsp;#&nbsp;0.15&nbsp;*&nbsp;target_cell_size</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_748">748</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_749">749</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;plot:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_750">750</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(None,&nbsp;(12,&nbsp;6))</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_751">751</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.subplot(121)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_752">752</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_753">753</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.scatter(self.initial_cell_size,&nbsp;self.initial_Ucell_size,&nbsp;s=3,&nbsp;alpha=0.1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_754">754</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.xlabel("total&nbsp;spliced")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_755">755</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.ylabel("total&nbsp;unspliced")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_756">756</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.scatter(self.initial_cell_size[bool_f],&nbsp;self.initial_Ucell_size[bool_f],&nbsp;s=3,&nbsp;alpha=0.1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_757">757</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.subplot(122)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_758">758</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.scatter(np.log2(self.initial_cell_size),&nbsp;np.log2(self.initial_Ucell_size),&nbsp;s=7,&nbsp;alpha=0.3)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_759">759</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.scatter(np.log2(self.initial_cell_size)[bool_f],&nbsp;np.log2(self.initial_Ucell_size)[bool_f],&nbsp;s=7,&nbsp;alpha=0.3)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_760">760</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.xlabel("log&nbsp;total&nbsp;spliced")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_761">761</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.ylabel("log&nbsp;total&nbsp;unspliced")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_762">762</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_763">763</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._normalize_S(relative_size=self.initial_cell_size,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_764">764</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target_size=target_cell_size)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_765">765</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;skip_low_U_pop:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_766">766</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._normalize_U(relative_size=np.clip(self.initial_Ucell_size,&nbsp;min_Ucell_size,&nbsp;None),</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_767">767</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target_size=target_Ucell_size)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_768">768</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_769">769</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._normalize_U(relative_size=self.initial_Ucell_size,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_770">770</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target_size=target_Ucell_size)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_771">771</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_772">772</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_773">773</td><td nowrap="nowrap"><span class="diff_sub">[docs]&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;normalize_by_size_factor(self,&nbsp;min_perc_U:&nbsp;float=0.5,&nbsp;plot:&nbsp;bool=False,&nbsp;skip_low_U_pop:&nbsp;bool=True,&nbsp;same_size_UnS:&nbsp;bool=False)&nbsp;-&gt;&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_774">774</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Normalize&nbsp;the&nbsp;cells&nbsp;using&nbsp;the&nbsp;(initial)&nbsp;size_factor</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_775">775</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_776">776</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_777">777</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_778">778</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_perc_U:&nbsp;float</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_779">779</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;percentile&nbsp;to&nbsp;use&nbsp;as&nbsp;a&nbsp;minimum&nbsp;value&nbsp;allowed&nbsp;for&nbsp;the&nbsp;size&nbsp;normalization</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_780">780</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plot:&nbsp;bool,&nbsp;default=False</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_781">781</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whether</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_782">782</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip_low_U_pop:&nbsp;bool,&nbsp;default=True</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_783">783</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;population&nbsp;with&nbsp;very&nbsp;low&nbsp;unspliced&nbsp;will&nbsp;not&nbsp;be&nbsp;multiplied&nbsp;by&nbsp;the&nbsp;scaling&nbsp;factor&nbsp;to&nbsp;avoid&nbsp;predicting&nbsp;very&nbsp;strong</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_784">784</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;velocity&nbsp;just&nbsp;as&nbsp;a&nbsp;consequence&nbsp;of&nbsp;low&nbsp;detection</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_785">785</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;same_size_UnS:&nbsp;bool,&nbsp;default=False</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_786">786</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Each&nbsp;cell&nbsp;is&nbsp;set&nbsp;tot&nbsp;have&nbsp;the&nbsp;same&nbsp;total&nbsp;number&nbsp;of&nbsp;spliced&nbsp;and&nbsp;unspliced&nbsp;molecules</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_787">787</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_788">788</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_789">789</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_790">790</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns&nbsp;nothing&nbsp;but&nbsp;it&nbsp;creates&nbsp;the&nbsp;attributes:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_791">791</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;small_U_pop:&nbsp;np.ndarray</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_792">792</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cells&nbsp;with&nbsp;extremely&nbsp;low&nbsp;unspliced&nbsp;count</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_793">793</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_794">794</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_795">795</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cell_size&nbsp;=&nbsp;self.S.sum(0)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_796">796</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ucell_size&nbsp;=&nbsp;self.U.sum(0)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_797">797</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target_cell_size&nbsp;=&nbsp;np.median(cell_size)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_798">798</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_Ucell_size&nbsp;=&nbsp;np.percentile(Ucell_size,&nbsp;min_perc_U)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_799">799</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;min_Ucell_size&nbsp;&lt;&nbsp;2:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_800">800</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;ValueError(f"min_perc_U={min_perc_U}&nbsp;corresponds&nbsp;to&nbsp;total&nbsp;Unspliced&nbsp;of&nbsp;1&nbsp;molecule&nbsp;of&nbsp;less.&nbsp;Please&nbsp;choose&nbsp;higher&nbsp;value&nbsp;or&nbsp;filter&nbsp;our&nbsp;these&nbsp;cell")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_801">801</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool_f&nbsp;=&nbsp;Ucell_size&nbsp;&lt;&nbsp;min_Ucell_size</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_802">802</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.small_U_pop&nbsp;=&nbsp;bool_f</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_803">803</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;same_size_UnS:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_804">804</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target_Ucell_size&nbsp;=&nbsp;target_cell_size&nbsp;&nbsp;#&nbsp;0.15&nbsp;*&nbsp;target_cell_size</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_805">805</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_806">806</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target_Ucell_size&nbsp;=&nbsp;np.median(Ucell_size[~self.small_U_pop])</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_807">807</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_808">808</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;plot:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_809">809</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(None,&nbsp;(12,&nbsp;6))</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_810">810</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.subplot(121)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_811">811</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.scatter(cell_size,&nbsp;Ucell_size,&nbsp;s=3,&nbsp;alpha=0.1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_812">812</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.xlabel("S&nbsp;cell_size")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_813">813</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.ylabel("U&nbsp;cell_size")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_814">814</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.scatter(cell_size[bool_f],&nbsp;Ucell_size[bool_f],&nbsp;s=3,&nbsp;alpha=0.1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_815">815</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.subplot(122)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_816">816</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.scatter(np.log2(cell_size),&nbsp;np.log2(Ucell_size),&nbsp;s=7,&nbsp;alpha=0.3)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_817">817</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.scatter(np.log2(cell_size)[bool_f],&nbsp;np.log2(Ucell_size)[bool_f],&nbsp;s=7,&nbsp;alpha=0.3)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_818">818</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.xlabel("log&nbsp;S&nbsp;cell_size")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_819">819</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.ylabel("log&nbsp;U&nbsp;cell_size")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_820">820</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_821">821</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._normalize_S(relative_size=self.size_factor,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_822">822</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target_size=target_cell_size)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_823">823</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;skip_low_U_pop:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_824">824</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._normalize_U(relative_size=np.clip(self.initial_Ucell_size,&nbsp;min_Ucell_size,&nbsp;None),</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_825">825</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target_size=target_Ucell_size)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_826">826</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_827">827</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._normalize_U(relative_size=self.initial_Ucell_size,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_828">828</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target_size=target_Ucell_size)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_829">829</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_830">830</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_831">831</td><td nowrap="nowrap"><span class="diff_sub">[docs]&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;adjust_totS_totU(self,&nbsp;skip_low_U_pop:&nbsp;bool=True,&nbsp;normalize_total:&nbsp;bool=False,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_832">832</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fit_with_low_U:&nbsp;bool=True,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_833">833</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;svr_C:&nbsp;float=100,&nbsp;svr_gamma:&nbsp;float=1e-6,&nbsp;plot:&nbsp;bool=False)&nbsp;-&gt;&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_834">834</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Adjust&nbsp;the&nbsp;spliced&nbsp;count&nbsp;on&nbsp;the&nbsp;base&nbsp;of&nbsp;the&nbsp;relation&nbsp;S_sz_tot&nbsp;and&nbsp;U_sz_tot</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_835">835</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_836">836</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_837">837</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_838">838</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip_low_U_pop:&nbsp;bool,&nbsp;default=True</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_839">839</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Do&nbsp;not&nbsp;normalize&nbsp;the&nbsp;low&nbsp;unspliced&nbsp;molecules&nbsp;cell&nbsp;population&nbsp;to&nbsp;avoid&nbsp;overinflated&nbsp;values</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_840">840</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;normalize_total:&nbsp;bool,&nbsp;default=False</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_841">841</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;this&nbsp;is&nbsp;True&nbsp;the&nbsp;function&nbsp;results&nbsp;in&nbsp;a&nbsp;normalization&nbsp;by&nbsp;median&nbsp;of&nbsp;both&nbsp;U&nbsp;and&nbsp;S.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_842">842</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOTE:&nbsp;Legacy&nbsp;compatibility,&nbsp;I&nbsp;might&nbsp;want&nbsp;to&nbsp;split&nbsp;this&nbsp;into&nbsp;a&nbsp;different&nbsp;function.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_843">843</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fit_with_low_U:&nbsp;bool,&nbsp;default=True</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_844">844</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Wether&nbsp;to&nbsp;consider&nbsp;the&nbsp;low_U&nbsp;population&nbsp;for&nbsp;the&nbsp;fit</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_845">845</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;svr_C:&nbsp;float</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_846">846</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;C&nbsp;parameter&nbsp;of&nbsp;scikit-learn&nbsp;Support&nbsp;Vector&nbsp;Regression</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_847">847</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;svr_gamma:&nbsp;float</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_848">848</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;gamma&nbsp;parameter&nbsp;of&nbsp;scikit-learn&nbsp;Support&nbsp;Vector&nbsp;Regression</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_849">849</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plot:&nbsp;bool</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_850">850</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Whether&nbsp;to&nbsp;plot&nbsp;the&nbsp;results&nbsp;of&nbsp;the&nbsp;fit</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_851">851</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_852">852</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_853">853</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_854">854</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;but&nbsp;it&nbsp;modifies&nbsp;the&nbsp;attributes:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_855">855</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;U_sz:&nbsp;np.ndarray</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_856">856</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_857">857</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_858">858</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;svr&nbsp;=&nbsp;SVR(C=svr_C,&nbsp;kernel="rbf",&nbsp;gamma=svr_gamma)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_859">859</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X,&nbsp;y&nbsp;=&nbsp;self.S_sz.sum(0),&nbsp;self.U_sz.sum(0)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_860">860</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;fit_with_low_U:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_861">861</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;svr.fit(X[:,&nbsp;None],&nbsp;y)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_862">862</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;predicted&nbsp;=&nbsp;svr.predict(X[:,&nbsp;None])</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_863">863</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_864">864</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;svr.fit(X[~self.small_U_pop,&nbsp;None],&nbsp;y[~self.small_U_pop])</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_865">865</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;predicted&nbsp;=&nbsp;np.copy(y)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_866">866</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;predicted[~self.small_U_pop]&nbsp;=&nbsp;svr.predict(X[~self.small_U_pop,&nbsp;None])</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_867">867</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_868">868</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj_factor&nbsp;=&nbsp;predicted&nbsp;/&nbsp;y</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_869">869</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj_factor[~np.isfinite(adj_factor)]&nbsp;=&nbsp;1</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_870">870</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;skip_low_U_pop:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_871">871</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.U_sz[:,&nbsp;~self.small_U_pop]&nbsp;=&nbsp;self.U_sz[:,&nbsp;~self.small_U_pop]&nbsp;*&nbsp;adj_factor[~self.small_U_pop]</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_872">872</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_873">873</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.U_sz&nbsp;=&nbsp;self.U_sz&nbsp;*&nbsp;adj_factor</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_874">874</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_875">875</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;normalize_total:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_876">876</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.normalize_median(which="renormalize",&nbsp;skip_low_U_pop=skip_low_U_pop)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_877">877</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_878">878</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;plot:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_879">879</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(None,&nbsp;(8,&nbsp;8))</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_880">880</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.scatter(X,&nbsp;y,&nbsp;s=3,&nbsp;alpha=0.1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_881">881</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.scatter(X,&nbsp;predicted,&nbsp;c="k",&nbsp;s=5,&nbsp;alpha=0.1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_882">882</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_883">883</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_884">884</td><td nowrap="nowrap"><span class="diff_sub">[docs]&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;normalize_median(self,&nbsp;which:&nbsp;str="imputed",&nbsp;skip_low_U_pop:&nbsp;bool=True)&nbsp;-&gt;&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_885">885</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Normalize&nbsp;cell&nbsp;size&nbsp;to&nbsp;the&nbsp;median,&nbsp;for&nbsp;both&nbsp;S&nbsp;and&nbsp;U.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_886">886</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_887">887</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_888">888</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_889">889</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;which:&nbsp;str,&nbsp;default="imputed"</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_890">890</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"imputed"&nbsp;or&nbsp;"renormalized"</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_891">891</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip_low_U_pop:&nbsp;bool=True</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_892">892</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Whether&nbsp;to&nbsp;skip&nbsp;the&nbsp;low&nbsp;U&nbsp;population&nbsp;defined&nbsp;in&nbsp;normalize_by_total</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_893">893</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_894">894</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_895">895</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_896">896</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;but&nbsp;it&nbsp;modifies&nbsp;the&nbsp;attributes:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_897">897</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S_sz:&nbsp;np.ndarray</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_898">898</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;U_sz:&nbsp;np.ndarray</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_899">899</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_900">900</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sx_sz:&nbsp;np.ndarray</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_901">901</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ux_sz:&nbsp;np.ndarray</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_902">902</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_903">903</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;hasattr(self,&nbsp;"small_U_pop")&nbsp;and&nbsp;skip_low_U_pop:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_904">904</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.small_U_pop&nbsp;=&nbsp;np.zeros(self.U_sz.shape[1],&nbsp;dtype=bool)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_905">905</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warning("object&nbsp;does&nbsp;not&nbsp;have&nbsp;the&nbsp;attribute&nbsp;`small_U_pop`,&nbsp;so&nbsp;all&nbsp;the&nbsp;unspliced&nbsp;will&nbsp;be&nbsp;normalized&nbsp;by&nbsp;relative&nbsp;size,&nbsp;this&nbsp;might&nbsp;cause&nbsp;the&nbsp;overinflation&nbsp;the&nbsp;unspliced&nbsp;counts&nbsp;of&nbsp;cells&nbsp;where&nbsp;only&nbsp;few&nbsp;unspliced&nbsp;molecules&nbsp;were&nbsp;detected")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_906">906</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;which&nbsp;==&nbsp;"renormalize":</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_907">907</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.S_sz&nbsp;=&nbsp;self.S_sz&nbsp;*&nbsp;(np.median(self.S_sz.sum(0))&nbsp;/&nbsp;self.S_sz.sum(0))</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_908">908</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;skip_low_U_pop:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_909">909</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.U_sz[:,&nbsp;~self.small_U_pop]&nbsp;=&nbsp;self.U_sz[:,&nbsp;~self.small_U_pop]&nbsp;*&nbsp;(np.median(self.U_sz[:,&nbsp;~self.small_U_pop].sum(0))&nbsp;/&nbsp;self.U_sz[:,&nbsp;~self.small_U_pop].sum(0))</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_910">910</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_911">911</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.U_sz&nbsp;=&nbsp;self.U_sz&nbsp;*&nbsp;(np.median(self.U_sz.sum(0))&nbsp;/&nbsp;self.U_sz.sum(0))</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_912">912</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;which&nbsp;==&nbsp;"imputed":</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_913">913</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Sx_sz&nbsp;=&nbsp;self.Sx&nbsp;*&nbsp;(np.median(self.Sx.sum(0))&nbsp;/&nbsp;self.Sx.sum(0))</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_914">914</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_915">915</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;skip_low_U_pop:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_916">916</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Ux_sz&nbsp;=&nbsp;np.copy(self.Ux)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_917">917</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Ux_sz[:,&nbsp;~self.small_U_pop]&nbsp;=&nbsp;self.Ux[:,&nbsp;~self.small_U_pop]&nbsp;*&nbsp;(np.median(self.Ux[:,&nbsp;~self.small_U_pop].sum(0))&nbsp;/&nbsp;self.Ux[:,&nbsp;~self.small_U_pop].sum(0))</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_918">918</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_919">919</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Ux_sz&nbsp;=&nbsp;self.Ux&nbsp;*&nbsp;(np.median(self.Ux.sum(0))&nbsp;/&nbsp;self.Ux.sum(0))</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__28"></td><td class="diff_header" id="from0_920">920</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_921">921</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_922">922</td><td nowrap="nowrap"><span class="diff_sub">[docs]&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;plot_pca(self,&nbsp;dim:&nbsp;List[int]=[0,&nbsp;1,&nbsp;2],&nbsp;elev:&nbsp;float=60,&nbsp;azim:&nbsp;float=-140)&nbsp;-&gt;&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_923">923</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Plot&nbsp;3d&nbsp;PCA</td><td class="diff_next"></td><td class="diff_header" id="to0_319">319</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Plot&nbsp;3d&nbsp;PCA</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_924">924</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_320">320</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__29">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to0__29">n</a></td><td class="diff_header" id="to0_321">321</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;dim&nbsp;==&nbsp;[0,1]:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_322">322</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_markers&nbsp;=&nbsp;self.ca["Markers"]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_323">323</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mark&nbsp;=&nbsp;sorted(set(my_markers))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_324">324</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;corresp&nbsp;=&nbsp;["o",&nbsp;"P",&nbsp;"D",&nbsp;"X",&nbsp;"*",&nbsp;"+",&nbsp;"&gt;",&nbsp;"&lt;"]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_325">325</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;0</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_326">326</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_types&nbsp;=&nbsp;{}</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_327">327</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;the_type&nbsp;in&nbsp;mark:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_328">328</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_types[the_type]&nbsp;=&nbsp;corresp[count]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_329">329</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;count&nbsp;+&nbsp;1</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_330">330</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;markers&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_331">331</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;mar&nbsp;in&nbsp;my_markers:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_332">332</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;markers.append(my_types.get(mar))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_333">333</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;randn(10)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_334">334</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fig,&nbsp;ax&nbsp;=&nbsp;plt.subplots(figsize=(8,&nbsp;7))&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_335">335</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(0,&nbsp;len(markers)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_336">336</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.scatter(self.pcs[i,&nbsp;dim[0]],&nbsp;self.pcs[i,&nbsp;dim[1]],&nbsp;marker=markers[i],&nbsp;c=self.colorandum[i])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_337">337</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexy_codes&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_338">338</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_keys&nbsp;=&nbsp;[k&nbsp;&nbsp;for&nbsp;&nbsp;k&nbsp;in&nbsp;&nbsp;self.cluster_colors_dict.keys()]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_339">339</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_my_keys&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_340">340</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;my_keys:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_341">341</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_my_keys.append(str(item,'utf-8'))&nbsp;#int()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_342">342</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmap2&nbsp;=&nbsp;cm.get_cmap('Paired')&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;PiYG</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_343">343</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(cmap2.N):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_344">344</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rgb&nbsp;=&nbsp;cmap2(i)[:3]&nbsp;#&nbsp;will&nbsp;return&nbsp;rgba,&nbsp;we&nbsp;take&nbsp;only&nbsp;first&nbsp;3&nbsp;so&nbsp;we&nbsp;get&nbsp;rgb</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_345">345</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexy_codes.append(matplotlib.colors.rgb2hex(rgb))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_346">346</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;legend_elements&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_347">347</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined&nbsp;=&nbsp;list(zip(decoded_my_keys,&nbsp;hexy_codes))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_348">348</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined&nbsp;=&nbsp;sorted(combined,&nbsp;key=itemgetter(0))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_349">349</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(typegroup&nbsp;!=&nbsp;"Strings"):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_350">350</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;timepoints&nbsp;=&nbsp;[int(i[0])&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_351">351</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colys&nbsp;=&nbsp;[i[1]&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_352">352</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tempDF&nbsp;=&nbsp;pd.DataFrame({'Group':timepoints,&nbsp;'colours':colys})</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_353">353</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tempDF&nbsp;=&nbsp;tempDF.sort_values('Group')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_354">354</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;groupys2&nbsp;=&nbsp;tempDF['Group'].tolist()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_355">355</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cols2&nbsp;=&nbsp;tempDF['colours'].tolist()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_356">356</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined&nbsp;=&nbsp;list(zip(groupys2,&nbsp;cols2))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_357">357</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_my_keys&nbsp;=&nbsp;[i[0]&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_358">358</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexy_codes&nbsp;=&nbsp;[i[1]&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_359">359</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#get&nbsp;markers&nbsp;and&nbsp;names</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_360">360</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;sample_type&nbsp;in&nbsp;range(0,&nbsp;len(decoded_my_keys)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_361">361</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to_add&nbsp;=&nbsp;Line2D([0],&nbsp;[0],&nbsp;marker='s',&nbsp;color='w',&nbsp;label=str(decoded_my_keys[sample_type]).strip('"'),&nbsp;markerfacecolor=str(hexy_codes[sample_type]),&nbsp;markersize=7)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_362">362</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;legend_elements.append(to_add)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_363">363</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;sample_type&nbsp;in&nbsp;range(0,&nbsp;len(mark)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_364">364</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to_add&nbsp;=&nbsp;Line2D([0],&nbsp;[0],&nbsp;marker=[*my_types.values()][sample_type],&nbsp;color='w',&nbsp;label=str([*my_types.keys()][sample_type]).strip('"'),&nbsp;markerfacecolor='black',&nbsp;markersize=7)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_365">365</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;legend_elements.append(to_add)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_366">366</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.legend(handles=legend_elements,&nbsp;title='Key')&nbsp;#Timepont&nbsp;\n(hours)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_367">367</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.set_xlabel('PC1&nbsp;'+'('+str(self.percentages[0])+'%)')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_368">368</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.set_ylabel('PC2&nbsp;'+'('+str(self.percentages[1])+'%)')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_369">369</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static&nbsp;=&nbsp;"PCA_plot"&nbsp;+&nbsp;Filename&nbsp;+&nbsp;".pdf"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_370">370</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(static)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_371">371</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_372">372</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;dim&nbsp;==&nbsp;[0,&nbsp;1,&nbsp;2]:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_373">373</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_markers&nbsp;=&nbsp;self.ca["Markers"]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_374">374</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mark&nbsp;=&nbsp;sorted(set(my_markers))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_375">375</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;corresp&nbsp;=&nbsp;["o",&nbsp;"P",&nbsp;"D",&nbsp;"X",&nbsp;"*",&nbsp;"+",&nbsp;"&gt;",&nbsp;"&lt;"]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_376">376</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;0</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_377">377</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_types&nbsp;=&nbsp;{}</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_378">378</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;the_type&nbsp;in&nbsp;mark:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_379">379</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_types[the_type]&nbsp;=&nbsp;corresp[count]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_380">380</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;count&nbsp;+&nbsp;1</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_381">381</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;markers&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_382">382</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;mar&nbsp;in&nbsp;my_markers:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_383">383</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;markers.append(my_types.get(mar))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_384">384</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;randn(10)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_385">385</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fig&nbsp;=&nbsp;plt.figure(figsize=(8,&nbsp;6))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_386">386</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax&nbsp;=&nbsp;fig.add_subplot(111,&nbsp;projection='3d')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_387">387</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(0,&nbsp;len(markers)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_388">388</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.scatter(self.pcs[i,&nbsp;dim[0]],&nbsp;self.pcs[i,&nbsp;dim[1]],&nbsp;self.pcs[i,&nbsp;dim[2]],&nbsp;marker=markers[i],&nbsp;c=self.colorandum[i])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_389">389</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#ax.scatter(self.pcs[:,&nbsp;dim[0]],</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_390">390</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.pcs[:,&nbsp;dim[1]],</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_391">391</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.pcs[:,&nbsp;dim[2]],</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_392">392</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c=self.colorandum)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_393">393</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#for&nbsp;i,&nbsp;typey&nbsp;in&nbsp;enumerate(my_type):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_394">394</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;self.pcs[i:,&nbsp;dim[0]]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_395">395</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;=&nbsp;self.pcs[i:,&nbsp;dim[1]]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_396">396</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;self.pcs[i:,&nbsp;dim[2]]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_397">397</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;plt.scatter(x,&nbsp;y,&nbsp;z,&nbsp;marker='x',&nbsp;color='red')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_398">398</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;plt.text(x+0.3,&nbsp;y+0.3,&nbsp;z+0.3,&nbsp;typey,&nbsp;fontsize=9)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_399">399</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexy_codes&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_400">400</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_keys&nbsp;=&nbsp;[k&nbsp;&nbsp;for&nbsp;&nbsp;k&nbsp;in&nbsp;&nbsp;self.cluster_colors_dict.keys()]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_401">401</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_my_keys&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_402">402</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;my_keys:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_403">403</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_my_keys.append(str(item,'utf-8'))&nbsp;#int()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_404">404</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmap2&nbsp;=&nbsp;cm.get_cmap('Paired')&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;PiYG</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_405">405</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(cmap2.N):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_406">406</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rgb&nbsp;=&nbsp;cmap2(i)[:3]&nbsp;#&nbsp;will&nbsp;return&nbsp;rgba,&nbsp;we&nbsp;take&nbsp;only&nbsp;first&nbsp;3&nbsp;so&nbsp;we&nbsp;get&nbsp;rgb</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_407">407</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexy_codes.append(matplotlib.colors.rgb2hex(rgb))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_408">408</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;legend_elements&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_409">409</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined&nbsp;=&nbsp;list(zip(decoded_my_keys,&nbsp;hexy_codes))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_410">410</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined&nbsp;=&nbsp;sorted(combined,&nbsp;key=itemgetter(0))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_411">411</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(typegroup&nbsp;!=&nbsp;"Strings"):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_412">412</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;timepoints&nbsp;=&nbsp;[int(i[0])&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_413">413</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colys&nbsp;=&nbsp;[i[1]&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_414">414</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tempDF&nbsp;=&nbsp;pd.DataFrame({'Group':timepoints,&nbsp;'colours':colys})</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_415">415</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tempDF&nbsp;=&nbsp;tempDF.sort_values('Group')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_416">416</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;groupys2&nbsp;=&nbsp;tempDF['Group'].tolist()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_417">417</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cols2&nbsp;=&nbsp;tempDF['colours'].tolist()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_418">418</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined&nbsp;=&nbsp;list(zip(groupys2,&nbsp;cols2))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_419">419</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_my_keys&nbsp;=&nbsp;[i[0]&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_420">420</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexy_codes&nbsp;=&nbsp;[i[1]&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_421">421</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#get&nbsp;markers&nbsp;and&nbsp;names</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_422">422</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;sample_type&nbsp;in&nbsp;range(0,&nbsp;len(decoded_my_keys)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_423">423</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to_add&nbsp;=&nbsp;Line2D([0],&nbsp;[0],&nbsp;marker='s',&nbsp;color='w',&nbsp;label=str(decoded_my_keys[sample_type]).strip('"'),&nbsp;markerfacecolor=str(hexy_codes[sample_type]),&nbsp;markersize=7)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_424">424</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;legend_elements.append(to_add)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_425">425</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;sample_type&nbsp;in&nbsp;range(0,&nbsp;len(mark)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_426">426</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to_add&nbsp;=&nbsp;Line2D([0],&nbsp;[0],&nbsp;marker=[*my_types.values()][sample_type],&nbsp;color='w',&nbsp;label=str([*my_types.keys()][sample_type]).strip('"'),&nbsp;markerfacecolor='black',&nbsp;markersize=7)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_427">427</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;legend_elements.append(to_add)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_428">428</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.legend(handles=legend_elements,&nbsp;title='Key')&nbsp;#Timepont&nbsp;\n(hours)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_429">429</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.set_xlabel('PC1&nbsp;'+'('+str(self.percentages[0])+'%)')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_430">430</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.set_ylabel('PC2&nbsp;'+'('+str(self.percentages[1])+'%)')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_431">431</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.set_zlabel('PC3&nbsp;'+'('+str(self.percentages[2])+'%)')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_432">432</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static&nbsp;=&nbsp;"PCA_plot"&nbsp;+&nbsp;Filename&nbsp;+&nbsp;".pdf"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_433">433</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(static)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_434">434</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#plt.show()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_435">435</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(make_gify&nbsp;==&nbsp;True):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_436">436</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;rotate(angle):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_437">437</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.view_init(azim=angle)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_438">438</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rot_animation&nbsp;=&nbsp;animation.FuncAnimation(fig,&nbsp;rotate,&nbsp;frames=np.arange(0,&nbsp;362,&nbsp;2),&nbsp;interval=100)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_439">439</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name1&nbsp;=&nbsp;"PCA_LeftRight"&nbsp;+&nbsp;Filename&nbsp;+&nbsp;".gif"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_440">440</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rot_animation.save(name1,&nbsp;dpi=80,&nbsp;writer='imagemagick')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_441">441</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;init():</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_442">442</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fig,</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_443">443</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;animate(i):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_444">444</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.view_init(elev=(i-45)*4,&nbsp;azim=10)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_445">445</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fig,</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_446">446</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ani_2&nbsp;=&nbsp;animation.FuncAnimation(fig,&nbsp;animate,&nbsp;init_func=init,&nbsp;frames=200,&nbsp;interval=100,&nbsp;blit=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_447">447</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name2&nbsp;=&nbsp;"PCA_rotation_UpDown"&nbsp;+&nbsp;Filename&nbsp;+&nbsp;".gif"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_448">448</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ani_2.save(name2,&nbsp;dpi=80,&nbsp;writer='imagemagick')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_449">449</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_450">450</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_451">451</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#animate&nbsp;it</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_452">452</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;make_views(ax,angles,elevation=None,&nbsp;width=8,&nbsp;height&nbsp;=&nbsp;6,&nbsp;prefix='tmprot_',**kwargs):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_453">453</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;files&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_454">454</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.figure.set_size_inches(width,height)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_455">455</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i,angle&nbsp;in&nbsp;enumerate(angles):&nbsp;&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_456">456</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.view_init(elev&nbsp;=&nbsp;elevation,&nbsp;azim=angle)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_457">457</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fname&nbsp;=&nbsp;'%s%03d.png'%(prefix,i)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_458">458</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.figure.savefig(fname)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_459">459</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;files.append(fname)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_460">460</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;files&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_461">461</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;make_movie(files,output,&nbsp;fps=10,bitrate=1800,**kwargs):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_462">462</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_name,&nbsp;output_ext&nbsp;=&nbsp;os.path.splitext(output)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_463">463</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;command&nbsp;=&nbsp;{&nbsp;'.mp4'&nbsp;:&nbsp;'mencoder&nbsp;"mf://%s"&nbsp;-mf&nbsp;fps=%d&nbsp;-o&nbsp;%s.mp4&nbsp;-ovc&nbsp;lavc\</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_464">464</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-lavcopts&nbsp;vcodec=msmpeg4v2:vbitrate=%d'</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_465">465</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%(",".join(files),fps,output_name,bitrate)}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_466">466</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;command['.ogv']&nbsp;=&nbsp;command['.mp4']&nbsp;+&nbsp;';&nbsp;ffmpeg&nbsp;-i&nbsp;%s.mp4&nbsp;-r&nbsp;%d&nbsp;%s'%(output_name,fps,output)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_467">467</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(command[output_ext])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_468">468</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_ext&nbsp;=&nbsp;os.path.splitext(output)[1]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_469">469</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.system(command[output_ext])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_470">470</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;make_gif(files,output,delay=100,&nbsp;repeat=True,**kwargs):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_471">471</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loop&nbsp;=&nbsp;-1&nbsp;if&nbsp;repeat&nbsp;else&nbsp;0</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_472">472</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.system('convert&nbsp;-delay&nbsp;%d&nbsp;-loop&nbsp;%d&nbsp;%s&nbsp;%s'</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_473">473</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%(delay,loop,"&nbsp;".join(files),output))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_474">474</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;make_strip(files,output,**kwargs):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_475">475</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.system('montage&nbsp;-tile&nbsp;1x&nbsp;-geometry&nbsp;+0+0&nbsp;%s&nbsp;%s'%("&nbsp;".join(files),output))&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_476">476</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;rotanimate(ax,&nbsp;angles,&nbsp;output,&nbsp;**kwargs):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_477">477</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_ext&nbsp;=&nbsp;os.path.splitext(output)[1]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_478">478</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;files&nbsp;=&nbsp;make_views(ax,angles,&nbsp;**kwargs)&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_479">479</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D&nbsp;=&nbsp;{&nbsp;'.mp4'&nbsp;:&nbsp;make_movie,</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_480">480</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'.ogv'&nbsp;:&nbsp;make_movie,</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_481">481</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'.gif':&nbsp;make_gif&nbsp;,</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_482">482</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'.jpeg':&nbsp;make_strip,</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_483">483</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'.png':make_strip}</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_484">484</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D[output_ext](files,output,**kwargs)&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_485">485</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;f&nbsp;in&nbsp;files:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_486">486</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.remove(f)&nbsp;&nbsp;&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_487">487</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.get_legend().remove()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_488">488</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;angles&nbsp;=&nbsp;np.linspace(0,360,21)[:-1]&nbsp;#&nbsp;A&nbsp;list&nbsp;of&nbsp;20&nbsp;angles&nbsp;between&nbsp;0&nbsp;and&nbsp;360</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_489">489</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;create&nbsp;an&nbsp;animated&nbsp;gif&nbsp;(20ms&nbsp;between&nbsp;frames)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_490">490</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rotanimate(ax,&nbsp;angles,'pca.gif',delay=200)&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_491">491</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;create&nbsp;a&nbsp;movie&nbsp;with&nbsp;10&nbsp;frames&nbsp;per&nbsp;seconds&nbsp;and&nbsp;'quality'&nbsp;2000</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_492">492</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rotanimate(ax,&nbsp;angles,'pca.mp4',fps=50,bitrate=4000)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_493">493</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_494">494</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_495">495</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;PCAVariationFS(self,&nbsp;n_pca_dims:&nbsp;int=3,&nbsp;spliced_file:&nbsp;str="Splicec.csv",&nbsp;resuts_directory:&nbsp;str="/filler/dir"):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_496">496</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;import&nbsp;R's&nbsp;utility&nbsp;package</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_497">497</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;utils&nbsp;=&nbsp;importr('utils')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_498">498</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('foreign')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_499">499</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('pbkrtest')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_500">500</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('sp')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_501">501</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('rio')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_502">502</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('lattice')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_503">503</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('maptools')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_504">504</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('Matrix')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_505">505</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('nlme')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_506">506</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('car')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_507">507</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ggplot2&nbsp;=&nbsp;importr('ggplot2')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_508">508</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;car&nbsp;=&nbsp;importr('car')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_509">509</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('cluster')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_510">510</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;car&nbsp;=&nbsp;importr('cluster')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_511">511</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('FactoMineR')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_512">512</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('factoextra')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_513">513</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FactoMineR&nbsp;=&nbsp;importr('FactoMineR')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_514">514</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;factoextra&nbsp;=&nbsp;importr('factoextra')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_515">515</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pandas2ri.activate()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_516">516</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;robjects.globalenv['spliced_file']&nbsp;=&nbsp;spliced_file</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_517">517</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;robjects.globalenv['resuts_directory']&nbsp;=&nbsp;resuts_directory</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_518">518</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ro.r('spliced_data&nbsp;&lt;-&nbsp;read.csv(spliced_file,&nbsp;sep=",",&nbsp;header=TRUE)')&nbsp;#mm10_pberghei_ercc_mouse_</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_519">519</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ro.r('rownames(spliced_data)&nbsp;&lt;-&nbsp;spliced_data$ID')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_520">520</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ro.r('spliced_data&nbsp;&lt;-&nbsp;spliced_data[,-1]')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_521">521</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ro.r('pcadata&nbsp;&lt;-&nbsp;t(spliced_data)')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_522">522</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ro.r('data.pca&nbsp;&lt;-&nbsp;PCA(pcadata,&nbsp;scale.unit&nbsp;=&nbsp;FALSE,&nbsp;ncp&nbsp;=&nbsp;3,&nbsp;graph&nbsp;=&nbsp;FALSE)')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_523">523</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ro.r('setwd(resuts_directory)')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_524">524</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ro.r('genes_contributions&nbsp;&lt;-&nbsp;data.frame(data.pca$var$contrib)')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_525">525</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ro.r('genes_contributions_pca_1_order&nbsp;&lt;-&nbsp;genes_contributions[order(-genes_contributions$Dim.1),]')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_526">526</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ro.r('genes_contributions_pca_2_order&nbsp;&lt;-&nbsp;genes_contributions[order(-genes_contributions$Dim.2),]')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_527">527</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#ro.r('print(genes_contributions_pca_1_order[1:10,])')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_528">528</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#ro.r('print(genes_contributions_pca_2_order[1:10,])')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_529">529</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ro.r('min_percent&nbsp;=&nbsp;100/nrow(spliced_data)')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_530">530</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ro.r('genes_contributionspc1&nbsp;=&nbsp;genes_contributions[genes_contributions$Dim.1&nbsp;&gt;&nbsp;min_percent*6,]')&nbsp;#pvivax&nbsp;dat:&nbsp;pc1&nbsp;loose&nbsp;as&nbsp;higher&nbsp;%&nbsp;contributors&nbsp;going&nbsp;wrong&nbsp;way&nbsp;so&nbsp;to&nbsp;ensure&nbsp;they&nbsp;are&nbsp;kept&nbsp;in&nbsp;when&nbsp;pc1&nbsp;is&nbsp;more&nbsp;stringent&nbsp;need&nbsp;stringent&nbsp;pc2&nbsp;and&nbsp;pc3&nbsp;thresholds,&nbsp;as&nbsp;pc1&nbsp;increase,&nbsp;pc2&nbsp;and&nbsp;3&nbsp;decrease&nbsp;i.e.&nbsp;some&nbsp;kind&nbsp;of&nbsp;weighting&nbsp;is&nbsp;required</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_531">531</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ro.r('genes_contributionspc2&nbsp;=&nbsp;genes_contributions[genes_contributions$Dim.2&nbsp;&gt;&nbsp;min_percent*30,]')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_532">532</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ro.r('genes_contributionspc3&nbsp;=&nbsp;genes_contributions[genes_contributions$Dim.3&nbsp;&gt;&nbsp;min_percent*30,]')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_533">533</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ro.r('genes_contributionspc1a2&nbsp;&lt;-&nbsp;unique(c(rownames(genes_contributionspc1),&nbsp;rownames(genes_contributionspc2),&nbsp;rownames(genes_contributionspc3)))')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_534">534</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ro.r('print(genes_contributionspc1a2)')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_535">535</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ro.r('write.table(genes_contributionspc1,&nbsp;file&nbsp;=&nbsp;"PC1_Genes.csv",&nbsp;row.names=TRUE,&nbsp;sep=",")')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_536">536</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ro.r('write.table(genes_contributionspc2,&nbsp;file&nbsp;=&nbsp;"PC2_Genes.csv",&nbsp;row.names=TRUE,&nbsp;sep=",")')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_537">537</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ro.r('write.table(genes_contributionspc3,&nbsp;file&nbsp;=&nbsp;"PC3_Genes.csv",&nbsp;row.names=TRUE,&nbsp;sep=",")')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_538">538</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ro.r('write.table(genes_contributionspc1a2,&nbsp;file&nbsp;=&nbsp;"selected_Genes.csv",&nbsp;row.names=TRUE,&nbsp;sep=",")')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_539">539</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ro.r('write.table(min_percent,&nbsp;file&nbsp;=&nbsp;"PCAthreshold_used.csv",&nbsp;row.names=TRUE,&nbsp;sep=",")')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_540">540</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;important_genes&nbsp;=&nbsp;robjects.r.genes_contributionspc1a2</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_541">541</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genes&nbsp;=&nbsp;list(self.ra["Genes"])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_542">542</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_genes&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_543">543</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;gene&nbsp;in&nbsp;genes:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_544">544</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_genes.append(gene.replace('"',""))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_545">545</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genes&nbsp;=&nbsp;new_genes</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_546">546</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;important_genes&nbsp;=&nbsp;list(important_genes)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_547">547</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;save_genes&nbsp;=&nbsp;list(set(genes).intersection(important_genes))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_548">548</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;indexes&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_549">549</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;gene&nbsp;in&nbsp;save_genes:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_550">550</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;index&nbsp;=&nbsp;genes.index(gene)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_551">551</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;indexes.append(index)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_552">552</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_S&nbsp;=&nbsp;self.S</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_553">553</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_S&nbsp;=&nbsp;new_S[indexes,&nbsp;]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_554">554</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.S&nbsp;=&nbsp;new_S</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_555">555</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.S_sz&nbsp;=&nbsp;new_S</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_556">556</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.S_norm&nbsp;=&nbsp;new_S</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_557">557</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_U&nbsp;=&nbsp;self.U</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_558">558</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_U&nbsp;=&nbsp;new_U[indexes,&nbsp;]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_559">559</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.U&nbsp;=&nbsp;new_U</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_560">560</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.U_sz&nbsp;=&nbsp;new_U</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_561">561</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.U_norm&nbsp;=&nbsp;new_U</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_562">562</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_A&nbsp;=&nbsp;self.A</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_563">563</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_A&nbsp;=&nbsp;new_A[indexes,&nbsp;]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_564">564</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.A&nbsp;=&nbsp;new_A</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_565">565</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genesy&nbsp;=&nbsp;self.ra["Genes"]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_566">566</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genesy&nbsp;=&nbsp;genesy[indexes]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_567">567</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ra["Genes"]&nbsp;=&nbsp;genesy</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_568">568</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_569">569</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;TransitionProbabilityScatterplots(self,&nbsp;filename:&nbsp;str="SummaryTable_Mean_SelfNotRemoved_NN5_UMAP.csv",&nbsp;make_gify:&nbsp;bool=True):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_570">570</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Meandata&nbsp;=&nbsp;pd.read_csv(filename)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_571">571</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GroupNames&nbsp;=&nbsp;sorted(set(list(Meandata.iloc[:,1])))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_572">572</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NumberGroups&nbsp;=&nbsp;len(set(list(Meandata.iloc[:,1])))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_573">573</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colours&nbsp;=&nbsp;["#CC79A7",&nbsp;"#009E73",&nbsp;"#E69F00"]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_574">574</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;markers&nbsp;=&nbsp;['o',&nbsp;'^',&nbsp;'X']</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_575">575</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;rotate(angle):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_576">576</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.view_init(azim=angle)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_577">577</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;init():</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_578">578</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fig,</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_579">579</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;animate(i):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_580">580</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.view_init(elev=(i-45)*4,&nbsp;azim=10)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_581">581</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fig,</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_582">582</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;NumberGroups&nbsp;==&nbsp;2:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_583">583</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plotnames&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_584">584</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fig,&nbsp;ax&nbsp;=&nbsp;plt.subplots(figsize=(8,&nbsp;7))&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_585">585</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;0</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_586">586</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;groupynam&nbsp;in&nbsp;GroupNames:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_587">587</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group1&nbsp;=&nbsp;Meandata.loc[Meandata['Group']&nbsp;==&nbsp;groupynam]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_588">588</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group1x&nbsp;=&nbsp;Group1[[str(GroupNames[-2])]]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_589">589</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group1y&nbsp;=&nbsp;Group1[[str(GroupNames[-1])]]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_590">590</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myplot&nbsp;=&nbsp;ax.scatter(x=Group1x,&nbsp;y=Group1y,&nbsp;c=colours[count],&nbsp;marker=markers[count])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_591">591</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plotnames.append(myplot)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_592">592</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;count&nbsp;+&nbsp;1&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_593">593</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xlab&nbsp;=&nbsp;'Transition&nbsp;Probability&nbsp;to&nbsp;'&nbsp;+&nbsp;str(GroupNames[-2])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_594">594</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ylab&nbsp;=&nbsp;'Transition&nbsp;Probability&nbsp;to&nbsp;'&nbsp;+&nbsp;str(GroupNames[-1])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_595">595</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.xlabel(xlab)&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_596">596</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.ylabel(ylab)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_597">597</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.legend(plotnames,&nbsp;list(GroupNames),&nbsp;fancybox=True,&nbsp;framealpha=1,&nbsp;borderpad=1,&nbsp;loc=(1.01,0.5),&nbsp;title='Key',&nbsp;prop={'size':7})</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_598">598</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newfilename&nbsp;=&nbsp;filename.rsplit('/',&nbsp;1)[0]&nbsp;+&nbsp;'/'&nbsp;+&nbsp;re.sub("SummaryTable_",&nbsp;"",&nbsp;&nbsp;&nbsp;re.sub(".csv",&nbsp;"",&nbsp;filename.rsplit('/',&nbsp;1)[1]))&nbsp;+&nbsp;"_2DScatterplot.png"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_599">599</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(newfilename)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_600">600</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;NumberGroups&nbsp;==&nbsp;3:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_601">601</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fig&nbsp;=&nbsp;plt.figure()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_602">602</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax&nbsp;=&nbsp;fig.add_subplot(111,&nbsp;projection='3d')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_603">603</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group1&nbsp;=&nbsp;Meandata.loc[Meandata['Group']&nbsp;==&nbsp;GroupNames[0]]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_604">604</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group1x&nbsp;=&nbsp;Group1.iloc[:,2]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_605">605</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group1y&nbsp;=&nbsp;Group1.iloc[:,3]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_606">606</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group1z&nbsp;=&nbsp;Group1.iloc[:,4]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_607">607</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group1plot&nbsp;=&nbsp;ax.scatter(Group1x,&nbsp;Group1y,&nbsp;Group1z,&nbsp;c=colours[0],&nbsp;marker=markers[0])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_608">608</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group2&nbsp;=&nbsp;Meandata.loc[Meandata['Group']&nbsp;==&nbsp;GroupNames[1]]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_609">609</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group2x&nbsp;=&nbsp;Group2.iloc[:,2]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_610">610</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group2y&nbsp;=&nbsp;Group2.iloc[:,3]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_611">611</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group2z&nbsp;=&nbsp;Group2.iloc[:,4]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_612">612</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group2plot&nbsp;=&nbsp;ax.scatter(Group2x,&nbsp;Group2y,&nbsp;Group2z,&nbsp;c=colours[1],&nbsp;marker=markers[1])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_613">613</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group3&nbsp;=&nbsp;Meandata.loc[Meandata['Group']&nbsp;==&nbsp;GroupNames[2]]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_614">614</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group3x&nbsp;=&nbsp;Group3.iloc[:,2]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_615">615</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group3y&nbsp;=&nbsp;Group3.iloc[:,3]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_616">616</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group3z&nbsp;=&nbsp;Group3.iloc[:,4]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_617">617</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group3plot&nbsp;=&nbsp;ax.scatter(Group3x,&nbsp;Group3y,&nbsp;Group3z,&nbsp;c=colours[2],&nbsp;marker=markers[2])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_618">618</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xlab&nbsp;=&nbsp;'Transition&nbsp;Probability&nbsp;to&nbsp;'&nbsp;+&nbsp;Meandata.columns[2]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_619">619</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ylab&nbsp;=&nbsp;'Transition&nbsp;Probability&nbsp;to&nbsp;'&nbsp;+&nbsp;Meandata.columns[3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_620">620</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zlab&nbsp;=&nbsp;'Transition&nbsp;Probability&nbsp;to&nbsp;'&nbsp;+&nbsp;Meandata.columns[4]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_621">621</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.set_xlabel(xlab)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_622">622</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.set_ylabel(ylab)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_623">623</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.set_zlabel(zlab)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_624">624</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.legend((Group1plot,&nbsp;Group2plot,&nbsp;Group3plot),&nbsp;list(GroupNames),&nbsp;fancybox=True,&nbsp;framealpha=1,&nbsp;borderpad=1,&nbsp;loc=(0.85,0.5),&nbsp;title='Key')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_625">625</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newfilename&nbsp;=&nbsp;filename.rsplit('/',&nbsp;1)[0]&nbsp;+&nbsp;'/'&nbsp;+&nbsp;re.sub("SummaryTable_",&nbsp;"",&nbsp;&nbsp;&nbsp;re.sub(".csv",&nbsp;"",&nbsp;filename.rsplit('/',&nbsp;1)[1]))&nbsp;+&nbsp;"_3DScatterplot.png"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_626">626</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(newfilename)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_627">627</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(make_gify&nbsp;==&nbsp;True):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_628">628</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gif_name_1&nbsp;=&nbsp;filename.rsplit('/',&nbsp;1)[0]&nbsp;+&nbsp;'/'&nbsp;+&nbsp;re.sub("SummaryTable_",&nbsp;"",&nbsp;re.sub(".csv",&nbsp;"",&nbsp;filename.rsplit('/',&nbsp;1)[1]))&nbsp;+&nbsp;"_3DScatterploLeftRight.gif"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_629">629</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gif_name_2&nbsp;=&nbsp;filename.rsplit('/',&nbsp;1)[0]&nbsp;+&nbsp;'/'&nbsp;+&nbsp;re.sub("SummaryTable_",&nbsp;"",&nbsp;re.sub(".csv",&nbsp;"",&nbsp;filename.rsplit('/',&nbsp;1)[1]))&nbsp;+&nbsp;"_3DScatterploUpDown.gif"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_630">630</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rot_animation&nbsp;=&nbsp;animation.FuncAnimation(fig,&nbsp;rotate,&nbsp;frames=np.arange(0,&nbsp;362,&nbsp;2),&nbsp;interval=100)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_631">631</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rot_animation.save(gif_name_1,&nbsp;dpi=80,&nbsp;writer='imagemagick')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_632">632</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ani_2&nbsp;=&nbsp;animation.FuncAnimation(fig,&nbsp;animate,&nbsp;init_func=init,&nbsp;frames=200,&nbsp;interval=100,&nbsp;blit=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_633">633</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ani_2.save(gif_name_2,&nbsp;dpi=80,&nbsp;writer='imagemagick')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_634">634</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;NumberGroups&nbsp;&gt;&nbsp;3:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_635">635</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numGraphstomake&nbsp;=&nbsp;NumberGroups/3</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_636">636</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numGraphstomake&nbsp;=&nbsp;int(numGraphstomake)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_637">637</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(NumberGroups&nbsp;&lt;=&nbsp;8):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_638">638</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;manycolours&nbsp;=&nbsp;["#000000",&nbsp;"#E69F00",&nbsp;"#56B4E9",&nbsp;"#009E73",&nbsp;"#F0E442",&nbsp;"#0072B2",&nbsp;"#D55E00",&nbsp;"#CC79A7"]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_639">639</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_640">640</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmap2&nbsp;=&nbsp;cm.get_cmap('Paired')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_641">641</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;manycolours&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_642">642</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(cmap2.N):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_643">643</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rgb&nbsp;=&nbsp;cmap2(i)[:3]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_644">644</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;manycolours.append(matplotlib.colors.rgb2hex(rgb))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_645">645</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;NumberGroups%3==0:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_646">646</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(0,&nbsp;numGraphstomake):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_647">647</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Groupnums&nbsp;=&nbsp;list(range(i+i+i,i+i+i+2+1))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_648">648</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myGroups&nbsp;=&nbsp;GroupNames[Groupnums[0]:&nbsp;Groupnums[-1]+1]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_649">649</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fig&nbsp;=&nbsp;plt.figure()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_650">650</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax&nbsp;=&nbsp;fig.add_subplot(111,&nbsp;projection='3d')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_651">651</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plotnames&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_652">652</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;0</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_653">653</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;groupynam&nbsp;in&nbsp;GroupNames:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_654">654</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group1&nbsp;=&nbsp;Meandata.loc[Meandata['Group']&nbsp;==&nbsp;groupynam]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_655">655</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group1x&nbsp;=&nbsp;Group1[[str(myGroups[0])]]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_656">656</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group1y&nbsp;=&nbsp;Group1[[str(myGroups[1])]]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_657">657</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group1z&nbsp;=&nbsp;Group1[[str(myGroups[2])]]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_658">658</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myplot&nbsp;=&nbsp;ax.scatter(Group1x,&nbsp;Group1y,&nbsp;Group1z,&nbsp;c=manycolours[count],&nbsp;marker='o')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_659">659</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plotnames.append(myplot)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_660">660</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;count&nbsp;+&nbsp;1</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_661">661</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xlab&nbsp;=&nbsp;'Transition&nbsp;Probability&nbsp;to&nbsp;'&nbsp;+&nbsp;str(myGroups[0])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_662">662</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ylab&nbsp;=&nbsp;'Transition&nbsp;Probability&nbsp;to&nbsp;'&nbsp;+&nbsp;str(myGroups[1])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_663">663</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zlab&nbsp;=&nbsp;'Transition&nbsp;Probability&nbsp;to&nbsp;'&nbsp;+&nbsp;str(myGroups[2])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_664">664</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.set_xlabel(xlab)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_665">665</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.set_ylabel(ylab)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_666">666</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.set_zlabel(zlab)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_667">667</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.legend(list(plotnames),&nbsp;list(GroupNames),&nbsp;title='Key')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_668">668</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newfilename&nbsp;=&nbsp;filename.rsplit('/',&nbsp;1)[0]&nbsp;+&nbsp;'/'&nbsp;+&nbsp;re.sub("SummaryTable_",&nbsp;"",&nbsp;&nbsp;&nbsp;re.sub(".csv",&nbsp;"",&nbsp;filename.rsplit('/',&nbsp;1)[1]))&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(i+1)&nbsp;+&nbsp;"_3DScatterplot.png"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_669">669</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(newfilename)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_670">670</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(make_gify&nbsp;==&nbsp;True):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_671">671</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gif_name_1&nbsp;=&nbsp;filename.rsplit('/',&nbsp;1)[0]&nbsp;+&nbsp;'/'&nbsp;+&nbsp;re.sub("SummaryTable_",&nbsp;"",&nbsp;re.sub(".csv",&nbsp;"",&nbsp;filename.rsplit('/',&nbsp;1)[1]))&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(i+1)&nbsp;+&nbsp;"_3DScatterploLeftRight.gif"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_672">672</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gif_name_2&nbsp;=&nbsp;filename.rsplit('/',&nbsp;1)[0]&nbsp;+&nbsp;'/'&nbsp;+&nbsp;re.sub("SummaryTable_",&nbsp;"",&nbsp;re.sub(".csv",&nbsp;"",&nbsp;filename.rsplit('/',&nbsp;1)[1]))&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(i+1)&nbsp;+&nbsp;"_3DScatterploUpDown.gif"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_673">673</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rot_animation&nbsp;=&nbsp;animation.FuncAnimation(fig,&nbsp;rotate,&nbsp;frames=np.arange(0,&nbsp;362,&nbsp;2),&nbsp;interval=100)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_674">674</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rot_animation.save(gif_name_1,&nbsp;dpi=80,&nbsp;writer='imagemagick')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_675">675</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ani_2&nbsp;=&nbsp;animation.FuncAnimation(fig,&nbsp;animate,&nbsp;init_func=init,&nbsp;frames=200,&nbsp;interval=100,&nbsp;blit=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_676">676</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ani_2.save(gif_name_2,&nbsp;dpi=80,&nbsp;writer='imagemagick')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_677">677</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_678">678</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(0,&nbsp;numGraphstomake):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_679">679</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Groupnums&nbsp;=&nbsp;list(range(i+i+i,i+i+i+2+1))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_680">680</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myGroups&nbsp;=&nbsp;GroupNames[Groupnums[0]:&nbsp;Groupnums[-1]+1]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_681">681</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fig&nbsp;=&nbsp;plt.figure()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_682">682</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax&nbsp;=&nbsp;fig.add_subplot(111,&nbsp;projection='3d')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_683">683</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plotnames&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_684">684</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;0</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_685">685</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;groupynam&nbsp;in&nbsp;GroupNames:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_686">686</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group1&nbsp;=&nbsp;Meandata.loc[Meandata['Group']&nbsp;==&nbsp;groupynam]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_687">687</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group1x&nbsp;=&nbsp;Group1[[str(myGroups[0])]]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_688">688</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group1y&nbsp;=&nbsp;Group1[[str(myGroups[1])]]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_689">689</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group1z&nbsp;=&nbsp;Group1[[str(myGroups[2])]]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_690">690</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myplot&nbsp;=&nbsp;ax.scatter(Group1x,&nbsp;Group1y,&nbsp;Group1z,&nbsp;c=manycolours[count],&nbsp;marker='o')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_691">691</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plotnames.append(myplot)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_692">692</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;count&nbsp;+&nbsp;1</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_693">693</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xlab&nbsp;=&nbsp;'Transition&nbsp;Probability&nbsp;to&nbsp;'&nbsp;+&nbsp;str(myGroups[0])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_694">694</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ylab&nbsp;=&nbsp;'Transition&nbsp;Probability&nbsp;to&nbsp;'&nbsp;+&nbsp;str(myGroups[1])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_695">695</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zlab&nbsp;=&nbsp;'Transition&nbsp;Probability&nbsp;to&nbsp;'&nbsp;+&nbsp;str(myGroups[2])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_696">696</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.set_xlabel(xlab)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_697">697</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.set_ylabel(ylab)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_698">698</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.set_zlabel(zlab)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_699">699</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.legend(list(plotnames),&nbsp;list(GroupNames),&nbsp;title='Key')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_700">700</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newfilename&nbsp;=&nbsp;filename.rsplit('/',&nbsp;1)[0]&nbsp;+&nbsp;'/'&nbsp;+&nbsp;re.sub("SummaryTable_",&nbsp;"",&nbsp;&nbsp;&nbsp;re.sub(".csv",&nbsp;"",&nbsp;filename.rsplit('/',&nbsp;1)[1]))&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(i+1)&nbsp;+&nbsp;"_3DScatterplot.png"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_701">701</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(newfilename)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_702">702</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(make_gify&nbsp;==&nbsp;True):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_703">703</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gif_name_1&nbsp;=&nbsp;filename.rsplit('/',&nbsp;1)[0]&nbsp;+&nbsp;'/'&nbsp;+&nbsp;re.sub("SummaryTable_",&nbsp;"",&nbsp;re.sub(".csv",&nbsp;"",&nbsp;filename.rsplit('/',&nbsp;1)[1]))&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(i+1)&nbsp;+&nbsp;"_3DScatterploLeftRight.gif"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_704">704</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gif_name_2&nbsp;=&nbsp;filename.rsplit('/',&nbsp;1)[0]&nbsp;+&nbsp;'/'&nbsp;+&nbsp;re.sub("SummaryTable_",&nbsp;"",&nbsp;re.sub(".csv",&nbsp;"",&nbsp;filename.rsplit('/',&nbsp;1)[1]))&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(i+1)&nbsp;+&nbsp;"_3DScatterploUpDown.gif"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_705">705</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rot_animation&nbsp;=&nbsp;animation.FuncAnimation(fig,&nbsp;rotate,&nbsp;frames=np.arange(0,&nbsp;362,&nbsp;2),&nbsp;interval=100)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_706">706</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rot_animation.save(gif_name_1,&nbsp;dpi=80,&nbsp;writer='imagemagick')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_707">707</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ani_2&nbsp;=&nbsp;animation.FuncAnimation(fig,&nbsp;animate,&nbsp;init_func=init,&nbsp;frames=200,&nbsp;interval=100,&nbsp;blit=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_708">708</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ani_2.save(gif_name_2,&nbsp;dpi=80,&nbsp;writer='imagemagick')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_709">709</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#2d&nbsp;graph&nbsp;of&nbsp;last&nbsp;two&nbsp;groups:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_710">710</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plotnames&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_711">711</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fig,&nbsp;ax&nbsp;=&nbsp;plt.subplots(figsize=(8,&nbsp;7))&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_712">712</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;0</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_713">713</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;groupynam&nbsp;in&nbsp;GroupNames:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_714">714</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group1&nbsp;=&nbsp;Meandata.loc[Meandata['Group']&nbsp;==&nbsp;groupynam]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_715">715</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group1x&nbsp;=&nbsp;Group1[[str(GroupNames[-2])]]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_716">716</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Group1y&nbsp;=&nbsp;Group1[[str(GroupNames[-1])]]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_717">717</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myplot&nbsp;=&nbsp;ax.scatter(x=Group1x,&nbsp;y=Group1y,&nbsp;c=manycolours[count],&nbsp;marker='o')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_718">718</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plotnames.append(myplot)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_719">719</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;count&nbsp;+&nbsp;1&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_720">720</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xlab&nbsp;=&nbsp;'Transition&nbsp;Probability&nbsp;to&nbsp;'&nbsp;+&nbsp;str(GroupNames[-2])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_721">721</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ylab&nbsp;=&nbsp;'Transition&nbsp;Probability&nbsp;to&nbsp;'&nbsp;+&nbsp;str(GroupNames[-1])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_722">722</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.xlabel(xlab)&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_723">723</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.ylabel(ylab)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_724">724</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.legend(plotnames,&nbsp;list(GroupNames),&nbsp;fancybox=True,&nbsp;framealpha=1,&nbsp;borderpad=1,&nbsp;loc=(1.01,0.5),&nbsp;title='Key',&nbsp;prop={'size':7})</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_725">725</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newfilename&nbsp;=&nbsp;filename.rsplit('/',&nbsp;1)[0]&nbsp;+&nbsp;'/'&nbsp;+&nbsp;re.sub("SummaryTable_",&nbsp;"",&nbsp;&nbsp;&nbsp;re.sub(".csv",&nbsp;"",&nbsp;filename.rsplit('/',&nbsp;1)[1]))&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(numGraphstomake+1)&nbsp;+&nbsp;"_2DScatterplot.png"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_726">726</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(newfilename)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_727">727</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close("all")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_728">728</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_729">729</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;CorrelationCoefficentFS(self,&nbsp;my_clusters):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_730">730</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spliced&nbsp;=&nbsp;self.S</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_731">731</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unspliced&nbsp;=&nbsp;self.U</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_732">732</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genes&nbsp;=&nbsp;self.ra["Genes"]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_733">733</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;time_points&nbsp;=&nbsp;self.ca["ClusterName"]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_734">734</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;samples&nbsp;=&nbsp;self.ca["Patients"]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_735">735</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#rows&nbsp;genes,&nbsp;columns:&nbsp;time-point</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_736">736</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spliced_df&nbsp;=&nbsp;pd.DataFrame.from_records(spliced)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_737">737</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spliced_df&nbsp;=&nbsp;spliced_df.transpose()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_738">738</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#spliced_df.rows&nbsp;=&nbsp;samples</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_739">739</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spliced_df.rename({1:&nbsp;2,&nbsp;2:&nbsp;4},&nbsp;axis='index')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_740">740</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spliced_df.columns&nbsp;=&nbsp;genes</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_741">741</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spliced_df['Time_Point']&nbsp;=&nbsp;list(map(int,time_points))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_742">742</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spliced_df['Samples']&nbsp;=&nbsp;samples</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_743">743</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spliced_df&nbsp;=&nbsp;pd.DataFrame(spliced_df).set_index('Samples')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_744">744</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccs&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_745">745</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;gene&nbsp;in&nbsp;genes:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_746">746</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccs.append(spliced_df[gene].corr(spliced_df["Time_Point"]))&nbsp;#default&nbsp;is&nbsp;pearson</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_747">747</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;coefficient_dataframe&nbsp;=&nbsp;pd.DataFrame({'Genes':&nbsp;genes,'CorrelCoeff':&nbsp;ccs})</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_748">748</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;increase&nbsp;=&nbsp;pd.DataFrame(coefficient_dataframe[coefficient_dataframe['CorrelCoeff']&nbsp;&gt;&nbsp;float(0.95)])&nbsp;#222</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_749">749</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decrease&nbsp;=&nbsp;pd.DataFrame(coefficient_dataframe[coefficient_dataframe['CorrelCoeff']&nbsp;&lt;&nbsp;float(-0.95)])&nbsp;#510</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_750">750</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;save_genes&nbsp;=&nbsp;unique(increase['Genes'].tolist()&nbsp;+&nbsp;decrease['Genes'].tolist())&nbsp;#concatenate&nbsp;with&nbsp;decrease&nbsp;genes</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_751">751</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(len(save_genes))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_752">752</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(increase)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_753">753</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(decrease)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_754">754</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;increase.to_csv("Transcripts_Selected_positive_correlation.csv",&nbsp;index=False)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_755">755</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decrease.to_csv("Transcripts_Selected_negative_correlation.csv",&nbsp;index=False)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_756">756</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genes&nbsp;=&nbsp;list(self.ra["Genes"])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_757">757</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;indexes&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_758">758</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;gene&nbsp;in&nbsp;save_genes:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_759">759</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;index&nbsp;=&nbsp;genes.index(gene)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_760">760</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;indexes.append(index)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_761">761</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_S&nbsp;=&nbsp;self.S</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_762">762</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_S&nbsp;=&nbsp;new_S[indexes,&nbsp;]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_763">763</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.S&nbsp;=&nbsp;new_S</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_764">764</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.S_sz&nbsp;=&nbsp;new_S</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_765">765</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.S_norm&nbsp;=&nbsp;new_S</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_766">766</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_U&nbsp;=&nbsp;self.U</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_767">767</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_U&nbsp;=&nbsp;new_U[indexes,&nbsp;]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_768">768</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.U&nbsp;=&nbsp;new_U</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_769">769</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.U_sz&nbsp;=&nbsp;new_U</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_770">770</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.U_norm&nbsp;=&nbsp;new_U</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_771">771</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_A&nbsp;=&nbsp;self.A</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_772">772</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_A&nbsp;=&nbsp;new_A[indexes,&nbsp;]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_773">773</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.A&nbsp;=&nbsp;new_A</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_774">774</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genesy&nbsp;=&nbsp;self.ra["Genes"]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_775">775</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genesy&nbsp;=&nbsp;genesy[indexes]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_776">776</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ra["Genes"]&nbsp;=&nbsp;genesy</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_777">777</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_778">778</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;basicUMAP(self,&nbsp;num_nei,&nbsp;make_gify:&nbsp;bool=True,&nbsp;distance:&nbsp;float=0.1,&nbsp;metric_method:&nbsp;str="euclidean",&nbsp;typegroup:&nbsp;str="integers",&nbsp;do3D:&nbsp;str="True",&nbsp;UMAP_3D_loc:&nbsp;str="/location/"):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_779">779</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_markers&nbsp;=&nbsp;self.ca["Markers"]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_780">780</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mark&nbsp;=&nbsp;sorted(set(my_markers))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_781">781</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;corresp&nbsp;=&nbsp;["o",&nbsp;"P",&nbsp;"D",&nbsp;"X",&nbsp;"*",&nbsp;"+",&nbsp;"&gt;",&nbsp;"&lt;"]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_782">782</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trans2comp&nbsp;=&nbsp;umap.UMAP(n_neighbors&nbsp;=&nbsp;num_nei,&nbsp;n_components=2).fit(self.S_norm.T)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_783">783</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.UMAPembed&nbsp;=&nbsp;trans2comp.embedding_</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_784">784</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;do3D&nbsp;==&nbsp;"True":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_785">785</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(UMAP_3D_loc)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_786">786</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trans&nbsp;=&nbsp;umap.UMAP(n_neighbors&nbsp;=&nbsp;num_nei,&nbsp;min_dist=distance,&nbsp;n_components=3,&nbsp;metric=metric_method).fit(self.S_norm.T)&nbsp;#min_distance&nbsp;defualt&nbsp;is&nbsp;0.1,&nbsp;varies&nbsp;0&nbsp;to&nbsp;0.99</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_787">787</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.UMAPembed3d&nbsp;=&nbsp;trans.embedding_</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_788">788</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;0</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_789">789</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_types&nbsp;=&nbsp;{}</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_790">790</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;the_type&nbsp;in&nbsp;mark:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_791">791</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_types[the_type]&nbsp;=&nbsp;corresp[count]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_792">792</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;count&nbsp;+&nbsp;1</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_793">793</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;markers&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_794">794</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;mar&nbsp;in&nbsp;my_markers:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_795">795</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;markers.append(my_types.get(mar))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_796">796</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;randn(10)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_797">797</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fig&nbsp;=&nbsp;plt.figure(figsize=(8,&nbsp;6))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_798">798</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax&nbsp;=&nbsp;fig.add_subplot(111,&nbsp;projection='3d')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_799">799</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(0,&nbsp;len(markers)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_800">800</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.scatter(trans.embedding_[i,&nbsp;0],&nbsp;trans.embedding_[i,&nbsp;1],&nbsp;trans.embedding_[i,&nbsp;2],&nbsp;marker=markers[i],&nbsp;c=self.colorandum[i])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_801">801</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexy_codes&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_802">802</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_keys&nbsp;=&nbsp;[k&nbsp;&nbsp;for&nbsp;&nbsp;k&nbsp;in&nbsp;&nbsp;self.cluster_colors_dict.keys()]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_803">803</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_my_keys&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_804">804</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;my_keys:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_805">805</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_my_keys.append(str(item,'utf-8'))&nbsp;#int()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_806">806</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmap2&nbsp;=&nbsp;cm.get_cmap('Paired')&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;PiYG</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_807">807</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(cmap2.N):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_808">808</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rgb&nbsp;=&nbsp;cmap2(i)[:3]&nbsp;#&nbsp;will&nbsp;return&nbsp;rgba,&nbsp;we&nbsp;take&nbsp;only&nbsp;first&nbsp;3&nbsp;so&nbsp;we&nbsp;get&nbsp;rgb</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_809">809</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexy_codes.append(matplotlib.colors.rgb2hex(rgb))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_810">810</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;legend_elements&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_811">811</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined&nbsp;=&nbsp;list(zip(decoded_my_keys,&nbsp;hexy_codes))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_812">812</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined&nbsp;=&nbsp;sorted(combined,&nbsp;key=itemgetter(0))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_813">813</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(typegroup&nbsp;!=&nbsp;"Strings"):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_814">814</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;timepoints&nbsp;=&nbsp;[int(i[0])&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_815">815</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colys&nbsp;=&nbsp;[i[1]&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_816">816</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tempDF&nbsp;=&nbsp;pd.DataFrame({'Group':timepoints,&nbsp;'colours':colys})</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_817">817</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tempDF&nbsp;=&nbsp;tempDF.sort_values('Group')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_818">818</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;groupys2&nbsp;=&nbsp;tempDF['Group'].tolist()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_819">819</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cols2&nbsp;=&nbsp;tempDF['colours'].tolist()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_820">820</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined&nbsp;=&nbsp;list(zip(groupys2,&nbsp;cols2))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_821">821</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_my_keys&nbsp;=&nbsp;[i[0]&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_822">822</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexy_codes&nbsp;=&nbsp;[i[1]&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_823">823</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;sample_type&nbsp;in&nbsp;range(0,&nbsp;len(decoded_my_keys)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_824">824</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to_add&nbsp;=&nbsp;Line2D([0],&nbsp;[0],&nbsp;marker='s',&nbsp;color='w',&nbsp;label=str(decoded_my_keys[sample_type]).strip('"'),&nbsp;markerfacecolor=str(hexy_codes[sample_type]),&nbsp;markersize=7)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_825">825</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;legend_elements.append(to_add)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_826">826</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;sample_type&nbsp;in&nbsp;range(0,&nbsp;len(mark)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_827">827</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to_add&nbsp;=&nbsp;Line2D([0],&nbsp;[0],&nbsp;marker=[*my_types.values()][sample_type],&nbsp;color='w',&nbsp;label=str([*my_types.keys()][sample_type]).strip('"'),&nbsp;markerfacecolor='black',&nbsp;markersize=7)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_828">828</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;legend_elements.append(to_add)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_829">829</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.legend(handles=legend_elements,&nbsp;title='Key')&nbsp;#Timepont&nbsp;\n(hours)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_830">830</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.set_xlabel('UMAP1')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_831">831</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.set_ylabel('UMAP2')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_832">832</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.set_zlabel('UMAP3')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_833">833</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;figure_name3D&nbsp;=&nbsp;'UMAP3D_NN'&nbsp;+&nbsp;str(num_nei)&nbsp;+&nbsp;'.pdf'</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_834">834</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(figure_name3D)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_835">835</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#plt.title('UMAP&nbsp;projection',&nbsp;fontsize=10);</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_836">836</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#plt.show()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_837">837</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(make_gify&nbsp;==&nbsp;True):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_838">838</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gify_name_1&nbsp;=&nbsp;'UMAP_rotation_NN'&nbsp;+&nbsp;str(num_nei)&nbsp;+&nbsp;'.gif'</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_839">839</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gify_name_2&nbsp;=&nbsp;'UMAP_rotation_up_down_NN'&nbsp;+&nbsp;str(num_nei)&nbsp;+&nbsp;'.gif'</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_840">840</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;rotate(angle):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_841">841</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.view_init(azim=angle)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_842">842</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rot_animation&nbsp;=&nbsp;animation.FuncAnimation(fig,&nbsp;rotate,&nbsp;frames=np.arange(0,&nbsp;362,&nbsp;2),&nbsp;interval=100)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_843">843</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rot_animation.save(gify_name_1,&nbsp;dpi=80,&nbsp;writer='imagemagick')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_844">844</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;init():</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_845">845</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fig,</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_846">846</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;animate(i):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_847">847</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.view_init(elev=(i-45)*4,&nbsp;azim=10)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_848">848</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fig,</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_849">849</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ani_2&nbsp;=&nbsp;animation.FuncAnimation(fig,&nbsp;animate,&nbsp;init_func=init,&nbsp;frames=200,&nbsp;interval=100,&nbsp;blit=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_850">850</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ani_2.save(gify_name_2,&nbsp;dpi=80,&nbsp;writer='imagemagick')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_851">851</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_852">852</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_853">853</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;estimate_transition_probUMAP(self,&nbsp;hidim:&nbsp;str="Sx_sz",&nbsp;embed:&nbsp;str="UMAPembed",&nbsp;transform:&nbsp;str="sqrt",ndims:&nbsp;int=None,&nbsp;n_sight:&nbsp;int=None,&nbsp;psc:&nbsp;float=None,knn_random:&nbsp;bool=False,&nbsp;sampled_fraction:&nbsp;float=0.3,sampling_probs:&nbsp;Tuple[float,&nbsp;float]=(0.5,&nbsp;0.1),&nbsp;max_dist_embed:&nbsp;float=None,&nbsp;n_jobs:&nbsp;int=4,&nbsp;threads:&nbsp;int=None,&nbsp;calculate_randomized:&nbsp;bool=True,&nbsp;random_seed:&nbsp;int=15071990,&nbsp;**kwargs)&nbsp;-&gt;&nbsp;None:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_854">854</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numba_random_seed(random_seed)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_855">855</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.which_hidim&nbsp;=&nbsp;hidim&nbsp;#spliced&nbsp;states&nbsp;before&nbsp;timepoint&nbsp;same&nbsp;calculation&nbsp;used&nbsp;to&nbsp;calculate&nbsp;after&nbsp;just&nbsp;with&nbsp;different&nbsp;names&nbsp;for&nbsp;the&nbsp;same&nbsp;thing&nbsp;this&nbsp;is:&nbsp;self.Sx_sz</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_856">856</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;"n_neighbors"&nbsp;in&nbsp;kwargs:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_857">857</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_neighbors&nbsp;=&nbsp;kwargs.pop("n_neighbors")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_858">858</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;len(kwargs)&nbsp;&gt;&nbsp;0:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_859">859</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warning(f"keyword&nbsp;arguments&nbsp;were&nbsp;passed&nbsp;but&nbsp;could&nbsp;not&nbsp;be&nbsp;interpreted&nbsp;{kwargs}")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_860">860</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_861">861</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_neighbors&nbsp;=&nbsp;None</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_862">862</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n_sight&nbsp;is&nbsp;None&nbsp;and&nbsp;n_neighbors&nbsp;is&nbsp;None:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_863">863</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_neighbors&nbsp;=&nbsp;int(self.S.shape[1]&nbsp;/&nbsp;5)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_864">864</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(n_sight&nbsp;is&nbsp;not&nbsp;None)&nbsp;and&nbsp;(n_neighbors&nbsp;is&nbsp;not&nbsp;None)&nbsp;and&nbsp;n_neighbors&nbsp;!=&nbsp;n_sight:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_865">865</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;ValueError("n_sight&nbsp;and&nbsp;n_neighbors&nbsp;are&nbsp;different&nbsp;names&nbsp;for&nbsp;the&nbsp;same&nbsp;parameter,&nbsp;they&nbsp;cannot&nbsp;be&nbsp;set&nbsp;differently")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_866">866</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n_sight&nbsp;is&nbsp;not&nbsp;None&nbsp;and&nbsp;n_neighbors&nbsp;is&nbsp;None:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_867">867</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_neighbors&nbsp;=&nbsp;n_sight</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_868">868</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;psc&nbsp;is&nbsp;None:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_869">869</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;transform&nbsp;==&nbsp;"log"&nbsp;or&nbsp;transform&nbsp;==&nbsp;"logratio":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_870">870</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;psc&nbsp;=&nbsp;1.</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_871">871</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;transform&nbsp;==&nbsp;"sqrt":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_872">872</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;psc&nbsp;=&nbsp;1e-10&nbsp;&nbsp;#&nbsp;for&nbsp;numerical&nbsp;stablity</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_873">873</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:&nbsp;&nbsp;#&nbsp;transform&nbsp;==&nbsp;"linear":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_874">874</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;psc&nbsp;=&nbsp;0</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_875">875</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;knn_random:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_876">876</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.random.seed(random_seed)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_877">877</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corr_calc&nbsp;=&nbsp;"knn_random"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_878">878</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;"pcs"&nbsp;in&nbsp;hidim:&nbsp;&nbsp;#&nbsp;sic</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_879">879</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim&nbsp;=&nbsp;np.array(getattr(self,&nbsp;hidim).T[:,&nbsp;:ndims],&nbsp;order="C")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_880">880</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim_t&nbsp;=&nbsp;np.array(getattr(self,&nbsp;hidim&nbsp;+&nbsp;"_t").T[:,&nbsp;:ndims],&nbsp;order="C")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_881">881</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_882">882</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ndims&nbsp;is&nbsp;not&nbsp;None:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_883">883</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;ValueError(f"ndims&nbsp;was&nbsp;set&nbsp;to&nbsp;{ndims}&nbsp;but&nbsp;hidim&nbsp;!=&nbsp;'pcs'.&nbsp;Set&nbsp;ndims&nbsp;=&nbsp;None&nbsp;for&nbsp;hidim='{hidim}'")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_884">884</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim&nbsp;=&nbsp;getattr(self,&nbsp;hidim)&nbsp;&nbsp;#&nbsp;[:,&nbsp;:ndims]&nbsp;hi_dim&nbsp;is&nbsp;the</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_885">885</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim_t&nbsp;=&nbsp;hi_dim&nbsp;+&nbsp;self.used_delta_t&nbsp;*&nbsp;self.delta_S&nbsp;&nbsp;#&nbsp;[:,&nbsp;:ndims]&nbsp;[:,&nbsp;:ndims]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_886">886</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_887">887</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_S_rndm&nbsp;=&nbsp;np.copy(self.delta_S)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_888">888</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permute_rows_nsign(self.delta_S_rndm)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_889">889</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim_t_rndm&nbsp;=&nbsp;hi_dim&nbsp;+&nbsp;self.used_delta_t&nbsp;*&nbsp;self.delta_S_rndm</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_890">890</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;embedding&nbsp;=&nbsp;getattr(self,&nbsp;embed)&nbsp;#here??????</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_891">891</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.embedding_UMAP&nbsp;=&nbsp;embedding</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_892">892</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug("Calculate&nbsp;KNN&nbsp;in&nbsp;the&nbsp;embedding&nbsp;space")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_893">893</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nn&nbsp;=&nbsp;NearestNeighbors(n_neighbors=n_neighbors,&nbsp;n_jobs=n_jobs)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_894">894</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nn.fit(embedding)&nbsp;&nbsp;#&nbsp;NOTE&nbsp;should&nbsp;support&nbsp;knn&nbsp;in&nbsp;high&nbsp;dimensions</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_895">895</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.embedding_UMAP_knn&nbsp;=&nbsp;nn.kneighbors_graph(mode="connectivity")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_896">896</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pick&nbsp;random&nbsp;neighbours&nbsp;and&nbsp;prune&nbsp;the&nbsp;rest</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_897">897</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neigh_ixs&nbsp;=&nbsp;self.embedding_UMAP_knn.indices.reshape((-1,&nbsp;n_neighbors))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_898">898</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;=&nbsp;np.linspace(sampling_probs[0],&nbsp;sampling_probs[1],&nbsp;neigh_ixs.shape[1])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_899">899</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;=&nbsp;p&nbsp;/&nbsp;p.sum()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_900">900</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;There&nbsp;was&nbsp;a&nbsp;problem&nbsp;of&nbsp;API&nbsp;consistency&nbsp;because&nbsp;the&nbsp;random.choice&nbsp;can&nbsp;pick&nbsp;the&nbsp;diagonal&nbsp;value&nbsp;(or&nbsp;not)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_901">901</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;resulting&nbsp;self.embedding_UMAPf&nbsp;with&nbsp;different&nbsp;number&nbsp;of&nbsp;nonzero&nbsp;entry&nbsp;per&nbsp;row.</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_902">902</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Not&nbsp;updated&nbsp;yet&nbsp;not&nbsp;to&nbsp;break&nbsp;previous&nbsp;analyses</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_903">903</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Fix&nbsp;is&nbsp;substituting&nbsp;below&nbsp;`neigh_ixs.shape[1]`&nbsp;with&nbsp;`np.arange(1,neigh_ixs.shape[1]-1)`</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_904">904</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;I&nbsp;change&nbsp;it&nbsp;here&nbsp;since&nbsp;I&nbsp;am&nbsp;doing&nbsp;some&nbsp;breaking&nbsp;changes</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_905">905</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sampling_ixs&nbsp;=&nbsp;np.stack((np.random.choice(neigh_ixs.shape[1],</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_906">906</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size=(int(sampled_fraction&nbsp;*&nbsp;(n_neighbors)),),</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_907">907</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;replace=False,</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_908">908</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p=p)&nbsp;for&nbsp;i&nbsp;in&nbsp;range(neigh_ixs.shape[0])),&nbsp;0)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_909">909</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.embedding_UMAP&nbsp;=&nbsp;sampling_ixs</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_910">910</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neigh_ixs&nbsp;=&nbsp;neigh_ixs[np.arange(neigh_ixs.shape[0])[:,&nbsp;None],&nbsp;sampling_ixs]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_911">911</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nonzero&nbsp;=&nbsp;neigh_ixs.shape[0]&nbsp;*&nbsp;neigh_ixs.shape[1]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_912">912</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.embedding_UMAP_knn&nbsp;=&nbsp;sparse.csr_matrix((np.ones(nonzero),</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_913">913</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neigh_ixs.ravel(),</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_914">914</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.arange(0,&nbsp;nonzero&nbsp;+&nbsp;1,&nbsp;neigh_ixs.shape[1])),</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_915">915</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shape=(neigh_ixs.shape[0],</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_916">916</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neigh_ixs.shape[0]))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_917">917</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;'{self.corr_calc}'")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_918">918</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;transform&nbsp;==&nbsp;"log":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_919">919</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim&nbsp;=&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_920">920</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP&nbsp;=&nbsp;colDeltaCorLog10partial(hi_dim,&nbsp;np.log10(np.abs(delta_hi_dim)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim),&nbsp;neigh_ixs,&nbsp;threads=threads,&nbsp;psc=psc)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_921">921</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_922">922</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_923">923</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim_rndm&nbsp;=&nbsp;hi_dim_t_rndm&nbsp;-&nbsp;hi_dim</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_924">924</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP_random&nbsp;=&nbsp;colDeltaCorLog10partial(hi_dim,&nbsp;np.log10(np.abs(delta_hi_dim_rndm)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim_rndm),&nbsp;neigh_ixs,&nbsp;threads=threads,&nbsp;psc=psc)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_925">925</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;transform&nbsp;==&nbsp;"logratio":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_926">926</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log2hidim&nbsp;=&nbsp;np.log2(hi_dim&nbsp;+&nbsp;psc)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_927">927</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim&nbsp;=&nbsp;np.log2(np.abs(hi_dim_t)&nbsp;+&nbsp;psc)&nbsp;-&nbsp;log2hidim</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_928">928</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP&nbsp;=&nbsp;colDeltaCorpartial(log2hidim,&nbsp;delta_hi_dim,&nbsp;neigh_ixs,&nbsp;threads=threads)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_929">929</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_930">930</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_931">931</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim_rndm&nbsp;=&nbsp;np.log2(np.abs(hi_dim_t_rndm)&nbsp;+&nbsp;psc)&nbsp;-&nbsp;log2hidim</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_932">932</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP_random&nbsp;=&nbsp;colDeltaCorpartial(log2hidim,&nbsp;delta_hi_dim_rndm,&nbsp;neigh_ixs,&nbsp;threads=threads)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_933">933</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;transform&nbsp;==&nbsp;"linear":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_934">934</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP&nbsp;=&nbsp;colDeltaCorpartial(hi_dim,&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim,&nbsp;neigh_ixs,&nbsp;threads=threads)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_935">935</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_936">936</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_937">937</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP_random&nbsp;=&nbsp;colDeltaCorpartial(hi_dim,&nbsp;hi_dim_t_rndm&nbsp;-&nbsp;hi_dim,&nbsp;neigh_ixs,&nbsp;threads=threads)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_938">938</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;transform&nbsp;==&nbsp;"sqrt":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_939">939</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim&nbsp;=&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_940">940</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP&nbsp;=&nbsp;colDeltaCorSqrtpartial(hi_dim,&nbsp;np.sqrt(np.abs(delta_hi_dim)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim),&nbsp;neigh_ixs,&nbsp;threads=threads,&nbsp;psc=psc)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_941">941</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_942">942</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_943">943</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim_rndm&nbsp;=&nbsp;hi_dim_t_rndm&nbsp;-&nbsp;hi_dim</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_944">944</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP_random&nbsp;=&nbsp;colDeltaCorSqrtpartial(hi_dim,&nbsp;np.sqrt(np.abs(delta_hi_dim_rndm)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim_rndm),&nbsp;neigh_ixs,&nbsp;threads=threads,&nbsp;psc=psc)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_945">945</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_946">946</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;NotImplementedError(f"transform={transform}&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;parameter")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_947">947</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.fill_diagonal(self.embedding_UMAP,&nbsp;0)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_948">948</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;np.any(np.isnan(self.embedding_UMAP)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_949">949</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.embedding_UMAP[np.isnan(self.embedding_UMAP)]&nbsp;=&nbsp;1</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_950">950</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warning("Nans&nbsp;encountered&nbsp;in&nbsp;corrcoef&nbsp;and&nbsp;corrected&nbsp;to&nbsp;1s.&nbsp;If&nbsp;not&nbsp;identical&nbsp;cells&nbsp;were&nbsp;present&nbsp;it&nbsp;is&nbsp;probably&nbsp;a&nbsp;small&nbsp;isolated&nbsp;cluster&nbsp;converging&nbsp;after&nbsp;imputation.")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_951">951</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_952">952</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.fill_diagonal(self.corrcoef_UMAP_random,&nbsp;0)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_953">953</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;np.any(np.isnan(self.corrcoef_UMAP_random)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_954">954</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP_random[np.isnan(self.corrcoef_UMAP_random)]&nbsp;=&nbsp;1</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_955">955</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warning("Nans&nbsp;encountered&nbsp;in&nbsp;corrcoef_random&nbsp;and&nbsp;corrected&nbsp;to&nbsp;1s.&nbsp;If&nbsp;not&nbsp;identical&nbsp;cells&nbsp;were&nbsp;present&nbsp;it&nbsp;is&nbsp;probably&nbsp;a&nbsp;small&nbsp;isolated&nbsp;cluster&nbsp;converging&nbsp;after&nbsp;imputation.")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_956">956</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Done&nbsp;Correlation&nbsp;Calculation")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_957">957</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_958">958</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corr_calc&nbsp;=&nbsp;"full"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_959">959</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;"pcs"&nbsp;in&nbsp;hidim:&nbsp;&nbsp;#&nbsp;sic</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_960">960</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim&nbsp;=&nbsp;np.array(getattr(self,&nbsp;hidim).T[:,&nbsp;:ndims],&nbsp;order="C")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_961">961</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim_t&nbsp;=&nbsp;np.array(getattr(self,&nbsp;hidim&nbsp;+&nbsp;"_t").T[:,&nbsp;:ndims],&nbsp;order="C")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_962">962</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:&nbsp;#this&nbsp;route:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_963">963</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ndims&nbsp;is&nbsp;not&nbsp;None:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_964">964</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;ValueError(f"ndims&nbsp;was&nbsp;set&nbsp;to&nbsp;{ndims}&nbsp;but&nbsp;hidim&nbsp;!=&nbsp;'pcs'.&nbsp;Set&nbsp;ndims&nbsp;=&nbsp;None&nbsp;for&nbsp;hidim='{hidim}'")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_965">965</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim&nbsp;=&nbsp;getattr(self,&nbsp;hidim)&nbsp;&nbsp;#&nbsp;[:,&nbsp;:ndims]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_966">966</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim_t&nbsp;=&nbsp;hi_dim&nbsp;+&nbsp;self.used_delta_t&nbsp;*&nbsp;self.delta_S&nbsp;&nbsp;#&nbsp;[:,&nbsp;:ndims]&nbsp;[:,&nbsp;:ndims]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_967">967</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_968">968</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_S_rndm&nbsp;=&nbsp;np.copy(self.delta_S)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_969">969</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permute_rows_nsign(self.delta_S_rndm)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_970">970</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim_t_rndm&nbsp;=&nbsp;hi_dim&nbsp;+&nbsp;self.used_delta_t&nbsp;*&nbsp;self.delta_S_rndm</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_971">971</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;embedding&nbsp;=&nbsp;getattr(self,&nbsp;embed)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_972">972</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.embedding_UMAP&nbsp;=&nbsp;embedding</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_973">973</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug("Calculate&nbsp;KNN&nbsp;in&nbsp;the&nbsp;embedding&nbsp;space")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_974">974</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nn&nbsp;=&nbsp;NearestNeighbors(n_neighbors=n_neighbors,&nbsp;n_jobs=n_jobs)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_975">975</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nn.fit(embedding)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_976">976</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.embedding_UMAP_knn&nbsp;=&nbsp;nn.kneighbors_graph(mode="connectivity")&nbsp;#def&nbsp;of&nbsp;embedding_knn</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_977">977</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#print(transform)&nbsp;#sqrt</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_978">978</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug("Correlation&nbsp;Calculation&nbsp;'full'")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_979">979</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;transform&nbsp;==&nbsp;"log":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_980">980</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim&nbsp;=&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_981">981</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP&nbsp;=&nbsp;colDeltaCorLog10(hi_dim,&nbsp;np.log10(np.abs(delta_hi_dim)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim),&nbsp;threads=threads,&nbsp;psc=psc)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_982">982</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_983">983</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_984">984</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim_rndm&nbsp;=&nbsp;hi_dim_t_rndm&nbsp;-&nbsp;hi_dim</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_985">985</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP_random&nbsp;=&nbsp;colDeltaCorLog10(hi_dim,&nbsp;np.log10(np.abs(delta_hi_dim_rndm)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim_rndm),&nbsp;threads=threads,&nbsp;psc=psc)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_986">986</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;transform&nbsp;==&nbsp;"logratio":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_987">987</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log2hidim&nbsp;=&nbsp;np.log2(hi_dim&nbsp;+&nbsp;psc)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_988">988</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim&nbsp;=&nbsp;np.log2(np.abs(hi_dim_t)&nbsp;+&nbsp;psc)&nbsp;-&nbsp;log2hidim</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_989">989</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP&nbsp;=&nbsp;colDeltaCor(log2hidim,&nbsp;delta_hi_dim,&nbsp;threads=threads)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_990">990</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_991">991</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_992">992</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim_rndm&nbsp;=&nbsp;np.log2(np.abs(hi_dim_t_rndm)&nbsp;+&nbsp;1)&nbsp;-&nbsp;log2hidim</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_993">993</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP_random&nbsp;=&nbsp;colDeltaCor(log2hidim,&nbsp;delta_hi_dim_rndm,&nbsp;threads=threads)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_994">994</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;transform&nbsp;==&nbsp;"linear":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_995">995</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP&nbsp;=&nbsp;colDeltaCor(hi_dim,&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim,&nbsp;threads=threads)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_996">996</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_997">997</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_998">998</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP_random&nbsp;=&nbsp;colDeltaCor(hi_dim,&nbsp;hi_dim_t_rndm&nbsp;-&nbsp;hi_dim,&nbsp;threads=threads)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_999">999</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;transform&nbsp;==&nbsp;"sqrt":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1000">1000</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim&nbsp;=&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1001">1001</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP&nbsp;=&nbsp;colDeltaCorSqrt(hi_dim,&nbsp;np.sqrt(np.abs(delta_hi_dim)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim),&nbsp;threads=threads,&nbsp;psc=psc)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1002">1002</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1003">1003</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1004">1004</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim_rndm&nbsp;=&nbsp;hi_dim_t_rndm&nbsp;-&nbsp;hi_dim</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1005">1005</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP_random&nbsp;=&nbsp;colDeltaCorSqrt(hi_dim,&nbsp;np.sqrt(np.abs(delta_hi_dim_rndm)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim_rndm),&nbsp;threads=threads,&nbsp;psc=psc)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1006">1006</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1007">1007</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;NotImplementedError(f"transform={transform}&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;parameter")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1008">1008</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.fill_diagonal(self.corrcoef_UMAP,&nbsp;0)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1009">1009</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1010">1010</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.fill_diagonal(self.corrcoef_UMAP_random,&nbsp;0)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1011">1011</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colnames_cells&nbsp;=&nbsp;list(self.ca["Patients"])&nbsp;#shape&nbsp;of&nbsp;all:&nbsp;(rows=genes,&nbsp;cols=samples)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1012">1012</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rownames_genes&nbsp;=&nbsp;list(self.ra["Genes"])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1013">1013</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp&nbsp;=&nbsp;np.array(hi_dim)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1014">1014</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp_df&nbsp;=&nbsp;pd.DataFrame(tp,&nbsp;columns=colnames_cells,&nbsp;index=rownames_genes)&nbsp;&nbsp;#emat=&nbsp;hi_dim&nbsp;#expression</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1015">1015</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"emat_UMAP.csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1016">1016</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#tp_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1017">1017</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqrtdmat&nbsp;=&nbsp;np.sqrt(np.abs(delta_hi_dim)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1018">1018</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp&nbsp;=&nbsp;np.array(sqrtdmat)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1019">1019</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"sqrt_dmat_UMAP.csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1020">1020</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp_df&nbsp;=&nbsp;pd.DataFrame(tp,&nbsp;columns=colnames_cells,&nbsp;index=rownames_genes)&nbsp;&nbsp;#dmat&nbsp;=&nbsp;np.sqrt(np.abs(delta_hi_dim)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim)&nbsp;#dmat&nbsp;are&nbsp;the&nbsp;velocities</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1021">1021</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#tp_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)&nbsp;&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1022">1022</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alt_dmat&nbsp;=&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1023">1023</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp&nbsp;=&nbsp;np.array(alt_dmat)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1024">1024</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp_df&nbsp;=&nbsp;pd.DataFrame(tp,&nbsp;columns=colnames_cells,&nbsp;index=rownames_genes)&nbsp;&nbsp;#&nbsp;alt&nbsp;dmat:&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim&nbsp;(for&nbsp;linear)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1025">1025</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"linear_dmat_UMAP.csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1026">1026</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#tp_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)&nbsp;&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1027">1027</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp&nbsp;=&nbsp;np.array(self.corrcoef_UMAP)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1028">1028</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp_df&nbsp;=&nbsp;pd.DataFrame(tp,&nbsp;columns=colnames_cells,&nbsp;index=colnames_cells)&nbsp;&nbsp;#&nbsp;raw&nbsp;cc&nbsp;values&nbsp;withot&nbsp;any&nbsp;alt</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1029">1029</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"CorrelationCoefficients_Raw_UMAP.csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1030">1030</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#tp_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1031">1031</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1032">1032</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;calculate_embedding_shiftUMAP(self,&nbsp;sigma_corr:&nbsp;float=0.05,&nbsp;expression_scaling:&nbsp;bool=False,&nbsp;Myneighbours:&nbsp;float=None,&nbsp;scaling_penalty:&nbsp;float=1.,&nbsp;metadataToUse:&nbsp;str="metadata.csv",&nbsp;pathToTransitionProbabilityCode:&nbsp;str="/",&nbsp;grouptype:&nbsp;str="Strings",&nbsp;secondgroup:&nbsp;str="metadataVersion.csv",&nbsp;manyfeatures:&nbsp;str="True",&nbsp;grouptype2:&nbsp;str="Strings",&nbsp;Randomsampling:&nbsp;str="False",&nbsp;extraNNvalue:&nbsp;int=5,&nbsp;DE_location:&nbsp;str="/location/",&nbsp;selfCC_folder:&nbsp;str="/location/",&nbsp;VecX_location:&nbsp;str="/location/",&nbsp;VecY_loc:&nbsp;str="/location/",&nbsp;TP_folder:&nbsp;str="/location/",&nbsp;UMAP_2D_GroupLevelTP:&nbsp;str="/location/")&nbsp;-&gt;&nbsp;None:&nbsp;#Use&nbsp;the&nbsp;transition&nbsp;probability&nbsp;to&nbsp;project&nbsp;the&nbsp;velocity&nbsp;direction&nbsp;on&nbsp;the&nbsp;embedding</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1033">1033</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Kernel&nbsp;evaluation</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1034">1034</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug("Calculate&nbsp;transition&nbsp;probability")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1035">1035</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.corr_calc&nbsp;==&nbsp;"full"&nbsp;or&nbsp;self.corr_calc&nbsp;==&nbsp;"knn_random":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1036">1036</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;NOTE&nbsp;maybe&nbsp;sparse&nbsp;matrix&nbsp;here&nbsp;are&nbsp;slower&nbsp;than&nbsp;dense</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1037">1037</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;NOTE&nbsp;if&nbsp;knn_random&nbsp;this&nbsp;could&nbsp;be&nbsp;made&nbsp;much&nbsp;faster&nbsp;either&nbsp;using&nbsp;sparse&nbsp;matrix&nbsp;or&nbsp;neigh_ixs</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1038">1038</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transition_prob_UMAP&nbsp;=&nbsp;np.exp(self.corrcoef_UMAP&nbsp;/&nbsp;sigma_corr)&nbsp;*&nbsp;self.embedding_UMAP_knn.A&nbsp;&nbsp;#&nbsp;naive,&nbsp;the&nbsp;exponential&nbsp;of&nbsp;the&nbsp;correlation&nbsp;coefficient/kernal&nbsp;scaling</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1039">1039</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transition_prob_UMAP&nbsp;/=&nbsp;self.transition_prob_UMAP.sum(1)[:,&nbsp;None]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1040">1040</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;hasattr(self,&nbsp;"corrcoef_random"):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1041">1041</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug("Calculate&nbsp;transition&nbsp;probability&nbsp;for&nbsp;negative&nbsp;control")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1042">1042</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transition_prob_UMAP_random_UMAP&nbsp;=&nbsp;np.exp(self.self.corrcoef_random_UMAP&nbsp;/&nbsp;sigma_corr)&nbsp;*&nbsp;self.embedding_UMAP_knn.A&nbsp;&nbsp;#&nbsp;naive</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1043">1043</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transition_prob_UMAP_random_UMAP&nbsp;/=&nbsp;self.transition_prob_UMAP_random_UMAP.sum(1)[:,&nbsp;None]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1044">1044</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unitary_vectors&nbsp;=&nbsp;self.embedding_UMAP.T[:,&nbsp;None,&nbsp;:]&nbsp;-&nbsp;self.embedding_UMAP.T[:,&nbsp;:,&nbsp;None]&nbsp;&nbsp;#&nbsp;shape&nbsp;(2,ncells,ncells)&nbsp;#for&nbsp;each&nbsp;cells&nbsp;coordinates&nbsp;-&nbsp;row1:&nbsp;cell1-cell1,&nbsp;cell1-cell2,&nbsp;cell1-cell3&nbsp;cell1-cell4,&nbsp;cell1-cell1,&nbsp;cell2-cell1,&nbsp;cell3-cell1&nbsp;etc.</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1045">1045</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;np.errstate(divide='ignore',&nbsp;invalid='ignore'):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1046">1046</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unitary_vectors&nbsp;/=&nbsp;np.linalg.norm(unitary_vectors,&nbsp;ord=2,&nbsp;axis=0)&nbsp;&nbsp;#&nbsp;divide&nbsp;by&nbsp;L2</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1047">1047</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.fill_diagonal(unitary_vectors[0,&nbsp;...],&nbsp;0)&nbsp;&nbsp;#&nbsp;fix&nbsp;nans&nbsp;replace&nbsp;NAN&nbsp;with&nbsp;0</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1048">1048</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.fill_diagonal(unitary_vectors[1,&nbsp;...],&nbsp;0)&nbsp;#embedding&nbsp;comes&nbsp;from&nbsp;the&nbsp;tSNE</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1049">1049</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.MY_ARROWS_umap&nbsp;=&nbsp;(self.transition_prob_UMAP&nbsp;*&nbsp;unitary_vectors).sum(2)&nbsp;#.A&nbsp;means&nbsp;change&nbsp;the&nbsp;data&nbsp;type&nbsp;from&nbsp;a&nbsp;matrix&nbsp;to&nbsp;an&nbsp;array&nbsp;#unit&nbsp;vector*transition&nbsp;probability,&nbsp;below:&nbsp;transition&nbsp;probab&nbsp;(no.&nbsp;samples&nbsp;x&nbsp;no.samples)&nbsp;is&nbsp;multiplied&nbsp;by&nbsp;each&nbsp;of&nbsp;the&nbsp;three&nbsp;(no.samplesxno.samples)&nbsp;matrices&nbsp;in&nbsp;the&nbsp;unitary&nbsp;vector&nbsp;individually.&nbsp;The&nbsp;result&nbsp;is&nbsp;then&nbsp;summed&nbsp;for&nbsp;each&nbsp;xm&nbsp;y&nbsp;and&nbsp;z&nbsp;across&nbsp;all&nbsp;number&nbsp;of&nbsp;samples&nbsp;rows&nbsp;for&nbsp;each&nbsp;number&nbsp;of&nbsp;sample&nbsp;columns</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1050">1050</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.MY_ARROWS_umap&nbsp;-=&nbsp;(self.embedding_UMAP_knn.A&nbsp;*&nbsp;unitary_vectors).sum(2)&nbsp;/&nbsp;self.embedding_UMAP_knn.sum(1).A.T</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1051">1051</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.MY_ARROWS_umap&nbsp;=&nbsp;self.MY_ARROWS_umap.T&nbsp;#transposes&nbsp;the&nbsp;vector</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1052">1052</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;expression_scaling:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1053">1053</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim&nbsp;=&nbsp;getattr(self,&nbsp;self.which_hidim)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1054">1054</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;estim_delta&nbsp;=&nbsp;hi_dim.dot(self.transition_prob_UMAP.T)&nbsp;-&nbsp;hi_dim.dot((self.embedding_UMAP_knn.A&nbsp;/&nbsp;self.embedding_UMAP_knn.sum(1).A).T)&nbsp;#this&nbsp;is&nbsp;the&nbsp;same&nbsp;problem&nbsp;as&nbsp;above</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1055">1055</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos_proj&nbsp;=&nbsp;(self.delta_S&nbsp;*&nbsp;estim_delta).sum(0)&nbsp;/&nbsp;np.sqrt((estim_delta**2).sum(0))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1056">1056</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.scaling_UMAP&nbsp;=&nbsp;np.clip(cos_proj&nbsp;/&nbsp;scaling_penalty,&nbsp;0,&nbsp;1)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1057">1057</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.MY_ARROWS_umap&nbsp;=&nbsp;self.MY_ARROWS_umap&nbsp;*&nbsp;self.scaling_UMAP[:,&nbsp;None]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1058">1058</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;hasattr(self,&nbsp;"corrcoef_random"):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1059">1059</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.MY_ARROWS_umap_random&nbsp;=&nbsp;(self.transition_prob_UMAP_random_UMAP&nbsp;*&nbsp;unitary_vectors).sum(2)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1060">1060</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.MY_ARROWS_umap_random&nbsp;-=&nbsp;(self.embedding_UMAP_knn.A&nbsp;*&nbsp;unitary_vectors).sum(2)&nbsp;/&nbsp;self.embedding_UMAP_knn.sum(1).A.T</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1061">1061</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.MY_ARROWS_umap_random&nbsp;=&nbsp;self.MY_ARROWS_umap_random.T</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1062">1062</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;expression_scaling:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1063">1063</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;estim_delta_rndm&nbsp;=&nbsp;hi_dim.dot(self.transition_prob_UMAP_random_UMAP.T)&nbsp;-&nbsp;hi_dim.dot((self.embedding_UMAP_knn.A&nbsp;/&nbsp;self.embedding_UMAP_knn.sum(1).A).T)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1064">1064</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos_proj_rndm&nbsp;=&nbsp;(self.delta_S_rndm&nbsp;*&nbsp;estim_delta_rndm).sum(0)&nbsp;/&nbsp;np.sqrt((estim_delta_rndm**2).sum(0))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1065">1065</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.scaling_UMAP_rndm&nbsp;=&nbsp;np.clip(cos_proj_rndm&nbsp;/&nbsp;scaling_penalty,&nbsp;0,&nbsp;1)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1066">1066</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.MY_ARROWS_umap_random&nbsp;=&nbsp;self.MY_ARROWS_umap_random&nbsp;*&nbsp;self.scaling_UMAP_rndm[:,&nbsp;None]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1067">1067</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1068">1068</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;NOTE&nbsp;should&nbsp;implement&nbsp;a&nbsp;version&nbsp;with&nbsp;cython</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1069">1069</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;NotImplementedError(f"Weird&nbsp;value&nbsp;self.corr_calc={self.corr_calc}")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1070">1070</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1071">1071</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colnames_cells&nbsp;=&nbsp;list(self.ca["Patients"])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1072">1072</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genes_embedding&nbsp;=&nbsp;np.array(self.MY_ARROWS_umap)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1073">1073</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spliced_df&nbsp;=&nbsp;pd.DataFrame(genes_embedding,&nbsp;columns=["x",&nbsp;"y"],&nbsp;index=colnames_cells)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1074">1074</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"Delta_embedding_NN"&nbsp;+&nbsp;str(Myneighbours)&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(extraNNvalue)&nbsp;+&nbsp;"_UMAP.csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1075">1075</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(DE_location)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1076">1076</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#spliced_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1077">1077</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genes_embedding&nbsp;=&nbsp;np.array(self.corrcoef_UMAP)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1078">1078</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spliced_df&nbsp;=&nbsp;pd.DataFrame(genes_embedding,&nbsp;columns=colnames_cells,&nbsp;index=colnames_cells)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1079">1079</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"selfCC_NN"&nbsp;+&nbsp;str(Myneighbours)&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(extraNNvalue)&nbsp;+&nbsp;"_UMAP.csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1080">1080</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(selfCC_folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1081">1081</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spliced_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1082">1082</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genes_embedding&nbsp;=&nbsp;np.array(unitary_vectors[0])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1083">1083</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spliced_df&nbsp;=&nbsp;pd.DataFrame(genes_embedding,&nbsp;columns=colnames_cells,&nbsp;index=colnames_cells)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1084">1084</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"UnVecX_NN"&nbsp;+&nbsp;str(Myneighbours)&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(extraNNvalue)&nbsp;+&nbsp;"_UMAP.csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1085">1085</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(VecX_location)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1086">1086</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#spliced_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1087">1087</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genes_embedding&nbsp;=&nbsp;np.array(unitary_vectors[1])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1088">1088</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spliced_df&nbsp;=&nbsp;pd.DataFrame(genes_embedding,&nbsp;columns=colnames_cells,&nbsp;index=colnames_cells)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1089">1089</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"UnVecY_NN"&nbsp;+&nbsp;str(Myneighbours)&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(extraNNvalue)&nbsp;+&nbsp;"_UMAP.csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1090">1090</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(VecY_loc)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1091">1091</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spliced_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1092">1092</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#print(self.embedding_knn)&nbsp;just&nbsp;a&nbsp;bunch&nbsp;of&nbsp;1.0s</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1093">1093</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp&nbsp;=&nbsp;np.array(self.transition_prob_UMAP)&nbsp;#number&nbsp;of&nbsp;samples&nbsp;x&nbsp;number&nbsp;of&nbsp;samples</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1094">1094</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp_df&nbsp;=&nbsp;pd.DataFrame(tp,&nbsp;columns=colnames_cells,&nbsp;index=colnames_cells)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1095">1095</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"Transition_Probability_NN"&nbsp;+&nbsp;str(Myneighbours)&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(extraNNvalue)&nbsp;+&nbsp;"_UMAP.csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1096">1096</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(TP_folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1097">1097</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1098">1098</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#####RUN&nbsp;TP&nbsp;code&nbsp;here################################</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1099">1099</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#note:&nbsp;the&nbsp;following&nbsp;requires&nbsp;these&nbsp;R&nbsp;packages&nbsp;to&nbsp;be&nbsp;installed:&nbsp;&nbsp;'gtools',&nbsp;'reshape2',&nbsp;ggplot2',&nbsp;grid'&nbsp;and&nbsp;'tidyverse'</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1100">1100</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#to&nbsp;code&nbsp;to&nbsp;install&nbsp;them&nbsp;has&nbsp;been&nbsp;commented&nbsp;out&nbsp;but&nbsp;is&nbsp;below:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1101">1101</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;import&nbsp;rpy2.robjects&nbsp;as&nbsp;ro</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1102">1102</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;rpy2.robjects.packages&nbsp;import&nbsp;importr</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1103">1103</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;utils&nbsp;=&nbsp;importr('utils')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1104">1104</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('gtools')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1105">1105</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('reshape2')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1106">1106</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('ggplot2')&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1107">1107</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('grid')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1108">1108</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('tidyverse')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1109">1109</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gtools&nbsp;=&nbsp;importr("gtools")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1110">1110</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reshape2&nbsp;=&nbsp;importr("reshape2")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1111">1111</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ggplot2&nbsp;=&nbsp;importr("ggplot2")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1112">1112</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grid&nbsp;=&nbsp;importr("grid")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1113">1113</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tidyverse&nbsp;=&nbsp;importr("tidyverse")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1114">1114</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path=pathToTransitionProbabilityCode</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1115">1115</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;version&nbsp;=&nbsp;"SampleGroup1"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1116">1116</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;RunTransitionProbabilityCode(filename,&nbsp;selfremoved,&nbsp;location,&nbsp;metaGroup,&nbsp;outputdir,&nbsp;grouptype,&nbsp;version,&nbsp;Randomsampling):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1117">1117</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r=ro.r</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1118">1118</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r.source(path+"TransitionProbability.R")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1119">1119</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p=r.TransitionProbability(filename,&nbsp;selfremoved,&nbsp;location,&nbsp;metaGroup,&nbsp;outputdir,&nbsp;grouptype,&nbsp;version,&nbsp;Randomsampling)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1120">1120</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;p</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1121">1121</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#a=RunTransitionProbabilityCode(file_name,&nbsp;"TRUE",&nbsp;TP_folder,&nbsp;metadataToUse,&nbsp;UMAP_2D_GroupLevelTP,&nbsp;grouptype,&nbsp;version,&nbsp;Randomsampling)&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1122">1122</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b=RunTransitionProbabilityCode(file_name,&nbsp;"FALSE",&nbsp;TP_folder,&nbsp;metadataToUse,&nbsp;UMAP_2D_GroupLevelTP,&nbsp;grouptype,&nbsp;version,&nbsp;Randomsampling)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1123">1123</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#if&nbsp;second&nbsp;metadata&nbsp;feature&nbsp;type&nbsp;==&nbsp;True</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1124">1124</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;manyfeatures&nbsp;==&nbsp;"True":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1125">1125</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;version&nbsp;=&nbsp;"SampleGroup2"&nbsp;#secondgroup</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1126">1126</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c=RunTransitionProbabilityCode(file_name,&nbsp;"TRUE",&nbsp;TP_folder,&nbsp;secondgroup,&nbsp;UMAP_2D_GroupLevelTP,&nbsp;grouptype2,&nbsp;version,&nbsp;Randomsampling)&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1127">1127</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d=RunTransitionProbabilityCode(file_name,&nbsp;"FALSE",&nbsp;TP_folder,&nbsp;secondgroup,&nbsp;UMAP_2D_GroupLevelTP,&nbsp;grouptype2,&nbsp;version,&nbsp;Randomsampling)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1128">1128</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1129">1129</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;UMAPwithArrows2D(self,&nbsp;UMAPembedding:&nbsp;str="UMAPembed",&nbsp;UMAP_Arrows:&nbsp;str="MY_ARROWS_umap",&nbsp;numberNeighb:&nbsp;float=2.,&nbsp;typegroup:&nbsp;str="integers",&nbsp;extraNNvalue:&nbsp;int=5):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1130">1130</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#trans&nbsp;=&nbsp;umap.UMAP(n_neighbors&nbsp;=&nbsp;num_nei,&nbsp;n_components=3).fit(self.S_norm.T)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1131">1131</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UMAP_samplesembedding&nbsp;=&nbsp;getattr(self,&nbsp;UMAPembedding)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1132">1132</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.UMAPsampleembedding&nbsp;=&nbsp;UMAP_samplesembedding</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1133">1133</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;umap_arrows_embedding_stuff&nbsp;=&nbsp;getattr(self,&nbsp;UMAP_Arrows)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1134">1134</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.arrowUMAPembed&nbsp;=&nbsp;umap_arrows_embedding_stuff</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1135">1135</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_markers&nbsp;=&nbsp;self.ca["Markers"]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1136">1136</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mark&nbsp;=&nbsp;sorted(set(my_markers))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1137">1137</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;corresp&nbsp;=&nbsp;["o",&nbsp;"P",&nbsp;"D",&nbsp;"X",&nbsp;"*",&nbsp;"+",&nbsp;"&gt;",&nbsp;"&lt;"]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1138">1138</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;0</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1139">1139</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_types&nbsp;=&nbsp;{}</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1140">1140</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;the_type&nbsp;in&nbsp;mark:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1141">1141</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_types[the_type]&nbsp;=&nbsp;corresp[count]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1142">1142</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;count&nbsp;+&nbsp;1</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1143">1143</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;markers&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1144">1144</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;mar&nbsp;in&nbsp;my_markers:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1145">1145</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;markers.append(my_types.get(mar))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1146">1146</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;randn(10)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1147">1147</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fig&nbsp;=&nbsp;plt.figure(figsize=(15,&nbsp;10))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1148">1148</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quiver_scale&nbsp;=&nbsp;60</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1149">1149</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(0,&nbsp;len(markers)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1150">1150</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.scatter(self.UMAPsampleembedding[i,&nbsp;0],&nbsp;self.UMAPsampleembedding[i,&nbsp;1],&nbsp;marker=markers[i],&nbsp;c=self.colorandum[i],&nbsp;alpha=1,&nbsp;s=120,&nbsp;edgecolor=(0,0,0,1),&nbsp;lw=0.3,&nbsp;rasterized=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1151">1151</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quiver_kwargs=dict(headaxislength=7,&nbsp;headlength=13,&nbsp;headwidth=10,linewidths=0.5,&nbsp;width=0.005,edgecolors="k",&nbsp;color="black",&nbsp;alpha=1,&nbsp;angles='xy')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1152">1152</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.quiver(self.UMAPsampleembedding[i,&nbsp;0],&nbsp;self.UMAPsampleembedding[i,&nbsp;1],&nbsp;self.arrowUMAPembed[i,&nbsp;0],&nbsp;self.arrowUMAPembed[i,&nbsp;1],&nbsp;scale=quiver_scale,&nbsp;**quiver_kwargs)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1153">1153</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexy_codes&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1154">1154</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_keys&nbsp;=&nbsp;[k&nbsp;&nbsp;for&nbsp;&nbsp;k&nbsp;in&nbsp;&nbsp;self.cluster_colors_dict.keys()]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1155">1155</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_my_keys&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1156">1156</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;my_keys:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1157">1157</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_my_keys.append(str(item,'utf-8'))&nbsp;#int()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1158">1158</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmap2&nbsp;=&nbsp;cm.get_cmap('Paired')&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;PiYG</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1159">1159</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(cmap2.N):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1160">1160</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rgb&nbsp;=&nbsp;cmap2(i)[:3]&nbsp;#&nbsp;will&nbsp;return&nbsp;rgba,&nbsp;we&nbsp;take&nbsp;only&nbsp;first&nbsp;3&nbsp;so&nbsp;we&nbsp;get&nbsp;rgb</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1161">1161</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexy_codes.append(matplotlib.colors.rgb2hex(rgb))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1162">1162</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;legend_elements&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1163">1163</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined&nbsp;=&nbsp;list(zip(decoded_my_keys,&nbsp;hexy_codes))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1164">1164</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined&nbsp;=&nbsp;sorted(combined,&nbsp;key=itemgetter(0))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1165">1165</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(typegroup&nbsp;!=&nbsp;"Strings"):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1166">1166</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;timepoints&nbsp;=&nbsp;[int(i[0])&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1167">1167</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colys&nbsp;=&nbsp;[i[1]&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1168">1168</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tempDF&nbsp;=&nbsp;pd.DataFrame({'Group':timepoints,&nbsp;'colours':colys})</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1169">1169</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tempDF&nbsp;=&nbsp;tempDF.sort_values('Group')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1170">1170</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;groupys2&nbsp;=&nbsp;tempDF['Group'].tolist()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1171">1171</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cols2&nbsp;=&nbsp;tempDF['colours'].tolist()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1172">1172</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined&nbsp;=&nbsp;list(zip(groupys2,&nbsp;cols2))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1173">1173</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_my_keys&nbsp;=&nbsp;[i[0]&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1174">1174</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexy_codes&nbsp;=&nbsp;[i[1]&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1175">1175</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;sample_type&nbsp;in&nbsp;range(0,&nbsp;len(decoded_my_keys)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1176">1176</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to_add&nbsp;=&nbsp;Line2D([0],&nbsp;[0],&nbsp;marker='s',&nbsp;color='w',&nbsp;label=str(decoded_my_keys[sample_type]).strip('"'),&nbsp;markerfacecolor=str(hexy_codes[sample_type]),&nbsp;markersize=7)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1177">1177</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;legend_elements.append(to_add)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1178">1178</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;sample_type&nbsp;in&nbsp;range(0,&nbsp;len(mark)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1179">1179</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to_add&nbsp;=&nbsp;Line2D([0],&nbsp;[0],&nbsp;marker=[*my_types.values()][sample_type],&nbsp;color='w',&nbsp;label=str([*my_types.keys()][sample_type]).strip('"'),&nbsp;markerfacecolor='black',&nbsp;markersize=7)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1180">1180</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;legend_elements.append(to_add)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1181">1181</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.legend(handles=legend_elements,&nbsp;fancybox=True,&nbsp;framealpha=1,&nbsp;borderpad=1,&nbsp;loc=(1.01,0.5),&nbsp;title='Key')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1182">1182</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.xlabel('UMAP1')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1183">1183</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.ylabel('UMAP2')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1184">1184</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;figure_name&nbsp;=&nbsp;'UMAP2D_Arrow_NN'&nbsp;+&nbsp;str(numberNeighb)&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(extraNNvalue)&nbsp;+&nbsp;'.png'</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1185">1185</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(figure_name)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1186">1186</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#plt.title('UMAP&nbsp;projection',&nbsp;fontsize=10);</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1187">1187</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#plt.show()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1188">1188</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1189">1189</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1190">1190</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;calculate_embedding_shiftUMAP3D(self,&nbsp;sigma_corr:&nbsp;float=0.05,&nbsp;expression_scaling:&nbsp;bool=False,&nbsp;Myneighbours:&nbsp;float=None,&nbsp;scaling_penalty:&nbsp;float=1.,&nbsp;metadataToUse:&nbsp;str="metadata.csv",&nbsp;pathToTransitionProbabilityCode:&nbsp;str="/",&nbsp;grouptype:&nbsp;str="Strings",&nbsp;secondgroup:&nbsp;str="metadataVersion.csv",&nbsp;manyfeatures:&nbsp;str="True",&nbsp;grouptype2:&nbsp;str="Strings",&nbsp;Randomsampling:&nbsp;str="False",&nbsp;extraNNvalue:&nbsp;int=5,&nbsp;DE_location:&nbsp;str="/location/",&nbsp;selfCC_folder:&nbsp;str="/location/",&nbsp;VecX_location:&nbsp;str="/location/",&nbsp;VecY_loc:&nbsp;str="/location/",&nbsp;VecZ_loc:&nbsp;str="/location/",&nbsp;TP_folder:&nbsp;str="/location/",&nbsp;UMAP_3D_GroupLevelTP:&nbsp;str="/location/")&nbsp;-&gt;&nbsp;None:&nbsp;#Use&nbsp;the&nbsp;transition&nbsp;probability&nbsp;to&nbsp;project&nbsp;the&nbsp;velocity&nbsp;direction&nbsp;on&nbsp;the&nbsp;embedding</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1191">1191</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Kernel&nbsp;evaluation</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1192">1192</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug("Calculate&nbsp;transition&nbsp;probability")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1193">1193</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.corr_calc&nbsp;==&nbsp;"full"&nbsp;or&nbsp;self.corr_calc&nbsp;==&nbsp;"knn_random":&nbsp;#thit&nbsp;way:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1194">1194</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;NOTE&nbsp;maybe&nbsp;sparse&nbsp;matrix&nbsp;here&nbsp;are&nbsp;slower&nbsp;than&nbsp;dense</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1195">1195</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;NOTE&nbsp;if&nbsp;knn_random&nbsp;this&nbsp;could&nbsp;be&nbsp;made&nbsp;much&nbsp;faster&nbsp;either&nbsp;using&nbsp;sparse&nbsp;matrix&nbsp;or&nbsp;neigh_ixs</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1196">1196</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transition_prob_UMAP_3d&nbsp;=&nbsp;np.exp(self.corrcoef_UMAP_3d&nbsp;/&nbsp;sigma_corr)&nbsp;*&nbsp;self.embedding_UMAP_knn_3d.A&nbsp;&nbsp;#&nbsp;naive,&nbsp;the&nbsp;exponential&nbsp;of&nbsp;the&nbsp;correlation&nbsp;coefficient/kernal&nbsp;scaling</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1197">1197</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transition_prob_UMAP_3d&nbsp;/=&nbsp;self.transition_prob_UMAP_3d.sum(1)[:,&nbsp;None]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1198">1198</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;hasattr(self,&nbsp;"corrcoef_random"):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1199">1199</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug("Calculate&nbsp;transition&nbsp;probability&nbsp;for&nbsp;negative&nbsp;control")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1200">1200</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transition_prob_UMAP_random_UMAP_3d&nbsp;=&nbsp;np.exp(self.self.corrcoef_random_UMAP_3d&nbsp;/&nbsp;sigma_corr)&nbsp;*&nbsp;self.embedding_UMAP_knn_3d.A&nbsp;&nbsp;#&nbsp;naive</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1201">1201</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transition_prob_UMAP_random_UMAP_3d&nbsp;/=&nbsp;self.transition_prob_UMAP_random_UMAP_3d.sum(1)[:,&nbsp;None]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1202">1202</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#print(len(embedding_UMAP_knn_3d))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1203">1203</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#print(len(embedding_UMAP_knn_3d[0]))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1204">1204</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unitary_vectors&nbsp;=&nbsp;self.embedding_UMAP_3d.T[:,&nbsp;None,&nbsp;:]&nbsp;-&nbsp;self.embedding_UMAP_3d.T[:,&nbsp;:,&nbsp;None]&nbsp;&nbsp;#&nbsp;shape&nbsp;(3,ncells,ncells)&nbsp;#for&nbsp;each&nbsp;cells&nbsp;coordinates&nbsp;-&nbsp;row1:&nbsp;cell1-cell1,&nbsp;cell2-cell1,&nbsp;cell3-cell1&nbsp;cell4-cell1</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1205">1205</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;np.errstate(divide='ignore',&nbsp;invalid='ignore'):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1206">1206</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unitary_vectors&nbsp;/=&nbsp;np.linalg.norm(unitary_vectors,&nbsp;ord=2,&nbsp;axis=0)&nbsp;&nbsp;#&nbsp;divide&nbsp;by&nbsp;L2,&nbsp;divides&nbsp;by&nbsp;the&nbsp;vector&nbsp;normed&nbsp;version,&nbsp;15x15</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1207">1207</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.fill_diagonal(unitary_vectors[0,&nbsp;...],&nbsp;0)&nbsp;&nbsp;#&nbsp;fix&nbsp;nans&nbsp;replace&nbsp;NAN&nbsp;with&nbsp;0</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1208">1208</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.fill_diagonal(unitary_vectors[1,&nbsp;...],&nbsp;0)&nbsp;#embedding&nbsp;comes&nbsp;from&nbsp;the&nbsp;UMAP</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1209">1209</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.fill_diagonal(unitary_vectors[2,&nbsp;...],&nbsp;0)&nbsp;#embedding&nbsp;comes&nbsp;from&nbsp;the&nbsp;UMAP</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1210">1210</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.MY_ARROWS_umap_3d&nbsp;=&nbsp;(self.transition_prob_UMAP_3d&nbsp;*&nbsp;unitary_vectors).sum(2)&nbsp;#.A&nbsp;means&nbsp;change&nbsp;the&nbsp;data&nbsp;type&nbsp;from&nbsp;a&nbsp;matrix&nbsp;to&nbsp;an&nbsp;array&nbsp;#unit&nbsp;vector*transition&nbsp;probability</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1211">1211</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.MY_ARROWS_umap_3d&nbsp;-=&nbsp;(self.embedding_UMAP_knn_3d.A&nbsp;*&nbsp;unitary_vectors).sum(2)&nbsp;/&nbsp;self.embedding_UMAP_knn_3d.sum(1).A.T</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1212">1212</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.MY_ARROWS_umap_3d&nbsp;=&nbsp;self.MY_ARROWS_umap_3d.T&nbsp;#transposes&nbsp;the&nbsp;vector</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1213">1213</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;expression_scaling:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1214">1214</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim&nbsp;=&nbsp;getattr(self,&nbsp;self.which_hidim)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1215">1215</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;estim_delta&nbsp;=&nbsp;hi_dim.dot(self.transition_prob_UMAP_3d.T)&nbsp;-&nbsp;hi_dim.dot((self.embedding_UMAP_knn_3d.A&nbsp;/&nbsp;self.embedding_UMAP_knn_3d.sum(1).A).T)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1216">1216</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos_proj&nbsp;=&nbsp;(self.delta_S&nbsp;*&nbsp;estim_delta).sum(0)&nbsp;/&nbsp;np.sqrt((estim_delta**2).sum(0))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1217">1217</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.scaling_UMAP_3d&nbsp;=&nbsp;np.clip(cos_proj&nbsp;/&nbsp;scaling_penalty,&nbsp;0,&nbsp;1)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1218">1218</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.MY_ARROWS_umap_3d&nbsp;=&nbsp;self.MY_ARROWS_umap_3d&nbsp;*&nbsp;self.scaling_UMAP_3d[:,&nbsp;None]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1219">1219</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;hasattr(self,&nbsp;"corrcoef_random"):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1220">1220</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.MY_ARROWS_umap_random_3d&nbsp;=&nbsp;(self.transition_prob_UMAP_random_UMAP_3d&nbsp;*&nbsp;unitary_vectors).sum(2)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1221">1221</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.MY_ARROWS_umap_random_3d&nbsp;-=&nbsp;(self.embedding_UMAP_knn_3d.A&nbsp;*&nbsp;unitary_vectors).sum(2)&nbsp;/&nbsp;self.embedding_UMAP_knn_3d.sum(1).A.T</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1222">1222</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.MY_ARROWS_umap_random_3d&nbsp;=&nbsp;self.MY_ARROWS_umap_random_3d.T</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1223">1223</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;expression_scaling:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1224">1224</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;estim_delta_rndm&nbsp;=&nbsp;hi_dim.dot(self.transition_prob_UMAP_random_UMAP_3d.T)&nbsp;-&nbsp;hi_dim.dot((self.embedding_UMAP_knn_3d.A&nbsp;/&nbsp;self.embedding_UMAP_knn_3d.sum(1).A).T)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1225">1225</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos_proj_rndm&nbsp;=&nbsp;(self.delta_S_rndm&nbsp;*&nbsp;estim_delta_rndm).sum(0)&nbsp;/&nbsp;np.sqrt((estim_delta_rndm**2).sum(0))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1226">1226</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.scaling_UMAP_rndm_3d&nbsp;=&nbsp;np.clip(cos_proj_rndm&nbsp;/&nbsp;scaling_penalty,&nbsp;0,&nbsp;1)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1227">1227</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.MY_ARROWS_umap_random_3d&nbsp;=&nbsp;self.MY_ARROWS_umap_random_3d&nbsp;*&nbsp;self.scaling_UMAP_rndm_3d[:,&nbsp;None]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1228">1228</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1229">1229</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;NOTE&nbsp;should&nbsp;implement&nbsp;a&nbsp;version&nbsp;with&nbsp;cython</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1230">1230</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;NotImplementedError(f"Weird&nbsp;value&nbsp;self.corr_calc={self.corr_calc}")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1231">1231</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colnames_cells&nbsp;=&nbsp;list(self.ca["Patients"])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1232">1232</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genes_embedding&nbsp;=&nbsp;np.array(self.MY_ARROWS_umap_3d)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1233">1233</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spliced_df&nbsp;=&nbsp;pd.DataFrame(genes_embedding,&nbsp;columns=["x",&nbsp;"y",&nbsp;"z"],&nbsp;index=colnames_cells)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1234">1234</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"Delta_embedding_NN"&nbsp;+&nbsp;str(Myneighbours)&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(extraNNvalue)&nbsp;+&nbsp;"_UMAP3D.csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1235">1235</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(DE_location)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1236">1236</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#spliced_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1237">1237</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genes_embedding&nbsp;=&nbsp;np.array(self.corrcoef_UMAP_3d)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1238">1238</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spliced_df&nbsp;=&nbsp;pd.DataFrame(genes_embedding,&nbsp;columns=colnames_cells,&nbsp;index=colnames_cells)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1239">1239</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"selfCC_NN"&nbsp;+&nbsp;str(Myneighbours)&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(extraNNvalue)&nbsp;+&nbsp;"_UMAP3D.csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1240">1240</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(selfCC_folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1241">1241</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spliced_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1242">1242</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genes_embedding&nbsp;=&nbsp;np.array(unitary_vectors[0])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1243">1243</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spliced_df&nbsp;=&nbsp;pd.DataFrame(genes_embedding,&nbsp;columns=colnames_cells,&nbsp;index=colnames_cells)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1244">1244</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"UnVecX_NN"&nbsp;+&nbsp;str(Myneighbours)&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(extraNNvalue)&nbsp;+&nbsp;"_UMAP3D.csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1245">1245</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(VecX_location)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1246">1246</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#spliced_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1247">1247</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genes_embedding&nbsp;=&nbsp;np.array(unitary_vectors[1])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1248">1248</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spliced_df&nbsp;=&nbsp;pd.DataFrame(genes_embedding,&nbsp;columns=colnames_cells,&nbsp;index=colnames_cells)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1249">1249</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"UnVecY_NN"&nbsp;+&nbsp;str(Myneighbours)&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(extraNNvalue)&nbsp;+&nbsp;"_UMAP3D.csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1250">1250</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(VecY_loc)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1251">1251</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#spliced_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1252">1252</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genes_embedding&nbsp;=&nbsp;np.array(unitary_vectors[2])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1253">1253</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spliced_df&nbsp;=&nbsp;pd.DataFrame(genes_embedding,&nbsp;columns=colnames_cells,&nbsp;index=colnames_cells)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1254">1254</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"UnVecZ_NN"&nbsp;+&nbsp;str(Myneighbours)&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(extraNNvalue)&nbsp;+&nbsp;"_UMAP3D.csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1255">1255</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(VecZ_loc)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1256">1256</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#spliced_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1257">1257</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp&nbsp;=&nbsp;np.array(self.transition_prob_UMAP_3d)&nbsp;#number&nbsp;of&nbsp;samples&nbsp;x&nbsp;number&nbsp;of&nbsp;samples</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1258">1258</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp_df&nbsp;=&nbsp;pd.DataFrame(tp,&nbsp;columns=colnames_cells,&nbsp;index=colnames_cells)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1259">1259</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"Transition_Probability_NN"&nbsp;+&nbsp;str(Myneighbours)&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(extraNNvalue)&nbsp;+&nbsp;"_UMAP3D.csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1260">1260</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(TP_folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1261">1261</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1262">1262</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#####RUN&nbsp;TP&nbsp;code&nbsp;here################################</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1263">1263</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#note:&nbsp;the&nbsp;following&nbsp;requires&nbsp;these&nbsp;R&nbsp;packages&nbsp;to&nbsp;be&nbsp;installed:&nbsp;&nbsp;'gtools',&nbsp;'reshape2',&nbsp;ggplot2',&nbsp;grid'&nbsp;and&nbsp;'tidyverse'</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1264">1264</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#to&nbsp;code&nbsp;to&nbsp;install&nbsp;them&nbsp;has&nbsp;been&nbsp;commented&nbsp;out&nbsp;but&nbsp;is&nbsp;below:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1265">1265</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;import&nbsp;rpy2.robjects&nbsp;as&nbsp;ro</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1266">1266</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;rpy2.robjects.packages&nbsp;import&nbsp;importr</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1267">1267</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;utils&nbsp;=&nbsp;importr('utils')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1268">1268</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('gtools')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1269">1269</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('reshape2')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1270">1270</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('ggplot2')&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1271">1271</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('grid')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1272">1272</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('tidyverse')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1273">1273</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gtools&nbsp;=&nbsp;importr("gtools")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1274">1274</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reshape2&nbsp;=&nbsp;importr("reshape2")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1275">1275</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ggplot2&nbsp;=&nbsp;importr("ggplot2")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1276">1276</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grid&nbsp;=&nbsp;importr("grid")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1277">1277</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tidyverse&nbsp;=&nbsp;importr("tidyverse")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1278">1278</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path=pathToTransitionProbabilityCode</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1279">1279</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;version&nbsp;=&nbsp;"SampleGroup1"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1280">1280</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;RunTransitionProbabilityCode(filename,&nbsp;selfremoved,&nbsp;location,&nbsp;metaGroup,&nbsp;outputdir,&nbsp;grouptype,&nbsp;version,&nbsp;Randomsampling):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1281">1281</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r=ro.r</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1282">1282</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r.source(path+"TransitionProbability.R")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1283">1283</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p=r.TransitionProbability(filename,&nbsp;selfremoved,&nbsp;location,&nbsp;metaGroup,&nbsp;outputdir,&nbsp;grouptype,&nbsp;version,&nbsp;Randomsampling)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1284">1284</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;p</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1285">1285</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#a=RunTransitionProbabilityCode(file_name,&nbsp;"TRUE",&nbsp;TP_folder,&nbsp;metadataToUse,&nbsp;UMAP_3D_GroupLevelTP,&nbsp;grouptype,&nbsp;version,&nbsp;Randomsampling)&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1286">1286</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b=RunTransitionProbabilityCode(file_name,&nbsp;"FALSE",&nbsp;TP_folder,&nbsp;metadataToUse,&nbsp;UMAP_3D_GroupLevelTP,&nbsp;grouptype,&nbsp;version,&nbsp;Randomsampling)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1287">1287</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#if&nbsp;second&nbsp;metadata&nbsp;feature&nbsp;type&nbsp;==&nbsp;True</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1288">1288</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;manyfeatures&nbsp;==&nbsp;"True":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1289">1289</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;version&nbsp;=&nbsp;"SampleGroup2"&nbsp;#secondgroup</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1290">1290</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c=RunTransitionProbabilityCode(file_name,&nbsp;"TRUE",&nbsp;TP_folder,&nbsp;secondgroup,&nbsp;UMAP_3D_GroupLevelTP,&nbsp;grouptype2,&nbsp;version,&nbsp;Randomsampling)&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1291">1291</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d=RunTransitionProbabilityCode(file_name,&nbsp;"FALSE",&nbsp;TP_folder,&nbsp;secondgroup,&nbsp;UMAP_3D_GroupLevelTP,&nbsp;grouptype2,&nbsp;version,&nbsp;Randomsampling)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1292">1292</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1293">1293</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;estimate_transition_probUMAP3D(self,&nbsp;hidim:&nbsp;str="Sx_sz",&nbsp;embed:&nbsp;str="UMAPembed3d",&nbsp;transform:&nbsp;str="sqrt",ndims:&nbsp;int=None,&nbsp;n_sight:&nbsp;int=None,&nbsp;psc:&nbsp;float=None,knn_random:&nbsp;bool=False,&nbsp;sampled_fraction:&nbsp;float=0.3,&nbsp;sampling_probs:&nbsp;Tuple[float,&nbsp;float]=(0.5,&nbsp;0.1),&nbsp;max_dist_embed:&nbsp;float=None,&nbsp;n_jobs:&nbsp;int=4,&nbsp;threads:&nbsp;int=None,&nbsp;calculate_randomized:&nbsp;bool=True,&nbsp;random_seed:&nbsp;int=15071990,&nbsp;**kwargs)&nbsp;-&gt;&nbsp;None:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1294">1294</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numba_random_seed(random_seed)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1295">1295</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.which_hidim&nbsp;=&nbsp;hidim&nbsp;#spliced&nbsp;states&nbsp;before&nbsp;timepoint&nbsp;same&nbsp;calculation&nbsp;used&nbsp;to&nbsp;calculate&nbsp;after&nbsp;just&nbsp;with&nbsp;different&nbsp;names&nbsp;for&nbsp;the&nbsp;same&nbsp;thing&nbsp;this&nbsp;is:&nbsp;self.Sx_sz</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1296">1296</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;"n_neighbors"&nbsp;in&nbsp;kwargs:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1297">1297</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_neighbors&nbsp;=&nbsp;kwargs.pop("n_neighbors")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1298">1298</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;len(kwargs)&nbsp;&gt;&nbsp;0:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1299">1299</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warning(f"keyword&nbsp;arguments&nbsp;were&nbsp;passed&nbsp;but&nbsp;could&nbsp;not&nbsp;be&nbsp;interpreted&nbsp;{kwargs}")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1300">1300</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1301">1301</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_neighbors&nbsp;=&nbsp;None</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1302">1302</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n_sight&nbsp;is&nbsp;None&nbsp;and&nbsp;n_neighbors&nbsp;is&nbsp;None:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1303">1303</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_neighbors&nbsp;=&nbsp;int(self.S.shape[1]&nbsp;/&nbsp;5)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1304">1304</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(n_sight&nbsp;is&nbsp;not&nbsp;None)&nbsp;and&nbsp;(n_neighbors&nbsp;is&nbsp;not&nbsp;None)&nbsp;and&nbsp;n_neighbors&nbsp;!=&nbsp;n_sight:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1305">1305</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;ValueError("n_sight&nbsp;and&nbsp;n_neighbors&nbsp;are&nbsp;different&nbsp;names&nbsp;for&nbsp;the&nbsp;same&nbsp;parameter,&nbsp;they&nbsp;cannot&nbsp;be&nbsp;set&nbsp;differently")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1306">1306</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n_sight&nbsp;is&nbsp;not&nbsp;None&nbsp;and&nbsp;n_neighbors&nbsp;is&nbsp;None:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1307">1307</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_neighbors&nbsp;=&nbsp;n_sight</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1308">1308</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;psc&nbsp;is&nbsp;None:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1309">1309</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;transform&nbsp;==&nbsp;"log"&nbsp;or&nbsp;transform&nbsp;==&nbsp;"logratio":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1310">1310</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;psc&nbsp;=&nbsp;1.</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1311">1311</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;transform&nbsp;==&nbsp;"sqrt":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1312">1312</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;psc&nbsp;=&nbsp;1e-10&nbsp;&nbsp;#&nbsp;for&nbsp;numerical&nbsp;stablity</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1313">1313</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:&nbsp;&nbsp;#&nbsp;transform&nbsp;==&nbsp;"linear":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1314">1314</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;psc&nbsp;=&nbsp;0</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1315">1315</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;knn_random:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1316">1316</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.random.seed(random_seed)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1317">1317</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corr_calc&nbsp;=&nbsp;"knn_random"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1318">1318</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;"pcs"&nbsp;in&nbsp;hidim:&nbsp;&nbsp;#&nbsp;sic</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1319">1319</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim&nbsp;=&nbsp;np.array(getattr(self,&nbsp;hidim).T[:,&nbsp;:ndims],&nbsp;order="C")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1320">1320</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim_t&nbsp;=&nbsp;np.array(getattr(self,&nbsp;hidim&nbsp;+&nbsp;"_t").T[:,&nbsp;:ndims],&nbsp;order="C")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1321">1321</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1322">1322</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ndims&nbsp;is&nbsp;not&nbsp;None:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1323">1323</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;ValueError(f"ndims&nbsp;was&nbsp;set&nbsp;to&nbsp;{ndims}&nbsp;but&nbsp;hidim&nbsp;!=&nbsp;'pcs'.&nbsp;Set&nbsp;ndims&nbsp;=&nbsp;None&nbsp;for&nbsp;hidim='{hidim}'")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1324">1324</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim&nbsp;=&nbsp;getattr(self,&nbsp;hidim)&nbsp;&nbsp;#&nbsp;[:,&nbsp;:ndims]&nbsp;hi_dim&nbsp;is&nbsp;the</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1325">1325</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim_t&nbsp;=&nbsp;hi_dim&nbsp;+&nbsp;self.used_delta_t&nbsp;*&nbsp;self.delta_S&nbsp;&nbsp;#&nbsp;[:,&nbsp;:ndims]&nbsp;[:,&nbsp;:ndims]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1326">1326</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1327">1327</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_S_rndm&nbsp;=&nbsp;np.copy(self.delta_S)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1328">1328</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permute_rows_nsign(self.delta_S_rndm)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1329">1329</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim_t_rndm&nbsp;=&nbsp;hi_dim&nbsp;+&nbsp;self.used_delta_t&nbsp;*&nbsp;self.delta_S_rndm</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1330">1330</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;embedding&nbsp;=&nbsp;getattr(self,&nbsp;embed)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1331">1331</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.embedding_UMAP_3d&nbsp;=&nbsp;embedding</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1332">1332</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug("Calculate&nbsp;KNN&nbsp;in&nbsp;the&nbsp;embedding&nbsp;space")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1333">1333</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nn&nbsp;=&nbsp;NearestNeighbors(n_neighbors=n_neighbors,&nbsp;n_jobs=n_jobs)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1334">1334</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nn.fit(embedding)&nbsp;&nbsp;#&nbsp;NOTE&nbsp;should&nbsp;support&nbsp;knn&nbsp;in&nbsp;high&nbsp;dimensions</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1335">1335</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.embedding_UMAP_knn_3d&nbsp;=&nbsp;nn.kneighbors_graph(mode="connectivity")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1336">1336</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pick&nbsp;random&nbsp;neighbours&nbsp;and&nbsp;prune&nbsp;the&nbsp;rest</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1337">1337</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neigh_ixs&nbsp;=&nbsp;self.embedding_UMAP_knn_3d.indices.reshape((-1,&nbsp;n_neighbors))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1338">1338</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;=&nbsp;np.linspace(sampling_probs[0],&nbsp;sampling_probs[1],&nbsp;neigh_ixs.shape[1])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1339">1339</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;=&nbsp;p&nbsp;/&nbsp;p.sum()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1340">1340</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;There&nbsp;was&nbsp;a&nbsp;problem&nbsp;of&nbsp;API&nbsp;consistency&nbsp;because&nbsp;the&nbsp;random.choice&nbsp;can&nbsp;pick&nbsp;the&nbsp;diagonal&nbsp;value&nbsp;(or&nbsp;not)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1341">1341</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;resulting&nbsp;self.embedding_UMAPf&nbsp;with&nbsp;different&nbsp;number&nbsp;of&nbsp;nonzero&nbsp;entry&nbsp;per&nbsp;row.</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1342">1342</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Not&nbsp;updated&nbsp;yet&nbsp;not&nbsp;to&nbsp;break&nbsp;previous&nbsp;analyses</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1343">1343</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Fix&nbsp;is&nbsp;substituting&nbsp;below&nbsp;`neigh_ixs.shape[1]`&nbsp;with&nbsp;`np.arange(1,neigh_ixs.shape[1]-1)`</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1344">1344</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;I&nbsp;change&nbsp;it&nbsp;here&nbsp;since&nbsp;I&nbsp;am&nbsp;doing&nbsp;some&nbsp;breaking&nbsp;changes</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1345">1345</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sampling_ixs&nbsp;=&nbsp;np.stack((np.random.choice(neigh_ixs.shape[1],</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1346">1346</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size=(int(sampled_fraction&nbsp;*&nbsp;(n_neighbors)),),</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1347">1347</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;replace=False,</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1348">1348</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p=p)&nbsp;for&nbsp;i&nbsp;in&nbsp;range(neigh_ixs.shape[0])),&nbsp;0)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1349">1349</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.embedding_umap_3d&nbsp;=&nbsp;sampling_ixs</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1350">1350</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neigh_ixs&nbsp;=&nbsp;neigh_ixs[np.arange(neigh_ixs.shape[0])[:,&nbsp;None],&nbsp;sampling_ixs]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1351">1351</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nonzero&nbsp;=&nbsp;neigh_ixs.shape[0]&nbsp;*&nbsp;neigh_ixs.shape[1]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1352">1352</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.embedding_UMAP_knn_3d&nbsp;=&nbsp;sparse.csr_matrix((np.ones(nonzero),</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1353">1353</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neigh_ixs.ravel(),</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1354">1354</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.arange(0,&nbsp;nonzero&nbsp;+&nbsp;1,&nbsp;neigh_ixs.shape[1])),</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1355">1355</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shape=(neigh_ixs.shape[0],</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1356">1356</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neigh_ixs.shape[0]))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1357">1357</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;'{self.corr_calc}'")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1358">1358</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;transform&nbsp;==&nbsp;"log":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1359">1359</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim&nbsp;=&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1360">1360</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP_3d&nbsp;=&nbsp;colDeltaCorLog10partial(hi_dim,&nbsp;np.log10(np.abs(delta_hi_dim)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim),&nbsp;neigh_ixs,&nbsp;threads=threads,&nbsp;psc=psc)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1361">1361</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1362">1362</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1363">1363</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim_rndm&nbsp;=&nbsp;hi_dim_t_rndm&nbsp;-&nbsp;hi_dim</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1364">1364</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP_random_3d&nbsp;=&nbsp;colDeltaCorLog10partial(hi_dim,&nbsp;np.log10(np.abs(delta_hi_dim_rndm)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim_rndm),&nbsp;neigh_ixs,&nbsp;threads=threads,&nbsp;psc=psc)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1365">1365</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;transform&nbsp;==&nbsp;"logratio":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1366">1366</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log2hidim&nbsp;=&nbsp;np.log2(hi_dim&nbsp;+&nbsp;psc)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1367">1367</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim&nbsp;=&nbsp;np.log2(np.abs(hi_dim_t)&nbsp;+&nbsp;psc)&nbsp;-&nbsp;log2hidim</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1368">1368</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP_3d&nbsp;=&nbsp;colDeltaCorpartial(log2hidim,&nbsp;delta_hi_dim,&nbsp;neigh_ixs,&nbsp;threads=threads)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1369">1369</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1370">1370</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1371">1371</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim_rndm&nbsp;=&nbsp;np.log2(np.abs(hi_dim_t_rndm)&nbsp;+&nbsp;psc)&nbsp;-&nbsp;log2hidim</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1372">1372</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP_random_3d&nbsp;=&nbsp;colDeltaCorpartial(log2hidim,&nbsp;delta_hi_dim_rndm,&nbsp;neigh_ixs,&nbsp;threads=threads)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1373">1373</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;transform&nbsp;==&nbsp;"linear":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1374">1374</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP_3d&nbsp;=&nbsp;colDeltaCorpartial(hi_dim,&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim,&nbsp;neigh_ixs,&nbsp;threads=threads)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1375">1375</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1376">1376</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1377">1377</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP_random_3d&nbsp;=&nbsp;colDeltaCorpartial(hi_dim,&nbsp;hi_dim_t_rndm&nbsp;-&nbsp;hi_dim,&nbsp;neigh_ixs,&nbsp;threads=threads)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1378">1378</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;transform&nbsp;==&nbsp;"sqrt":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1379">1379</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim&nbsp;=&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1380">1380</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP_3d&nbsp;=&nbsp;colDeltaCorSqrtpartial(hi_dim,&nbsp;np.sqrt(np.abs(delta_hi_dim)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim),&nbsp;neigh_ixs,&nbsp;threads=threads,&nbsp;psc=psc)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1381">1381</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1382">1382</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1383">1383</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim_rndm&nbsp;=&nbsp;hi_dim_t_rndm&nbsp;-&nbsp;hi_dim</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1384">1384</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP_random_3d&nbsp;=&nbsp;colDeltaCorSqrtpartial(hi_dim,&nbsp;np.sqrt(np.abs(delta_hi_dim_rndm)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim_rndm),&nbsp;neigh_ixs,&nbsp;threads=threads,&nbsp;psc=psc)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1385">1385</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1386">1386</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;NotImplementedError(f"transform={transform}&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;parameter")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1387">1387</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.fill_diagonal(self.embedding_UMAP_3d,&nbsp;0)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1388">1388</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;np.any(np.isnan(self.embedding_UMAP_3d)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1389">1389</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.embedding_UMAP_3d[np.isnan(self.embedding_UMAP_3d)]&nbsp;=&nbsp;1</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1390">1390</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warning("Nans&nbsp;encountered&nbsp;in&nbsp;corrcoef&nbsp;and&nbsp;corrected&nbsp;to&nbsp;1s.&nbsp;If&nbsp;not&nbsp;identical&nbsp;cells&nbsp;were&nbsp;present&nbsp;it&nbsp;is&nbsp;probably&nbsp;a&nbsp;small&nbsp;isolated&nbsp;cluster&nbsp;converging&nbsp;after&nbsp;imputation.")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1391">1391</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1392">1392</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.fill_diagonal(self.corrcoef_UMAP_random_3d,&nbsp;0)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1393">1393</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;np.any(np.isnan(self.corrcoef_UMAP_random_3d)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1394">1394</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP_random_3d[np.isnan(self.corrcoef_UMAP_random_3d)]&nbsp;=&nbsp;1</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1395">1395</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warning("Nans&nbsp;encountered&nbsp;in&nbsp;corrcoef_random&nbsp;and&nbsp;corrected&nbsp;to&nbsp;1s.&nbsp;If&nbsp;not&nbsp;identical&nbsp;cells&nbsp;were&nbsp;present&nbsp;it&nbsp;is&nbsp;probably&nbsp;a&nbsp;small&nbsp;isolated&nbsp;cluster&nbsp;converging&nbsp;after&nbsp;imputation.")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1396">1396</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Done&nbsp;Correlation&nbsp;Calculation")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1397">1397</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1398">1398</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corr_calc&nbsp;=&nbsp;"full"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1399">1399</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;"pcs"&nbsp;in&nbsp;hidim:&nbsp;&nbsp;#&nbsp;sic</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1400">1400</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim&nbsp;=&nbsp;np.array(getattr(self,&nbsp;hidim).T[:,&nbsp;:ndims],&nbsp;order="C")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1401">1401</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim_t&nbsp;=&nbsp;np.array(getattr(self,&nbsp;hidim&nbsp;+&nbsp;"_t").T[:,&nbsp;:ndims],&nbsp;order="C")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1402">1402</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:&nbsp;#this&nbsp;route:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1403">1403</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ndims&nbsp;is&nbsp;not&nbsp;None:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1404">1404</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;ValueError(f"ndims&nbsp;was&nbsp;set&nbsp;to&nbsp;{ndims}&nbsp;but&nbsp;hidim&nbsp;!=&nbsp;'pcs'.&nbsp;Set&nbsp;ndims&nbsp;=&nbsp;None&nbsp;for&nbsp;hidim='{hidim}'")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1405">1405</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim&nbsp;=&nbsp;getattr(self,&nbsp;hidim)&nbsp;&nbsp;#&nbsp;[:,&nbsp;:ndims]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1406">1406</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim_t&nbsp;=&nbsp;hi_dim&nbsp;+&nbsp;self.used_delta_t&nbsp;*&nbsp;self.delta_S&nbsp;&nbsp;#&nbsp;[:,&nbsp;:ndims]&nbsp;[:,&nbsp;:ndims]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1407">1407</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1408">1408</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_S_rndm&nbsp;=&nbsp;np.copy(self.delta_S)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1409">1409</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permute_rows_nsign(self.delta_S_rndm)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1410">1410</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim_t_rndm&nbsp;=&nbsp;hi_dim&nbsp;+&nbsp;self.used_delta_t&nbsp;*&nbsp;self.delta_S_rndm</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1411">1411</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;embedding&nbsp;=&nbsp;getattr(self,&nbsp;embed)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1412">1412</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.embedding_UMAP_3d&nbsp;=&nbsp;embedding</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1413">1413</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug("Calculate&nbsp;KNN&nbsp;in&nbsp;the&nbsp;embedding&nbsp;space")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1414">1414</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nn&nbsp;=&nbsp;NearestNeighbors(n_neighbors=n_neighbors,&nbsp;n_jobs=n_jobs)&nbsp;#auto&nbsp;algorithm&nbsp;means&nbsp;it&nbsp;will&nbsp;tyr&nbsp;and&nbsp;determine&nbsp;the&nbsp;best&nbsp;method&nbsp;itself.000</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1415">1415</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nn.fit(embedding)&nbsp;&nbsp;#&nbsp;NOTE&nbsp;should&nbsp;support&nbsp;knn&nbsp;in&nbsp;high&nbsp;dimensions</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1416">1416</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.embedding_UMAP_knn_3d&nbsp;=&nbsp;nn.kneighbors_graph(mode="connectivity")&nbsp;#def&nbsp;of&nbsp;embedding_knn</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1417">1417</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#print(transform)&nbsp;#sqrt</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1418">1418</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug("Correlation&nbsp;Calculation&nbsp;'full'")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1419">1419</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;transform&nbsp;==&nbsp;"log":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1420">1420</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim&nbsp;=&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1421">1421</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP_3d&nbsp;=&nbsp;colDeltaCorLog10(hi_dim,&nbsp;np.log10(np.abs(delta_hi_dim)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim),&nbsp;threads=threads,&nbsp;psc=psc)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1422">1422</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1423">1423</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1424">1424</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim_rndm&nbsp;=&nbsp;hi_dim_t_rndm&nbsp;-&nbsp;hi_dim</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1425">1425</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP_random_3d&nbsp;=&nbsp;colDeltaCorLog10(hi_dim,&nbsp;np.log10(np.abs(delta_hi_dim_rndm)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim_rndm),&nbsp;threads=threads,&nbsp;psc=psc)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1426">1426</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;transform&nbsp;==&nbsp;"logratio":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1427">1427</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log2hidim&nbsp;=&nbsp;np.log2(hi_dim&nbsp;+&nbsp;psc)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1428">1428</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim&nbsp;=&nbsp;np.log2(np.abs(hi_dim_t)&nbsp;+&nbsp;psc)&nbsp;-&nbsp;log2hidim</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1429">1429</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP_3d&nbsp;=&nbsp;colDeltaCor(log2hidim,&nbsp;delta_hi_dim,&nbsp;threads=threads)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1430">1430</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1431">1431</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1432">1432</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim_rndm&nbsp;=&nbsp;np.log2(np.abs(hi_dim_t_rndm)&nbsp;+&nbsp;1)&nbsp;-&nbsp;log2hidim</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1433">1433</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP_random_3d&nbsp;=&nbsp;colDeltaCor(log2hidim,&nbsp;delta_hi_dim_rndm,&nbsp;threads=threads)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1434">1434</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;transform&nbsp;==&nbsp;"linear":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1435">1435</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP_3d&nbsp;=&nbsp;colDeltaCor(hi_dim,&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim,&nbsp;threads=threads)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1436">1436</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1437">1437</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1438">1438</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP_random_3d&nbsp;=&nbsp;colDeltaCor(hi_dim,&nbsp;hi_dim_t_rndm&nbsp;-&nbsp;hi_dim,&nbsp;threads=threads)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1439">1439</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;transform&nbsp;==&nbsp;"sqrt":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1440">1440</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim&nbsp;=&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1441">1441</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP_3d&nbsp;=&nbsp;colDeltaCorSqrt(hi_dim,&nbsp;np.sqrt(np.abs(delta_hi_dim)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim),&nbsp;threads=threads,&nbsp;psc=psc)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1442">1442</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1443">1443</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1444">1444</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim_rndm&nbsp;=&nbsp;hi_dim_t_rndm&nbsp;-&nbsp;hi_dim</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1445">1445</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_UMAP_random_3d&nbsp;=&nbsp;colDeltaCorSqrt(hi_dim,&nbsp;np.sqrt(np.abs(delta_hi_dim_rndm)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim_rndm),&nbsp;threads=threads,&nbsp;psc=psc)&nbsp;#30&nbsp;*&nbsp;number&nbsp;of&nbsp;genes&nbsp;matrix&nbsp;of&nbsp;submatrices</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1446">1446</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1447">1447</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;NotImplementedError(f"transform={transform}&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;parameter")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1448">1448</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.fill_diagonal(self.corrcoef_UMAP_3d,&nbsp;0)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1449">1449</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1450">1450</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.fill_diagonal(self.corrcoef_UMAP_random_3d,&nbsp;0)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1451">1451</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colnames_cells&nbsp;=&nbsp;list(self.ca["Patients"])&nbsp;#shape&nbsp;of&nbsp;all:&nbsp;(rows=genes,&nbsp;cols=samples)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1452">1452</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rownames_genes&nbsp;=&nbsp;list(self.ra["Genes"])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1453">1453</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp&nbsp;=&nbsp;np.array(hi_dim)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1454">1454</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp_df&nbsp;=&nbsp;pd.DataFrame(tp,&nbsp;columns=colnames_cells,&nbsp;index=rownames_genes)&nbsp;&nbsp;#emat=&nbsp;hi_dim&nbsp;#expression</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1455">1455</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"emat_UMAP_3D.csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1456">1456</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#tp_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1457">1457</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqrtdmat&nbsp;=&nbsp;np.sqrt(np.abs(delta_hi_dim)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1458">1458</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp&nbsp;=&nbsp;np.array(sqrtdmat)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1459">1459</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"sqrt_dmat_UMAP_3D.csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1460">1460</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp_df&nbsp;=&nbsp;pd.DataFrame(tp,&nbsp;columns=colnames_cells,&nbsp;index=rownames_genes)&nbsp;&nbsp;#dmat&nbsp;=&nbsp;np.sqrt(np.abs(delta_hi_dim)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim)&nbsp;#dmat&nbsp;are&nbsp;the&nbsp;velocities</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1461">1461</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#tp_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)&nbsp;&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1462">1462</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alt_dmat&nbsp;=&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1463">1463</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp&nbsp;=&nbsp;np.array(alt_dmat)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1464">1464</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp_df&nbsp;=&nbsp;pd.DataFrame(tp,&nbsp;columns=colnames_cells,&nbsp;index=rownames_genes)&nbsp;&nbsp;#&nbsp;alt&nbsp;dmat:&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim&nbsp;(for&nbsp;linear)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1465">1465</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"linear_dmat_UMAP_3D.csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1466">1466</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#tp_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)&nbsp;&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1467">1467</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp&nbsp;=&nbsp;np.array(self.corrcoef_UMAP_3d)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1468">1468</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp_df&nbsp;=&nbsp;pd.DataFrame(tp,&nbsp;columns=colnames_cells,&nbsp;index=colnames_cells)&nbsp;&nbsp;#&nbsp;raw&nbsp;cc&nbsp;values&nbsp;withot&nbsp;any&nbsp;alt</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1469">1469</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"CorrelationCoefficients_Raw_UMAP_3D.csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1470">1470</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#tp_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1471">1471</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1472">1472</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1473">1473</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;UMAPwithArrows3D(self,&nbsp;UMAPembedding:&nbsp;str="UMAPembed3d",&nbsp;UMAP_Arrows:&nbsp;str="MY_ARROWS_umap_3d",&nbsp;make_gify:&nbsp;bool=True,&nbsp;numberNeighb:&nbsp;float=2.,&nbsp;typegroup:&nbsp;str="integers",&nbsp;extraNNvalue:&nbsp;int=5):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1474">1474</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#trans&nbsp;=&nbsp;umap.UMAP(n_neighbors&nbsp;=&nbsp;num_nei,&nbsp;n_components=3).fit(self.S_norm.T)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1475">1475</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UMAP_samplesembedding&nbsp;=&nbsp;getattr(self,&nbsp;UMAPembedding)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1476">1476</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.UMAPsampleembedding3d&nbsp;=&nbsp;UMAP_samplesembedding</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1477">1477</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;umap_arrows_embedding_stuff&nbsp;=&nbsp;getattr(self,&nbsp;UMAP_Arrows)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1478">1478</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.arrowUMAPembed3d&nbsp;=&nbsp;umap_arrows_embedding_stuff</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1479">1479</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_markers&nbsp;=&nbsp;self.ca["Markers"]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1480">1480</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mark&nbsp;=&nbsp;sorted(set(my_markers))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1481">1481</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;corresp&nbsp;=&nbsp;["o",&nbsp;"P",&nbsp;"D",&nbsp;"X",&nbsp;"*",&nbsp;"+",&nbsp;"&gt;",&nbsp;"&lt;"]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1482">1482</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;0</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1483">1483</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_types&nbsp;=&nbsp;{}</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1484">1484</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;the_type&nbsp;in&nbsp;mark:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1485">1485</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_types[the_type]&nbsp;=&nbsp;corresp[count]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1486">1486</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;count&nbsp;+&nbsp;1</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__29"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1487">1487</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;markers&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1488">1488</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;mar&nbsp;in&nbsp;my_markers:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1489">1489</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;markers.append(my_types.get(mar))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1490">1490</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;randn(10)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_925">925</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fig&nbsp;=&nbsp;plt.figure(figsize=(8,&nbsp;6))</td><td class="diff_next"></td><td class="diff_header" id="to0_1491">1491</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fig&nbsp;=&nbsp;plt.figure(figsize=(8,&nbsp;6))</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__30">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to0__30">n</a></td><td class="diff_header" id="to0_1492">1492</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quiver_scale&nbsp;=&nbsp;60</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_926">926</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax&nbsp;=&nbsp;fig.add_subplot(111,&nbsp;projection='3d')</td><td class="diff_next"></td><td class="diff_header" id="to0_1493">1493</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_add">#</span>ax&nbsp;=&nbsp;fig.add_subplot(111,&nbsp;projection='3d')</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_927">927</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.scatter(self.pcs[:,&nbsp;dim[0]],</span></td><td class="diff_next"></td><td class="diff_header" id="to0_1494">1494</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax&nbsp;=&nbsp;fig.gca(projection='3d')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_928">928</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.pcs[:,&nbsp;dim[1]],</span></td><td class="diff_next"></td><td class="diff_header" id="to0_1495">1495</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(0,&nbsp;len(markers)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_929">929</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.pcs[:,&nbsp;dim[2]],</span></td><td class="diff_next"></td><td class="diff_header" id="to0_1496">1496</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#ax.scatter(trans.embedding_[i,&nbsp;0],&nbsp;trans.embedding_[i,&nbsp;1],&nbsp;trans.embedding_[i,&nbsp;2],&nbsp;marker=markers[i],&nbsp;c=self.colorandum[i])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_930">930</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c=self.colorandum)</span></td><td class="diff_next"></td><td class="diff_header" id="to0_1497">1497</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#plt.scatter(self.UMAPsampleembedding[i,&nbsp;0],&nbsp;self.UMAPsampleembedding[i,&nbsp;1],c="0.8",&nbsp;alpha=1,&nbsp;s=120,&nbsp;edgecolor="")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_931">931</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.view_init(elev=elev,&nbsp;azim=azim)</span></td><td class="diff_next"></td><td class="diff_header" id="to0_1498">1498</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.scatter(self.UMAPsampleembedding3d[i,&nbsp;0],&nbsp;self.UMAPsampleembedding3d[i,&nbsp;1],&nbsp;self.UMAPsampleembedding3d[i,&nbsp;2],&nbsp;marker=markers[i],&nbsp;c=self.colorandum[i],&nbsp;s=35)#,&nbsp;alpha=1,&nbsp;edgecolor=(0,0,0,1),&nbsp;lw=0.3,&nbsp;rasterized=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_932">932</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header" id="to0_1499">1499</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#quiver_kwargs=dict(headaxislength=7,&nbsp;headlength=13,&nbsp;headwidth=10,linewidths=0.5,&nbsp;width=0.005,&nbsp;color="black",&nbsp;alpha=1)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_933">933</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header" id="to0_1500">1500</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.quiver(self.UMAPsampleembedding3d[i,&nbsp;0],&nbsp;self.UMAPsampleembedding3d[i,&nbsp;1],&nbsp;self.UMAPsampleembedding3d[i,&nbsp;2],&nbsp;self.arrowUMAPembed3d[i,&nbsp;0],&nbsp;self.arrowUMAPembed3d[i,&nbsp;1],&nbsp;self.arrowUMAPembed3d[i,&nbsp;2],&nbsp;arrow_length_ratio=0.35,&nbsp;normalize=False,&nbsp;color="black")&nbsp;#arrow_length_ratio=1.1,&nbsp;color="black")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1501">1501</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1502">1502</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexy_codes&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1503">1503</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_keys&nbsp;=&nbsp;[k&nbsp;&nbsp;for&nbsp;&nbsp;k&nbsp;in&nbsp;&nbsp;self.cluster_colors_dict.keys()]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1504">1504</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_my_keys&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1505">1505</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;my_keys:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1506">1506</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_my_keys.append(str(item,'utf-8'))&nbsp;#int()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1507">1507</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmap2&nbsp;=&nbsp;cm.get_cmap('Paired')&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;PiYG</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1508">1508</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(cmap2.N):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1509">1509</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rgb&nbsp;=&nbsp;cmap2(i)[:3]&nbsp;#&nbsp;will&nbsp;return&nbsp;rgba,&nbsp;we&nbsp;take&nbsp;only&nbsp;first&nbsp;3&nbsp;so&nbsp;we&nbsp;get&nbsp;rgb</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1510">1510</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexy_codes.append(matplotlib.colors.rgb2hex(rgb))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1511">1511</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;legend_elements&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1512">1512</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined&nbsp;=&nbsp;list(zip(decoded_my_keys,&nbsp;hexy_codes))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1513">1513</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined&nbsp;=&nbsp;sorted(combined,&nbsp;key=itemgetter(0))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1514">1514</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(typegroup&nbsp;!=&nbsp;"Strings"):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1515">1515</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;timepoints&nbsp;=&nbsp;[int(i[0])&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1516">1516</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colys&nbsp;=&nbsp;[i[1]&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1517">1517</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tempDF&nbsp;=&nbsp;pd.DataFrame({'Group':timepoints,&nbsp;'colours':colys})</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1518">1518</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tempDF&nbsp;=&nbsp;tempDF.sort_values('Group')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1519">1519</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;groupys2&nbsp;=&nbsp;tempDF['Group'].tolist()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1520">1520</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cols2&nbsp;=&nbsp;tempDF['colours'].tolist()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1521">1521</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined&nbsp;=&nbsp;list(zip(groupys2,&nbsp;cols2))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1522">1522</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_my_keys&nbsp;=&nbsp;[i[0]&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1523">1523</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexy_codes&nbsp;=&nbsp;[i[1]&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1524">1524</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;sample_type&nbsp;in&nbsp;range(0,&nbsp;len(decoded_my_keys)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1525">1525</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to_add&nbsp;=&nbsp;Line2D([0],&nbsp;[0],&nbsp;marker='s',&nbsp;color='w',&nbsp;label=str(decoded_my_keys[sample_type]).strip('"'),&nbsp;markerfacecolor=str(hexy_codes[sample_type]),&nbsp;markersize=7)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1526">1526</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;legend_elements.append(to_add)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1527">1527</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;sample_type&nbsp;in&nbsp;range(0,&nbsp;len(mark)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1528">1528</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to_add&nbsp;=&nbsp;Line2D([0],&nbsp;[0],&nbsp;marker=[*my_types.values()][sample_type],&nbsp;color='w',&nbsp;label=str([*my_types.keys()][sample_type]).strip('"'),&nbsp;markerfacecolor='black',&nbsp;markersize=7)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1529">1529</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;legend_elements.append(to_add)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1530">1530</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#ax.legend(handles=legend_elements,&nbsp;fancybox=True,&nbsp;framealpha=1,&nbsp;borderpad=1,&nbsp;loc=(1.01,0.5),&nbsp;title='Key')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1531">1531</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.legend(handles=legend_elements,&nbsp;title='Key')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1532">1532</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.set_xlabel('UMAP1')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1533">1533</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.set_ylabel('UMAP2')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1534">1534</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.set_zlabel('UMAP3')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1535">1535</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;figure_name3D&nbsp;=&nbsp;'UMAP3D_Arrows_NN'&nbsp;+&nbsp;str(numberNeighb)&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(extraNNvalue)&nbsp;+&nbsp;'.png'</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1536">1536</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(figure_name3D)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1537">1537</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#plt.title('UMAP&nbsp;3D&nbsp;projection',&nbsp;fontsize=10);</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1538">1538</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#plt.show()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1539">1539</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gif_name_1&nbsp;=&nbsp;'UMAP3D_Arrows_rotation_NN'&nbsp;+&nbsp;str(numberNeighb)&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(extraNNvalue)&nbsp;+&nbsp;'.gif'</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1540">1540</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gif_name_2&nbsp;=&nbsp;'UMAP3D_Arrows_rotation_up_down_NN'&nbsp;+&nbsp;str(numberNeighb)&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(extraNNvalue)&nbsp;+&nbsp;'.gif'</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1541">1541</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(make_gify&nbsp;==&nbsp;True):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1542">1542</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;rotate(angle):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1543">1543</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.view_init(azim=angle)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1544">1544</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rot_animation&nbsp;=&nbsp;animation.FuncAnimation(fig,&nbsp;rotate,&nbsp;frames=np.arange(0,&nbsp;362,&nbsp;2),&nbsp;interval=100)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1545">1545</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rot_animation.save(gif_name_1,&nbsp;dpi=80,&nbsp;writer='imagemagick')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1546">1546</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;init():</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1547">1547</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fig,</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1548">1548</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;animate(i):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1549">1549</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.view_init(elev=(i-45)*4,&nbsp;azim=10)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1550">1550</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fig,</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1551">1551</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ani_2&nbsp;=&nbsp;animation.FuncAnimation(fig,&nbsp;animate,&nbsp;init_func=init,&nbsp;frames=200,&nbsp;interval=100,&nbsp;blit=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1552">1552</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ani_2.save(gif_name_2,&nbsp;dpi=80,&nbsp;writer='imagemagick')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1553">1553</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#UMAP1&nbsp;vs&nbsp;UMAP2</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1554">1554</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fig&nbsp;=&nbsp;plt.figure(figsize=(15,&nbsp;10))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1555">1555</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quiver_scale&nbsp;=&nbsp;60</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1556">1556</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(0,&nbsp;len(markers)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1557">1557</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.scatter(self.UMAPsampleembedding3d[i,&nbsp;0],&nbsp;self.UMAPsampleembedding3d[i,&nbsp;1],&nbsp;marker=markers[i],&nbsp;c=self.colorandum[i],&nbsp;alpha=1,&nbsp;s=120,&nbsp;edgecolor=(0,0,0,1),&nbsp;lw=0.3,&nbsp;rasterized=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1558">1558</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quiver_kwargs=dict(headaxislength=7,&nbsp;headlength=13,&nbsp;headwidth=10,linewidths=0.5,&nbsp;width=0.005,edgecolors="k",&nbsp;color="black",&nbsp;alpha=1,&nbsp;angles='xy')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1559">1559</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.quiver(self.UMAPsampleembedding3d[i,&nbsp;0],&nbsp;self.UMAPsampleembedding3d[i,&nbsp;1],&nbsp;self.arrowUMAPembed3d[i,&nbsp;0],&nbsp;self.arrowUMAPembed3d[i,&nbsp;1],&nbsp;scale=quiver_scale,&nbsp;**quiver_kwargs)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1560">1560</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexy_codes&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1561">1561</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_keys&nbsp;=&nbsp;[k&nbsp;&nbsp;for&nbsp;&nbsp;k&nbsp;in&nbsp;&nbsp;self.cluster_colors_dict.keys()]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1562">1562</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_my_keys&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1563">1563</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;my_keys:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1564">1564</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_my_keys.append(str(item,'utf-8'))&nbsp;#int()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1565">1565</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmap2&nbsp;=&nbsp;cm.get_cmap('Paired')&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;PiYG</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1566">1566</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(cmap2.N):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1567">1567</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rgb&nbsp;=&nbsp;cmap2(i)[:3]&nbsp;#&nbsp;will&nbsp;return&nbsp;rgba,&nbsp;we&nbsp;take&nbsp;only&nbsp;first&nbsp;3&nbsp;so&nbsp;we&nbsp;get&nbsp;rgb</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1568">1568</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexy_codes.append(matplotlib.colors.rgb2hex(rgb))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1569">1569</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;legend_elements&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1570">1570</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined&nbsp;=&nbsp;list(zip(decoded_my_keys,&nbsp;hexy_codes))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1571">1571</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined&nbsp;=&nbsp;sorted(combined,&nbsp;key=itemgetter(0))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1572">1572</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(typegroup&nbsp;!=&nbsp;"Strings"):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1573">1573</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;timepoints&nbsp;=&nbsp;[int(i[0])&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1574">1574</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colys&nbsp;=&nbsp;[i[1]&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1575">1575</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tempDF&nbsp;=&nbsp;pd.DataFrame({'Group':timepoints,&nbsp;'colours':colys})</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1576">1576</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tempDF&nbsp;=&nbsp;tempDF.sort_values('Group')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1577">1577</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;groupys2&nbsp;=&nbsp;tempDF['Group'].tolist()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1578">1578</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cols2&nbsp;=&nbsp;tempDF['colours'].tolist()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1579">1579</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined&nbsp;=&nbsp;list(zip(groupys2,&nbsp;cols2))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1580">1580</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_my_keys&nbsp;=&nbsp;[i[0]&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1581">1581</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexy_codes&nbsp;=&nbsp;[i[1]&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1582">1582</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;sample_type&nbsp;in&nbsp;range(0,&nbsp;len(decoded_my_keys)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1583">1583</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to_add&nbsp;=&nbsp;Line2D([0],&nbsp;[0],&nbsp;marker='s',&nbsp;color='w',&nbsp;label=str(decoded_my_keys[sample_type]).strip('"'),&nbsp;markerfacecolor=str(hexy_codes[sample_type]),&nbsp;markersize=7)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1584">1584</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;legend_elements.append(to_add)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1585">1585</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;sample_type&nbsp;in&nbsp;range(0,&nbsp;len(mark)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1586">1586</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to_add&nbsp;=&nbsp;Line2D([0],&nbsp;[0],&nbsp;marker=[*my_types.values()][sample_type],&nbsp;color='w',&nbsp;label=str([*my_types.keys()][sample_type]).strip('"'),&nbsp;markerfacecolor='black',&nbsp;markersize=7)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1587">1587</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;legend_elements.append(to_add)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1588">1588</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.legend(handles=legend_elements,&nbsp;fancybox=True,&nbsp;framealpha=1,&nbsp;borderpad=1,&nbsp;loc=(1.01,0.5),&nbsp;title='Key')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1589">1589</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.xlabel('UMAP1')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1590">1590</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.ylabel('UMAP2')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1591">1591</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;figure_name&nbsp;=&nbsp;'UMAP3D_Arrow_UMAP1vsUMAP2_NN'&nbsp;+&nbsp;str(numberNeighb)&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(extraNNvalue)&nbsp;+&nbsp;'.png'</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1592">1592</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(figure_name)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1593">1593</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#UMAP1&nbsp;vs&nbsp;UMAP3</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1594">1594</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fig&nbsp;=&nbsp;plt.figure(figsize=(15,&nbsp;10))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1595">1595</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quiver_scale&nbsp;=&nbsp;60</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1596">1596</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(0,&nbsp;len(markers)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1597">1597</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.scatter(self.UMAPsampleembedding3d[i,&nbsp;0],&nbsp;self.UMAPsampleembedding3d[i,&nbsp;2],&nbsp;marker=markers[i],&nbsp;c=self.colorandum[i],&nbsp;alpha=1,&nbsp;s=120,&nbsp;edgecolor=(0,0,0,1),&nbsp;lw=0.3,&nbsp;rasterized=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1598">1598</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quiver_kwargs=dict(headaxislength=7,&nbsp;headlength=13,&nbsp;headwidth=10,linewidths=0.5,&nbsp;width=0.005,edgecolors="k",&nbsp;color="black",&nbsp;alpha=1,&nbsp;angles='xy')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1599">1599</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.quiver(self.UMAPsampleembedding3d[i,&nbsp;0],&nbsp;self.UMAPsampleembedding3d[i,&nbsp;2],&nbsp;self.arrowUMAPembed3d[i,&nbsp;0],&nbsp;self.arrowUMAPembed3d[i,&nbsp;2],&nbsp;scale=quiver_scale,&nbsp;**quiver_kwargs)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1600">1600</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexy_codes&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1601">1601</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_keys&nbsp;=&nbsp;[k&nbsp;&nbsp;for&nbsp;&nbsp;k&nbsp;in&nbsp;&nbsp;self.cluster_colors_dict.keys()]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1602">1602</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_my_keys&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1603">1603</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;my_keys:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1604">1604</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_my_keys.append(str(item,'utf-8'))&nbsp;#int()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1605">1605</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmap2&nbsp;=&nbsp;cm.get_cmap('Paired')&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;PiYG</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1606">1606</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(cmap2.N):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1607">1607</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rgb&nbsp;=&nbsp;cmap2(i)[:3]&nbsp;#&nbsp;will&nbsp;return&nbsp;rgba,&nbsp;we&nbsp;take&nbsp;only&nbsp;first&nbsp;3&nbsp;so&nbsp;we&nbsp;get&nbsp;rgb</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1608">1608</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexy_codes.append(matplotlib.colors.rgb2hex(rgb))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1609">1609</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;legend_elements&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1610">1610</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined&nbsp;=&nbsp;list(zip(decoded_my_keys,&nbsp;hexy_codes))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1611">1611</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined&nbsp;=&nbsp;sorted(combined,&nbsp;key=itemgetter(0))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1612">1612</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(typegroup&nbsp;!=&nbsp;"Strings"):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1613">1613</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;timepoints&nbsp;=&nbsp;[int(i[0])&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1614">1614</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colys&nbsp;=&nbsp;[i[1]&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1615">1615</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tempDF&nbsp;=&nbsp;pd.DataFrame({'Group':timepoints,&nbsp;'colours':colys})</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1616">1616</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tempDF&nbsp;=&nbsp;tempDF.sort_values('Group')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1617">1617</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;groupys2&nbsp;=&nbsp;tempDF['Group'].tolist()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1618">1618</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cols2&nbsp;=&nbsp;tempDF['colours'].tolist()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1619">1619</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined&nbsp;=&nbsp;list(zip(groupys2,&nbsp;cols2))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1620">1620</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_my_keys&nbsp;=&nbsp;[i[0]&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1621">1621</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexy_codes&nbsp;=&nbsp;[i[1]&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1622">1622</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;sample_type&nbsp;in&nbsp;range(0,&nbsp;len(decoded_my_keys)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1623">1623</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to_add&nbsp;=&nbsp;Line2D([0],&nbsp;[0],&nbsp;marker='s',&nbsp;color='w',&nbsp;label=str(decoded_my_keys[sample_type]).strip('"'),&nbsp;markerfacecolor=str(hexy_codes[sample_type]),&nbsp;markersize=7)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1624">1624</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;legend_elements.append(to_add)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1625">1625</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;sample_type&nbsp;in&nbsp;range(0,&nbsp;len(mark)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1626">1626</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to_add&nbsp;=&nbsp;Line2D([0],&nbsp;[0],&nbsp;marker=[*my_types.values()][sample_type],&nbsp;color='w',&nbsp;label=str([*my_types.keys()][sample_type]).strip('"'),&nbsp;markerfacecolor='black',&nbsp;markersize=7)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1627">1627</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;legend_elements.append(to_add)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1628">1628</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.legend(handles=legend_elements,&nbsp;fancybox=True,&nbsp;framealpha=1,&nbsp;borderpad=1,&nbsp;loc=(1.01,0.5),&nbsp;title='Key')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1629">1629</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.xlabel('UMAP1')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1630">1630</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.ylabel('UMAP3')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1631">1631</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;figure_name&nbsp;=&nbsp;'UMAP3D_Arrow_UMAP1vsUMAP3_NN'&nbsp;+&nbsp;str(numberNeighb)&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(extraNNvalue)&nbsp;+&nbsp;'.png'</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1632">1632</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(figure_name)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1633">1633</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#UMAP2&nbsp;vs&nbsp;UMAP3</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1634">1634</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fig&nbsp;=&nbsp;plt.figure(figsize=(15,&nbsp;10))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1635">1635</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quiver_scale&nbsp;=&nbsp;60</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1636">1636</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(0,&nbsp;len(markers)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1637">1637</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.scatter(self.UMAPsampleembedding3d[i,&nbsp;1],&nbsp;self.UMAPsampleembedding3d[i,&nbsp;2],&nbsp;marker=markers[i],&nbsp;c=self.colorandum[i],&nbsp;alpha=1,&nbsp;s=120,&nbsp;edgecolor=(0,0,0,1),&nbsp;lw=0.3,&nbsp;rasterized=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1638">1638</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quiver_kwargs=dict(headaxislength=7,&nbsp;headlength=13,&nbsp;headwidth=10,linewidths=0.5,&nbsp;width=0.005,edgecolors="k",&nbsp;color="black",&nbsp;alpha=1,&nbsp;angles='xy')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1639">1639</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.quiver(self.UMAPsampleembedding3d[i,&nbsp;1],&nbsp;self.UMAPsampleembedding3d[i,&nbsp;2],&nbsp;self.arrowUMAPembed3d[i,&nbsp;1],&nbsp;self.arrowUMAPembed3d[i,&nbsp;2],&nbsp;scale=quiver_scale,&nbsp;**quiver_kwargs)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1640">1640</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexy_codes&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1641">1641</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_keys&nbsp;=&nbsp;[k&nbsp;&nbsp;for&nbsp;&nbsp;k&nbsp;in&nbsp;&nbsp;self.cluster_colors_dict.keys()]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1642">1642</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_my_keys&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1643">1643</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;my_keys:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1644">1644</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_my_keys.append(str(item,'utf-8'))&nbsp;#int()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1645">1645</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmap2&nbsp;=&nbsp;cm.get_cmap('Paired')&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;PiYG</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1646">1646</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(cmap2.N):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1647">1647</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rgb&nbsp;=&nbsp;cmap2(i)[:3]&nbsp;#&nbsp;will&nbsp;return&nbsp;rgba,&nbsp;we&nbsp;take&nbsp;only&nbsp;first&nbsp;3&nbsp;so&nbsp;we&nbsp;get&nbsp;rgb</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1648">1648</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexy_codes.append(matplotlib.colors.rgb2hex(rgb))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1649">1649</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;legend_elements&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1650">1650</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined&nbsp;=&nbsp;list(zip(decoded_my_keys,&nbsp;hexy_codes))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1651">1651</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined&nbsp;=&nbsp;sorted(combined,&nbsp;key=itemgetter(0))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1652">1652</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_my_keys&nbsp;=&nbsp;[i[0]&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1653">1653</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(typegroup&nbsp;!=&nbsp;"Strings"):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1654">1654</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;timepoints&nbsp;=&nbsp;[int(i[0])&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1655">1655</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colys&nbsp;=&nbsp;[i[1]&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1656">1656</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tempDF&nbsp;=&nbsp;pd.DataFrame({'Group':timepoints,&nbsp;'colours':colys})</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1657">1657</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tempDF&nbsp;=&nbsp;tempDF.sort_values('Group')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1658">1658</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;groupys2&nbsp;=&nbsp;tempDF['Group'].tolist()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1659">1659</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cols2&nbsp;=&nbsp;tempDF['colours'].tolist()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1660">1660</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined&nbsp;=&nbsp;list(zip(groupys2,&nbsp;cols2))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1661">1661</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexy_codes&nbsp;=&nbsp;[i[1]&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1662">1662</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;sample_type&nbsp;in&nbsp;range(0,&nbsp;len(decoded_my_keys)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1663">1663</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to_add&nbsp;=&nbsp;Line2D([0],&nbsp;[0],&nbsp;marker='s',&nbsp;color='w',&nbsp;label=str(decoded_my_keys[sample_type]).strip('"'),&nbsp;markerfacecolor=str(hexy_codes[sample_type]),&nbsp;markersize=7)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1664">1664</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;legend_elements.append(to_add)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1665">1665</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;sample_type&nbsp;in&nbsp;range(0,&nbsp;len(mark)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1666">1666</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to_add&nbsp;=&nbsp;Line2D([0],&nbsp;[0],&nbsp;marker=[*my_types.values()][sample_type],&nbsp;color='w',&nbsp;label=str([*my_types.keys()][sample_type]).strip('"'),&nbsp;markerfacecolor='black',&nbsp;markersize=7)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1667">1667</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;legend_elements.append(to_add)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1668">1668</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.legend(handles=legend_elements,&nbsp;fancybox=True,&nbsp;framealpha=1,&nbsp;borderpad=1,&nbsp;loc=(1.01,0.5),&nbsp;title='Key')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1669">1669</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.xlabel('UMAP2')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1670">1670</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.ylabel('UMAP3')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1671">1671</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;figure_name&nbsp;=&nbsp;'UMAP3D_Arrow_UMAP2vsUMAP3_NN'&nbsp;+&nbsp;str(numberNeighb)&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(extraNNvalue)&nbsp;+&nbsp;'.png'</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1672">1672</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(figure_name)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1673">1673</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1674">1674</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_934">934</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;_perform_PCA_imputed(self,&nbsp;n_components:&nbsp;int=None)&nbsp;-&gt;&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_1675">1675</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;_perform_PCA_imputed(self,&nbsp;n_components:&nbsp;int=None)&nbsp;-&gt;&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_935">935</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Simply&nbsp;performs&nbsp;PCA&nbsp;of&nbsp;`Sx_norm`&nbsp;and&nbsp;save&nbsp;the&nbsp;result&nbsp;as&nbsp;&nbsp;`pcax`"""</td><td class="diff_next"></td><td class="diff_header" id="to0_1676">1676</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Simply&nbsp;performs&nbsp;PCA&nbsp;of&nbsp;`Sx_norm`&nbsp;and&nbsp;save&nbsp;the&nbsp;result&nbsp;as&nbsp;&nbsp;`pcax`"""</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_936">936</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.pcax&nbsp;=&nbsp;PCA(n_components=n_components)</td><td class="diff_next"></td><td class="diff_header" id="to0_1677">1677</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.pcax&nbsp;=&nbsp;PCA(n_components=n_components)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_937">937</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.pcsx&nbsp;=&nbsp;self.pcax.fit_transform(self.Sx_norm.T)</td><td class="diff_next"></td><td class="diff_header" id="to0_1678">1678</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.pcsx&nbsp;=&nbsp;self.pcax.fit_transform(self.Sx_norm.T)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_938">938</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1679">1679</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_939">939</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;_plot_pca_imputed(self,&nbsp;dim:&nbsp;List[int]=[0,&nbsp;1,&nbsp;2],&nbsp;elev:&nbsp;float=60,&nbsp;azim:&nbsp;float=-140)&nbsp;-&gt;&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_1680">1680</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;_plot_pca_imputed(self,&nbsp;dim:&nbsp;List[int]=[0,&nbsp;1,&nbsp;2],&nbsp;elev:&nbsp;float=60,&nbsp;azim:&nbsp;float=-140)&nbsp;-&gt;&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_940">940</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Plot&nbsp;3d&nbsp;PCA&nbsp;of&nbsp;the&nbsp;smoothed&nbsp;data</td><td class="diff_next"></td><td class="diff_header" id="to0_1681">1681</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Plot&nbsp;3d&nbsp;PCA&nbsp;of&nbsp;the&nbsp;smoothed&nbsp;data</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_941">941</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_1682">1682</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_942">942</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fig&nbsp;=&nbsp;plt.figure(figsize=(8,&nbsp;6))</td><td class="diff_next"></td><td class="diff_header" id="to0_1683">1683</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fig&nbsp;=&nbsp;plt.figure(figsize=(8,&nbsp;6))</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_943">943</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax&nbsp;=&nbsp;fig.add_subplot(111,&nbsp;projection='3d')</td><td class="diff_next"></td><td class="diff_header" id="to0_1684">1684</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax&nbsp;=&nbsp;fig.add_subplot(111,&nbsp;projection='3d')</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_944">944</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.scatter(self.pcsx[:,&nbsp;dim[0]],</td><td class="diff_next"></td><td class="diff_header" id="to0_1685">1685</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.scatter(self.pcsx[:,&nbsp;dim[0]],</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__30"></td><td class="diff_header" id="from0_945">945</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.pcsx[:,&nbsp;dim[1]],</td><td class="diff_next"></td><td class="diff_header" id="to0_1686">1686</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.pcsx[:,&nbsp;dim[1]],</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_946">946</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.pcsx[:,&nbsp;dim[2]],</td><td class="diff_next"></td><td class="diff_header" id="to0_1687">1687</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.pcsx[:,&nbsp;dim[2]],</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_947">947</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c=self.colorandum)</td><td class="diff_next"></td><td class="diff_header" id="to0_1688">1688</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c=self.colorandum)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_948">948</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.view_init(elev=elev,&nbsp;azim=azim)</td><td class="diff_next"></td><td class="diff_header" id="to0_1689">1689</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax.view_init(elev=elev,&nbsp;azim=azim)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_949">949</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1690">1690</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__31">n</a></td><td class="diff_header" id="from0_950">950</td><td nowrap="nowrap"><span class="diff_sub">[docs]&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;knn_imputation(self,&nbsp;k:&nbsp;int=None,&nbsp;pca_space:&nbsp;float=True,&nbsp;metric:&nbsp;str="euclidean",&nbsp;diag:&nbsp;float=1,</span></td><td class="diff_next"><a href="#difflib_chg_to0__31">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__31"></td><td class="diff_header" id="from0_951">951</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_pca_dims:&nbsp;int=None,&nbsp;maximum:&nbsp;bool=False,&nbsp;size_norm:&nbsp;bool=True,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_952">952</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;balanced:&nbsp;bool=False,&nbsp;b_sight:&nbsp;int=None,&nbsp;b_maxl:&nbsp;int=None,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_953">953</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;group_constraint:&nbsp;Union[str,&nbsp;np.ndarray]=None,&nbsp;n_jobs:&nbsp;int=8)&nbsp;-&gt;&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_954">954</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Performs&nbsp;k-nn&nbsp;smoothing&nbsp;of&nbsp;the&nbsp;data&nbsp;matrix</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_955">955</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1691">1691</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__32">n</a></td><td class="diff_header" id="from0_956">956</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</span></td><td class="diff_next"><a href="#difflib_chg_to0__32">n</a></td><td class="diff_header" id="to0_1692">1692</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_957">957</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_958">958</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k:&nbsp;int</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_959">959</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;neighbors.&nbsp;If&nbsp;None&nbsp;the&nbsp;default&nbsp;it&nbsp;is&nbsp;chosen&nbsp;to&nbsp;be&nbsp;`0.025&nbsp;*&nbsp;Ncells`</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_960">960</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pca_space:&nbsp;bool,&nbsp;default=True</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_961">961</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;True&nbsp;the&nbsp;knn&nbsp;will&nbsp;be&nbsp;performed&nbsp;in&nbsp;PCA&nbsp;space&nbsp;(`pcs`)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_962">962</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherwise&nbsp;it&nbsp;will&nbsp;use&nbsp;log2&nbsp;size&nbsp;normalized&nbsp;data&nbsp;&nbsp;(`S_norm`)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_963">963</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;metric:&nbsp;str</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_964">964</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"euclidean"&nbsp;or&nbsp;"correlation"</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_965">965</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;diag:&nbsp;int,&nbsp;default=1</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_966">966</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;before&nbsp;smoothing&nbsp;this&nbsp;value&nbsp;is&nbsp;substituted&nbsp;in&nbsp;the&nbsp;diagonal&nbsp;of&nbsp;the&nbsp;knn&nbsp;contiguity&nbsp;matrix</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_967">967</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Resulting&nbsp;in&nbsp;a&nbsp;reduction&nbsp;of&nbsp;the&nbsp;smoothing&nbsp;effect.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_968">968</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E.g.&nbsp;if&nbsp;diag=8&nbsp;and&nbsp;k=10&nbsp;value&nbsp;of&nbsp;Si&nbsp;=&nbsp;(8&nbsp;*&nbsp;S_i&nbsp;+&nbsp;sum(S_n,&nbsp;with&nbsp;n&nbsp;in&nbsp;5nn&nbsp;of&nbsp;i))&nbsp;/&nbsp;(8+5)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_969">969</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maximum:&nbsp;bool,&nbsp;default=False</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_970">970</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;True&nbsp;the&nbsp;maximum&nbsp;value&nbsp;of&nbsp;the&nbsp;smoothing&nbsp;and&nbsp;the&nbsp;original&nbsp;matrix&nbsp;entry&nbsp;is&nbsp;taken.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_971">971</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_pca_dims:&nbsp;int,&nbsp;default=None</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_972">972</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;pca&nbsp;to&nbsp;use&nbsp;for&nbsp;the&nbsp;knn&nbsp;distance&nbsp;metric.&nbsp;If&nbsp;None&nbsp;all&nbsp;pcs&nbsp;will&nbsp;be&nbsp;used.&nbsp;(used&nbsp;only&nbsp;if&nbsp;pca_space&nbsp;==&nbsp;True)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_973">973</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;balanced:&nbsp;bool</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_974">974</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whether&nbsp;to&nbsp;use&nbsp;BalancedKNN&nbsp;version</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_975">975</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b_sight:&nbsp;int</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_976">976</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;sight&nbsp;parameter&nbsp;of&nbsp;BalancedKNN&nbsp;(used&nbsp;only&nbsp;if&nbsp;balanced&nbsp;==&nbsp;True)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_977">977</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b_maxl:&nbsp;int</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_978">978</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;maxl&nbsp;parameter&nbsp;of&nbsp;BalancedKNN&nbsp;(used&nbsp;only&nbsp;if&nbsp;balanced&nbsp;==&nbsp;True)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_979">979</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;group_constraint:&nbsp;str&nbsp;or&nbsp;np.ndarray[int]:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_980">980</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;currently&nbsp;implemented&nbsp;only&nbsp;for&nbsp;balanced&nbsp;=&nbsp;True</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__32"></td><td class="diff_header" id="from0_981">981</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;"clusters"&nbsp;the&nbsp;the&nbsp;clusters&nbsp;will&nbsp;be&nbsp;used&nbsp;as&nbsp;a&nbsp;constraint&nbsp;so&nbsp;that&nbsp;cells&nbsp;of&nbsp;different&nbsp;clusters&nbsp;cannot&nbsp;be&nbsp;neighbors</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_982">982</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;an&nbsp;array&nbsp;of&nbsp;integers&nbsp;of&nbsp;shape&nbsp;vlm.S.shape[1]&nbsp;it&nbsp;will&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;labels&nbsp;of&nbsp;the&nbsp;groups</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_983">983</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_jobs:&nbsp;int,&nbsp;default&nbsp;8</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_984">984</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;parallel&nbsp;jobs&nbsp;in&nbsp;knn&nbsp;calculation</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_985">985</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1693">1693</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__33">n</a></td><td class="diff_header" id="from0_986">986</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</span></td><td class="diff_next"><a href="#difflib_chg_to0__33">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_987">987</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_988">988</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;but&nbsp;it&nbsp;creates&nbsp;the&nbsp;attributes:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_989">989</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;knn:&nbsp;scipy.sparse.csr_matrix</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_990">990</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;knn&nbsp;contiguity&nbsp;matrix</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_991">991</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;knn_smoothing_w:&nbsp;scipy.sparse.lil_matrix</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_992">992</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;weights&nbsp;used&nbsp;for&nbsp;the&nbsp;smoothing</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_993">993</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sx:&nbsp;np.ndarray</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_994">994</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smoothed&nbsp;spliced</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_995">995</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ux:&nbsp;np.ndarray</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_996">996</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smoothed&nbsp;unspliced</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_997">997</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_998">998</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_999">999</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N&nbsp;=&nbsp;self.S.shape[1]</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1000">1000</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;k&nbsp;is&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1001">1001</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k&nbsp;=&nbsp;int(N&nbsp;*&nbsp;0.025)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1002">1002</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;b_sight&nbsp;is&nbsp;None&nbsp;and&nbsp;balanced:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1003">1003</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b_sight&nbsp;=&nbsp;np.maximum(int(k&nbsp;*&nbsp;8),&nbsp;N&nbsp;-&nbsp;1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1004">1004</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;b_maxl&nbsp;is&nbsp;None&nbsp;and&nbsp;balanced:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1005">1005</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b_maxl&nbsp;=&nbsp;np.maximum(int(k&nbsp;*&nbsp;4),&nbsp;N&nbsp;-&nbsp;1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1006">1006</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;pca_space:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1007">1007</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;space&nbsp;=&nbsp;self.pcs[:,&nbsp;:n_pca_dims]</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1008">1008</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1009">1009</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;space&nbsp;=&nbsp;self.S_norm.T</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1010">1010</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;balanced:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1011">1011</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;group_constraint&nbsp;is&nbsp;not&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1012">1012</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;isinstance(group_constraint,&nbsp;str)&nbsp;and&nbsp;group_constraint&nbsp;==&nbsp;"clusters":</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1013">1013</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constraint&nbsp;=&nbsp;np.array(self.cluster_ix)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1014">1014</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bknn&nbsp;=&nbsp;BalancedKNN(k=k,&nbsp;sight_k=b_sight,&nbsp;maxl=b_maxl,&nbsp;metric=metric,&nbsp;constraint=constraint,&nbsp;mode="distance",&nbsp;n_jobs=n_jobs)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1015">1015</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1016">1016</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bknn&nbsp;=&nbsp;BalancedKNN(k=k,&nbsp;sight_k=b_sight,&nbsp;maxl=b_maxl,&nbsp;metric=metric,&nbsp;mode="distance",&nbsp;n_jobs=n_jobs)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1017">1017</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bknn.fit(space)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1018">1018</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.knn&nbsp;=&nbsp;bknn.kneighbors_graph(mode="distance")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1019">1019</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1020">1020</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;group_constraint&nbsp;is&nbsp;not&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1021">1021</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;ValueError("group_constraint&nbsp;is&nbsp;currently&nbsp;supported&nbsp;only&nbsp;if&nbsp;the&nbsp;argument&nbsp;balanced&nbsp;is&nbsp;set&nbsp;to&nbsp;True")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1022">1022</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.knn&nbsp;=&nbsp;knn_distance_matrix(space,&nbsp;metric=metric,&nbsp;k=k,&nbsp;mode="distance",&nbsp;n_jobs=n_jobs)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1023">1023</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connectivity&nbsp;=&nbsp;(self.knn&nbsp;&gt;&nbsp;0).astype(float)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1024">1024</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;warnings.catch_warnings():</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1025">1025</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warnings.simplefilter("ignore")&nbsp;&nbsp;#&nbsp;SparseEfficiencyWarning:&nbsp;Changing&nbsp;the&nbsp;sparsity&nbsp;structure&nbsp;of&nbsp;a&nbsp;csr_matrix&nbsp;is&nbsp;expensive.&nbsp;lil_matrix&nbsp;is&nbsp;more&nbsp;efficient.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1026">1026</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connectivity.setdiag(diag)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1027">1027</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.knn_smoothing_w&nbsp;=&nbsp;connectivity_to_weights(connectivity)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1028">1028</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;size_norm:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1029">1029</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Sx&nbsp;=&nbsp;convolve_by_sparse_weights(self.S_sz,&nbsp;self.knn_smoothing_w)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1030">1030</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Ux&nbsp;=&nbsp;convolve_by_sparse_weights(self.U_sz,&nbsp;self.knn_smoothing_w)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1031">1031</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1032">1032</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Sx&nbsp;=&nbsp;convolve_by_sparse_weights(self.S,&nbsp;self.knn_smoothing_w)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__33"></td><td class="diff_header" id="from0_1033">1033</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Ux&nbsp;=&nbsp;convolve_by_sparse_weights(self.U,&nbsp;self.knn_smoothing_w)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1034">1034</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;maximum:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1035">1035</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Sx&nbsp;=&nbsp;np.maximum(self.S_sz,&nbsp;self.Sx)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1036">1036</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Ux&nbsp;=&nbsp;np.maximum(self.U_sz,&nbsp;self.Ux)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1037">1037</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1694">1694</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__34">n</a></td><td class="diff_header" id="from0_1038">1038</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Make&nbsp;a&nbsp;differently&nbsp;named&nbsp;varaible&nbsp;for&nbsp;backwards&nbsp;compatibility</span></td><td class="diff_next"><a href="#difflib_chg_to0__34">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1039">1039</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Sx_sz&nbsp;=&nbsp;np.copy(self.Sx)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1040">1040</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Ux_sz&nbsp;=&nbsp;np.copy(self.Ux)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1041">1041</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1042">1042</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1043">1043</td><td nowrap="nowrap"><span class="diff_sub">[docs]&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;knn_imputation_precomputed(self,&nbsp;knn_smoothing_w:&nbsp;sparse.lil_matrix,&nbsp;maximum:&nbsp;bool=False)&nbsp;-&gt;&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1044">1044</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Performs&nbsp;k-nn&nbsp;imputation&nbsp;(like&nbsp;`.knn_imputation()`)&nbsp;but&nbsp;with&nbsp;a&nbsp;precomputed&nbsp;weight&nbsp;matrix</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1045">1045</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1046">1046</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1047">1047</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1048">1048</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;knn_smoothing_w:&nbsp;sparse.lil_matrix</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1049">1049</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;sparse&nbsp;matrix&nbsp;to&nbsp;be&nbsp;convolved&nbsp;with&nbsp;self.S_sz&nbsp;and&nbsp;self.U_sz</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1050">1050</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;should&nbsp;be&nbsp;the&nbsp;result&nbsp;of&nbsp;something&nbsp;like:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1051">1051</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connectivity.setdiag(diagonal_value)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1052">1052</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;knn_smoothing_w&nbsp;=&nbsp;connectivity_to_weights(connectivity)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1053">1053</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maximum:&nbsp;bool,&nbsp;default=False</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1054">1054</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whether&nbsp;to&nbsp;take&nbsp;the&nbsp;maximum&nbsp;value&nbsp;of&nbsp;the&nbsp;smoothing&nbsp;and&nbsp;the&nbsp;original&nbsp;matrix</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1055">1055</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1056">1056</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1057">1057</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1058">1058</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;but&nbsp;it&nbsp;creates&nbsp;the&nbsp;attributes:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1059">1059</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sx:&nbsp;np.ndarray</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1060">1060</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smoothed&nbsp;spliced</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1061">1061</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ux:&nbsp;np.ndarray</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1062">1062</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smoothed&nbsp;unspliced</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1063">1063</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1064">1064</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Sx&nbsp;=&nbsp;convolve_by_sparse_weights(self.S_sz,&nbsp;knn_smoothing_w)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1065">1065</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Ux&nbsp;=&nbsp;convolve_by_sparse_weights(self.U_sz,&nbsp;knn_smoothing_w)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1066">1066</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;maximum:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1067">1067</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Sx&nbsp;=&nbsp;np.maximum(self.S_sz,&nbsp;self.Sx)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1068">1068</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Ux&nbsp;=&nbsp;np.maximum(self.U_sz,&nbsp;self.Ux)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1069">1069</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1070">1070</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Sx_sz&nbsp;=&nbsp;np.copy(self.Sx)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1071">1071</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Ux_sz&nbsp;=&nbsp;np.copy(self.Ux)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1072">1072</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1073">1073</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1074">1074</td><td nowrap="nowrap"><span class="diff_sub">[docs]&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;gene_knn_imputation(self,&nbsp;k:&nbsp;int=15,&nbsp;pca_space:&nbsp;float=False,&nbsp;metric:&nbsp;str="correlation",&nbsp;diag:&nbsp;float=1,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1075">1075</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scale_weights:&nbsp;bool=True,&nbsp;balanced:&nbsp;bool=True,&nbsp;b_sight:&nbsp;int=100,&nbsp;b_maxl:&nbsp;int=18,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1076">1076</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_jobs:&nbsp;int=8)&nbsp;-&gt;&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1077">1077</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Performs&nbsp;genes&nbsp;k-nn&nbsp;smoothing&nbsp;of&nbsp;the&nbsp;genes</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1078">1078</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1079">1079</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1080">1080</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1081">1081</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k:&nbsp;int,&nbsp;default=15</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1082">1082</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;neighbors</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1083">1083</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pca_space:&nbsp;bool,&nbsp;default=False</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1084">1084</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;True&nbsp;the&nbsp;knn&nbsp;will&nbsp;be&nbsp;performed&nbsp;in&nbsp;PCA&nbsp;space&nbsp;(`pcs`)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1085">1085</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherwise&nbsp;it&nbsp;will&nbsp;use&nbsp;log2&nbsp;size&nbsp;normalized&nbsp;data&nbsp;&nbsp;(`S_norm`)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1086">1086</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;metric:&nbsp;str,&nbsp;default="correlation"</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1087">1087</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"euclidean"&nbsp;or&nbsp;"correlation"</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1088">1088</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;diag:&nbsp;int,&nbsp;default=1</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1089">1089</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;before&nbsp;smoothing&nbsp;this&nbsp;value&nbsp;is&nbsp;substituted&nbsp;in&nbsp;the&nbsp;diagonal&nbsp;of&nbsp;the&nbsp;knn&nbsp;contiguity&nbsp;matrix</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1090">1090</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Resulting&nbsp;in&nbsp;a&nbsp;reduction&nbsp;of&nbsp;the&nbsp;smoothing&nbsp;effect</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1091">1091</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E.g.&nbsp;if&nbsp;diag=8&nbsp;and&nbsp;k=10&nbsp;value&nbsp;of&nbsp;Si&nbsp;=&nbsp;(8&nbsp;*&nbsp;S_i&nbsp;+&nbsp;sum(S_n,&nbsp;with&nbsp;n&nbsp;in&nbsp;5nn&nbsp;of&nbsp;i))&nbsp;/&nbsp;(8+5)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1092">1092</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scale_weights:&nbsp;bool,&nbsp;default=True</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1093">1093</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whether&nbsp;to&nbsp;scale&nbsp;weights&nbsp;by&nbsp;gene&nbsp;total&nbsp;expression/yield</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1094">1094</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;balanced:&nbsp;bool,&nbsp;default=True</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1095">1095</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whether&nbsp;to&nbsp;use&nbsp;BalancedKNN&nbsp;version</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1096">1096</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b_sight:&nbsp;int,&nbsp;default=100</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1097">1097</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;sight&nbsp;parameter&nbsp;of&nbsp;BalancedKNN&nbsp;(used&nbsp;only&nbsp;if&nbsp;balanced&nbsp;==&nbsp;True)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1098">1098</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b_maxl:&nbsp;int,&nbsp;default=18</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1099">1099</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;maxl&nbsp;parameter&nbsp;of&nbsp;BalancedKNN&nbsp;(used&nbsp;only&nbsp;if&nbsp;balanced&nbsp;==&nbsp;True)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1100">1100</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_jobs:&nbsp;int,&nbsp;default=8</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1101">1101</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;parallel&nbsp;jobs&nbsp;in&nbsp;knn&nbsp;calculation</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1102">1102</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1103">1103</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1104">1104</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1105">1105</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;but&nbsp;it&nbsp;creates&nbsp;the&nbsp;attributes:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1106">1106</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gknn:&nbsp;scipy.sparse.csr_matrix</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1107">1107</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genes&nbsp;knn&nbsp;contiguity&nbsp;matrix</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1108">1108</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gknn_smoothing_w:&nbsp;scipy.sparse.lil_matrix</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1109">1109</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;weights&nbsp;used&nbsp;for&nbsp;the&nbsp;smoothing&nbsp;of&nbsp;the&nbsp;genes</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1110">1110</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sx:&nbsp;np.ndarray</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1111">1111</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smoothed&nbsp;spliced</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1112">1112</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ux:&nbsp;np.ndarray</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1113">1113</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smoothed&nbsp;unspliced</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1114">1114</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1115">1115</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1116">1116</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;pca_space:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1117">1117</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assert&nbsp;NotImplementedError</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1118">1118</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1119">1119</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;space&nbsp;=&nbsp;self.Sx_sz&nbsp;&nbsp;#&nbsp;imputed&nbsp;size&nbsp;normalized&nbsp;counts</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1120">1120</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;balanced:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1121">1121</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bknn&nbsp;=&nbsp;BalancedKNN(k=k,&nbsp;sight_k=b_sight,&nbsp;maxl=b_maxl,&nbsp;mode="distance",&nbsp;metric=metric,&nbsp;n_jobs=n_jobs)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1122">1122</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bknn.fit(space)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1123">1123</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.gknn&nbsp;=&nbsp;bknn.kneighbors_graph(mode="distance")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1124">1124</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1125">1125</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.gknn&nbsp;=&nbsp;knn_distance_matrix(space,&nbsp;metric=metric,&nbsp;k=k,&nbsp;mode="distance",&nbsp;n_jobs=n_jobs)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1126">1126</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connectivity&nbsp;=&nbsp;(self.knn&nbsp;&gt;&nbsp;0).astype(float)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1127">1127</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;warnings.catch_warnings():</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1128">1128</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warnings.simplefilter("ignore")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1129">1129</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connectivity.setdiag(diag)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1130">1130</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.gknn_smoothing_w&nbsp;=&nbsp;connectivity_to_weights(connectivity).tocsr()</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1131">1131</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1132">1132</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;scale_weights:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1133">1133</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genes_total&nbsp;=&nbsp;space.sum(1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1134">1134</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.gknn_smoothing_w&nbsp;=&nbsp;scale_to_match_median(self.gknn_smoothing_w,&nbsp;genes_total)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1135">1135</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;NOTE&nbsp;This&nbsp;might&nbsp;be&nbsp;not&nbsp;computationally&nbsp;efficient&nbsp;after&nbsp;transpose,&nbsp;maybe&nbsp;better&nbsp;to&nbsp;use&nbsp;csc&nbsp;for&nbsp;the&nbsp;genes</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1136">1136</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Sx_sz&nbsp;=&nbsp;convolve_by_sparse_weights(self.Sx_sz.T,&nbsp;self.gknn_smoothing_w).T</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1137">1137</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Ux_sz&nbsp;=&nbsp;convolve_by_sparse_weights(self.Ux_sz.T,&nbsp;self.gknn_smoothing_w).T</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1138">1138</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1139">1139</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1140">1140</td><td nowrap="nowrap"><span class="diff_sub">[docs]</span>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;fit_gammas(self,&nbsp;steady_state_bool:&nbsp;np.ndarray=None,&nbsp;use_imputed_data:&nbsp;bool=True,&nbsp;use_size_norm:&nbsp;bool=<span class="diff_chg">Tru</span>e,</td><td class="diff_next"></td><td class="diff_header" id="to0_1695">1695</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;fit_gammas(self,&nbsp;steady_state_bool:&nbsp;np.ndarray=None,&nbsp;use_imputed_data:&nbsp;bool=True,&nbsp;use_size_norm:&nbsp;bool=<span class="diff_chg">Fals</span>e,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1141">1141</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fit_offset:&nbsp;bool=True,&nbsp;fixperc_q:&nbsp;bool=False,&nbsp;weighted:&nbsp;bool=True,&nbsp;weights:&nbsp;np.ndarray&nbsp;=&nbsp;"maxmin_diag",</td><td class="diff_next"></td><td class="diff_header" id="to0_1696">1696</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fit_offset:&nbsp;bool=True,&nbsp;fixperc_q:&nbsp;bool=False,&nbsp;weighted:&nbsp;bool=True,&nbsp;weights:&nbsp;np.ndarray&nbsp;=&nbsp;"maxmin_diag",</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1142">1142</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;limit_gamma:&nbsp;bool=False,&nbsp;maxmin_perc:&nbsp;List[float]=[2,&nbsp;98],&nbsp;maxmin_weighted_pow:&nbsp;float=15)&nbsp;-&gt;&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_1697">1697</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;limit_gamma:&nbsp;bool=False,&nbsp;maxmin_perc:&nbsp;List[float]=[2,&nbsp;98],&nbsp;maxmin_weighted_pow:&nbsp;float=15)&nbsp;-&gt;&nbsp;None:</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__34"></td><td class="diff_header" id="from0_1143">1143</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Fit&nbsp;gamma&nbsp;using&nbsp;spliced&nbsp;and&nbsp;unspliced&nbsp;data</td><td class="diff_next"></td><td class="diff_header" id="to0_1698">1698</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Fit&nbsp;gamma&nbsp;using&nbsp;spliced&nbsp;and&nbsp;unspliced&nbsp;data</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1144">1144</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1699">1699</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1145">1145</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td><td class="diff_next"></td><td class="diff_header" id="to0_1700">1700</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1146">1146</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td><td class="diff_next"></td><td class="diff_header" id="to0_1701">1701</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1147">1147</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;steady_state_bool:&nbsp;np.ndarray,&nbsp;default=None</td><td class="diff_next"></td><td class="diff_header" id="to0_1702">1702</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;steady_state_bool:&nbsp;np.ndarray,&nbsp;default=None</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__35">n</a></td><td class="diff_header" id="from0_1148">1148</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;a&nbsp;boolean&nbsp;array&nbsp;is&nbsp;specified,&nbsp;gamma&nbsp;is&nbsp;fitted&nbsp;using&nbsp;only&nbsp;the&nbsp;corresponding&nbsp;<span class="diff_chg">c</span>e<span class="diff_sub">ll</span>s</td><td class="diff_next"><a href="#difflib_chg_to0__35">n</a></td><td class="diff_header" id="to0_1703">1703</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;a&nbsp;boolean&nbsp;array&nbsp;is&nbsp;specified,&nbsp;gamma&nbsp;is&nbsp;fitted&nbsp;using&nbsp;only&nbsp;the&nbsp;corresponding&nbsp;<span class="diff_chg">sampl</span>es</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1149">1149</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;use_imputed_data:&nbsp;bool,&nbsp;default=True</td><td class="diff_next"></td><td class="diff_header" id="to0_1704">1704</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;use_imputed_data:&nbsp;bool,&nbsp;default=True</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1150">1150</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;use&nbsp;knn&nbsp;smoothed&nbsp;data</td><td class="diff_next"></td><td class="diff_header" id="to0_1705">1705</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;use&nbsp;knn&nbsp;smoothed&nbsp;data</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1151">1151</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;use_size_norm:&nbsp;bool,&nbsp;default=False</td><td class="diff_next"></td><td class="diff_header" id="to0_1706">1706</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;use_size_norm:&nbsp;bool,&nbsp;default=False</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1152">1152</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;use&nbsp;size&nbsp;normalized&nbsp;data&nbsp;for&nbsp;the&nbsp;fit</td><td class="diff_next"></td><td class="diff_header" id="to0_1707">1707</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;use&nbsp;size&nbsp;normalized&nbsp;data&nbsp;for&nbsp;the&nbsp;fit</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1153">1153</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fit_offset:&nbsp;bool,&nbsp;default=True</td><td class="diff_next"></td><td class="diff_header" id="to0_1708">1708</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fit_offset:&nbsp;bool,&nbsp;default=True</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1154">1154</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Fit&nbsp;with&nbsp;offset</td><td class="diff_next"></td><td class="diff_header" id="to0_1709">1709</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Fit&nbsp;with&nbsp;offset</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1155">1155</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fixperc_q:&nbsp;bool,&nbsp;default=False</td><td class="diff_next"></td><td class="diff_header" id="to0_1710">1710</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fixperc_q:&nbsp;bool,&nbsp;default=False</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1156">1156</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(when&nbsp;fit_offset==False)&nbsp;Wether&nbsp;to&nbsp;fix&nbsp;the&nbsp;offset&nbsp;to&nbsp;a&nbsp;lower&nbsp;percentile&nbsp;of&nbsp;the&nbsp;unspliced</td><td class="diff_next"></td><td class="diff_header" id="to0_1711">1711</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(when&nbsp;fit_offset==False)&nbsp;Wether&nbsp;to&nbsp;fix&nbsp;the&nbsp;offset&nbsp;to&nbsp;a&nbsp;lower&nbsp;percentile&nbsp;of&nbsp;the&nbsp;unspliced</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1157">1157</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weighted:&nbsp;bool,&nbsp;default=True</td><td class="diff_next"></td><td class="diff_header" id="to0_1712">1712</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weighted:&nbsp;bool,&nbsp;default=True</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1158">1158</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;use&nbsp;weights&nbsp;for&nbsp;the&nbsp;least&nbsp;squares&nbsp;fit</td><td class="diff_next"></td><td class="diff_header" id="to0_1713">1713</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;use&nbsp;weights&nbsp;for&nbsp;the&nbsp;least&nbsp;squares&nbsp;fit</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1159">1159</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights:&nbsp;string&nbsp;or&nbsp;np.ndarray,&nbsp;default="maxmin_diag"</td><td class="diff_next"></td><td class="diff_header" id="to0_1714">1714</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights:&nbsp;string&nbsp;or&nbsp;np.ndarray,&nbsp;default="maxmin_diag"</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1160">1160</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;method&nbsp;to&nbsp;determine&nbsp;the&nbsp;weights&nbsp;of&nbsp;the&nbsp;least&nbsp;squares&nbsp;fit.</td><td class="diff_next"></td><td class="diff_header" id="to0_1715">1715</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;method&nbsp;to&nbsp;determine&nbsp;the&nbsp;weights&nbsp;of&nbsp;the&nbsp;least&nbsp;squares&nbsp;fit.</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1161">1161</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"maxmin_diag",&nbsp;"maxmin",&nbsp;"sum",&nbsp;"prod",&nbsp;"maxmin_weighted"&nbsp;are&nbsp;supported</td><td class="diff_next"></td><td class="diff_header" id="to0_1716">1716</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"maxmin_diag",&nbsp;"maxmin",&nbsp;"sum",&nbsp;"prod",&nbsp;"maxmin_weighted"&nbsp;are&nbsp;supported</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1162">1162</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;a&nbsp;2d&nbsp;np.ndarray&nbsp;is&nbsp;provided&nbsp;the&nbsp;entry&nbsp;(i,j)&nbsp;is&nbsp;the&nbsp;weight&nbsp;of&nbsp;the&nbsp;cell&nbsp;j&nbsp;when&nbsp;fitting&nbsp;gamma&nbsp;to&nbsp;gene&nbsp;i</td><td class="diff_next"></td><td class="diff_header" id="to0_1717">1717</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;a&nbsp;2d&nbsp;np.ndarray&nbsp;is&nbsp;provided&nbsp;the&nbsp;entry&nbsp;(i,j)&nbsp;is&nbsp;the&nbsp;weight&nbsp;of&nbsp;the&nbsp;cell&nbsp;j&nbsp;when&nbsp;fitting&nbsp;gamma&nbsp;to&nbsp;gene&nbsp;i</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1163">1163</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;limit_gamma:&nbsp;np.ndarray,&nbsp;default=True</td><td class="diff_next"></td><td class="diff_header" id="to0_1718">1718</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;limit_gamma:&nbsp;np.ndarray,&nbsp;default=True</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1164">1164</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whether&nbsp;to&nbsp;limit&nbsp;gamma&nbsp;when&nbsp;unspliced&nbsp;is&nbsp;much&nbsp;higher&nbsp;than&nbsp;spliced</td><td class="diff_next"></td><td class="diff_header" id="to0_1719">1719</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whether&nbsp;to&nbsp;limit&nbsp;gamma&nbsp;when&nbsp;unspliced&nbsp;is&nbsp;much&nbsp;higher&nbsp;than&nbsp;spliced</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1165">1165</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxmin_perc:&nbsp;List[float],&nbsp;default=[2,98]</td><td class="diff_next"></td><td class="diff_header" id="to0_1720">1720</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxmin_perc:&nbsp;List[float],&nbsp;default=[2,98]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1166">1166</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;percentile&nbsp;to&nbsp;use&nbsp;if&nbsp;weights&nbsp;=&nbsp;"maxmin"&nbsp;or&nbsp;"maxmin_diag"</td><td class="diff_next"></td><td class="diff_header" id="to0_1721">1721</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;percentile&nbsp;to&nbsp;use&nbsp;if&nbsp;weights&nbsp;=&nbsp;"maxmin"&nbsp;or&nbsp;"maxmin_diag"</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1167">1167</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1722">1722</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1168">1168</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td><td class="diff_next"></td><td class="diff_header" id="to0_1723">1723</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1169">1169</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td><td class="diff_next"></td><td class="diff_header" id="to0_1724">1724</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1170">1170</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;it&nbsp;just&nbsp;creates&nbsp;the&nbsp;attributes:</td><td class="diff_next"></td><td class="diff_header" id="to0_1725">1725</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;it&nbsp;just&nbsp;creates&nbsp;the&nbsp;attributes:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1171">1171</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gammas:&nbsp;np.ndarray</td><td class="diff_next"></td><td class="diff_header" id="to0_1726">1726</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gammas:&nbsp;np.ndarray</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1172">1172</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;vector&nbsp;of&nbsp;the&nbsp;gammas&nbsp;fit&nbsp;to&nbsp;each&nbsp;gene</td><td class="diff_next"></td><td class="diff_header" id="to0_1727">1727</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;vector&nbsp;of&nbsp;the&nbsp;gammas&nbsp;fit&nbsp;to&nbsp;each&nbsp;gene</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1173">1173</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q:&nbsp;np.ndarray</td><td class="diff_next"></td><td class="diff_header" id="to0_1728">1728</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q:&nbsp;np.ndarray</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__35"></td><td class="diff_header" id="from0_1174">1174</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;vector&nbsp;of&nbsp;offsets&nbsp;of&nbsp;the&nbsp;fit</td><td class="diff_next"></td><td class="diff_header" id="to0_1729">1729</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;vector&nbsp;of&nbsp;offsets&nbsp;of&nbsp;the&nbsp;fit</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1175">1175</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R2:&nbsp;np.ndarray&nbsp;(optional)</td><td class="diff_next"></td><td class="diff_header" id="to0_1730">1730</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R2:&nbsp;np.ndarray&nbsp;(optional)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1176">1176</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;vector&nbsp;of&nbsp;squared&nbsp;coefficient&nbsp;of&nbsp;determination</td><td class="diff_next"></td><td class="diff_header" id="to0_1731">1731</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;vector&nbsp;of&nbsp;squared&nbsp;coefficient&nbsp;of&nbsp;determination</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1177">1177</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1732">1732</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1178">1178</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_1733">1733</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__36">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to0__36">n</a></td><td class="diff_header" id="to0_1734">1734</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Sx&nbsp;=&nbsp;np.copy(self.S)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1735">1735</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Ux&nbsp;=&nbsp;np.copy(self.U)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1736">1736</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Sx_sz&nbsp;=&nbsp;np.copy(self.S)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1737">1737</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Ux_sz&nbsp;=&nbsp;np.copy(self.U)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1179">1179</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;steady_state_bool:</td><td class="diff_next"></td><td class="diff_header" id="to0_1738">1738</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;steady_state_bool:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1180">1180</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.steady_state&nbsp;=&nbsp;steady_state_bool</td><td class="diff_next"></td><td class="diff_header" id="to0_1739">1739</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.steady_state&nbsp;=&nbsp;steady_state_bool</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1181">1181</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_1740">1740</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1182">1182</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.steady_state&nbsp;=&nbsp;np.ones(self.S.shape[1],&nbsp;dtype=bool)</td><td class="diff_next"></td><td class="diff_header" id="to0_1741">1741</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.steady_state&nbsp;=&nbsp;np.ones(self.S.shape[1],&nbsp;dtype=bool)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1183">1183</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1742">1742</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1184">1184</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;use_imputed_data:</td><td class="diff_next"></td><td class="diff_header" id="to0_1743">1743</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;use_imputed_data:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1185">1185</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;use_size_norm:</td><td class="diff_next"></td><td class="diff_header" id="to0_1744">1744</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;use_size_norm:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1186">1186</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpS&nbsp;=&nbsp;self.Sx_sz</td><td class="diff_next"></td><td class="diff_header" id="to0_1745">1745</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpS&nbsp;=&nbsp;self.Sx_sz</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1187">1187</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpU&nbsp;=&nbsp;self.Ux_sz</td><td class="diff_next"></td><td class="diff_header" id="to0_1746">1746</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpU&nbsp;=&nbsp;self.Ux_sz</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1188">1188</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_1747">1747</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1189">1189</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpS&nbsp;=&nbsp;self.Sx</td><td class="diff_next"></td><td class="diff_header" id="to0_1748">1748</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpS&nbsp;=&nbsp;self.Sx</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1190">1190</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpU&nbsp;=&nbsp;self.Ux</td><td class="diff_next"></td><td class="diff_header" id="to0_1749">1749</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpU&nbsp;=&nbsp;self.Ux</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1191">1191</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_1750">1750</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1192">1192</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;use_size_norm:</td><td class="diff_next"></td><td class="diff_header" id="to0_1751">1751</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;use_size_norm:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1193">1193</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpS&nbsp;=&nbsp;self.S_sz</td><td class="diff_next"></td><td class="diff_header" id="to0_1752">1752</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpS&nbsp;=&nbsp;self.S_sz</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1194">1194</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpU&nbsp;=&nbsp;self.U_sz</td><td class="diff_next"></td><td class="diff_header" id="to0_1753">1753</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpU&nbsp;=&nbsp;self.U_sz</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1195">1195</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_1754">1754</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1196">1196</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpS&nbsp;=&nbsp;self.S</td><td class="diff_next"></td><td class="diff_header" id="to0_1755">1755</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpS&nbsp;=&nbsp;self.S</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1197">1197</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpU&nbsp;=&nbsp;self.U</td><td class="diff_next"></td><td class="diff_header" id="to0_1756">1756</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpU&nbsp;=&nbsp;self.U</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1198">1198</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1757">1757</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1199">1199</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;weighted:</td><td class="diff_next"></td><td class="diff_header" id="to0_1758">1758</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;weighted:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1200">1200</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;type(weights)&nbsp;is&nbsp;np.ndarray:</td><td class="diff_next"></td><td class="diff_header" id="to0_1759">1759</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;type(weights)&nbsp;is&nbsp;np.ndarray:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1201">1201</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W&nbsp;=&nbsp;weights</td><td class="diff_next"></td><td class="diff_header" id="to0_1760">1760</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W&nbsp;=&nbsp;weights</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1202">1202</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;weights&nbsp;==&nbsp;"sum":</td><td class="diff_next"></td><td class="diff_header" id="to0_1761">1761</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;weights&nbsp;==&nbsp;"sum":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1203">1203</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W&nbsp;=&nbsp;(tmpS&nbsp;/&nbsp;np.percentile(tmpS,&nbsp;99,&nbsp;1)[:,&nbsp;None])&nbsp;+&nbsp;(tmpU&nbsp;/&nbsp;np.percentile(tmpU,&nbsp;99,&nbsp;1)[:,&nbsp;None])</td><td class="diff_next"></td><td class="diff_header" id="to0_1762">1762</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W&nbsp;=&nbsp;(tmpS&nbsp;/&nbsp;np.percentile(tmpS,&nbsp;99,&nbsp;1)[:,&nbsp;None])&nbsp;+&nbsp;(tmpU&nbsp;/&nbsp;np.percentile(tmpU,&nbsp;99,&nbsp;1)[:,&nbsp;None])</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1204">1204</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;weights&nbsp;==&nbsp;"prod":</td><td class="diff_next"></td><td class="diff_header" id="to0_1763">1763</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;weights&nbsp;==&nbsp;"prod":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1205">1205</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W&nbsp;=&nbsp;(tmpS&nbsp;/&nbsp;np.percentile(tmpS,&nbsp;99,&nbsp;1)[:,&nbsp;None])&nbsp;*&nbsp;(tmpU&nbsp;/&nbsp;np.percentile(tmpU,&nbsp;99,&nbsp;1)[:,&nbsp;None])</td><td class="diff_next"></td><td class="diff_header" id="to0_1764">1764</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W&nbsp;=&nbsp;(tmpS&nbsp;/&nbsp;np.percentile(tmpS,&nbsp;99,&nbsp;1)[:,&nbsp;None])&nbsp;*&nbsp;(tmpU&nbsp;/&nbsp;np.percentile(tmpU,&nbsp;99,&nbsp;1)[:,&nbsp;None])</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1206">1206</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;weights&nbsp;==&nbsp;"maxmin_weighted":</td><td class="diff_next"></td><td class="diff_header" id="to0_1765">1765</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;weights&nbsp;==&nbsp;"maxmin_weighted":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1207">1207</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Slightly&nbsp;smoother&nbsp;than&nbsp;just&nbsp;takin&nbsp;top&nbsp;and&nbsp;bottom&nbsp;percentile</td><td class="diff_next"></td><td class="diff_header" id="to0_1766">1766</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Slightly&nbsp;smoother&nbsp;than&nbsp;just&nbsp;takin&nbsp;top&nbsp;and&nbsp;bottom&nbsp;percentile</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1208">1208</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;down,&nbsp;up&nbsp;=&nbsp;np.percentile(tmpS,&nbsp;maxmin_perc,&nbsp;1)&nbsp;&nbsp;#&nbsp;Do&nbsp;this&nbsp;asymmetrically,&nbsp;data&nbsp;is&nbsp;sparse!</td><td class="diff_next"></td><td class="diff_header" id="to0_1767">1767</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;down,&nbsp;up&nbsp;=&nbsp;np.percentile(tmpS,&nbsp;maxmin_perc,&nbsp;1)&nbsp;&nbsp;#&nbsp;Do&nbsp;this&nbsp;asymmetrically,&nbsp;data&nbsp;is&nbsp;sparse!</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1209">1209</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Srange&nbsp;=&nbsp;np.clip(tmpS,&nbsp;down[:,&nbsp;None],&nbsp;up[:,&nbsp;None])</td><td class="diff_next"></td><td class="diff_header" id="to0_1768">1768</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Srange&nbsp;=&nbsp;np.clip(tmpS,&nbsp;down[:,&nbsp;None],&nbsp;up[:,&nbsp;None])</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1210">1210</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Srange&nbsp;-=&nbsp;Srange.min(1)[:,&nbsp;None]</td><td class="diff_next"></td><td class="diff_header" id="to0_1769">1769</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Srange&nbsp;-=&nbsp;Srange.min(1)[:,&nbsp;None]</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__36"></td><td class="diff_header" id="from0_1211">1211</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Srange&nbsp;/=&nbsp;Srange.max(1)[:,&nbsp;None]</td><td class="diff_next"></td><td class="diff_header" id="to0_1770">1770</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Srange&nbsp;/=&nbsp;Srange.max(1)[:,&nbsp;None]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1212">1212</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W&nbsp;=&nbsp;0.5&nbsp;*&nbsp;(Srange**maxmin_weighted_pow&nbsp;+&nbsp;(1&nbsp;-&nbsp;Srange)**maxmin_weighted_pow)</td><td class="diff_next"></td><td class="diff_header" id="to0_1771">1771</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W&nbsp;=&nbsp;0.5&nbsp;*&nbsp;(Srange**maxmin_weighted_pow&nbsp;+&nbsp;(1&nbsp;-&nbsp;Srange)**maxmin_weighted_pow)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1213">1213</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;weights&nbsp;==&nbsp;"maxmin":</td><td class="diff_next"></td><td class="diff_header" id="to0_1772">1772</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;weights&nbsp;==&nbsp;"maxmin":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1214">1214</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;down,&nbsp;up&nbsp;=&nbsp;np.percentile(tmpS,&nbsp;maxmin_perc,&nbsp;1)&nbsp;&nbsp;#&nbsp;Do&nbsp;this&nbsp;asymmetrically,&nbsp;data&nbsp;is&nbsp;sparse!</td><td class="diff_next"></td><td class="diff_header" id="to0_1773">1773</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;down,&nbsp;up&nbsp;=&nbsp;np.percentile(tmpS,&nbsp;maxmin_perc,&nbsp;1)&nbsp;&nbsp;#&nbsp;Do&nbsp;this&nbsp;asymmetrically,&nbsp;data&nbsp;is&nbsp;sparse!</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1215">1215</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W&nbsp;=&nbsp;((tmpS&nbsp;&lt;=&nbsp;down[:,&nbsp;None])&nbsp;|&nbsp;(tmpS&nbsp;&gt;=&nbsp;up[:,&nbsp;None])).astype(float)</td><td class="diff_next"></td><td class="diff_header" id="to0_1774">1774</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W&nbsp;=&nbsp;((tmpS&nbsp;&lt;=&nbsp;down[:,&nbsp;None])&nbsp;|&nbsp;(tmpS&nbsp;&gt;=&nbsp;up[:,&nbsp;None])).astype(float)</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__37">n</a></td><td class="diff_header" id="from0_1216">1216</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;weights&nbsp;==&nbsp;"maxmin_diag":</span></td><td class="diff_next"><a href="#difflib_chg_to0__37">n</a></td><td class="diff_header" id="to0_1775">1775</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;weights&nbsp;==&nbsp;"maxmin_diag":&nbsp;#default&nbsp;goes&nbsp;down&nbsp;this&nbsp;route</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1217">1217</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;denom_Sx&nbsp;=&nbsp;np.percentile(self.Sx,&nbsp;99.9,&nbsp;1)</td><td class="diff_next"></td><td class="diff_header" id="to0_1776">1776</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;denom_Sx&nbsp;=&nbsp;np.percentile(self.Sx,&nbsp;99.9,&nbsp;1)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1218">1218</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;np.sum(denom_Sx&nbsp;==&nbsp;0):</td><td class="diff_next"></td><td class="diff_header" id="to0_1777">1777</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;np.sum(denom_Sx&nbsp;==&nbsp;0):</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1219">1219</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;denom_Sx[denom_Sx&nbsp;==&nbsp;0]&nbsp;=&nbsp;np.maximum(np.max(self.Sx[denom_Sx&nbsp;==&nbsp;0,&nbsp;:],&nbsp;1),&nbsp;0.001)</td><td class="diff_next"></td><td class="diff_header" id="to0_1778">1778</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;denom_Sx[denom_Sx&nbsp;==&nbsp;0]&nbsp;=&nbsp;np.maximum(np.max(self.Sx[denom_Sx&nbsp;==&nbsp;0,&nbsp;:],&nbsp;1),&nbsp;0.001)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1220">1220</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;denom_Ux&nbsp;=&nbsp;np.percentile(self.Ux,&nbsp;99.9,&nbsp;1)</td><td class="diff_next"></td><td class="diff_header" id="to0_1779">1779</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;denom_Ux&nbsp;=&nbsp;np.percentile(self.Ux,&nbsp;99.9,&nbsp;1)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1221">1221</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;np.sum(denom_Ux&nbsp;==&nbsp;0):</td><td class="diff_next"></td><td class="diff_header" id="to0_1780">1780</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;np.sum(denom_Ux&nbsp;==&nbsp;0):</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1222">1222</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;denom_Ux[denom_Ux&nbsp;==&nbsp;0]&nbsp;=&nbsp;np.maximum(np.max(self.Ux[denom_Ux&nbsp;==&nbsp;0,&nbsp;:],&nbsp;1),&nbsp;0.001)</td><td class="diff_next"></td><td class="diff_header" id="to0_1781">1781</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;denom_Ux[denom_Ux&nbsp;==&nbsp;0]&nbsp;=&nbsp;np.maximum(np.max(self.Ux[denom_Ux&nbsp;==&nbsp;0,&nbsp;:],&nbsp;1),&nbsp;0.001)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1223">1223</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sx_maxnorm&nbsp;=&nbsp;self.Sx&nbsp;/&nbsp;denom_Sx[:,&nbsp;None]</td><td class="diff_next"></td><td class="diff_header" id="to0_1782">1782</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sx_maxnorm&nbsp;=&nbsp;self.Sx&nbsp;/&nbsp;denom_Sx[:,&nbsp;None]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1224">1224</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ux_maxnorm&nbsp;=&nbsp;self.Ux&nbsp;/&nbsp;denom_Ux[:,&nbsp;None]</td><td class="diff_next"></td><td class="diff_header" id="to0_1783">1783</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ux_maxnorm&nbsp;=&nbsp;self.Ux&nbsp;/&nbsp;denom_Ux[:,&nbsp;None]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1225">1225</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X&nbsp;=&nbsp;Sx_maxnorm&nbsp;+&nbsp;Ux_maxnorm</td><td class="diff_next"></td><td class="diff_header" id="to0_1784">1784</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X&nbsp;=&nbsp;Sx_maxnorm&nbsp;+&nbsp;Ux_maxnorm</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1226">1226</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;down,&nbsp;up&nbsp;=&nbsp;np.percentile(X,&nbsp;maxmin_perc,&nbsp;axis=1)</td><td class="diff_next"></td><td class="diff_header" id="to0_1785">1785</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;down,&nbsp;up&nbsp;=&nbsp;np.percentile(X,&nbsp;maxmin_perc,&nbsp;axis=1)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1227">1227</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W&nbsp;=&nbsp;((X&nbsp;&lt;=&nbsp;down[:,&nbsp;None])&nbsp;|&nbsp;(X&nbsp;&gt;=&nbsp;up[:,&nbsp;None])).astype(float)</td><td class="diff_next"></td><td class="diff_header" id="to0_1786">1786</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W&nbsp;=&nbsp;((X&nbsp;&lt;=&nbsp;down[:,&nbsp;None])&nbsp;|&nbsp;(X&nbsp;&gt;=&nbsp;up[:,&nbsp;None])).astype(float)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1228">1228</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;weights&nbsp;==&nbsp;"maxmin_double":</td><td class="diff_next"></td><td class="diff_header" id="to0_1787">1787</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;weights&nbsp;==&nbsp;"maxmin_double":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1229">1229</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;denom_Sx&nbsp;=&nbsp;np.percentile(self.Sx,&nbsp;99.9,&nbsp;1)</td><td class="diff_next"></td><td class="diff_header" id="to0_1788">1788</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;denom_Sx&nbsp;=&nbsp;np.percentile(self.Sx,&nbsp;99.9,&nbsp;1)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1230">1230</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;denom_Sx[denom_Sx&nbsp;==&nbsp;0]&nbsp;=&nbsp;np.maximum(np.max(self.Sx[denom_Sx&nbsp;==&nbsp;0,&nbsp;:],&nbsp;1),&nbsp;0.001)</td><td class="diff_next"></td><td class="diff_header" id="to0_1789">1789</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;denom_Sx[denom_Sx&nbsp;==&nbsp;0]&nbsp;=&nbsp;np.maximum(np.max(self.Sx[denom_Sx&nbsp;==&nbsp;0,&nbsp;:],&nbsp;1),&nbsp;0.001)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1231">1231</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;denom_Ux&nbsp;=&nbsp;np.percentile(self.Ux,&nbsp;99.9,&nbsp;1)</td><td class="diff_next"></td><td class="diff_header" id="to0_1790">1790</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;denom_Ux&nbsp;=&nbsp;np.percentile(self.Ux,&nbsp;99.9,&nbsp;1)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1232">1232</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;denom_Ux[denom_Ux&nbsp;==&nbsp;0]&nbsp;=&nbsp;np.maximum(np.max(self.Ux[denom_Ux&nbsp;==&nbsp;0,&nbsp;:],&nbsp;1),&nbsp;0.001)</td><td class="diff_next"></td><td class="diff_header" id="to0_1791">1791</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;denom_Ux[denom_Ux&nbsp;==&nbsp;0]&nbsp;=&nbsp;np.maximum(np.max(self.Ux[denom_Ux&nbsp;==&nbsp;0,&nbsp;:],&nbsp;1),&nbsp;0.001)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1233">1233</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sx_maxnorm&nbsp;=&nbsp;self.Sx&nbsp;/&nbsp;denom_Sx[:,&nbsp;None]</td><td class="diff_next"></td><td class="diff_header" id="to0_1792">1792</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sx_maxnorm&nbsp;=&nbsp;self.Sx&nbsp;/&nbsp;denom_Sx[:,&nbsp;None]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1234">1234</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ux_maxnorm&nbsp;=&nbsp;self.Ux&nbsp;/&nbsp;denom_Ux[:,&nbsp;None]</td><td class="diff_next"></td><td class="diff_header" id="to0_1793">1793</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ux_maxnorm&nbsp;=&nbsp;self.Ux&nbsp;/&nbsp;denom_Ux[:,&nbsp;None]</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__37"></td><td class="diff_header" id="from0_1235">1235</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X&nbsp;=&nbsp;Sx_maxnorm&nbsp;+&nbsp;Ux_maxnorm</td><td class="diff_next"></td><td class="diff_header" id="to0_1794">1794</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X&nbsp;=&nbsp;Sx_maxnorm&nbsp;+&nbsp;Ux_maxnorm</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1236">1236</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;down,&nbsp;up&nbsp;=&nbsp;np.percentile(X,&nbsp;maxmin_perc,&nbsp;axis=1)</td><td class="diff_next"></td><td class="diff_header" id="to0_1795">1795</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;down,&nbsp;up&nbsp;=&nbsp;np.percentile(X,&nbsp;maxmin_perc,&nbsp;axis=1)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1237">1237</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W&nbsp;=&nbsp;((X&nbsp;&lt;=&nbsp;down[:,&nbsp;None])&nbsp;|&nbsp;(X&nbsp;&gt;=&nbsp;up[:,&nbsp;None])).astype(float)</td><td class="diff_next"></td><td class="diff_header" id="to0_1796">1796</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W&nbsp;=&nbsp;((X&nbsp;&lt;=&nbsp;down[:,&nbsp;None])&nbsp;|&nbsp;(X&nbsp;&gt;=&nbsp;up[:,&nbsp;None])).astype(float)</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__38"></td><td class="diff_header" id="from0_1238">1238</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;down,&nbsp;up&nbsp;=&nbsp;np.percentile(self.Sx,&nbsp;maxmin_perc,&nbsp;1)</td><td class="diff_next"></td><td class="diff_header" id="to0_1797">1797</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;down,&nbsp;up&nbsp;=&nbsp;np.percentile(self.Sx,&nbsp;maxmin_perc,&nbsp;1)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1239">1239</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W&nbsp;+=&nbsp;((self.Sx&nbsp;&lt;=&nbsp;down[:,&nbsp;None])&nbsp;|&nbsp;(self.Sx&nbsp;&gt;=&nbsp;up[:,&nbsp;None])).astype(float)</td><td class="diff_next"></td><td class="diff_header" id="to0_1798">1798</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W&nbsp;+=&nbsp;((self.Sx&nbsp;&lt;=&nbsp;down[:,&nbsp;None])&nbsp;|&nbsp;(self.Sx&nbsp;&gt;=&nbsp;up[:,&nbsp;None])).astype(float)</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__38">n</a></td><td class="diff_header" id="from0_1240">1240</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__38">n</a></td><td class="diff_header" id="to0_1799">1799</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__39"></td><td class="diff_header" id="from0_1241">1241</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;fit_offset:</td><td class="diff_next"></td><td class="diff_header" id="to0_1800">1800</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;fit_offset:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1242">1242</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;weighted:</td><td class="diff_next"></td><td class="diff_header" id="to0_1801">1801</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;weighted:</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__39">n</a></td><td class="diff_header" id="from0_1243">1243</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.gammas,&nbsp;self.q,&nbsp;self.R2&nbsp;=&nbsp;fit_slope_weighted_offset(tmpU[:,&nbsp;self.steady_state],</span></td><td class="diff_next"><a href="#difflib_chg_to0__39">n</a></td><td class="diff_header" id="to0_1802">1802</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.gammas,&nbsp;self.q,&nbsp;self.R2&nbsp;=&nbsp;fit_slope_weighted_offset(tmpU[:,&nbsp;self.steady_state],&nbsp;#loops&nbsp;through&nbsp;the&nbsp;genes&nbsp;and&nbsp;fits&nbsp;it&nbsp;to&nbsp;the&nbsp;slope,&nbsp;gammas&nbsp;=&nbsp;slopes,&nbsp;Y:&nbsp;np.ndarray,&nbsp;shape=(genes,&nbsp;cells)the&nbsp;dependent&nbsp;variable&nbsp;(unspliced),&nbsp;X:&nbsp;np.ndarray,&nbsp;shape=(genes,&nbsp;cells):&nbsp;the&nbsp;independent&nbsp;variable&nbsp;(spliced)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1244">1244</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpS[:,&nbsp;self.steady_state],</td><td class="diff_next"></td><td class="diff_header" id="to0_1803">1803</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpS[:,&nbsp;self.steady_state],</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1245">1245</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W,</td><td class="diff_next"></td><td class="diff_header" id="to0_1804">1804</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W,</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__40">n</a></td><td class="diff_header" id="from0_1246">1246</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return_R2=True,</td><td class="diff_next"><a href="#difflib_chg_to0__40">n</a></td><td class="diff_header" id="to0_1805">1805</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return_R2=True,<span class="diff_add">&nbsp;#add&nbsp;third&nbsp;parameter:&nbsp;np.array&nbsp;of&nbsp;the&nbsp;svp's</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__40"></td><td class="diff_header" id="from0_1247">1247</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;limit_gamma=limit_gamma)</span></td><td class="diff_next"></td><td class="diff_header" id="to0_1806">1806</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;limit_gamma=limit_gamma)&nbsp;#Performs&nbsp;the&nbsp;_fit1_slope_weighted_offset&nbsp;function&nbsp;from&nbsp;the&nbsp;estimation&nbsp;source&nbsp;file&nbsp;this&nbsp;fits&nbsp;a&nbsp;weighted&nbsp;linear&nbsp;regression&nbsp;model&nbsp;with&nbsp;intercept</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1248">1248</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_1807">1807</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1249">1249</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;limit_gamma:</td><td class="diff_next"></td><td class="diff_header" id="to0_1808">1808</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;limit_gamma:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1250">1250</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warning("limit_gamma&nbsp;not&nbsp;implemented&nbsp;with&nbsp;this&nbsp;settings")</td><td class="diff_next"></td><td class="diff_header" id="to0_1809">1809</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warning("limit_gamma&nbsp;not&nbsp;implemented&nbsp;with&nbsp;this&nbsp;settings")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1251">1251</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.gammas,&nbsp;self.q&nbsp;=&nbsp;fit_slope_offset(tmpU[:,&nbsp;self.steady_state],</td><td class="diff_next"></td><td class="diff_header" id="to0_1810">1810</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.gammas,&nbsp;self.q&nbsp;=&nbsp;fit_slope_offset(tmpU[:,&nbsp;self.steady_state],</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__41"><a href="#difflib_chg_to0__41">n</a></td><td class="diff_header" id="from0_1252">1252</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpS[:,&nbsp;self.steady_state])</td><td class="diff_next"><a href="#difflib_chg_to0__41">n</a></td><td class="diff_header" id="to0_1811">1811</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpS[:,&nbsp;self.steady_state])<span class="diff_add">&nbsp;#add&nbsp;third&nbsp;parameter:&nbsp;np.array&nbsp;of&nbsp;the&nbsp;svp's</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1253">1253</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;fixperc_q:</td><td class="diff_next"></td><td class="diff_header" id="to0_1812">1812</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;fixperc_q:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1254">1254</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;weighted:</td><td class="diff_next"></td><td class="diff_header" id="to0_1813">1813</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;weighted:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1255">1255</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.gammas,&nbsp;self.q&nbsp;=&nbsp;fit_slope_weighted_offset(tmpU[:,&nbsp;self.steady_state],</td><td class="diff_next"></td><td class="diff_header" id="to0_1814">1814</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.gammas,&nbsp;self.q&nbsp;=&nbsp;fit_slope_weighted_offset(tmpU[:,&nbsp;self.steady_state],</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1256">1256</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpS[:,&nbsp;self.steady_state],</td><td class="diff_next"></td><td class="diff_header" id="to0_1815">1815</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpS[:,&nbsp;self.steady_state],</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__42">n</a></td><td class="diff_header" id="from0_1257">1257</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W,&nbsp;fixperc_q=True,&nbsp;limit_gamma=limit_gamma)</td><td class="diff_next"><a href="#difflib_chg_to0__42">n</a></td><td class="diff_header" id="to0_1816">1816</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W,&nbsp;fixperc_q=True,&nbsp;limit_gamma=limit_gamma)<span class="diff_add">&nbsp;#add&nbsp;third&nbsp;parameter:&nbsp;np.array&nbsp;of&nbsp;the&nbsp;svp's</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__42"></td><td class="diff_header" id="from0_1258">1258</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_1817">1817</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1259">1259</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;limit_gamma:</td><td class="diff_next"></td><td class="diff_header" id="to0_1818">1818</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;limit_gamma:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1260">1260</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warning("limit_gamma&nbsp;not&nbsp;implemented&nbsp;with&nbsp;this&nbsp;settings")</td><td class="diff_next"></td><td class="diff_header" id="to0_1819">1819</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warning("limit_gamma&nbsp;not&nbsp;implemented&nbsp;with&nbsp;this&nbsp;settings")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1261">1261</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.gammas,&nbsp;self.q&nbsp;=&nbsp;fit_slope_offset(tmpU[:,&nbsp;self.steady_state],</td><td class="diff_next"></td><td class="diff_header" id="to0_1820">1820</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.gammas,&nbsp;self.q&nbsp;=&nbsp;fit_slope_offset(tmpU[:,&nbsp;self.steady_state],</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1262">1262</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpS[:,&nbsp;self.steady_state],</td><td class="diff_next"></td><td class="diff_header" id="to0_1821">1821</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpS[:,&nbsp;self.steady_state],</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__43"><a href="#difflib_chg_to0__43">n</a></td><td class="diff_header" id="from0_1263">1263</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fixperc_q=True)</td><td class="diff_next"><a href="#difflib_chg_to0__43">n</a></td><td class="diff_header" id="to0_1822">1822</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fixperc_q=True)<span class="diff_add">&nbsp;#add&nbsp;third&nbsp;parameter:&nbsp;np.array&nbsp;of&nbsp;the&nbsp;svp's</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1264">1264</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_1823">1823</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__44"></td><td class="diff_header" id="from0_1265">1265</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;weighted:</td><td class="diff_next"></td><td class="diff_header" id="to0_1824">1824</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;weighted:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1266">1266</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.gammas,&nbsp;self.R2&nbsp;=&nbsp;fit_slope_weighted(tmpU[:,&nbsp;self.steady_state],</td><td class="diff_next"></td><td class="diff_header" id="to0_1825">1825</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.gammas,&nbsp;self.R2&nbsp;=&nbsp;fit_slope_weighted(tmpU[:,&nbsp;self.steady_state],</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1267">1267</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpS[:,&nbsp;self.steady_state],</td><td class="diff_next"></td><td class="diff_header" id="to0_1826">1826</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpS[:,&nbsp;self.steady_state],</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__44">n</a></td><td class="diff_header" id="from0_1268">1268</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W,<span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__44">n</a></td><td class="diff_header" id="to0_1827">1827</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1269">1269</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return_R2=True,</td><td class="diff_next"></td><td class="diff_header" id="to0_1828">1828</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return_R2=True,</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__45">n</a></td><td class="diff_header" id="from0_1270">1270</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;limit_gamma=limit_gamma)</td><td class="diff_next"><a href="#difflib_chg_to0__45">n</a></td><td class="diff_header" id="to0_1829">1829</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;limit_gamma=limit_gamma)<span class="diff_add">&nbsp;#add&nbsp;third&nbsp;parameter:&nbsp;np.array&nbsp;of&nbsp;the&nbsp;svp's</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__45"></td><td class="diff_header" id="from0_1271">1271</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.q&nbsp;=&nbsp;np.zeros_like(self.gammas)</td><td class="diff_next"></td><td class="diff_header" id="to0_1830">1830</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.q&nbsp;=&nbsp;np.zeros_like(self.gammas)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1272">1272</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_1831">1831</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1273">1273</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;limit_gamma:</td><td class="diff_next"></td><td class="diff_header" id="to0_1832">1832</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;limit_gamma:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1274">1274</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warning("limit_gamma&nbsp;not&nbsp;implemented&nbsp;with&nbsp;this&nbsp;settings")</td><td class="diff_next"></td><td class="diff_header" id="to0_1833">1833</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warning("limit_gamma&nbsp;not&nbsp;implemented&nbsp;with&nbsp;this&nbsp;settings")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1275">1275</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.gammas&nbsp;=&nbsp;fit_slope(tmpU[:,&nbsp;self.steady_state],</td><td class="diff_next"></td><td class="diff_header" id="to0_1834">1834</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.gammas&nbsp;=&nbsp;fit_slope(tmpU[:,&nbsp;self.steady_state],</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__46">n</a></td><td class="diff_header" id="from0_1276">1276</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpS[:,&nbsp;self.steady_state])</td><td class="diff_next"><a href="#difflib_chg_to0__46">n</a></td><td class="diff_header" id="to0_1835">1835</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpS[:,&nbsp;self.steady_state])<span class="diff_add">&nbsp;#add&nbsp;third&nbsp;parameter:&nbsp;np.array&nbsp;of&nbsp;the&nbsp;svp's</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1277">1277</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.q&nbsp;=&nbsp;np.zeros_like(self.gammas)</td><td class="diff_next"></td><td class="diff_header" id="to0_1836">1836</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.q&nbsp;=&nbsp;np.zeros_like(self.gammas)</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__46"></td><td class="diff_header" id="from0_1278">1278</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1837">1837</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1279">1279</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Fix&nbsp;gammas</td><td class="diff_next"></td><td class="diff_header" id="to0_1838">1838</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Fix&nbsp;gammas</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1280">1280</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.gammas[~np.isfinite(self.gammas)]&nbsp;=&nbsp;0</td><td class="diff_next"></td><td class="diff_header" id="to0_1839">1839</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.gammas[~np.isfinite(self.gammas)]&nbsp;=&nbsp;0</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1281">1281</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1840">1840</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1282">1282</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1841">1841</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__47">n</a></td><td class="diff_header" id="from0_1283">1283</td><td nowrap="nowrap"><span class="diff_chg">[docs]&nbsp;&nbsp;&nbsp;&nbsp;</span>def&nbsp;filter_genes_good_fit(self,&nbsp;minR:&nbsp;float=0.1,&nbsp;min_gamma:&nbsp;float=0.01)&nbsp;-&gt;&nbsp;None:</td><td class="diff_next"><a href="#difflib_chg_to0__47">n</a></td><td class="diff_header" id="to0_1842">1842</td><td nowrap="nowrap"><span class="diff_chg">&nbsp;&nbsp;&nbsp;&nbsp;#</span>def&nbsp;filter_genes_good_fit(self,&nbsp;minR:&nbsp;float=0.1,&nbsp;min_gamma:&nbsp;float=0.01)&nbsp;-&gt;&nbsp;None:</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__47"></td><td class="diff_header" id="from0_1284">1284</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""For&nbsp;backwards&nbsp;compatibility&nbsp;a&nbsp;wrapper&nbsp;around&nbsp;filter_genes_by_phase_portrait</td><td class="diff_next"></td><td class="diff_header" id="to0_1843">1843</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_add">#</span>&nbsp;&nbsp;&nbsp;&nbsp;"""For&nbsp;backwards&nbsp;compatibility&nbsp;a&nbsp;wrapper&nbsp;around&nbsp;filter_genes_by_phase_portrait</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1285">1285</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_1844">1844</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_add">#</span>&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1286">1286</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self.filter_genes_by_phase_portrait(minR2=minR,&nbsp;min_gamma=min_gamma,&nbsp;minCorr=None)</td><td class="diff_next"></td><td class="diff_header" id="to0_1845">1845</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_add">#</span>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self.filter_genes_by_phase_portrait(minR2=minR,&nbsp;min_gamma=min_gamma,&nbsp;minCorr=None)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1287">1287</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1846">1846</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1288">1288</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1847">1847</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__48">n</a></td><td class="diff_header" id="from0_1289">1289</td><td nowrap="nowrap"><span class="diff_sub">[docs]</span>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;filter_genes_by_phase_portrait(self,&nbsp;minR2:&nbsp;float=0.1,&nbsp;min_gamma:&nbsp;float=0.01,&nbsp;minCorr:&nbsp;float=0.1)&nbsp;-&gt;&nbsp;None:</td><td class="diff_next"><a href="#difflib_chg_to0__48">n</a></td><td class="diff_header" id="to0_1848">1848</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;filter_genes_by_phase_portrait(self,&nbsp;minR2:&nbsp;float=0.1,&nbsp;min_gamma:&nbsp;float=0.01,&nbsp;minCorr:&nbsp;float=0.1)&nbsp;-&gt;&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1290">1290</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Use&nbsp;the&nbsp;coefficient&nbsp;of&nbsp;determination&nbsp;to&nbsp;filter&nbsp;away&nbsp;genes&nbsp;that&nbsp;have&nbsp;an&nbsp;irregular/complex&nbsp;phase&nbsp;portrait</td><td class="diff_next"></td><td class="diff_header" id="to0_1849">1849</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Use&nbsp;the&nbsp;coefficient&nbsp;of&nbsp;determination&nbsp;to&nbsp;filter&nbsp;away&nbsp;genes&nbsp;that&nbsp;have&nbsp;an&nbsp;irregular/complex&nbsp;phase&nbsp;portrait</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1291">1291</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1850">1850</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1292">1292</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td><td class="diff_next"></td><td class="diff_header" id="to0_1851">1851</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1293">1293</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td><td class="diff_next"></td><td class="diff_header" id="to0_1852">1852</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__48"></td><td class="diff_header" id="from0_1294">1294</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minR2:&nbsp;float,&nbsp;default=0.1</td><td class="diff_next"></td><td class="diff_header" id="to0_1853">1853</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minR2:&nbsp;float,&nbsp;default=0.1</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1295">1295</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filter&nbsp;away&nbsp;low&nbsp;coefficient&nbsp;of&nbsp;determination&nbsp;fits.&nbsp;If&nbsp;None&nbsp;this&nbsp;filtering&nbsp;will&nbsp;be&nbsp;skipped</td><td class="diff_next"></td><td class="diff_header" id="to0_1854">1854</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filter&nbsp;away&nbsp;low&nbsp;coefficient&nbsp;of&nbsp;determination&nbsp;fits.&nbsp;If&nbsp;None&nbsp;this&nbsp;filtering&nbsp;will&nbsp;be&nbsp;skipped</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1296">1296</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_gamma:&nbsp;float,&nbsp;default=0.01</td><td class="diff_next"></td><td class="diff_header" id="to0_1855">1855</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_gamma:&nbsp;float,&nbsp;default=0.01</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1297">1297</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filter&nbsp;away&nbsp;low&nbsp;gammas.&nbsp;If&nbsp;None&nbsp;this&nbsp;filtering&nbsp;will&nbsp;be&nbsp;skipped</td><td class="diff_next"></td><td class="diff_header" id="to0_1856">1856</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filter&nbsp;away&nbsp;low&nbsp;gammas.&nbsp;If&nbsp;None&nbsp;this&nbsp;filtering&nbsp;will&nbsp;be&nbsp;skipped</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1298">1298</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minCorr:&nbsp;flaot,&nbsp;default=0.2</td><td class="diff_next"></td><td class="diff_header" id="to0_1857">1857</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minCorr:&nbsp;flaot,&nbsp;default=0.2</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__49">n</a></td><td class="diff_header" id="from0_1299">1299</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filter&nbsp;away&nbsp;low&nbsp;spliced-un<span class="diff_sub">s</span>pliced&nbsp;correlation.&nbsp;If&nbsp;None&nbsp;this&nbsp;filtering&nbsp;will&nbsp;be&nbsp;skipped</td><td class="diff_next"><a href="#difflib_chg_to0__49">n</a></td><td class="diff_header" id="to0_1858">1858</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filter&nbsp;away&nbsp;low&nbsp;spliced-u<span class="diff_add">s</span>npliced&nbsp;correlation.&nbsp;If&nbsp;None&nbsp;this&nbsp;filtering&nbsp;will&nbsp;be&nbsp;skipped</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1300">1300</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1859">1859</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1301">1301</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td><td class="diff_next"></td><td class="diff_header" id="to0_1860">1860</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1302">1302</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td><td class="diff_next"></td><td class="diff_header" id="to0_1861">1861</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1303">1303</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;but&nbsp;modifies&nbsp;it&nbsp;filters&nbsp;out&nbsp;the&nbsp;genes&nbsp;that&nbsp;do&nbsp;not&nbsp;satisfy&nbsp;the&nbsp;conditions</td><td class="diff_next"></td><td class="diff_header" id="to0_1862">1862</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;but&nbsp;modifies&nbsp;it&nbsp;filters&nbsp;out&nbsp;the&nbsp;genes&nbsp;that&nbsp;do&nbsp;not&nbsp;satisfy&nbsp;the&nbsp;conditions</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1304">1304</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;affects:&nbsp;"U",&nbsp;"U_sz",&nbsp;"U_norm",&nbsp;"Ux",&nbsp;"Ux_sz",&nbsp;"Ux_norm",&nbsp;"S",&nbsp;"S_sz",&nbsp;"S_norm",&nbsp;"Sx",&nbsp;"Sx_sz",&nbsp;"Sx_norm",&nbsp;"gammas",&nbsp;"q",&nbsp;"R2"</td><td class="diff_next"></td><td class="diff_header" id="to0_1863">1863</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;affects:&nbsp;"U",&nbsp;"U_sz",&nbsp;"U_norm",&nbsp;"Ux",&nbsp;"Ux_sz",&nbsp;"Ux_norm",&nbsp;"S",&nbsp;"S_sz",&nbsp;"S_norm",&nbsp;"Sx",&nbsp;"Sx_sz",&nbsp;"Sx_norm",&nbsp;"gammas",&nbsp;"q",&nbsp;"R2"</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1305">1305</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_1864">1864</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1306">1306</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1865">1865</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1307">1307</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;paired_correlation_rows(A:&nbsp;np.array,&nbsp;B:&nbsp;np.array)&nbsp;-&gt;&nbsp;np.array:</td><td class="diff_next"></td><td class="diff_header" id="to0_1866">1866</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;paired_correlation_rows(A:&nbsp;np.array,&nbsp;B:&nbsp;np.array)&nbsp;-&gt;&nbsp;np.array:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1308">1308</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A_m&nbsp;=&nbsp;A&nbsp;-&nbsp;A.mean(1)[:,&nbsp;None]</td><td class="diff_next"></td><td class="diff_header" id="to0_1867">1867</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A_m&nbsp;=&nbsp;A&nbsp;-&nbsp;A.mean(1)[:,&nbsp;None]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1309">1309</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B_m&nbsp;=&nbsp;B&nbsp;-&nbsp;B.mean(1)[:,&nbsp;None]</td><td class="diff_next"></td><td class="diff_header" id="to0_1868">1868</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B_m&nbsp;=&nbsp;B&nbsp;-&nbsp;B.mean(1)[:,&nbsp;None]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1310">1310</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(A_m&nbsp;*&nbsp;B_m).sum(1)&nbsp;/&nbsp;(np.linalg.norm(A_m,&nbsp;2,&nbsp;1)&nbsp;*&nbsp;np.linalg.norm(B_m,&nbsp;2,&nbsp;1))</td><td class="diff_next"></td><td class="diff_header" id="to0_1869">1869</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(A_m&nbsp;*&nbsp;B_m).sum(1)&nbsp;/&nbsp;(np.linalg.norm(A_m,&nbsp;2,&nbsp;1)&nbsp;*&nbsp;np.linalg.norm(B_m,&nbsp;2,&nbsp;1))</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1311">1311</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1870">1870</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1312">1312</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;@numba.njit()</td><td class="diff_next"></td><td class="diff_header" id="to0_1871">1871</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;@numba.njit()</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1313">1313</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;def&nbsp;paired_correlation_rows(A,&nbsp;B):</td><td class="diff_next"></td><td class="diff_header" id="to0_1872">1872</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;def&nbsp;paired_correlation_rows(A,&nbsp;B):</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__49"></td><td class="diff_header" id="from0_1314">1314</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res&nbsp;=&nbsp;np.zeros(A.shape[0])</td><td class="diff_next"></td><td class="diff_header" id="to0_1873">1873</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res&nbsp;=&nbsp;np.zeros(A.shape[0])</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1315">1315</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(A.shape[0]):</td><td class="diff_next"></td><td class="diff_header" id="to0_1874">1874</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(A.shape[0]):</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1316">1316</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;=&nbsp;A[i,:]&nbsp;-&nbsp;np.sum(A[i,:])&nbsp;/&nbsp;A.shape[1]</td><td class="diff_next"></td><td class="diff_header" id="to0_1875">1875</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;=&nbsp;A[i,:]&nbsp;-&nbsp;np.sum(A[i,:])&nbsp;/&nbsp;A.shape[1]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1317">1317</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b&nbsp;=&nbsp;B[i,:]&nbsp;-&nbsp;np.sum(B[i,:])&nbsp;/&nbsp;B.shape[1]</td><td class="diff_next"></td><td class="diff_header" id="to0_1876">1876</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b&nbsp;=&nbsp;B[i,:]&nbsp;-&nbsp;np.sum(B[i,:])&nbsp;/&nbsp;B.shape[1]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1318">1318</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res[i]&nbsp;=&nbsp;np.sum(a&nbsp;*&nbsp;b)&nbsp;/&nbsp;(np.sqrt(np.sum(a*a))&nbsp;*&nbsp;np.sqrt(np.sum(b*b)))</td><td class="diff_next"></td><td class="diff_header" id="to0_1877">1877</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res[i]&nbsp;=&nbsp;np.sum(a&nbsp;*&nbsp;b)&nbsp;/&nbsp;(np.sqrt(np.sum(a*a))&nbsp;*&nbsp;np.sqrt(np.sum(b*b)))</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__50">n</a></td><td class="diff_header" id="from0_1319">1319</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;res<span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__50">n</a></td><td class="diff_header" id="to0_1878">1878</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;res</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1320">1320</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1879">1879</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1321">1321</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_filter&nbsp;=&nbsp;np.ones(self.gammas.shape,&nbsp;dtype=bool)</td><td class="diff_next"></td><td class="diff_header" id="to0_1880">1880</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_filter&nbsp;=&nbsp;np.ones(self.gammas.shape,&nbsp;dtype=bool)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1322">1322</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;minR2&nbsp;is&nbsp;not&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_1881">1881</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;minR2&nbsp;is&nbsp;not&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1323">1323</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;NOTE&nbsp;Should&nbsp;be:&nbsp;tmp_filter&nbsp;=&nbsp;np.sqrt(self.R2)&nbsp;&gt;&nbsp;minR&nbsp;but&nbsp;since&nbsp;the&nbsp;fit&nbsp;is&nbsp;weighted&nbsp;and&nbsp;constrained&nbsp;R2&nbsp;can&nbsp;be&nbsp;negative</td><td class="diff_next"></td><td class="diff_header" id="to0_1882">1882</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;NOTE&nbsp;Should&nbsp;be:&nbsp;tmp_filter&nbsp;=&nbsp;np.sqrt(self.R2)&nbsp;&gt;&nbsp;minR&nbsp;but&nbsp;since&nbsp;the&nbsp;fit&nbsp;is&nbsp;weighted&nbsp;and&nbsp;constrained&nbsp;R2&nbsp;can&nbsp;be&nbsp;negative</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1324">1324</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R2_corrected&nbsp;=&nbsp;np.sqrt(np.abs(self.R2))&nbsp;*&nbsp;np.sign(self.R2)</td><td class="diff_next"></td><td class="diff_header" id="to0_1883">1883</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R2_corrected&nbsp;=&nbsp;np.sqrt(np.abs(self.R2))&nbsp;*&nbsp;np.sign(self.R2)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1325">1325</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_filter&nbsp;=&nbsp;tmp_filter&nbsp;&amp;&nbsp;(R2_corrected&nbsp;&gt;&nbsp;minR2)</td><td class="diff_next"></td><td class="diff_header" id="to0_1884">1884</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_filter&nbsp;=&nbsp;tmp_filter&nbsp;&amp;&nbsp;(R2_corrected&nbsp;&gt;&nbsp;minR2)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1326">1326</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;min_gamma&nbsp;is&nbsp;not&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_1885">1885</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;min_gamma&nbsp;is&nbsp;not&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1327">1327</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_filter&nbsp;=&nbsp;tmp_filter&nbsp;&amp;&nbsp;(self.gammas&nbsp;&gt;&nbsp;min_gamma)</td><td class="diff_next"></td><td class="diff_header" id="to0_1886">1886</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_filter&nbsp;=&nbsp;tmp_filter&nbsp;&amp;&nbsp;(self.gammas&nbsp;&gt;&nbsp;min_gamma)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1328">1328</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;minCorr&nbsp;is&nbsp;not&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_1887">1887</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;minCorr&nbsp;is&nbsp;not&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1329">1329</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Corr&nbsp;=&nbsp;paired_correlation_rows(self.Sx_sz,&nbsp;self.Ux_sz)</td><td class="diff_next"></td><td class="diff_header" id="to0_1888">1888</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Corr&nbsp;=&nbsp;paired_correlation_rows(self.Sx_sz,&nbsp;self.Ux_sz)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1330">1330</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_filter&nbsp;=&nbsp;tmp_filter&nbsp;&amp;&nbsp;(Corr&nbsp;&gt;&nbsp;minCorr)</td><td class="diff_next"></td><td class="diff_header" id="to0_1889">1889</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_filter&nbsp;=&nbsp;tmp_filter&nbsp;&amp;&nbsp;(Corr&nbsp;&gt;&nbsp;minCorr)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1331">1331</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Perform&nbsp;the&nbsp;filtering</td><td class="diff_next"></td><td class="diff_header" id="to0_1890">1890</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Perform&nbsp;the&nbsp;filtering</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1332">1332</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ra&nbsp;=&nbsp;{k:&nbsp;v[tmp_filter]&nbsp;for&nbsp;k,&nbsp;v&nbsp;in&nbsp;self.ra.items()}</td><td class="diff_next"></td><td class="diff_header" id="to0_1891">1891</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ra&nbsp;=&nbsp;{k:&nbsp;v[tmp_filter]&nbsp;for&nbsp;k,&nbsp;v&nbsp;in&nbsp;self.ra.items()}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1333">1333</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matrixes2filter&nbsp;=&nbsp;["U",&nbsp;"U_sz",&nbsp;"U_norm",&nbsp;"Ux",&nbsp;"Ux_sz",&nbsp;"Ux_norm",</td><td class="diff_next"></td><td class="diff_header" id="to0_1892">1892</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matrixes2filter&nbsp;=&nbsp;["U",&nbsp;"U_sz",&nbsp;"U_norm",&nbsp;"Ux",&nbsp;"Ux_sz",&nbsp;"Ux_norm",</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1334">1334</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"S",&nbsp;"S_sz",&nbsp;"S_norm",&nbsp;"Sx",&nbsp;"Sx_sz",&nbsp;"Sx_norm"]</td><td class="diff_next"></td><td class="diff_header" id="to0_1893">1893</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"S",&nbsp;"S_sz",&nbsp;"S_norm",&nbsp;"Sx",&nbsp;"Sx_sz",&nbsp;"Sx_norm"]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1335">1335</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vectors2filter&nbsp;=&nbsp;["gammas",&nbsp;"q",&nbsp;"R2"]</td><td class="diff_next"></td><td class="diff_header" id="to0_1894">1894</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vectors2filter&nbsp;=&nbsp;["gammas",&nbsp;"q",&nbsp;"R2"]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1336">1336</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;name_attr&nbsp;in&nbsp;matrixes2filter:</td><td class="diff_next"></td><td class="diff_header" id="to0_1895">1895</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;name_attr&nbsp;in&nbsp;matrixes2filter:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1337">1337</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;hasattr(self,&nbsp;name_attr):</td><td class="diff_next"></td><td class="diff_header" id="to0_1896">1896</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;hasattr(self,&nbsp;name_attr):</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1338">1338</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setattr(self,&nbsp;name_attr,&nbsp;getattr(self,&nbsp;name_attr)[tmp_filter,&nbsp;:])</td><td class="diff_next"></td><td class="diff_header" id="to0_1897">1897</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setattr(self,&nbsp;name_attr,&nbsp;getattr(self,&nbsp;name_attr)[tmp_filter,&nbsp;:])</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__50"></td><td class="diff_header" id="from0_1339">1339</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;name_attr&nbsp;in&nbsp;vectors2filter:</td><td class="diff_next"></td><td class="diff_header" id="to0_1898">1898</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;name_attr&nbsp;in&nbsp;vectors2filter:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1340">1340</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;hasattr(self,&nbsp;name_attr):</td><td class="diff_next"></td><td class="diff_header" id="to0_1899">1899</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;hasattr(self,&nbsp;name_attr):</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1341">1341</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setattr(self,&nbsp;name_attr,&nbsp;getattr(self,&nbsp;name_attr)[tmp_filter])</td><td class="diff_next"></td><td class="diff_header" id="to0_1900">1900</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setattr(self,&nbsp;name_attr,&nbsp;getattr(self,&nbsp;name_attr)[tmp_filter])</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1342">1342</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1901">1901</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1343">1343</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1902">1902</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__51">n</a></td><td class="diff_header" id="from0_1344">1344</td><td nowrap="nowrap"><span class="diff_sub">[docs]</span>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;predict_U(self,&nbsp;which_gamma:&nbsp;str="gammas",&nbsp;which_S:&nbsp;str=&nbsp;"Sx_sz",&nbsp;which_offset:&nbsp;str="q")&nbsp;-&gt;&nbsp;None:</td><td class="diff_next"><a href="#difflib_chg_to0__51">n</a></td><td class="diff_header" id="to0_1903">1903</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;predict_U(self,&nbsp;which_gamma:&nbsp;str="gammas",&nbsp;which_S:&nbsp;str=&nbsp;"Sx_sz",&nbsp;which_offset:&nbsp;str="q")&nbsp;-&gt;&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1345">1345</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Predict&nbsp;U&nbsp;(gamma&nbsp;*&nbsp;S)&nbsp;given&nbsp;the&nbsp;gamma&nbsp;model&nbsp;fit</td><td class="diff_next"></td><td class="diff_header" id="to0_1904">1904</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Predict&nbsp;U&nbsp;(gamma&nbsp;*&nbsp;S)&nbsp;given&nbsp;the&nbsp;gamma&nbsp;model&nbsp;fit</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1346">1346</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1905">1905</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1347">1347</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td><td class="diff_next"></td><td class="diff_header" id="to0_1906">1906</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1348">1348</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td><td class="diff_next"></td><td class="diff_header" id="to0_1907">1907</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1349">1349</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;which_gamma:&nbsp;str,&nbsp;default="gammas"</td><td class="diff_next"></td><td class="diff_header" id="to0_1908">1908</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;which_gamma:&nbsp;str,&nbsp;default="gammas"</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1350">1350</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;of&nbsp;the&nbsp;attribute&nbsp;to&nbsp;use&nbsp;as&nbsp;gamma</td><td class="diff_next"></td><td class="diff_header" id="to0_1909">1909</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;of&nbsp;the&nbsp;attribute&nbsp;to&nbsp;use&nbsp;as&nbsp;gamma</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1351">1351</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;which_S:&nbsp;str,&nbsp;default="Sx_sz"</td><td class="diff_next"></td><td class="diff_header" id="to0_1910">1910</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;which_S:&nbsp;str,&nbsp;default="Sx_sz"</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1352">1352</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;of&nbsp;the&nbsp;attribute&nbsp;to&nbsp;use&nbsp;as&nbsp;S</td><td class="diff_next"></td><td class="diff_header" id="to0_1911">1911</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;of&nbsp;the&nbsp;attribute&nbsp;to&nbsp;use&nbsp;as&nbsp;S</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1353">1353</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;which_offset:&nbsp;str,&nbsp;default="q"</td><td class="diff_next"></td><td class="diff_header" id="to0_1912">1912</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;which_offset:&nbsp;str,&nbsp;default="q"</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1354">1354</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;of&nbsp;the&nbsp;attribute&nbsp;containing&nbsp;the&nbsp;offset</td><td class="diff_next"></td><td class="diff_header" id="to0_1913">1913</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;of&nbsp;the&nbsp;attribute&nbsp;containing&nbsp;the&nbsp;offset</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1355">1355</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1914">1914</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1356">1356</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td><td class="diff_next"></td><td class="diff_header" id="to0_1915">1915</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1357">1357</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;------</td><td class="diff_next"></td><td class="diff_header" id="to0_1916">1916</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1358">1358</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Noting&nbsp;but&nbsp;it&nbsp;creates&nbsp;the&nbsp;attribute</td><td class="diff_next"></td><td class="diff_header" id="to0_1917">1917</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Noting&nbsp;but&nbsp;it&nbsp;creates&nbsp;the&nbsp;attribute</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1359">1359</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Upred:&nbsp;np.ndarray</td><td class="diff_next"></td><td class="diff_header" id="to0_1918">1918</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Upred:&nbsp;np.ndarray</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1360">1360</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unspliced&nbsp;estimated&nbsp;as&nbsp;`gamma&nbsp;*&nbsp;S`</td><td class="diff_next"></td><td class="diff_header" id="to0_1919">1919</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unspliced&nbsp;estimated&nbsp;as&nbsp;`gamma&nbsp;*&nbsp;S`</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1361">1361</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_1920">1920</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1362">1362</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.which_S_for_pred&nbsp;=&nbsp;which_S</td><td class="diff_next"></td><td class="diff_header" id="to0_1921">1921</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.which_S_for_pred&nbsp;=&nbsp;which_S</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1363">1363</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;which_offset&nbsp;is&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_1922">1922</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;which_offset&nbsp;is&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1364">1364</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;hasattr(self,&nbsp;"q_W")&nbsp;or&nbsp;hasattr(self,&nbsp;"q"):</td><td class="diff_next"></td><td class="diff_header" id="to0_1923">1923</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;hasattr(self,&nbsp;"q_W")&nbsp;or&nbsp;hasattr(self,&nbsp;"q"):</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1365">1365</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warn("Predicting&nbsp;U&nbsp;without&nbsp;intercept&nbsp;but&nbsp;intercept&nbsp;was&nbsp;previously&nbsp;fit!&nbsp;Set&nbsp;which_offset='q'&nbsp;or&nbsp;'q_W'&nbsp;")</td><td class="diff_next"></td><td class="diff_header" id="to0_1924">1924</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warn("Predicting&nbsp;U&nbsp;without&nbsp;intercept&nbsp;but&nbsp;intercept&nbsp;was&nbsp;previously&nbsp;fit!&nbsp;Set&nbsp;which_offset='q'&nbsp;or&nbsp;'q_W'&nbsp;")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1366">1366</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Upred&nbsp;=&nbsp;getattr(self,&nbsp;which_gamma)[:,&nbsp;None]&nbsp;*&nbsp;getattr(self,&nbsp;which_S)</td><td class="diff_next"></td><td class="diff_header" id="to0_1925">1925</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Upred&nbsp;=&nbsp;getattr(self,&nbsp;which_gamma)[:,&nbsp;None]&nbsp;*&nbsp;getattr(self,&nbsp;which_S)</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__51"></td><td class="diff_header" id="from0_1367">1367</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;self.Upred&nbsp;=&nbsp;self.gammas[:,&nbsp;None]&nbsp;*&nbsp;self.Sx_sz</td><td class="diff_next"></td><td class="diff_header" id="to0_1926">1926</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;self.Upred&nbsp;=&nbsp;self.gammas[:,&nbsp;None]&nbsp;*&nbsp;self.Sx_sz</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1368">1368</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_1927">1927</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__52"></td><td class="diff_header" id="from0_1369">1369</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Upred&nbsp;=&nbsp;getattr(self,&nbsp;which_gamma)[:,&nbsp;None]&nbsp;*&nbsp;getattr(self,&nbsp;which_S)&nbsp;+&nbsp;getattr(self,&nbsp;which_offset)[:,&nbsp;None]</td><td class="diff_next"></td><td class="diff_header" id="to0_1928">1928</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Upred&nbsp;=&nbsp;getattr(self,&nbsp;which_gamma)[:,&nbsp;None]&nbsp;*&nbsp;getattr(self,&nbsp;which_S)&nbsp;+&nbsp;getattr(self,&nbsp;which_offset)[:,&nbsp;None]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1370">1370</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1929">1929</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1371">1371</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1930">1930</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__52">n</a></td><td class="diff_header" id="from0_1372">1372</td><td nowrap="nowrap"><span class="diff_sub">[docs]&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;calculate_velocity(self,&nbsp;kind:&nbsp;str="residual",&nbsp;eps:&nbsp;float=None)&nbsp;-&gt;&nbsp;None:</span></td><td class="diff_next"><a href="#difflib_chg_to0__52">n</a></td><td class="diff_header" id="to0_1931">1931</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;calculate_velocity(self,&nbsp;kind:&nbsp;str="residual",&nbsp;eps:&nbsp;float=None,&nbsp;Myneighbours:&nbsp;float=None,&nbsp;VelocityFolder:&nbsp;str="/location/",&nbsp;UnsplicedFolder:&nbsp;str="/location/")&nbsp;-&gt;&nbsp;None:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1373">1373</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Calculate&nbsp;velocity</td><td class="diff_next"></td><td class="diff_header" id="to0_1932">1932</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Calculate&nbsp;velocity</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__53"><a href="#difflib_chg_to0__53">n</a></td><td class="diff_header" id="from0_1374">1374</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__53">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1375">1375</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td><td class="diff_next"></td><td class="diff_header" id="to0_1933">1933</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1376">1376</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td><td class="diff_next"></td><td class="diff_header" id="to0_1934">1934</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1377">1377</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kind:&nbsp;str,&nbsp;default="residual"</td><td class="diff_next"></td><td class="diff_header" id="to0_1935">1935</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kind:&nbsp;str,&nbsp;default="residual"</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__54"></td><td class="diff_header" id="from0_1378">1378</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"residual"&nbsp;calculates&nbsp;the&nbsp;velocity&nbsp;as&nbsp;U_measured&nbsp;-&nbsp;U_predicted</td><td class="diff_next"></td><td class="diff_header" id="to0_1936">1936</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"residual"&nbsp;calculates&nbsp;the&nbsp;velocity&nbsp;as&nbsp;U_measured&nbsp;-&nbsp;U_predicted</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__54">n</a></td><td class="diff_header" id="from0_1379">1379</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__54">n</a></td><td class="diff_header" id="to0_1937">1937</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1380">1380</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eps:&nbsp;float,&nbsp;default=None</td><td class="diff_next"></td><td class="diff_header" id="to0_1938">1938</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eps:&nbsp;float,&nbsp;default=None</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1381">1381</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;specified,&nbsp;velocities&nbsp;with&nbsp;absolute&nbsp;value&nbsp;smaller&nbsp;than&nbsp;eps&nbsp;*&nbsp;range_of_U&nbsp;will&nbsp;be&nbsp;set&nbsp;to&nbsp;0</td><td class="diff_next"></td><td class="diff_header" id="to0_1939">1939</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;specified,&nbsp;velocities&nbsp;with&nbsp;absolute&nbsp;value&nbsp;smaller&nbsp;than&nbsp;eps&nbsp;*&nbsp;range_of_U&nbsp;will&nbsp;be&nbsp;set&nbsp;to&nbsp;0</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1382">1382</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;None&nbsp;this&nbsp;step&nbsp;will&nbsp;be&nbsp;skipped</td><td class="diff_next"></td><td class="diff_header" id="to0_1940">1940</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;None&nbsp;this&nbsp;step&nbsp;will&nbsp;be&nbsp;skipped</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__55">n</a></td><td class="diff_header" id="from0_1383">1383</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__55">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__55"></td><td class="diff_header" id="from0_1384">1384</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Results</td><td class="diff_next"></td><td class="diff_header" id="to0_1941">1941</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Results</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1385">1385</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td><td class="diff_next"></td><td class="diff_header" id="to0_1942">1942</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1386">1386</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;but&nbsp;it&nbsp;creates&nbsp;the&nbsp;attribute:</td><td class="diff_next"></td><td class="diff_header" id="to0_1943">1943</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;but&nbsp;it&nbsp;creates&nbsp;the&nbsp;attribute:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1387">1387</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;velocity:&nbsp;np.ndarray</td><td class="diff_next"></td><td class="diff_header" id="to0_1944">1944</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;velocity:&nbsp;np.ndarray</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1388">1388</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;U_measured&nbsp;-&nbsp;U_predicted</td><td class="diff_next"></td><td class="diff_header" id="to0_1945">1945</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;U_measured&nbsp;-&nbsp;U_predicted</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__56">n</a></td><td class="diff_header" id="from0_1389">1389</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__56">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1390">1390</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_1946">1946</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1391">1391</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;kind&nbsp;==&nbsp;"residual":</td><td class="diff_next"></td><td class="diff_header" id="to0_1947">1947</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;kind&nbsp;==&nbsp;"residual":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1392">1392</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.which_S_for_pred&nbsp;==&nbsp;"Sx_sz":</td><td class="diff_next"></td><td class="diff_header" id="to0_1948">1948</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.which_S_for_pred&nbsp;==&nbsp;"Sx_sz":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1393">1393</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.velocity&nbsp;=&nbsp;self.Ux_sz&nbsp;-&nbsp;self.Upred</td><td class="diff_next"></td><td class="diff_header" id="to0_1949">1949</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.velocity&nbsp;=&nbsp;self.Ux_sz&nbsp;-&nbsp;self.Upred</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1394">1394</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;self.which_S_for_pred&nbsp;==&nbsp;"Sx":</td><td class="diff_next"></td><td class="diff_header" id="to0_1950">1950</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;self.which_S_for_pred&nbsp;==&nbsp;"Sx":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1395">1395</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.velocity&nbsp;=&nbsp;self.Ux&nbsp;-&nbsp;self.Upred</td><td class="diff_next"></td><td class="diff_header" id="to0_1951">1951</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.velocity&nbsp;=&nbsp;self.Ux&nbsp;-&nbsp;self.Upred</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1396">1396</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_1952">1952</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1397">1397</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NotImplementedError(f"Not&nbsp;implemented&nbsp;with&nbsp;which_S&nbsp;=&nbsp;{self.which_S_for_pred}")</td><td class="diff_next"></td><td class="diff_header" id="to0_1953">1953</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NotImplementedError(f"Not&nbsp;implemented&nbsp;with&nbsp;which_S&nbsp;=&nbsp;{self.which_S_for_pred}")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1398">1398</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_1954">1954</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__56"></td><td class="diff_header" id="from0_1399">1399</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;NotImplementedError(f"Velocity&nbsp;calculation&nbsp;kind={kind}&nbsp;is&nbsp;not&nbsp;implemented")</td><td class="diff_next"></td><td class="diff_header" id="to0_1955">1955</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;NotImplementedError(f"Velocity&nbsp;calculation&nbsp;kind={kind}&nbsp;is&nbsp;not&nbsp;implemented")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1400">1400</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1956">1956</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1401">1401</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;eps:</td><td class="diff_next"></td><td class="diff_header" id="to0_1957">1957</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;eps:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1402">1402</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimal_signed_res&nbsp;=&nbsp;self.Upred.max(1)&nbsp;*&nbsp;eps</td><td class="diff_next"></td><td class="diff_header" id="to0_1958">1958</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimal_signed_res&nbsp;=&nbsp;self.Upred.max(1)&nbsp;*&nbsp;eps</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1403">1403</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.velocity[np.abs(self.velocity)&nbsp;&lt;&nbsp;minimal_signed_res[:,&nbsp;None]]&nbsp;=&nbsp;0</td><td class="diff_next"></td><td class="diff_header" id="to0_1959">1959</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.velocity[np.abs(self.velocity)&nbsp;&lt;&nbsp;minimal_signed_res[:,&nbsp;None]]&nbsp;=&nbsp;0</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__57">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to0__57">n</a></td><td class="diff_header" id="to0_1960">1960</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rownames_genes&nbsp;=&nbsp;list(self.ra["Genes"])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1961">1961</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colnames_cells&nbsp;=&nbsp;list(self.ca["Patients"])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1962">1962</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genes_velocity&nbsp;=&nbsp;np.array(self.velocity)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1963">1963</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spliced_df&nbsp;=&nbsp;pd.DataFrame(genes_velocity,&nbsp;columns=colnames_cells,&nbsp;index=rownames_genes)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1964">1964</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"VelocityValues_NN"&nbsp;+&nbsp;str(Myneighbours)&nbsp;+&nbsp;".csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1965">1965</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(VelocityFolder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1966">1966</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spliced_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1967">1967</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#self.Upred</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1968">1968</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genes_PrUnsp&nbsp;=&nbsp;np.array(self.Upred)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1969">1969</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;preunspdf&nbsp;=&nbsp;pd.DataFrame(genes_PrUnsp,&nbsp;columns=colnames_cells,&nbsp;index=rownames_genes)</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__57"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1970">1970</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"PredictedUnspiced_NN"&nbsp;+&nbsp;str(Myneighbours)&nbsp;+&nbsp;".csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1971">1971</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(UnsplicedFolder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1972">1972</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;preunspdf.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1404">1404</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1973">1973</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1405">1405</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1974">1974</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__58">n</a></td><td class="diff_header" id="from0_1406">1406</td><td nowrap="nowrap"><span class="diff_sub">[docs]</span>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;calculate_shift(self,&nbsp;assumption:&nbsp;str="constant_velocity",&nbsp;delta_t:&nbsp;float=1)&nbsp;-&gt;&nbsp;None:</td><td class="diff_next"><a href="#difflib_chg_to0__58">n</a></td><td class="diff_header" id="to0_1975">1975</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;calculate_shift(self,&nbsp;assumption:&nbsp;str="constant_velocity",&nbsp;delta_t:&nbsp;float=1)&nbsp;-&gt;&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1407">1407</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Find&nbsp;the&nbsp;change&nbsp;(deltaS)&nbsp;in&nbsp;gene&nbsp;expression&nbsp;for&nbsp;every&nbsp;cell</td><td class="diff_next"></td><td class="diff_header" id="to0_1976">1976</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Find&nbsp;the&nbsp;change&nbsp;(deltaS)&nbsp;in&nbsp;gene&nbsp;expression&nbsp;for&nbsp;every&nbsp;cell</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1408">1408</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1977">1977</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1409">1409</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td><td class="diff_next"></td><td class="diff_header" id="to0_1978">1978</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1410">1410</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td><td class="diff_next"></td><td class="diff_header" id="to0_1979">1979</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1411">1411</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assumption:&nbsp;str,&nbsp;default="constant_velocity"</td><td class="diff_next"></td><td class="diff_header" id="to0_1980">1980</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assumption:&nbsp;str,&nbsp;default="constant_velocity"</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1412">1412</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constant_velocity&nbsp;(described&nbsp;in&nbsp;the&nbsp;paper&nbsp;as&nbsp;Model&nbsp;I)</td><td class="diff_next"></td><td class="diff_header" id="to0_1981">1981</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constant_velocity&nbsp;(described&nbsp;in&nbsp;the&nbsp;paper&nbsp;as&nbsp;Model&nbsp;I)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1413">1413</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constant_unspliced&nbsp;(described&nbsp;in&nbsp;the&nbsp;paper&nbsp;as&nbsp;Model&nbsp;II)</td><td class="diff_next"></td><td class="diff_header" id="to0_1982">1982</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constant_unspliced&nbsp;(described&nbsp;in&nbsp;the&nbsp;paper&nbsp;as&nbsp;Model&nbsp;II)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1414">1414</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_t:&nbsp;float,&nbsp;default=1</td><td class="diff_next"></td><td class="diff_header" id="to0_1983">1983</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_t:&nbsp;float,&nbsp;default=1</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1415">1415</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;time&nbsp;step&nbsp;for&nbsp;extrapolation</td><td class="diff_next"></td><td class="diff_header" id="to0_1984">1984</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;time&nbsp;step&nbsp;for&nbsp;extrapolation</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1416">1416</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_1985">1985</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1417">1417</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td><td class="diff_next"></td><td class="diff_header" id="to0_1986">1986</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1418">1418</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td><td class="diff_next"></td><td class="diff_header" id="to0_1987">1987</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__58"></td><td class="diff_header" id="from0_1419">1419</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;it&nbsp;only&nbsp;creates&nbsp;the&nbsp;following&nbsp;attributes</td><td class="diff_next"></td><td class="diff_header" id="to0_1988">1988</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;it&nbsp;only&nbsp;creates&nbsp;the&nbsp;following&nbsp;attributes</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1420">1420</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_S:&nbsp;np.ndarray</td><td class="diff_next"></td><td class="diff_header" id="to0_1989">1989</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_S:&nbsp;np.ndarray</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1421">1421</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;variation&nbsp;in&nbsp;gene&nbsp;expression</td><td class="diff_next"></td><td class="diff_header" id="to0_1990">1990</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;variation&nbsp;in&nbsp;gene&nbsp;expression</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1422">1422</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_1991">1991</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1423">1423</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;assumption&nbsp;==&nbsp;"constant_velocity":</td><td class="diff_next"></td><td class="diff_header" id="to0_1992">1992</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;assumption&nbsp;==&nbsp;"constant_velocity":</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__59">n</a></td><td class="diff_header" id="from0_1424">1424</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_S&nbsp;=&nbsp;delta_t&nbsp;*&nbsp;self.velocity</span></td><td class="diff_next"><a href="#difflib_chg_to0__59">n</a></td><td class="diff_header" id="to0_1993">1993</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_S&nbsp;=&nbsp;delta_t&nbsp;*&nbsp;self.velocity&nbsp;#where&nbsp;the&nbsp;timestep&nbsp;is&nbsp;incorporated&nbsp;into&nbsp;the&nbsp;calculation&nbsp;#here!!!!</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1425">1425</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;assumption&nbsp;==&nbsp;"constant_unspliced":</td><td class="diff_next"></td><td class="diff_header" id="to0_1994">1994</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;assumption&nbsp;==&nbsp;"constant_unspliced":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1426">1426</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Ux_sz&nbsp;=&nbsp;self.Ux_sz&nbsp;-&nbsp;offset;&nbsp;Ux_sz[Ux_sz&lt;0]&nbsp;=&nbsp;0</td><td class="diff_next"></td><td class="diff_header" id="to0_1995">1995</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Ux_sz&nbsp;=&nbsp;self.Ux_sz&nbsp;-&nbsp;offset;&nbsp;Ux_sz[Ux_sz&lt;0]&nbsp;=&nbsp;0</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1427">1427</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;maybe&nbsp;I&nbsp;should&nbsp;say&nbsp;ratio&nbsp;see&nbsp;below</td><td class="diff_next"></td><td class="diff_header" id="to0_1996">1996</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;maybe&nbsp;I&nbsp;should&nbsp;say&nbsp;ratio&nbsp;see&nbsp;below</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1428">1428</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ux_szo&nbsp;=&nbsp;self.Ux_sz&nbsp;-&nbsp;self.q[:,&nbsp;None]</td><td class="diff_next"></td><td class="diff_header" id="to0_1997">1997</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ux_szo&nbsp;=&nbsp;self.Ux_sz&nbsp;-&nbsp;self.q[:,&nbsp;None]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1429">1429</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ux_szo[Ux_szo&nbsp;&lt;&nbsp;0]&nbsp;=&nbsp;0</td><td class="diff_next"></td><td class="diff_header" id="to0_1998">1998</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ux_szo[Ux_szo&nbsp;&lt;&nbsp;0]&nbsp;=&nbsp;0</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1430">1430</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;egt&nbsp;=&nbsp;np.exp(-self.gammas&nbsp;*&nbsp;delta_t)[:,&nbsp;None]</td><td class="diff_next"></td><td class="diff_header" id="to0_1999">1999</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;egt&nbsp;=&nbsp;np.exp(-self.gammas&nbsp;*&nbsp;delta_t)[:,&nbsp;None]</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__59"></td><td class="diff_header" id="from0_1431">1431</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_S&nbsp;=&nbsp;self.Sx_sz&nbsp;*&nbsp;egt&nbsp;+&nbsp;(1&nbsp;-&nbsp;egt)&nbsp;*&nbsp;Ux_szo&nbsp;/&nbsp;self.gammas[:,&nbsp;None]&nbsp;-&nbsp;self.Sx_sz</td><td class="diff_next"></td><td class="diff_header" id="to0_2000">2000</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_S&nbsp;=&nbsp;self.Sx_sz&nbsp;*&nbsp;egt&nbsp;+&nbsp;(1&nbsp;-&nbsp;egt)&nbsp;*&nbsp;Ux_szo&nbsp;/&nbsp;self.gammas[:,&nbsp;None]&nbsp;-&nbsp;self.Sx_sz</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1432">1432</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_2001">2001</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1433">1433</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;NotImplementedError(f"Assumption&nbsp;{assumption}&nbsp;is&nbsp;not&nbsp;implemented")</td><td class="diff_next"></td><td class="diff_header" id="to0_2002">2002</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;NotImplementedError(f"Assumption&nbsp;{assumption}&nbsp;is&nbsp;not&nbsp;implemented")</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__60"></td><td class="diff_header" id="from0_1434">1434</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2003">2003</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1435">1435</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2004">2004</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__60">n</a></td><td class="diff_header" id="from0_1436">1436</td><td nowrap="nowrap"><span class="diff_sub">[docs]&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;extrapolate_cell_at_t(self,&nbsp;delta_t:&nbsp;float=1,&nbsp;clip:&nbsp;bool=True)&nbsp;-&gt;&nbsp;None:</span></td><td class="diff_next"><a href="#difflib_chg_to0__60">n</a></td><td class="diff_header" id="to0_2005">2005</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2006">2006</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;extrapolate_cell_at_t(self,&nbsp;delta_t:&nbsp;float=1,&nbsp;clip:&nbsp;bool=True,&nbsp;Myneighbours:&nbsp;float=1,&nbsp;location:&nbsp;str="/location/")&nbsp;-&gt;&nbsp;None:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1437">1437</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Extrapolate&nbsp;the&nbsp;gene&nbsp;expression&nbsp;profile&nbsp;for&nbsp;each&nbsp;cell&nbsp;after&nbsp;delta_t</td><td class="diff_next"></td><td class="diff_header" id="to0_2007">2007</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Extrapolate&nbsp;the&nbsp;gene&nbsp;expression&nbsp;profile&nbsp;for&nbsp;each&nbsp;cell&nbsp;after&nbsp;delta_t</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__61">n</a></td><td class="diff_header" id="from0_1438">1438</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__61">n</a></td><td class="diff_header" id="to0_2008">2008</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1439">1439</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td><td class="diff_next"></td><td class="diff_header" id="to0_2009">2009</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1440">1440</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td><td class="diff_next"></td><td class="diff_header" id="to0_2010">2010</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1441">1441</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_t:&nbsp;float,&nbsp;default=1</td><td class="diff_next"></td><td class="diff_header" id="to0_2011">2011</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_t:&nbsp;float,&nbsp;default=1</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1442">1442</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;time&nbsp;step&nbsp;considered&nbsp;for&nbsp;the&nbsp;extrapolation</td><td class="diff_next"></td><td class="diff_header" id="to0_2012">2012</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;time&nbsp;step&nbsp;considered&nbsp;for&nbsp;the&nbsp;extrapolation</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1443">1443</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clip:&nbsp;bool,&nbsp;default=True</td><td class="diff_next"></td><td class="diff_header" id="to0_2013">2013</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clip:&nbsp;bool,&nbsp;default=True</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1444">1444</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;True&nbsp;negative&nbsp;values&nbsp;are&nbsp;clipped&nbsp;to&nbsp;zero</td><td class="diff_next"></td><td class="diff_header" id="to0_2014">2014</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;True&nbsp;negative&nbsp;values&nbsp;are&nbsp;clipped&nbsp;to&nbsp;zero</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1445">1445</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2015">2015</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1446">1446</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td><td class="diff_next"></td><td class="diff_header" id="to0_2016">2016</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1447">1447</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td><td class="diff_next"></td><td class="diff_header" id="to0_2017">2017</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1448">1448</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;but&nbsp;it&nbsp;creates&nbsp;the&nbsp;attributes:</td><td class="diff_next"></td><td class="diff_header" id="to0_2018">2018</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;but&nbsp;it&nbsp;creates&nbsp;the&nbsp;attributes:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1449">1449</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sx_sz_t:&nbsp;np.ndarray</td><td class="diff_next"></td><td class="diff_header" id="to0_2019">2019</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sx_sz_t:&nbsp;np.ndarray</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__61"></td><td class="diff_header" id="from0_1450">1450</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;extrapolated&nbsp;expression&nbsp;profile</td><td class="diff_next"></td><td class="diff_header" id="to0_2020">2020</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;extrapolated&nbsp;expression&nbsp;profile</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1451">1451</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;used_delta_t:&nbsp;float</td><td class="diff_next"></td><td class="diff_header" id="to0_2021">2021</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;used_delta_t:&nbsp;float</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1452">1452</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stores&nbsp;delta_t&nbsp;for&nbsp;future&nbsp;usage</td><td class="diff_next"></td><td class="diff_header" id="to0_2022">2022</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stores&nbsp;delta_t&nbsp;for&nbsp;future&nbsp;usage</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1453">1453</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_2023">2023</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1454">1454</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.which_S_for_pred&nbsp;==&nbsp;"Sx_sz":</td><td class="diff_next"></td><td class="diff_header" id="to0_2024">2024</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.which_S_for_pred&nbsp;==&nbsp;"Sx_sz":</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__62">n</a></td><td class="diff_header" id="from0_1455">1455</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Sx_sz_t&nbsp;=&nbsp;self.Sx_sz&nbsp;+&nbsp;delta_t&nbsp;*&nbsp;self.delta_S</span></td><td class="diff_next"><a href="#difflib_chg_to0__62">n</a></td><td class="diff_header" id="to0_2025">2025</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Sx_sz_t&nbsp;=&nbsp;self.Sx_sz&nbsp;+&nbsp;delta_t&nbsp;*&nbsp;self.delta_S&nbsp;#extrapolated&nbsp;expression&nbsp;at&nbsp;the&nbsp;timestep&nbsp;=&nbsp;expression&nbsp;profile&nbsp;+&nbsp;timestep&nbsp;x&nbsp;variation&nbsp;in&nbsp;expression</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1456">1456</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;clip:</td><td class="diff_next"></td><td class="diff_header" id="to0_2026">2026</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;clip:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1457">1457</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Sx_sz_t&nbsp;=&nbsp;np.clip(self.Sx_sz_t,&nbsp;0,&nbsp;None)</td><td class="diff_next"></td><td class="diff_header" id="to0_2027">2027</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Sx_sz_t&nbsp;=&nbsp;np.clip(self.Sx_sz_t,&nbsp;0,&nbsp;None)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1458">1458</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.used_delta_t&nbsp;=&nbsp;delta_t</td><td class="diff_next"></td><td class="diff_header" id="to0_2028">2028</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.used_delta_t&nbsp;=&nbsp;delta_t</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1459">1459</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;self.which_S_for_pred&nbsp;==&nbsp;"Sx":</td><td class="diff_next"></td><td class="diff_header" id="to0_2029">2029</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;self.which_S_for_pred&nbsp;==&nbsp;"Sx":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1460">1460</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Sx_t&nbsp;=&nbsp;self.Sx&nbsp;+&nbsp;delta_t&nbsp;*&nbsp;self.delta_S</td><td class="diff_next"></td><td class="diff_header" id="to0_2030">2030</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Sx_t&nbsp;=&nbsp;self.Sx&nbsp;+&nbsp;delta_t&nbsp;*&nbsp;self.delta_S</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__62"></td><td class="diff_header" id="from0_1461">1461</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;clip:</td><td class="diff_next"></td><td class="diff_header" id="to0_2031">2031</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;clip:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1462">1462</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Sx_t&nbsp;=&nbsp;np.clip(self.Sx_t,&nbsp;0,&nbsp;None)</td><td class="diff_next"></td><td class="diff_header" id="to0_2032">2032</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Sx_t&nbsp;=&nbsp;np.clip(self.Sx_t,&nbsp;0,&nbsp;None)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1463">1463</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.used_delta_t&nbsp;=&nbsp;delta_t</td><td class="diff_next"></td><td class="diff_header" id="to0_2033">2033</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.used_delta_t&nbsp;=&nbsp;delta_t</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1464">1464</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_2034">2034</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1465">1465</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NotImplementedError("not&nbsp;implemented&nbsp;for&nbsp;other&nbsp;situations&nbsp;other&nbsp;than&nbsp;Sx&nbsp;or&nbsp;Sx_sz")</td><td class="diff_next"></td><td class="diff_header" id="to0_2035">2035</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NotImplementedError("not&nbsp;implemented&nbsp;for&nbsp;other&nbsp;situations&nbsp;other&nbsp;than&nbsp;Sx&nbsp;or&nbsp;Sx_sz")</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__63">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to0__63">n</a></td><td class="diff_header" id="to0_2036">2036</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#print("genes&nbsp;future&nbsp;expression&nbsp;level:&nbsp;",&nbsp;self.Sx_sz_t)&nbsp;#matrix&nbsp;of&nbsp;genes&nbsp;in&nbsp;each&nbsp;cell&nbsp;exprapolated&nbsp;future&nbsp;state</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2037">2037</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(location)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2038">2038</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rownames_genes&nbsp;=&nbsp;list(self.ra["Genes"])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2039">2039</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colnames_cells&nbsp;=&nbsp;list(self.ca["Patients"])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2040">2040</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genes_spliced&nbsp;=&nbsp;np.array(self.Sx_sz_t)</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__63"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2041">2041</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spliced_df&nbsp;=&nbsp;pd.DataFrame(genes_spliced,&nbsp;columns=colnames_cells,&nbsp;index=rownames_genes)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2042">2042</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"Future_gene_spliced_state_correspondingtoplotsforNN"&nbsp;+&nbsp;str(Myneighbours)&nbsp;+&nbsp;".csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2043">2043</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spliced_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1466">1466</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2044">2044</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1467">1467</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2045">2045</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__64">n</a></td><td class="diff_header" id="from0_1468">1468</td><td nowrap="nowrap"><span class="diff_sub">[docs]</span>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;perform_TSNE(self,&nbsp;n_dims:&nbsp;int=2,&nbsp;perplexity:&nbsp;float=30,&nbsp;initial_pos:&nbsp;np.ndarray=None,</td><td class="diff_next"><a href="#difflib_chg_to0__64">n</a></td><td class="diff_header" id="to0_2046">2046</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;perform_TSNE(self,&nbsp;n_dims:&nbsp;int=2,&nbsp;perplexity:&nbsp;float=30,&nbsp;initial_pos:&nbsp;np.ndarray=None,<span class="diff_add">&nbsp;#not&nbsp;used</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1469">1469</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theta:&nbsp;float=0.5,&nbsp;n_pca_dim:&nbsp;int=None,&nbsp;max_iter:&nbsp;int=1000)&nbsp;-&gt;&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_2047">2047</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theta:&nbsp;float=0.5,&nbsp;n_pca_dim:&nbsp;int=None,&nbsp;max_iter:&nbsp;int=1000)&nbsp;-&gt;&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1470">1470</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Perform&nbsp;TSNE&nbsp;on&nbsp;the&nbsp;PCA&nbsp;using&nbsp;barnes&nbsp;hut&nbsp;approximation</td><td class="diff_next"></td><td class="diff_header" id="to0_2048">2048</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Perform&nbsp;TSNE&nbsp;on&nbsp;the&nbsp;PCA&nbsp;using&nbsp;barnes&nbsp;hut&nbsp;approximation</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1471">1471</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_2049">2049</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1472">1472</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Perform&nbsp;TSNE</td><td class="diff_next"></td><td class="diff_header" id="to0_2050">2050</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Perform&nbsp;TSNE</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1473">1473</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug("Running&nbsp;bhtsne")</td><td class="diff_next"></td><td class="diff_header" id="to0_2051">2051</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug("Running&nbsp;bhtsne")</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__64"></td><td class="diff_header" id="from0_1474">1474</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;initial_pos&nbsp;is&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_2052">2052</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;initial_pos&nbsp;is&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1475">1475</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initial_pos&nbsp;=&nbsp;"random"</td><td class="diff_next"></td><td class="diff_header" id="to0_2053">2053</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initial_pos&nbsp;=&nbsp;"random"</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1476">1476</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bh_tsne&nbsp;=&nbsp;TSNE(n_components=n_dims,&nbsp;perplexity=perplexity,&nbsp;angle=theta,&nbsp;init=initial_pos,&nbsp;n_iter=max_iter)</td><td class="diff_next"></td><td class="diff_header" id="to0_2054">2054</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bh_tsne&nbsp;=&nbsp;TSNE(n_components=n_dims,&nbsp;perplexity=perplexity,&nbsp;angle=theta,&nbsp;init=initial_pos,&nbsp;n_iter=max_iter)</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__65"></td><td class="diff_header" id="from0_1477">1477</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ts&nbsp;=&nbsp;bh_tsne.fit_transform(self.pcs[:,&nbsp;:n_pca_dim])</td><td class="diff_next"></td><td class="diff_header" id="to0_2055">2055</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ts&nbsp;=&nbsp;bh_tsne.fit_transform(self.pcs[:,&nbsp;:n_pca_dim])</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1478">1478</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2056">2056</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__65">n</a></td><td class="diff_header" id="from0_1479">1479</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__65">n</a></td><td class="diff_header" id="to0_2057">2057</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;estimate_transition_prob(self,&nbsp;hidim:&nbsp;str="Sx_sz",&nbsp;embed:&nbsp;str="ts",&nbsp;transform:&nbsp;str="sqrt",&nbsp;#uses&nbsp;the&nbsp;principle&nbsp;components&nbsp;from&nbsp;the&nbsp;pca&nbsp;to&nbsp;calculate&nbsp;embedding&nbsp;coordinates&nbsp;for&nbsp;each&nbsp;point&nbsp;(embedding)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1480">1480</td><td nowrap="nowrap"><span class="diff_sub">[docs]&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;estimate_transition_prob(self,&nbsp;hidim:&nbsp;str="Sx_sz",&nbsp;embed:&nbsp;str="ts",&nbsp;transform:&nbsp;str="sqrt",</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1481">1481</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ndims:&nbsp;int=None,&nbsp;n_sight:&nbsp;int=None,&nbsp;psc:&nbsp;float=None,</td><td class="diff_next"></td><td class="diff_header" id="to0_2058">2058</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ndims:&nbsp;int=None,&nbsp;n_sight:&nbsp;int=None,&nbsp;psc:&nbsp;float=None,</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__66"><a href="#difflib_chg_to0__66">n</a></td><td class="diff_header" id="from0_1482">1482</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;knn_random:&nbsp;bool=<span class="diff_chg">Tru</span>e,&nbsp;sampled_fraction:&nbsp;float=0.3,</td><td class="diff_next"><a href="#difflib_chg_to0__66">n</a></td><td class="diff_header" id="to0_2059">2059</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;knn_random:&nbsp;bool=<span class="diff_chg">Fals</span>e,&nbsp;sampled_fraction:&nbsp;float=0.3,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1483">1483</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sampling_probs:&nbsp;Tuple[float,&nbsp;float]=(0.5,&nbsp;0.1),&nbsp;max_dist_embed:&nbsp;float=None,</td><td class="diff_next"></td><td class="diff_header" id="to0_2060">2060</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sampling_probs:&nbsp;Tuple[float,&nbsp;float]=(0.5,&nbsp;0.1),&nbsp;max_dist_embed:&nbsp;float=None,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1484">1484</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_jobs:&nbsp;int=4,&nbsp;threads:&nbsp;int=None,&nbsp;calculate_randomized:&nbsp;bool=True,</td><td class="diff_next"></td><td class="diff_header" id="to0_2061">2061</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_jobs:&nbsp;int=4,&nbsp;threads:&nbsp;int=None,&nbsp;calculate_randomized:&nbsp;bool=True,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1485">1485</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;random_seed:&nbsp;int=15071990,&nbsp;**kwargs)&nbsp;-&gt;&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_2062">2062</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;random_seed:&nbsp;int=15071990,&nbsp;**kwargs)&nbsp;-&gt;&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1486">1486</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Use&nbsp;correlation&nbsp;to&nbsp;estimate&nbsp;transition&nbsp;probabilities&nbsp;for&nbsp;every&nbsp;cells&nbsp;to&nbsp;its&nbsp;embedding&nbsp;neighborhood</td><td class="diff_next"></td><td class="diff_header" id="to0_2063">2063</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Use&nbsp;correlation&nbsp;to&nbsp;estimate&nbsp;transition&nbsp;probabilities&nbsp;for&nbsp;every&nbsp;cells&nbsp;to&nbsp;its&nbsp;embedding&nbsp;neighborhood</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__67">n</a></td><td class="diff_header" id="from0_1487">1487</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__67">n</a></td><td class="diff_header" id="to0_2064">2064</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1488">1488</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td><td class="diff_next"></td><td class="diff_header" id="to0_2065">2065</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1489">1489</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td><td class="diff_next"></td><td class="diff_header" id="to0_2066">2066</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1490">1490</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hidim:&nbsp;str,&nbsp;default="Sx_sz"</td><td class="diff_next"></td><td class="diff_header" id="to0_2067">2067</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hidim:&nbsp;str,&nbsp;default="Sx_sz"</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1491">1491</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;attribute&nbsp;containing&nbsp;the&nbsp;high&nbsp;dimensional&nbsp;space.&nbsp;It&nbsp;will&nbsp;be&nbsp;retrieved&nbsp;as&nbsp;getattr(self,&nbsp;hidim)</td><td class="diff_next"></td><td class="diff_header" id="to0_2068">2068</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;attribute&nbsp;containing&nbsp;the&nbsp;high&nbsp;dimensional&nbsp;space.&nbsp;It&nbsp;will&nbsp;be&nbsp;retrieved&nbsp;as&nbsp;getattr(self,&nbsp;hidim)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1492">1492</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;updated&nbsp;vector&nbsp;at&nbsp;time&nbsp;t&nbsp;is&nbsp;assumed&nbsp;to&nbsp;be&nbsp;getattr(self,&nbsp;hidim&nbsp;+&nbsp;"_t")</td><td class="diff_next"></td><td class="diff_header" id="to0_2069">2069</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;updated&nbsp;vector&nbsp;at&nbsp;time&nbsp;t&nbsp;is&nbsp;assumed&nbsp;to&nbsp;be&nbsp;getattr(self,&nbsp;hidim&nbsp;+&nbsp;"_t")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1493">1493</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Appending&nbsp;.T&nbsp;to&nbsp;the&nbsp;string&nbsp;will&nbsp;transpose&nbsp;the&nbsp;matrix&nbsp;(useful&nbsp;in&nbsp;case&nbsp;we&nbsp;want&nbsp;to&nbsp;use&nbsp;S&nbsp;or&nbsp;Sx)</td><td class="diff_next"></td><td class="diff_header" id="to0_2070">2070</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Appending&nbsp;.T&nbsp;to&nbsp;the&nbsp;string&nbsp;will&nbsp;transpose&nbsp;the&nbsp;matrix&nbsp;(useful&nbsp;in&nbsp;case&nbsp;we&nbsp;want&nbsp;to&nbsp;use&nbsp;S&nbsp;or&nbsp;Sx)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1494">1494</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;embed:&nbsp;str,&nbsp;default="ts"</td><td class="diff_next"></td><td class="diff_header" id="to0_2071">2071</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;embed:&nbsp;str,&nbsp;default="ts"</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1495">1495</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;attribute&nbsp;containing&nbsp;the&nbsp;embedding.&nbsp;It&nbsp;will&nbsp;be&nbsp;retrieved&nbsp;as&nbsp;getattr(self,&nbsp;embed)</td><td class="diff_next"></td><td class="diff_header" id="to0_2072">2072</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;attribute&nbsp;containing&nbsp;the&nbsp;embedding.&nbsp;It&nbsp;will&nbsp;be&nbsp;retrieved&nbsp;as&nbsp;getattr(self,&nbsp;embed)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1496">1496</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;transform:&nbsp;str,&nbsp;default="sqrt"</td><td class="diff_next"></td><td class="diff_header" id="to0_2073">2073</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;transform:&nbsp;str,&nbsp;default="sqrt"</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1497">1497</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;transformation&nbsp;that&nbsp;is&nbsp;applies&nbsp;on&nbsp;the&nbsp;high&nbsp;dimensional&nbsp;space.</td><td class="diff_next"></td><td class="diff_header" id="to0_2074">2074</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;transformation&nbsp;that&nbsp;is&nbsp;applies&nbsp;on&nbsp;the&nbsp;high&nbsp;dimensional&nbsp;space.</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1498">1498</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;None&nbsp;the&nbsp;raw&nbsp;data&nbsp;will&nbsp;be&nbsp;used</td><td class="diff_next"></td><td class="diff_header" id="to0_2075">2075</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;None&nbsp;the&nbsp;raw&nbsp;data&nbsp;will&nbsp;be&nbsp;used</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1499">1499</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ndims:&nbsp;int,&nbsp;default=None</td><td class="diff_next"></td><td class="diff_header" id="to0_2076">2076</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ndims:&nbsp;int,&nbsp;default=None</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1500">1500</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;number&nbsp;of&nbsp;dimensions&nbsp;of&nbsp;the&nbsp;high&nbsp;dimensional&nbsp;space&nbsp;to&nbsp;work&nbsp;with.&nbsp;If&nbsp;None&nbsp;all&nbsp;will&nbsp;be&nbsp;considered</td><td class="diff_next"></td><td class="diff_header" id="to0_2077">2077</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;number&nbsp;of&nbsp;dimensions&nbsp;of&nbsp;the&nbsp;high&nbsp;dimensional&nbsp;space&nbsp;to&nbsp;work&nbsp;with.&nbsp;If&nbsp;None&nbsp;all&nbsp;will&nbsp;be&nbsp;considered</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1501">1501</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;It&nbsp;makes&nbsp;sense&nbsp;only&nbsp;when&nbsp;using&nbsp;principal&nbsp;components</td><td class="diff_next"></td><td class="diff_header" id="to0_2078">2078</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;It&nbsp;makes&nbsp;sense&nbsp;only&nbsp;when&nbsp;using&nbsp;principal&nbsp;components</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1502">1502</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_sight:&nbsp;int,&nbsp;default=None&nbsp;(also&nbsp;n_neighbors)</td><td class="diff_next"></td><td class="diff_header" id="to0_2079">2079</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_sight:&nbsp;int,&nbsp;default=None&nbsp;(also&nbsp;n_neighbors)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1503">1503</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;number&nbsp;of&nbsp;neighbors&nbsp;to&nbsp;take&nbsp;into&nbsp;account&nbsp;when&nbsp;performing&nbsp;the&nbsp;projection</td><td class="diff_next"></td><td class="diff_header" id="to0_2080">2080</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;number&nbsp;of&nbsp;neighbors&nbsp;to&nbsp;take&nbsp;into&nbsp;account&nbsp;when&nbsp;performing&nbsp;the&nbsp;projection</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1504">1504</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;psc:&nbsp;float,&nbsp;default=None</td><td class="diff_next"></td><td class="diff_header" id="to0_2081">2081</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;psc:&nbsp;float,&nbsp;default=None</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1505">1505</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pseudocount&nbsp;added&nbsp;in&nbsp;variance&nbsp;normalizing&nbsp;transform</td><td class="diff_next"></td><td class="diff_header" id="to0_2082">2082</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pseudocount&nbsp;added&nbsp;in&nbsp;variance&nbsp;normalizing&nbsp;transform</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1506">1506</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;None,&nbsp;1&nbsp;would&nbsp;be&nbsp;used&nbsp;for&nbsp;log,&nbsp;0&nbsp;otherwise</td><td class="diff_next"></td><td class="diff_header" id="to0_2083">2083</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;None,&nbsp;1&nbsp;would&nbsp;be&nbsp;used&nbsp;for&nbsp;log,&nbsp;0&nbsp;otherwise</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1507">1507</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;knn_random:&nbsp;bool,&nbsp;default=True</td><td class="diff_next"></td><td class="diff_header" id="to0_2084">2084</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;knn_random:&nbsp;bool,&nbsp;default=True</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1508">1508</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whether&nbsp;to&nbsp;random&nbsp;sample&nbsp;the&nbsp;neighborhoods&nbsp;to&nbsp;speedup&nbsp;calculation</td><td class="diff_next"></td><td class="diff_header" id="to0_2085">2085</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whether&nbsp;to&nbsp;random&nbsp;sample&nbsp;the&nbsp;neighborhoods&nbsp;to&nbsp;speedup&nbsp;calculation</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1509">1509</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sampling_probs:&nbsp;Tuple,&nbsp;default=(0.5,&nbsp;1)</td><td class="diff_next"></td><td class="diff_header" id="to0_2086">2086</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sampling_probs:&nbsp;Tuple,&nbsp;default=(0.5,&nbsp;1)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1510">1510</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max_dist_embed:&nbsp;float,&nbsp;default=None</td><td class="diff_next"></td><td class="diff_header" id="to0_2087">2087</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max_dist_embed:&nbsp;float,&nbsp;default=None</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1511">1511</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CURRENTLY&nbsp;NOT&nbsp;USED</td><td class="diff_next"></td><td class="diff_header" id="to0_2088">2088</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CURRENTLY&nbsp;NOT&nbsp;USED</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1512">1512</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;maximum&nbsp;distance&nbsp;allowed</td><td class="diff_next"></td><td class="diff_header" id="to0_2089">2089</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;maximum&nbsp;distance&nbsp;allowed</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1513">1513</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;None&nbsp;it&nbsp;will&nbsp;be&nbsp;set&nbsp;to&nbsp;0.25&nbsp;*&nbsp;average_distance_two_points_taken_at_random</td><td class="diff_next"></td><td class="diff_header" id="to0_2090">2090</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;None&nbsp;it&nbsp;will&nbsp;be&nbsp;set&nbsp;to&nbsp;0.25&nbsp;*&nbsp;average_distance_two_points_taken_at_random</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1514">1514</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_jobs:&nbsp;int,&nbsp;default=4</td><td class="diff_next"></td><td class="diff_header" id="to0_2091">2091</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_jobs:&nbsp;int,&nbsp;default=4</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1515">1515</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;jobs&nbsp;to&nbsp;calculate&nbsp;knn</td><td class="diff_next"></td><td class="diff_header" id="to0_2092">2092</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;jobs&nbsp;to&nbsp;calculate&nbsp;knn</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1516">1516</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this&nbsp;only&nbsp;applies&nbsp;to&nbsp;the&nbsp;knn&nbsp;search,&nbsp;for&nbsp;the&nbsp;more&nbsp;time&nbsp;consuming&nbsp;correlation&nbsp;computation&nbsp;see&nbsp;threads</td><td class="diff_next"></td><td class="diff_header" id="to0_2093">2093</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this&nbsp;only&nbsp;applies&nbsp;to&nbsp;the&nbsp;knn&nbsp;search,&nbsp;for&nbsp;the&nbsp;more&nbsp;time&nbsp;consuming&nbsp;correlation&nbsp;computation&nbsp;see&nbsp;threads</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1517">1517</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;threads:&nbsp;int,&nbsp;default=None</td><td class="diff_next"></td><td class="diff_header" id="to0_2094">2094</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;threads:&nbsp;int,&nbsp;default=None</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1518">1518</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;threads&nbsp;will&nbsp;be&nbsp;used&nbsp;for&nbsp;the&nbsp;actual&nbsp;correlation&nbsp;computation&nbsp;by&nbsp;default&nbsp;half&nbsp;of&nbsp;the&nbsp;total.</td><td class="diff_next"></td><td class="diff_header" id="to0_2095">2095</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;threads&nbsp;will&nbsp;be&nbsp;used&nbsp;for&nbsp;the&nbsp;actual&nbsp;correlation&nbsp;computation&nbsp;by&nbsp;default&nbsp;half&nbsp;of&nbsp;the&nbsp;total.</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__67"></td><td class="diff_header" id="from0_1519">1519</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;calculate_randomized:&nbsp;bool,&nbsp;default=True</td><td class="diff_next"></td><td class="diff_header" id="to0_2096">2096</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;calculate_randomized:&nbsp;bool,&nbsp;default=True</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1520">1520</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calculate&nbsp;the&nbsp;transition&nbsp;probabilities&nbsp;with&nbsp;randomized&nbsp;residuals.</td><td class="diff_next"></td><td class="diff_header" id="to0_2097">2097</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calculate&nbsp;the&nbsp;transition&nbsp;probabilities&nbsp;with&nbsp;randomized&nbsp;residuals.</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1521">1521</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;can&nbsp;be&nbsp;plotted&nbsp;downstream&nbsp;as&nbsp;a&nbsp;negative&nbsp;control&nbsp;and&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;adjust&nbsp;the&nbsp;visualization&nbsp;scale&nbsp;of&nbsp;the&nbsp;velocity&nbsp;field.</td><td class="diff_next"></td><td class="diff_header" id="to0_2098">2098</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;can&nbsp;be&nbsp;plotted&nbsp;downstream&nbsp;as&nbsp;a&nbsp;negative&nbsp;control&nbsp;and&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;adjust&nbsp;the&nbsp;visualization&nbsp;scale&nbsp;of&nbsp;the&nbsp;velocity&nbsp;field.</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1522">1522</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;random_seed:&nbsp;int,&nbsp;default=15071990</td><td class="diff_next"></td><td class="diff_header" id="to0_2099">2099</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;random_seed:&nbsp;int,&nbsp;default=15071990</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__68"></td><td class="diff_header" id="from0_1523">1523</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Random&nbsp;seed&nbsp;to&nbsp;make&nbsp;knn_random&nbsp;mode&nbsp;reproducible</td><td class="diff_next"></td><td class="diff_header" id="to0_2100">2100</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Random&nbsp;seed&nbsp;to&nbsp;make&nbsp;knn_random&nbsp;mode&nbsp;reproducible</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__68">n</a></td><td class="diff_header" id="from0_1524">1524</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__68">n</a></td><td class="diff_header" id="to0_2101">2101</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__69"></td><td class="diff_header" id="from0_1525">1525</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td><td class="diff_next"></td><td class="diff_header" id="to0_2102">2102</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1526">1526</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td><td class="diff_next"></td><td class="diff_header" id="to0_2103">2103</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1527">1527</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_2104">2104</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__69">n</a></td><td class="diff_header" id="from0_1528">1528</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__69">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1529">1529</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numba_random_seed(random_seed)</td><td class="diff_next"></td><td class="diff_header" id="to0_2105">2105</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numba_random_seed(random_seed)</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__70">n</a></td><td class="diff_header" id="from0_1530">1530</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.which_hidim&nbsp;=&nbsp;hidim</span></td><td class="diff_next"><a href="#difflib_chg_to0__70">n</a></td><td class="diff_header" id="to0_2106">2106</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.which_hidim&nbsp;=&nbsp;hidim&nbsp;#spliced&nbsp;states&nbsp;before&nbsp;timepoint&nbsp;same&nbsp;calculation&nbsp;used&nbsp;to&nbsp;calculate&nbsp;after&nbsp;just&nbsp;with&nbsp;different&nbsp;names&nbsp;for&nbsp;the&nbsp;same&nbsp;thing&nbsp;this&nbsp;is:&nbsp;self.Sx_sz</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1531">1531</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1532">1532</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;"n_neighbors"&nbsp;in&nbsp;kwargs:</td><td class="diff_next"></td><td class="diff_header" id="to0_2107">2107</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;"n_neighbors"&nbsp;in&nbsp;kwargs:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1533">1533</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_neighbors&nbsp;=&nbsp;kwargs.pop("n_neighbors")</td><td class="diff_next"></td><td class="diff_header" id="to0_2108">2108</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_neighbors&nbsp;=&nbsp;kwargs.pop("n_neighbors")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1534">1534</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;len(kwargs)&nbsp;&gt;&nbsp;0:</td><td class="diff_next"></td><td class="diff_header" id="to0_2109">2109</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;len(kwargs)&nbsp;&gt;&nbsp;0:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1535">1535</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warning(f"keyword&nbsp;arguments&nbsp;were&nbsp;passed&nbsp;but&nbsp;could&nbsp;not&nbsp;be&nbsp;interpreted&nbsp;{kwargs}")</td><td class="diff_next"></td><td class="diff_header" id="to0_2110">2110</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warning(f"keyword&nbsp;arguments&nbsp;were&nbsp;passed&nbsp;but&nbsp;could&nbsp;not&nbsp;be&nbsp;interpreted&nbsp;{kwargs}")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1536">1536</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_2111">2111</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1537">1537</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_neighbors&nbsp;=&nbsp;None</td><td class="diff_next"></td><td class="diff_header" id="to0_2112">2112</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_neighbors&nbsp;=&nbsp;None</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1538">1538</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2113">2113</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1539">1539</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n_sight&nbsp;is&nbsp;None&nbsp;and&nbsp;n_neighbors&nbsp;is&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_2114">2114</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n_sight&nbsp;is&nbsp;None&nbsp;and&nbsp;n_neighbors&nbsp;is&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1540">1540</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_neighbors&nbsp;=&nbsp;int(self.S.shape[1]&nbsp;/&nbsp;5)</td><td class="diff_next"></td><td class="diff_header" id="to0_2115">2115</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_neighbors&nbsp;=&nbsp;int(self.S.shape[1]&nbsp;/&nbsp;5)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1541">1541</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2116">2116</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1542">1542</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(n_sight&nbsp;is&nbsp;not&nbsp;None)&nbsp;and&nbsp;(n_neighbors&nbsp;is&nbsp;not&nbsp;None)&nbsp;and&nbsp;n_neighbors&nbsp;!=&nbsp;n_sight:</td><td class="diff_next"></td><td class="diff_header" id="to0_2117">2117</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(n_sight&nbsp;is&nbsp;not&nbsp;None)&nbsp;and&nbsp;(n_neighbors&nbsp;is&nbsp;not&nbsp;None)&nbsp;and&nbsp;n_neighbors&nbsp;!=&nbsp;n_sight:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1543">1543</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;ValueError("n_sight&nbsp;and&nbsp;n_neighbors&nbsp;are&nbsp;different&nbsp;names&nbsp;for&nbsp;the&nbsp;same&nbsp;parameter,&nbsp;they&nbsp;cannot&nbsp;be&nbsp;set&nbsp;differently")</td><td class="diff_next"></td><td class="diff_header" id="to0_2118">2118</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;ValueError("n_sight&nbsp;and&nbsp;n_neighbors&nbsp;are&nbsp;different&nbsp;names&nbsp;for&nbsp;the&nbsp;same&nbsp;parameter,&nbsp;they&nbsp;cannot&nbsp;be&nbsp;set&nbsp;differently")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1544">1544</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2119">2119</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1545">1545</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n_sight&nbsp;is&nbsp;not&nbsp;None&nbsp;and&nbsp;n_neighbors&nbsp;is&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_2120">2120</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n_sight&nbsp;is&nbsp;not&nbsp;None&nbsp;and&nbsp;n_neighbors&nbsp;is&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1546">1546</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_neighbors&nbsp;=&nbsp;n_sight</td><td class="diff_next"></td><td class="diff_header" id="to0_2121">2121</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_neighbors&nbsp;=&nbsp;n_sight</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1547">1547</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2122">2122</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1548">1548</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;psc&nbsp;is&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_2123">2123</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;psc&nbsp;is&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1549">1549</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;transform&nbsp;==&nbsp;"log"&nbsp;or&nbsp;transform&nbsp;==&nbsp;"logratio":</td><td class="diff_next"></td><td class="diff_header" id="to0_2124">2124</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;transform&nbsp;==&nbsp;"log"&nbsp;or&nbsp;transform&nbsp;==&nbsp;"logratio":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1550">1550</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;psc&nbsp;=&nbsp;1.</td><td class="diff_next"></td><td class="diff_header" id="to0_2125">2125</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;psc&nbsp;=&nbsp;1.</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1551">1551</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;transform&nbsp;==&nbsp;"sqrt":</td><td class="diff_next"></td><td class="diff_header" id="to0_2126">2126</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;transform&nbsp;==&nbsp;"sqrt":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1552">1552</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;psc&nbsp;=&nbsp;1e-10&nbsp;&nbsp;#&nbsp;for&nbsp;numerical&nbsp;stablity</td><td class="diff_next"></td><td class="diff_header" id="to0_2127">2127</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;psc&nbsp;=&nbsp;1e-10&nbsp;&nbsp;#&nbsp;for&nbsp;numerical&nbsp;stablity</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1553">1553</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:&nbsp;&nbsp;#&nbsp;transform&nbsp;==&nbsp;"linear":</td><td class="diff_next"></td><td class="diff_header" id="to0_2128">2128</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:&nbsp;&nbsp;#&nbsp;transform&nbsp;==&nbsp;"linear":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1554">1554</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;psc&nbsp;=&nbsp;0</td><td class="diff_next"></td><td class="diff_header" id="to0_2129">2129</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;psc&nbsp;=&nbsp;0</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1555">1555</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2130">2130</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1556">1556</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;knn_random:</td><td class="diff_next"></td><td class="diff_header" id="to0_2131">2131</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;knn_random:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1557">1557</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.random.seed(random_seed)</td><td class="diff_next"></td><td class="diff_header" id="to0_2132">2132</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.random.seed(random_seed)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1558">1558</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corr_calc&nbsp;=&nbsp;"knn_random"</td><td class="diff_next"></td><td class="diff_header" id="to0_2133">2133</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corr_calc&nbsp;=&nbsp;"knn_random"</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1559">1559</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;"pcs"&nbsp;in&nbsp;hidim:&nbsp;&nbsp;#&nbsp;sic</td><td class="diff_next"></td><td class="diff_header" id="to0_2134">2134</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;"pcs"&nbsp;in&nbsp;hidim:&nbsp;&nbsp;#&nbsp;sic</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__70"></td><td class="diff_header" id="from0_1560">1560</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim&nbsp;=&nbsp;np.array(getattr(self,&nbsp;hidim).T[:,&nbsp;:ndims],&nbsp;order="C")</td><td class="diff_next"></td><td class="diff_header" id="to0_2135">2135</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim&nbsp;=&nbsp;np.array(getattr(self,&nbsp;hidim).T[:,&nbsp;:ndims],&nbsp;order="C")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1561">1561</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim_t&nbsp;=&nbsp;np.array(getattr(self,&nbsp;hidim&nbsp;+&nbsp;"_t").T[:,&nbsp;:ndims],&nbsp;order="C")</td><td class="diff_next"></td><td class="diff_header" id="to0_2136">2136</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim_t&nbsp;=&nbsp;np.array(getattr(self,&nbsp;hidim&nbsp;+&nbsp;"_t").T[:,&nbsp;:ndims],&nbsp;order="C")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1562">1562</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_2137">2137</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1563">1563</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ndims&nbsp;is&nbsp;not&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_2138">2138</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ndims&nbsp;is&nbsp;not&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1564">1564</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;ValueError(f"ndims&nbsp;was&nbsp;set&nbsp;to&nbsp;{ndims}&nbsp;but&nbsp;hidim&nbsp;!=&nbsp;'pcs'.&nbsp;Set&nbsp;ndims&nbsp;=&nbsp;None&nbsp;for&nbsp;hidim='{hidim}'")</td><td class="diff_next"></td><td class="diff_header" id="to0_2139">2139</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;ValueError(f"ndims&nbsp;was&nbsp;set&nbsp;to&nbsp;{ndims}&nbsp;but&nbsp;hidim&nbsp;!=&nbsp;'pcs'.&nbsp;Set&nbsp;ndims&nbsp;=&nbsp;None&nbsp;for&nbsp;hidim='{hidim}'")</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__71">n</a></td><td class="diff_header" id="from0_1565">1565</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim&nbsp;=&nbsp;getattr(self,&nbsp;hidim)&nbsp;&nbsp;#&nbsp;[:,&nbsp;:ndims]</td><td class="diff_next"><a href="#difflib_chg_to0__71">n</a></td><td class="diff_header" id="to0_2140">2140</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim&nbsp;=&nbsp;getattr(self,&nbsp;hidim)&nbsp;&nbsp;#&nbsp;[:,&nbsp;:ndims]<span class="diff_add">&nbsp;hi_dim&nbsp;is&nbsp;the</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__71"></td><td class="diff_header" id="from0_1566">1566</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim_t&nbsp;=&nbsp;hi_dim&nbsp;+&nbsp;self.used_delta_t&nbsp;*&nbsp;self.delta_S&nbsp;&nbsp;#&nbsp;[:,&nbsp;:ndims]&nbsp;[:,&nbsp;:ndims]</td><td class="diff_next"></td><td class="diff_header" id="to0_2141">2141</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim_t&nbsp;=&nbsp;hi_dim&nbsp;+&nbsp;self.used_delta_t&nbsp;*&nbsp;self.delta_S&nbsp;&nbsp;#&nbsp;[:,&nbsp;:ndims]&nbsp;[:,&nbsp;:ndims]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1567">1567</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</td><td class="diff_next"></td><td class="diff_header" id="to0_2142">2142</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1568">1568</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_S_rndm&nbsp;=&nbsp;np.copy(self.delta_S)</td><td class="diff_next"></td><td class="diff_header" id="to0_2143">2143</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_S_rndm&nbsp;=&nbsp;np.copy(self.delta_S)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1569">1569</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permute_rows_nsign(self.delta_S_rndm)</td><td class="diff_next"></td><td class="diff_header" id="to0_2144">2144</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permute_rows_nsign(self.delta_S_rndm)</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__72"></td><td class="diff_header" id="from0_1570">1570</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim_t_rndm&nbsp;=&nbsp;hi_dim&nbsp;+&nbsp;self.used_delta_t&nbsp;*&nbsp;self.delta_S_rndm</td><td class="diff_next"></td><td class="diff_header" id="to0_2145">2145</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim_t_rndm&nbsp;=&nbsp;hi_dim&nbsp;+&nbsp;self.used_delta_t&nbsp;*&nbsp;self.delta_S_rndm</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__72">n</a></td><td class="diff_header" id="from0_1571">1571</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__72">n</a></td><td class="diff_header" id="to0_2146">2146</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1572">1572</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;embedding&nbsp;=&nbsp;getattr(self,&nbsp;embed)</td><td class="diff_next"></td><td class="diff_header" id="to0_2147">2147</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;embedding&nbsp;=&nbsp;getattr(self,&nbsp;embed)</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__73"></td><td class="diff_header" id="from0_1573">1573</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.embedding&nbsp;=&nbsp;embedding</td><td class="diff_next"></td><td class="diff_header" id="to0_2148">2148</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.embedding&nbsp;=&nbsp;embedding</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1574">1574</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug("Calculate&nbsp;KNN&nbsp;in&nbsp;the&nbsp;embedding&nbsp;space")</td><td class="diff_next"></td><td class="diff_header" id="to0_2149">2149</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug("Calculate&nbsp;KNN&nbsp;in&nbsp;the&nbsp;embedding&nbsp;space")</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__74"><a href="#difflib_chg_to0__73">n</a></td><td class="diff_header" id="from0_1575">1575</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nn&nbsp;=&nbsp;NearestNeighbors(n_neighbors=n_neighbors<span class="diff_sub">&nbsp;+&nbsp;1</span>,&nbsp;n_jobs=n_jobs)</td><td class="diff_next"><a href="#difflib_chg_to0__73">n</a></td><td class="diff_header" id="to0_2150">2150</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nn&nbsp;=&nbsp;NearestNeighbors(n_neighbors=n_neighbors,&nbsp;n_jobs=n_jobs)<span class="diff_add">&nbsp;#+1?</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1576">1576</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nn.fit(embedding)&nbsp;&nbsp;#&nbsp;NOTE&nbsp;should&nbsp;support&nbsp;knn&nbsp;in&nbsp;high&nbsp;dimensions</td><td class="diff_next"></td><td class="diff_header" id="to0_2151">2151</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nn.fit(embedding)&nbsp;&nbsp;#&nbsp;NOTE&nbsp;should&nbsp;support&nbsp;knn&nbsp;in&nbsp;high&nbsp;dimensions</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1577">1577</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.embedding_knn&nbsp;=&nbsp;nn.kneighbors_graph(mode="connectivity")</td><td class="diff_next"></td><td class="diff_header" id="to0_2152">2152</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.embedding_knn&nbsp;=&nbsp;nn.kneighbors_graph(mode="connectivity")</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__74">n</a></td><td class="diff_header" id="from0_1578">1578</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__74">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1579">1579</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pick&nbsp;random&nbsp;neighbours&nbsp;and&nbsp;prune&nbsp;the&nbsp;rest</td><td class="diff_next"></td><td class="diff_header" id="to0_2153">2153</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pick&nbsp;random&nbsp;neighbours&nbsp;and&nbsp;prune&nbsp;the&nbsp;rest</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__75">n</a></td><td class="diff_header" id="from0_1580">1580</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neigh_ixs&nbsp;=&nbsp;self.embedding_knn.indices.reshape((-1,&nbsp;n_neighbors<span class="diff_sub">&nbsp;+&nbsp;1</span>))</td><td class="diff_next"><a href="#difflib_chg_to0__75">n</a></td><td class="diff_header" id="to0_2154">2154</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neigh_ixs&nbsp;=&nbsp;self.embedding_knn.indices.reshape((-1,&nbsp;n_neighbors))</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1581">1581</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;=&nbsp;np.linspace(sampling_probs[0],&nbsp;sampling_probs[1],&nbsp;neigh_ixs.shape[1])</td><td class="diff_next"></td><td class="diff_header" id="to0_2155">2155</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;=&nbsp;np.linspace(sampling_probs[0],&nbsp;sampling_probs[1],&nbsp;neigh_ixs.shape[1])</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1582">1582</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;=&nbsp;p&nbsp;/&nbsp;p.sum()</td><td class="diff_next"></td><td class="diff_header" id="to0_2156">2156</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;=&nbsp;p&nbsp;/&nbsp;p.sum()</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1583">1583</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2157">2157</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1584">1584</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;There&nbsp;was&nbsp;a&nbsp;problem&nbsp;of&nbsp;API&nbsp;consistency&nbsp;because&nbsp;the&nbsp;random.choice&nbsp;can&nbsp;pick&nbsp;the&nbsp;diagonal&nbsp;value&nbsp;(or&nbsp;not)</td><td class="diff_next"></td><td class="diff_header" id="to0_2158">2158</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;There&nbsp;was&nbsp;a&nbsp;problem&nbsp;of&nbsp;API&nbsp;consistency&nbsp;because&nbsp;the&nbsp;random.choice&nbsp;can&nbsp;pick&nbsp;the&nbsp;diagonal&nbsp;value&nbsp;(or&nbsp;not)</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__75"></td><td class="diff_header" id="from0_1585">1585</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;resulting&nbsp;self.corrcoeff&nbsp;with&nbsp;different&nbsp;number&nbsp;of&nbsp;nonzero&nbsp;entry&nbsp;per&nbsp;row.</td><td class="diff_next"></td><td class="diff_header" id="to0_2159">2159</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;resulting&nbsp;self.corrcoeff&nbsp;with&nbsp;different&nbsp;number&nbsp;of&nbsp;nonzero&nbsp;entry&nbsp;per&nbsp;row.</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1586">1586</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Not&nbsp;updated&nbsp;yet&nbsp;not&nbsp;to&nbsp;break&nbsp;previous&nbsp;analyses</td><td class="diff_next"></td><td class="diff_header" id="to0_2160">2160</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Not&nbsp;updated&nbsp;yet&nbsp;not&nbsp;to&nbsp;break&nbsp;previous&nbsp;analyses</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1587">1587</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Fix&nbsp;is&nbsp;substituting&nbsp;below&nbsp;`neigh_ixs.shape[1]`&nbsp;with&nbsp;`np.arange(1,neigh_ixs.shape[1]-1)`</td><td class="diff_next"></td><td class="diff_header" id="to0_2161">2161</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Fix&nbsp;is&nbsp;substituting&nbsp;below&nbsp;`neigh_ixs.shape[1]`&nbsp;with&nbsp;`np.arange(1,neigh_ixs.shape[1]-1)`</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1588">1588</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;I&nbsp;change&nbsp;it&nbsp;here&nbsp;since&nbsp;I&nbsp;am&nbsp;doing&nbsp;some&nbsp;breaking&nbsp;changes</td><td class="diff_next"></td><td class="diff_header" id="to0_2162">2162</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;I&nbsp;change&nbsp;it&nbsp;here&nbsp;since&nbsp;I&nbsp;am&nbsp;doing&nbsp;some&nbsp;breaking&nbsp;changes</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1589">1589</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sampling_ixs&nbsp;=&nbsp;np.stack((np.random.choice(neigh_ixs.shape[1],</td><td class="diff_next"></td><td class="diff_header" id="to0_2163">2163</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sampling_ixs&nbsp;=&nbsp;np.stack((np.random.choice(neigh_ixs.shape[1],</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__76">n</a></td><td class="diff_header" id="from0_1590">1590</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size=(int(sampled_fraction&nbsp;*&nbsp;(n_neighbors<span class="diff_sub">&nbsp;+&nbsp;1</span>)),),</td><td class="diff_next"><a href="#difflib_chg_to0__76">n</a></td><td class="diff_header" id="to0_2164">2164</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size=(int(sampled_fraction&nbsp;*&nbsp;(n_neighbors)),),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1591">1591</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;replace=False,</td><td class="diff_next"></td><td class="diff_header" id="to0_2165">2165</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;replace=False,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1592">1592</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p=p)&nbsp;for&nbsp;i&nbsp;in&nbsp;range(neigh_ixs.shape[0])),&nbsp;0)</td><td class="diff_next"></td><td class="diff_header" id="to0_2166">2166</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p=p)&nbsp;for&nbsp;i&nbsp;in&nbsp;range(neigh_ixs.shape[0])),&nbsp;0)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1593">1593</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sampling_ixs&nbsp;=&nbsp;sampling_ixs</td><td class="diff_next"></td><td class="diff_header" id="to0_2167">2167</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sampling_ixs&nbsp;=&nbsp;sampling_ixs</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1594">1594</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neigh_ixs&nbsp;=&nbsp;neigh_ixs[np.arange(neigh_ixs.shape[0])[:,&nbsp;None],&nbsp;sampling_ixs]</td><td class="diff_next"></td><td class="diff_header" id="to0_2168">2168</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neigh_ixs&nbsp;=&nbsp;neigh_ixs[np.arange(neigh_ixs.shape[0])[:,&nbsp;None],&nbsp;sampling_ixs]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1595">1595</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nonzero&nbsp;=&nbsp;neigh_ixs.shape[0]&nbsp;*&nbsp;neigh_ixs.shape[1]</td><td class="diff_next"></td><td class="diff_header" id="to0_2169">2169</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nonzero&nbsp;=&nbsp;neigh_ixs.shape[0]&nbsp;*&nbsp;neigh_ixs.shape[1]</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__76"></td><td class="diff_header" id="from0_1596">1596</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.embedding_knn&nbsp;=&nbsp;sparse.csr_matrix((np.ones(nonzero),</td><td class="diff_next"></td><td class="diff_header" id="to0_2170">2170</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.embedding_knn&nbsp;=&nbsp;sparse.csr_matrix((np.ones(nonzero),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1597">1597</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neigh_ixs.ravel(),</td><td class="diff_next"></td><td class="diff_header" id="to0_2171">2171</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neigh_ixs.ravel(),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1598">1598</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.arange(0,&nbsp;nonzero&nbsp;+&nbsp;1,&nbsp;neigh_ixs.shape[1])),</td><td class="diff_next"></td><td class="diff_header" id="to0_2172">2172</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.arange(0,&nbsp;nonzero&nbsp;+&nbsp;1,&nbsp;neigh_ixs.shape[1])),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1599">1599</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shape=(neigh_ixs.shape[0],</td><td class="diff_next"></td><td class="diff_header" id="to0_2173">2173</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shape=(neigh_ixs.shape[0],</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1600">1600</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neigh_ixs.shape[0]))</td><td class="diff_next"></td><td class="diff_header" id="to0_2174">2174</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neigh_ixs.shape[0]))</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__77">n</a></td><td class="diff_header" id="from0_1601">1601</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__77">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1602">1602</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;'{self.corr_calc}'")</td><td class="diff_next"></td><td class="diff_header" id="to0_2175">2175</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;'{self.corr_calc}'")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1603">1603</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;transform&nbsp;==&nbsp;"log":</td><td class="diff_next"></td><td class="diff_header" id="to0_2176">2176</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;transform&nbsp;==&nbsp;"log":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1604">1604</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim&nbsp;=&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim</td><td class="diff_next"></td><td class="diff_header" id="to0_2177">2177</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim&nbsp;=&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1605">1605</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef&nbsp;=&nbsp;colDeltaCorLog10partial(hi_dim,&nbsp;np.log10(np.abs(delta_hi_dim)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim),&nbsp;neigh_ixs,&nbsp;threads=threads,&nbsp;psc=psc)</td><td class="diff_next"></td><td class="diff_header" id="to0_2178">2178</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef&nbsp;=&nbsp;colDeltaCorLog10partial(hi_dim,&nbsp;np.log10(np.abs(delta_hi_dim)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim),&nbsp;neigh_ixs,&nbsp;threads=threads,&nbsp;psc=psc)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1606">1606</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</td><td class="diff_next"></td><td class="diff_header" id="to0_2179">2179</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1607">1607</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</td><td class="diff_next"></td><td class="diff_header" id="to0_2180">2180</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1608">1608</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim_rndm&nbsp;=&nbsp;hi_dim_t_rndm&nbsp;-&nbsp;hi_dim</td><td class="diff_next"></td><td class="diff_header" id="to0_2181">2181</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim_rndm&nbsp;=&nbsp;hi_dim_t_rndm&nbsp;-&nbsp;hi_dim</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1609">1609</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_random&nbsp;=&nbsp;colDeltaCorLog10partial(hi_dim,&nbsp;np.log10(np.abs(delta_hi_dim_rndm)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim_rndm),&nbsp;neigh_ixs,&nbsp;threads=threads,&nbsp;psc=psc)</td><td class="diff_next"></td><td class="diff_header" id="to0_2182">2182</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_random&nbsp;=&nbsp;colDeltaCorLog10partial(hi_dim,&nbsp;np.log10(np.abs(delta_hi_dim_rndm)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim_rndm),&nbsp;neigh_ixs,&nbsp;threads=threads,&nbsp;psc=psc)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1610">1610</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;transform&nbsp;==&nbsp;"logratio":</td><td class="diff_next"></td><td class="diff_header" id="to0_2183">2183</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;transform&nbsp;==&nbsp;"logratio":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1611">1611</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log2hidim&nbsp;=&nbsp;np.log2(hi_dim&nbsp;+&nbsp;psc)</td><td class="diff_next"></td><td class="diff_header" id="to0_2184">2184</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log2hidim&nbsp;=&nbsp;np.log2(hi_dim&nbsp;+&nbsp;psc)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1612">1612</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim&nbsp;=&nbsp;np.log2(np.abs(hi_dim_t)&nbsp;+&nbsp;psc)&nbsp;-&nbsp;log2hidim</td><td class="diff_next"></td><td class="diff_header" id="to0_2185">2185</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim&nbsp;=&nbsp;np.log2(np.abs(hi_dim_t)&nbsp;+&nbsp;psc)&nbsp;-&nbsp;log2hidim</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1613">1613</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef&nbsp;=&nbsp;colDeltaCorpartial(log2hidim,&nbsp;delta_hi_dim,&nbsp;neigh_ixs,&nbsp;threads=threads)</td><td class="diff_next"></td><td class="diff_header" id="to0_2186">2186</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef&nbsp;=&nbsp;colDeltaCorpartial(log2hidim,&nbsp;delta_hi_dim,&nbsp;neigh_ixs,&nbsp;threads=threads)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1614">1614</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</td><td class="diff_next"></td><td class="diff_header" id="to0_2187">2187</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1615">1615</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</td><td class="diff_next"></td><td class="diff_header" id="to0_2188">2188</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1616">1616</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim_rndm&nbsp;=&nbsp;np.log2(np.abs(hi_dim_t_rndm)&nbsp;+&nbsp;psc)&nbsp;-&nbsp;log2hidim</td><td class="diff_next"></td><td class="diff_header" id="to0_2189">2189</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim_rndm&nbsp;=&nbsp;np.log2(np.abs(hi_dim_t_rndm)&nbsp;+&nbsp;psc)&nbsp;-&nbsp;log2hidim</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1617">1617</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_random&nbsp;=&nbsp;colDeltaCorpartial(log2hidim,&nbsp;delta_hi_dim_rndm,&nbsp;neigh_ixs,&nbsp;threads=threads)</td><td class="diff_next"></td><td class="diff_header" id="to0_2190">2190</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_random&nbsp;=&nbsp;colDeltaCorpartial(log2hidim,&nbsp;delta_hi_dim_rndm,&nbsp;neigh_ixs,&nbsp;threads=threads)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1618">1618</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;transform&nbsp;==&nbsp;"linear":</td><td class="diff_next"></td><td class="diff_header" id="to0_2191">2191</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;transform&nbsp;==&nbsp;"linear":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1619">1619</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef&nbsp;=&nbsp;colDeltaCorpartial(hi_dim,&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim,&nbsp;neigh_ixs,&nbsp;threads=threads)</td><td class="diff_next"></td><td class="diff_header" id="to0_2192">2192</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef&nbsp;=&nbsp;colDeltaCorpartial(hi_dim,&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim,&nbsp;neigh_ixs,&nbsp;threads=threads)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1620">1620</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</td><td class="diff_next"></td><td class="diff_header" id="to0_2193">2193</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1621">1621</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</td><td class="diff_next"></td><td class="diff_header" id="to0_2194">2194</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1622">1622</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_random&nbsp;=&nbsp;colDeltaCorpartial(hi_dim,&nbsp;hi_dim_t_rndm&nbsp;-&nbsp;hi_dim,&nbsp;neigh_ixs,&nbsp;threads=threads)</td><td class="diff_next"></td><td class="diff_header" id="to0_2195">2195</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_random&nbsp;=&nbsp;colDeltaCorpartial(hi_dim,&nbsp;hi_dim_t_rndm&nbsp;-&nbsp;hi_dim,&nbsp;neigh_ixs,&nbsp;threads=threads)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1623">1623</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;transform&nbsp;==&nbsp;"sqrt":</td><td class="diff_next"></td><td class="diff_header" id="to0_2196">2196</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;transform&nbsp;==&nbsp;"sqrt":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1624">1624</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim&nbsp;=&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim</td><td class="diff_next"></td><td class="diff_header" id="to0_2197">2197</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim&nbsp;=&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1625">1625</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef&nbsp;=&nbsp;colDeltaCorSqrtpartial(hi_dim,&nbsp;np.sqrt(np.abs(delta_hi_dim)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim),&nbsp;neigh_ixs,&nbsp;threads=threads,&nbsp;psc=psc)</td><td class="diff_next"></td><td class="diff_header" id="to0_2198">2198</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef&nbsp;=&nbsp;colDeltaCorSqrtpartial(hi_dim,&nbsp;np.sqrt(np.abs(delta_hi_dim)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim),&nbsp;neigh_ixs,&nbsp;threads=threads,&nbsp;psc=psc)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1626">1626</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</td><td class="diff_next"></td><td class="diff_header" id="to0_2199">2199</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1627">1627</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</td><td class="diff_next"></td><td class="diff_header" id="to0_2200">2200</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1628">1628</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim_rndm&nbsp;=&nbsp;hi_dim_t_rndm&nbsp;-&nbsp;hi_dim</td><td class="diff_next"></td><td class="diff_header" id="to0_2201">2201</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim_rndm&nbsp;=&nbsp;hi_dim_t_rndm&nbsp;-&nbsp;hi_dim</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1629">1629</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_random&nbsp;=&nbsp;colDeltaCorSqrtpartial(hi_dim,&nbsp;np.sqrt(np.abs(delta_hi_dim_rndm)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim_rndm),&nbsp;neigh_ixs,&nbsp;threads=threads,&nbsp;psc=psc)</td><td class="diff_next"></td><td class="diff_header" id="to0_2202">2202</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_random&nbsp;=&nbsp;colDeltaCorSqrtpartial(hi_dim,&nbsp;np.sqrt(np.abs(delta_hi_dim_rndm)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim_rndm),&nbsp;neigh_ixs,&nbsp;threads=threads,&nbsp;psc=psc)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1630">1630</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_2203">2203</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1631">1631</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;NotImplementedError(f"transform={transform}&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;parameter")</td><td class="diff_next"></td><td class="diff_header" id="to0_2204">2204</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;NotImplementedError(f"transform={transform}&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;parameter")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1632">1632</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.fill_diagonal(self.corrcoef,&nbsp;0)</td><td class="diff_next"></td><td class="diff_header" id="to0_2205">2205</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.fill_diagonal(self.corrcoef,&nbsp;0)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1633">1633</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;np.any(np.isnan(self.corrcoef)):</td><td class="diff_next"></td><td class="diff_header" id="to0_2206">2206</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;np.any(np.isnan(self.corrcoef)):</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1634">1634</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef[np.isnan(self.corrcoef)]&nbsp;=&nbsp;1</td><td class="diff_next"></td><td class="diff_header" id="to0_2207">2207</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef[np.isnan(self.corrcoef)]&nbsp;=&nbsp;1</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1635">1635</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warning("Nans&nbsp;encountered&nbsp;in&nbsp;corrcoef&nbsp;and&nbsp;corrected&nbsp;to&nbsp;1s.&nbsp;If&nbsp;not&nbsp;identical&nbsp;cells&nbsp;were&nbsp;present&nbsp;it&nbsp;is&nbsp;probably&nbsp;a&nbsp;small&nbsp;isolated&nbsp;cluster&nbsp;converging&nbsp;after&nbsp;imputation.")</td><td class="diff_next"></td><td class="diff_header" id="to0_2208">2208</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warning("Nans&nbsp;encountered&nbsp;in&nbsp;corrcoef&nbsp;and&nbsp;corrected&nbsp;to&nbsp;1s.&nbsp;If&nbsp;not&nbsp;identical&nbsp;cells&nbsp;were&nbsp;present&nbsp;it&nbsp;is&nbsp;probably&nbsp;a&nbsp;small&nbsp;isolated&nbsp;cluster&nbsp;converging&nbsp;after&nbsp;imputation.")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1636">1636</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</td><td class="diff_next"></td><td class="diff_header" id="to0_2209">2209</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1637">1637</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.fill_diagonal(self.corrcoef_random,&nbsp;0)</td><td class="diff_next"></td><td class="diff_header" id="to0_2210">2210</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.fill_diagonal(self.corrcoef_random,&nbsp;0)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1638">1638</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;np.any(np.isnan(self.corrcoef_random)):</td><td class="diff_next"></td><td class="diff_header" id="to0_2211">2211</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;np.any(np.isnan(self.corrcoef_random)):</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1639">1639</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_random[np.isnan(self.corrcoef_random)]&nbsp;=&nbsp;1</td><td class="diff_next"></td><td class="diff_header" id="to0_2212">2212</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_random[np.isnan(self.corrcoef_random)]&nbsp;=&nbsp;1</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1640">1640</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warning("Nans&nbsp;encountered&nbsp;in&nbsp;corrcoef_random&nbsp;and&nbsp;corrected&nbsp;to&nbsp;1s.&nbsp;If&nbsp;not&nbsp;identical&nbsp;cells&nbsp;were&nbsp;present&nbsp;it&nbsp;is&nbsp;probably&nbsp;a&nbsp;small&nbsp;isolated&nbsp;cluster&nbsp;converging&nbsp;after&nbsp;imputation.")</td><td class="diff_next"></td><td class="diff_header" id="to0_2213">2213</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warning("Nans&nbsp;encountered&nbsp;in&nbsp;corrcoef_random&nbsp;and&nbsp;corrected&nbsp;to&nbsp;1s.&nbsp;If&nbsp;not&nbsp;identical&nbsp;cells&nbsp;were&nbsp;present&nbsp;it&nbsp;is&nbsp;probably&nbsp;a&nbsp;small&nbsp;isolated&nbsp;cluster&nbsp;converging&nbsp;after&nbsp;imputation.")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1641">1641</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Done&nbsp;Correlation&nbsp;Calculation")</td><td class="diff_next"></td><td class="diff_header" id="to0_2214">2214</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Done&nbsp;Correlation&nbsp;Calculation")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1642">1642</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_2215">2215</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1643">1643</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corr_calc&nbsp;=&nbsp;"full"</td><td class="diff_next"></td><td class="diff_header" id="to0_2216">2216</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corr_calc&nbsp;=&nbsp;"full"</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1644">1644</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;"pcs"&nbsp;in&nbsp;hidim:&nbsp;&nbsp;#&nbsp;sic</td><td class="diff_next"></td><td class="diff_header" id="to0_2217">2217</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;"pcs"&nbsp;in&nbsp;hidim:&nbsp;&nbsp;#&nbsp;sic</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1645">1645</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim&nbsp;=&nbsp;np.array(getattr(self,&nbsp;hidim).T[:,&nbsp;:ndims],&nbsp;order="C")</td><td class="diff_next"></td><td class="diff_header" id="to0_2218">2218</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim&nbsp;=&nbsp;np.array(getattr(self,&nbsp;hidim).T[:,&nbsp;:ndims],&nbsp;order="C")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1646">1646</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim_t&nbsp;=&nbsp;np.array(getattr(self,&nbsp;hidim&nbsp;+&nbsp;"_t").T[:,&nbsp;:ndims],&nbsp;order="C")</td><td class="diff_next"></td><td class="diff_header" id="to0_2219">2219</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim_t&nbsp;=&nbsp;np.array(getattr(self,&nbsp;hidim&nbsp;+&nbsp;"_t").T[:,&nbsp;:ndims],&nbsp;order="C")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1647">1647</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_2220">2220</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1648">1648</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ndims&nbsp;is&nbsp;not&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_2221">2221</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ndims&nbsp;is&nbsp;not&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1649">1649</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;ValueError(f"ndims&nbsp;was&nbsp;set&nbsp;to&nbsp;{ndims}&nbsp;but&nbsp;hidim&nbsp;!=&nbsp;'pcs'.&nbsp;Set&nbsp;ndims&nbsp;=&nbsp;None&nbsp;for&nbsp;hidim='{hidim}'")</td><td class="diff_next"></td><td class="diff_header" id="to0_2222">2222</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;ValueError(f"ndims&nbsp;was&nbsp;set&nbsp;to&nbsp;{ndims}&nbsp;but&nbsp;hidim&nbsp;!=&nbsp;'pcs'.&nbsp;Set&nbsp;ndims&nbsp;=&nbsp;None&nbsp;for&nbsp;hidim='{hidim}'")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1650">1650</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim&nbsp;=&nbsp;getattr(self,&nbsp;hidim)&nbsp;&nbsp;#&nbsp;[:,&nbsp;:ndims]</td><td class="diff_next"></td><td class="diff_header" id="to0_2223">2223</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim&nbsp;=&nbsp;getattr(self,&nbsp;hidim)&nbsp;&nbsp;#&nbsp;[:,&nbsp;:ndims]</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__77"></td><td class="diff_header" id="from0_1651">1651</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim_t&nbsp;=&nbsp;hi_dim&nbsp;+&nbsp;self.used_delta_t&nbsp;*&nbsp;self.delta_S&nbsp;&nbsp;#&nbsp;[:,&nbsp;:ndims]&nbsp;[:,&nbsp;:ndims]</td><td class="diff_next"></td><td class="diff_header" id="to0_2224">2224</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim_t&nbsp;=&nbsp;hi_dim&nbsp;+&nbsp;self.used_delta_t&nbsp;*&nbsp;self.delta_S&nbsp;&nbsp;#&nbsp;[:,&nbsp;:ndims]&nbsp;[:,&nbsp;:ndims]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1652">1652</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</td><td class="diff_next"></td><td class="diff_header" id="to0_2225">2225</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1653">1653</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_S_rndm&nbsp;=&nbsp;np.copy(self.delta_S)</td><td class="diff_next"></td><td class="diff_header" id="to0_2226">2226</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_S_rndm&nbsp;=&nbsp;np.copy(self.delta_S)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1654">1654</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permute_rows_nsign(self.delta_S_rndm)</td><td class="diff_next"></td><td class="diff_header" id="to0_2227">2227</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permute_rows_nsign(self.delta_S_rndm)</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__78"></td><td class="diff_header" id="from0_1655">1655</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim_t_rndm&nbsp;=&nbsp;hi_dim&nbsp;+&nbsp;self.used_delta_t&nbsp;*&nbsp;self.delta_S_rndm</td><td class="diff_next"></td><td class="diff_header" id="to0_2228">2228</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim_t_rndm&nbsp;=&nbsp;hi_dim&nbsp;+&nbsp;self.used_delta_t&nbsp;*&nbsp;self.delta_S_rndm</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__78">n</a></td><td class="diff_header" id="from0_1656">1656</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__78">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__79"></td><td class="diff_header" id="from0_1657">1657</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;embedding&nbsp;=&nbsp;getattr(self,&nbsp;embed)</td><td class="diff_next"></td><td class="diff_header" id="to0_2229">2229</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;embedding&nbsp;=&nbsp;getattr(self,&nbsp;embed)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1658">1658</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.embedding&nbsp;=&nbsp;embedding</td><td class="diff_next"></td><td class="diff_header" id="to0_2230">2230</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.embedding&nbsp;=&nbsp;embedding</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1659">1659</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug("Calculate&nbsp;KNN&nbsp;in&nbsp;the&nbsp;embedding&nbsp;space")</td><td class="diff_next"></td><td class="diff_header" id="to0_2231">2231</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug("Calculate&nbsp;KNN&nbsp;in&nbsp;the&nbsp;embedding&nbsp;space")</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__79">n</a></td><td class="diff_header" id="from0_1660">1660</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nn&nbsp;=&nbsp;NearestNeighbors(n_neighbors=n_neighbors<span class="diff_sub">&nbsp;+&nbsp;1</span>,&nbsp;n_jobs=n_jobs)</td><td class="diff_next"><a href="#difflib_chg_to0__79">n</a></td><td class="diff_header" id="to0_2232">2232</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nn&nbsp;=&nbsp;NearestNeighbors(n_neighbors=n_neighbors,&nbsp;n_jobs=n_jobs)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1661">1661</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nn.fit(embedding)</td><td class="diff_next"></td><td class="diff_header" id="to0_2233">2233</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nn.fit(embedding)</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__80">n</a></td><td class="diff_header" id="from0_1662">1662</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.embedding_knn&nbsp;=&nbsp;nn.kneighbors_graph(mode="connectivity")</td><td class="diff_next"><a href="#difflib_chg_to0__80">n</a></td><td class="diff_header" id="to0_2234">2234</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.embedding_knn&nbsp;=&nbsp;nn.kneighbors_graph(mode="connectivity")<span class="diff_add">&nbsp;#def&nbsp;of&nbsp;embedding_knn</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1663">1663</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1664">1664</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug("Correlation&nbsp;Calculation&nbsp;'full'")</td><td class="diff_next"></td><td class="diff_header" id="to0_2235">2235</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug("Correlation&nbsp;Calculation&nbsp;'full'")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1665">1665</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;transform&nbsp;==&nbsp;"log":</td><td class="diff_next"></td><td class="diff_header" id="to0_2236">2236</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;transform&nbsp;==&nbsp;"log":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1666">1666</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim&nbsp;=&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim</td><td class="diff_next"></td><td class="diff_header" id="to0_2237">2237</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim&nbsp;=&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1667">1667</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef&nbsp;=&nbsp;colDeltaCorLog10(hi_dim,&nbsp;np.log10(np.abs(delta_hi_dim)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim),&nbsp;threads=threads,&nbsp;psc=psc)</td><td class="diff_next"></td><td class="diff_header" id="to0_2238">2238</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef&nbsp;=&nbsp;colDeltaCorLog10(hi_dim,&nbsp;np.log10(np.abs(delta_hi_dim)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim),&nbsp;threads=threads,&nbsp;psc=psc)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1668">1668</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</td><td class="diff_next"></td><td class="diff_header" id="to0_2239">2239</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1669">1669</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</td><td class="diff_next"></td><td class="diff_header" id="to0_2240">2240</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1670">1670</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim_rndm&nbsp;=&nbsp;hi_dim_t_rndm&nbsp;-&nbsp;hi_dim</td><td class="diff_next"></td><td class="diff_header" id="to0_2241">2241</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim_rndm&nbsp;=&nbsp;hi_dim_t_rndm&nbsp;-&nbsp;hi_dim</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1671">1671</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_random&nbsp;=&nbsp;colDeltaCorLog10(hi_dim,&nbsp;np.log10(np.abs(delta_hi_dim_rndm)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim_rndm),&nbsp;threads=threads,&nbsp;psc=psc)</td><td class="diff_next"></td><td class="diff_header" id="to0_2242">2242</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_random&nbsp;=&nbsp;colDeltaCorLog10(hi_dim,&nbsp;np.log10(np.abs(delta_hi_dim_rndm)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim_rndm),&nbsp;threads=threads,&nbsp;psc=psc)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1672">1672</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;transform&nbsp;==&nbsp;"logratio":</td><td class="diff_next"></td><td class="diff_header" id="to0_2243">2243</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;transform&nbsp;==&nbsp;"logratio":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1673">1673</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log2hidim&nbsp;=&nbsp;np.log2(hi_dim&nbsp;+&nbsp;psc)</td><td class="diff_next"></td><td class="diff_header" id="to0_2244">2244</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log2hidim&nbsp;=&nbsp;np.log2(hi_dim&nbsp;+&nbsp;psc)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1674">1674</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim&nbsp;=&nbsp;np.log2(np.abs(hi_dim_t)&nbsp;+&nbsp;psc)&nbsp;-&nbsp;log2hidim</td><td class="diff_next"></td><td class="diff_header" id="to0_2245">2245</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim&nbsp;=&nbsp;np.log2(np.abs(hi_dim_t)&nbsp;+&nbsp;psc)&nbsp;-&nbsp;log2hidim</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1675">1675</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef&nbsp;=&nbsp;colDeltaCor(log2hidim,&nbsp;delta_hi_dim,&nbsp;threads=threads)</td><td class="diff_next"></td><td class="diff_header" id="to0_2246">2246</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef&nbsp;=&nbsp;colDeltaCor(log2hidim,&nbsp;delta_hi_dim,&nbsp;threads=threads)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1676">1676</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</td><td class="diff_next"></td><td class="diff_header" id="to0_2247">2247</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1677">1677</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</td><td class="diff_next"></td><td class="diff_header" id="to0_2248">2248</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1678">1678</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim_rndm&nbsp;=&nbsp;np.log2(np.abs(hi_dim_t_rndm)&nbsp;+&nbsp;1)&nbsp;-&nbsp;log2hidim</td><td class="diff_next"></td><td class="diff_header" id="to0_2249">2249</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim_rndm&nbsp;=&nbsp;np.log2(np.abs(hi_dim_t_rndm)&nbsp;+&nbsp;1)&nbsp;-&nbsp;log2hidim</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__80"></td><td class="diff_header" id="from0_1679">1679</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_random&nbsp;=&nbsp;colDeltaCor(log2hidim,&nbsp;delta_hi_dim_rndm,&nbsp;threads=threads)</td><td class="diff_next"></td><td class="diff_header" id="to0_2250">2250</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_random&nbsp;=&nbsp;colDeltaCor(log2hidim,&nbsp;delta_hi_dim_rndm,&nbsp;threads=threads)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1680">1680</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;transform&nbsp;==&nbsp;"linear":</td><td class="diff_next"></td><td class="diff_header" id="to0_2251">2251</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;transform&nbsp;==&nbsp;"linear":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1681">1681</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef&nbsp;=&nbsp;colDeltaCor(hi_dim,&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim,&nbsp;threads=threads)</td><td class="diff_next"></td><td class="diff_header" id="to0_2252">2252</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef&nbsp;=&nbsp;colDeltaCor(hi_dim,&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim,&nbsp;threads=threads)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1682">1682</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</td><td class="diff_next"></td><td class="diff_header" id="to0_2253">2253</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__81"></td><td class="diff_header" id="from0_1683">1683</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</td><td class="diff_next"></td><td class="diff_header" id="to0_2254">2254</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__81">n</a></td><td class="diff_header" id="from0_1684">1684</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_random&nbsp;=&nbsp;colDeltaCor(hi_dim,&nbsp;hi_dim_t_rndm&nbsp;-&nbsp;hi_dim,&nbsp;threads=threads<span class="diff_sub">,&nbsp;psc=psc</span>)</td><td class="diff_next"><a href="#difflib_chg_to0__81">n</a></td><td class="diff_header" id="to0_2255">2255</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_random&nbsp;=&nbsp;colDeltaCor(hi_dim,&nbsp;hi_dim_t_rndm&nbsp;-&nbsp;hi_dim,&nbsp;threads=threads)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1685">1685</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;transform&nbsp;==&nbsp;"sqrt":</td><td class="diff_next"></td><td class="diff_header" id="to0_2256">2256</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;transform&nbsp;==&nbsp;"sqrt":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1686">1686</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim&nbsp;=&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim</td><td class="diff_next"></td><td class="diff_header" id="to0_2257">2257</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim&nbsp;=&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1687">1687</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef&nbsp;=&nbsp;colDeltaCorSqrt(hi_dim,&nbsp;np.sqrt(np.abs(delta_hi_dim)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim),&nbsp;threads=threads,&nbsp;psc=psc)</td><td class="diff_next"></td><td class="diff_header" id="to0_2258">2258</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef&nbsp;=&nbsp;colDeltaCorSqrt(hi_dim,&nbsp;np.sqrt(np.abs(delta_hi_dim)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim),&nbsp;threads=threads,&nbsp;psc=psc)</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__82">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to0__82">n</a></td><td class="diff_header" id="to0_2259">2259</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1688">1688</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</td><td class="diff_next"></td><td class="diff_header" id="to0_2260">2260</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1689">1689</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</td><td class="diff_next"></td><td class="diff_header" id="to0_2261">2261</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug(f"Correlation&nbsp;Calculation&nbsp;for&nbsp;negative&nbsp;control")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1690">1690</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim_rndm&nbsp;=&nbsp;hi_dim_t_rndm&nbsp;-&nbsp;hi_dim</td><td class="diff_next"></td><td class="diff_header" id="to0_2262">2262</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_hi_dim_rndm&nbsp;=&nbsp;hi_dim_t_rndm&nbsp;-&nbsp;hi_dim</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1691">1691</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_random&nbsp;=&nbsp;colDeltaCorSqrt(hi_dim,&nbsp;np.sqrt(np.abs(delta_hi_dim_rndm)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim_rndm),&nbsp;threads=threads,&nbsp;psc=psc)</td><td class="diff_next"></td><td class="diff_header" id="to0_2263">2263</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.corrcoef_random&nbsp;=&nbsp;colDeltaCorSqrt(hi_dim,&nbsp;np.sqrt(np.abs(delta_hi_dim_rndm)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim_rndm),&nbsp;threads=threads,&nbsp;psc=psc)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1692">1692</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_2264">2264</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__82"></td><td class="diff_header" id="from0_1693">1693</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;NotImplementedError(f"transform={transform}&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;parameter")</td><td class="diff_next"></td><td class="diff_header" id="to0_2265">2265</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;NotImplementedError(f"transform={transform}&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;parameter")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1694">1694</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.fill_diagonal(self.corrcoef,&nbsp;0)</td><td class="diff_next"></td><td class="diff_header" id="to0_2266">2266</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.fill_diagonal(self.corrcoef,&nbsp;0)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1695">1695</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</td><td class="diff_next"></td><td class="diff_header" id="to0_2267">2267</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calculate_randomized:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1696">1696</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.fill_diagonal(self.corrcoef_random,&nbsp;0)</td><td class="diff_next"></td><td class="diff_header" id="to0_2268">2268</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.fill_diagonal(self.corrcoef_random,&nbsp;0)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1697">1697</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2269">2269</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__83">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to0__83">n</a></td><td class="diff_header" id="to0_2270">2270</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2271">2271</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colnames_cells&nbsp;=&nbsp;list(self.ca["Patients"])&nbsp;#shape&nbsp;of&nbsp;all:&nbsp;(rows=genes,&nbsp;cols=samples)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2272">2272</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rownames_genes&nbsp;=&nbsp;list(self.ra["Genes"])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2273">2273</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp&nbsp;=&nbsp;np.array(hi_dim)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2274">2274</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp_df&nbsp;=&nbsp;pd.DataFrame(tp,&nbsp;columns=colnames_cells,&nbsp;index=rownames_genes)&nbsp;&nbsp;#emat=&nbsp;hi_dim&nbsp;#expression</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2275">2275</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"emat_tSNE.csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2276">2276</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#tp_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2277">2277</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2278">2278</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqrtdmat&nbsp;=&nbsp;np.sqrt(np.abs(delta_hi_dim)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim)</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__83"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2279">2279</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp&nbsp;=&nbsp;np.array(sqrtdmat)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2280">2280</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"sqrt_dmat_tSNE.csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2281">2281</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp_df&nbsp;=&nbsp;pd.DataFrame(tp,&nbsp;columns=colnames_cells,&nbsp;index=rownames_genes)&nbsp;&nbsp;#dmat&nbsp;=&nbsp;np.sqrt(np.abs(delta_hi_dim)&nbsp;+&nbsp;psc)&nbsp;*&nbsp;np.sign(delta_hi_dim)&nbsp;#dmat&nbsp;are&nbsp;the&nbsp;ve,locities</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2282">2282</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#tp_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)&nbsp;&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1698">1698</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2283">2283</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__84">n</a></td><td class="diff_header" id="from0_1699">1699</td><td nowrap="nowrap"><span class="diff_sub">[docs]&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;calculate_embedding_shift(self,&nbsp;sigma_corr:&nbsp;float=0.05,&nbsp;expression_scaling:&nbsp;bool=True,&nbsp;scaling_penalty:&nbsp;float=1.)&nbsp;-&gt;&nbsp;None:</span></td><td class="diff_next"><a href="#difflib_chg_to0__84">n</a></td><td class="diff_header" id="to0_2284">2284</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alt_dmat&nbsp;=&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2285">2285</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp&nbsp;=&nbsp;np.array(alt_dmat)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2286">2286</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp_df&nbsp;=&nbsp;pd.DataFrame(tp,&nbsp;columns=colnames_cells,&nbsp;index=rownames_genes)&nbsp;&nbsp;#&nbsp;alt&nbsp;dmat:&nbsp;hi_dim_t&nbsp;-&nbsp;hi_dim&nbsp;(for&nbsp;linear)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2287">2287</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"linear_dmat_tSNE.csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2288">2288</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#tp_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)&nbsp;&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2289">2289</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2290">2290</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp&nbsp;=&nbsp;np.array(self.corrcoef)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2291">2291</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp_df&nbsp;=&nbsp;pd.DataFrame(tp,&nbsp;columns=colnames_cells,&nbsp;index=colnames_cells)&nbsp;&nbsp;#&nbsp;raw&nbsp;cc&nbsp;values&nbsp;withot&nbsp;any&nbsp;alt</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2292">2292</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"CorrelationCoefficients_Raw_tSNE.csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2293">2293</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#tp_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)&nbsp;&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2294">2294</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2295">2295</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2296">2296</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;calculate_embedding_shift(self,&nbsp;sigma_corr:&nbsp;float=0.05,&nbsp;expression_scaling:&nbsp;bool=False,&nbsp;Myneighbours:&nbsp;float=None,&nbsp;scaling_penalty:&nbsp;float=1.,&nbsp;metadataToUse:&nbsp;str="metadata.csv",&nbsp;pathToTransitionProbabilityCode:&nbsp;str="/",&nbsp;grouptype:&nbsp;str="Strings",&nbsp;secondgroup:&nbsp;str="metadataVersion.csv",&nbsp;manyfeatures:&nbsp;str="True",&nbsp;grouptype2:&nbsp;str="Strings",&nbsp;Randomsampling:&nbsp;str="False",&nbsp;extraNNvalue:&nbsp;int=5,&nbsp;DE_location:&nbsp;str="/location/",&nbsp;selfCC_folder:&nbsp;str="/location/",&nbsp;VecX_location:&nbsp;str="/location/",&nbsp;VecY_loc:&nbsp;str="/location/",&nbsp;TP_folder:&nbsp;str="/location/",&nbsp;tSNE_GroupLevelTP:&nbsp;str="/location/")&nbsp;-&gt;&nbsp;None:&nbsp;#Use&nbsp;the&nbsp;transition&nbsp;probability&nbsp;to&nbsp;project&nbsp;the&nbsp;velocity&nbsp;direction&nbsp;on&nbsp;the&nbsp;embedding</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1700">1700</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Use&nbsp;the&nbsp;transition&nbsp;probability&nbsp;to&nbsp;project&nbsp;the&nbsp;velocity&nbsp;direction&nbsp;on&nbsp;the&nbsp;embedding</td><td class="diff_next"></td><td class="diff_header" id="to0_2297">2297</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Use&nbsp;the&nbsp;transition&nbsp;probability&nbsp;to&nbsp;project&nbsp;the&nbsp;velocity&nbsp;direction&nbsp;on&nbsp;the&nbsp;embedding</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1701">1701</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2298">2298</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1702">1702</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td><td class="diff_next"></td><td class="diff_header" id="to0_2299">2299</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1703">1703</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td><td class="diff_next"></td><td class="diff_header" id="to0_2300">2300</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1704">1704</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma_corr:&nbsp;float,&nbsp;default=0.05</td><td class="diff_next"></td><td class="diff_header" id="to0_2301">2301</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma_corr:&nbsp;float,&nbsp;default=0.05</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__84"></td><td class="diff_header" id="from0_1705">1705</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;kernel&nbsp;scaling</td><td class="diff_next"></td><td class="diff_header" id="to0_2302">2302</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;kernel&nbsp;scaling</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1706">1706</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expression_scaling:&nbsp;bool,&nbsp;default=True</td><td class="diff_next"></td><td class="diff_header" id="to0_2303">2303</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expression_scaling:&nbsp;bool,&nbsp;default=True</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1707">1707</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rescale&nbsp;arrow&nbsp;intensity&nbsp;penalizing&nbsp;arrows&nbsp;that&nbsp;explain&nbsp;very&nbsp;small&nbsp;amount&nbsp;of&nbsp;expression&nbsp;differences</td><td class="diff_next"></td><td class="diff_header" id="to0_2304">2304</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rescale&nbsp;arrow&nbsp;intensity&nbsp;penalizing&nbsp;arrows&nbsp;that&nbsp;explain&nbsp;very&nbsp;small&nbsp;amount&nbsp;of&nbsp;expression&nbsp;differences</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1708">1708</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scaling_penalty:&nbsp;float,&nbsp;default=1</td><td class="diff_next"></td><td class="diff_header" id="to0_2305">2305</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scaling_penalty:&nbsp;float,&nbsp;default=1</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1709">1709</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Higher&nbsp;values&nbsp;correspond&nbsp;to&nbsp;a&nbsp;stronger&nbsp;penalty</td><td class="diff_next"></td><td class="diff_header" id="to0_2306">2306</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Higher&nbsp;values&nbsp;correspond&nbsp;to&nbsp;a&nbsp;stronger&nbsp;penalty</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__85">n</a></td><td class="diff_header" id="from0_1710">1710</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__85">n</a></td><td class="diff_header" id="to0_2307">2307</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1711">1711</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2308">2308</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1712">1712</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td><td class="diff_next"></td><td class="diff_header" id="to0_2309">2309</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1713">1713</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td><td class="diff_next"></td><td class="diff_header" id="to0_2310">2310</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1714">1714</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;but&nbsp;it&nbsp;creates&nbsp;the&nbsp;following&nbsp;attributes:</td><td class="diff_next"></td><td class="diff_header" id="to0_2311">2311</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;but&nbsp;it&nbsp;creates&nbsp;the&nbsp;following&nbsp;attributes:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1715">1715</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;transition_prob:&nbsp;np.ndarray</td><td class="diff_next"></td><td class="diff_header" id="to0_2312">2312</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;transition_prob:&nbsp;np.ndarray</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1716">1716</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;transition&nbsp;probability&nbsp;calculated&nbsp;using&nbsp;the&nbsp;exponential&nbsp;kernel&nbsp;on&nbsp;the&nbsp;correlation&nbsp;coefficient</td><td class="diff_next"></td><td class="diff_header" id="to0_2313">2313</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;transition&nbsp;probability&nbsp;calculated&nbsp;using&nbsp;the&nbsp;exponential&nbsp;kernel&nbsp;on&nbsp;the&nbsp;correlation&nbsp;coefficient</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__85"></td><td class="diff_header" id="from0_1717">1717</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_embedding:&nbsp;np.ndarray</td><td class="diff_next"></td><td class="diff_header" id="to0_2314">2314</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_embedding:&nbsp;np.ndarray</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1718">1718</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;resulting&nbsp;vector</td><td class="diff_next"></td><td class="diff_header" id="to0_2315">2315</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;resulting&nbsp;vector</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1719">1719</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_2316">2316</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1720">1720</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Kernel&nbsp;evaluation</td><td class="diff_next"></td><td class="diff_header" id="to0_2317">2317</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Kernel&nbsp;evaluation</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__86"></td><td class="diff_header" id="from0_1721">1721</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug("Calculate&nbsp;transition&nbsp;probability")</td><td class="diff_next"></td><td class="diff_header" id="to0_2318">2318</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug("Calculate&nbsp;transition&nbsp;probability")</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__86">n</a></td><td class="diff_header" id="from0_1722">1722</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__86">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1723">1723</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.corr_calc&nbsp;==&nbsp;"full"&nbsp;or&nbsp;self.corr_calc&nbsp;==&nbsp;"knn_random":</td><td class="diff_next"></td><td class="diff_header" id="to0_2319">2319</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.corr_calc&nbsp;==&nbsp;"full"&nbsp;or&nbsp;self.corr_calc&nbsp;==&nbsp;"knn_random":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1724">1724</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;NOTE&nbsp;maybe&nbsp;sparse&nbsp;matrix&nbsp;here&nbsp;are&nbsp;slower&nbsp;than&nbsp;dense</td><td class="diff_next"></td><td class="diff_header" id="to0_2320">2320</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;NOTE&nbsp;maybe&nbsp;sparse&nbsp;matrix&nbsp;here&nbsp;are&nbsp;slower&nbsp;than&nbsp;dense</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1725">1725</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;NOTE&nbsp;if&nbsp;knn_random&nbsp;this&nbsp;could&nbsp;be&nbsp;made&nbsp;much&nbsp;faster&nbsp;either&nbsp;using&nbsp;sparse&nbsp;matrix&nbsp;or&nbsp;neigh_ixs</td><td class="diff_next"></td><td class="diff_header" id="to0_2321">2321</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;NOTE&nbsp;if&nbsp;knn_random&nbsp;this&nbsp;could&nbsp;be&nbsp;made&nbsp;much&nbsp;faster&nbsp;either&nbsp;using&nbsp;sparse&nbsp;matrix&nbsp;or&nbsp;neigh_ixs</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__87">n</a></td><td class="diff_header" id="from0_1726">1726</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transition_prob&nbsp;=&nbsp;np.exp(self.corrcoef&nbsp;/&nbsp;sigma_corr)&nbsp;*&nbsp;self.embedding_knn.A&nbsp;&nbsp;#&nbsp;naive</td><td class="diff_next"><a href="#difflib_chg_to0__87">n</a></td><td class="diff_header" id="to0_2322">2322</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transition_prob&nbsp;=&nbsp;np.exp(self.corrcoef&nbsp;/&nbsp;sigma_corr)&nbsp;*&nbsp;self.embedding_knn.A&nbsp;&nbsp;#&nbsp;naive<span class="diff_add">,&nbsp;the&nbsp;exponential&nbsp;of&nbsp;the&nbsp;correlation&nbsp;coefficient/kernal&nbsp;scaling</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__87"></td><td class="diff_header" id="from0_1727">1727</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transition_prob&nbsp;/=&nbsp;self.transition_prob.sum(1)[:,&nbsp;None]</td><td class="diff_next"></td><td class="diff_header" id="to0_2323">2323</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transition_prob&nbsp;/=&nbsp;self.transition_prob.sum(1)[:,&nbsp;None]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1728">1728</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;hasattr(self,&nbsp;"corrcoef_random"):</td><td class="diff_next"></td><td class="diff_header" id="to0_2324">2324</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;hasattr(self,&nbsp;"corrcoef_random"):</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1729">1729</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug("Calculate&nbsp;transition&nbsp;probability&nbsp;for&nbsp;negative&nbsp;control")</td><td class="diff_next"></td><td class="diff_header" id="to0_2325">2325</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.debug("Calculate&nbsp;transition&nbsp;probability&nbsp;for&nbsp;negative&nbsp;control")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1730">1730</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transition_prob_random&nbsp;=&nbsp;np.exp(self.corrcoef_random&nbsp;/&nbsp;sigma_corr)&nbsp;*&nbsp;self.embedding_knn.A&nbsp;&nbsp;#&nbsp;naive</td><td class="diff_next"></td><td class="diff_header" id="to0_2326">2326</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transition_prob_random&nbsp;=&nbsp;np.exp(self.corrcoef_random&nbsp;/&nbsp;sigma_corr)&nbsp;*&nbsp;self.embedding_knn.A&nbsp;&nbsp;#&nbsp;naive</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__88"></td><td class="diff_header" id="from0_1731">1731</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transition_prob_random&nbsp;/=&nbsp;self.transition_prob_random.sum(1)[:,&nbsp;None]</td><td class="diff_next"></td><td class="diff_header" id="to0_2327">2327</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.transition_prob_random&nbsp;/=&nbsp;self.transition_prob_random.sum(1)[:,&nbsp;None]</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__88">n</a></td><td class="diff_header" id="from0_1732">1732</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__88">n</a></td><td class="diff_header" id="to0_2328">2328</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unitary_vectors&nbsp;=&nbsp;self.embedding.T[:,&nbsp;None,&nbsp;:]&nbsp;-&nbsp;self.embedding.T[:,&nbsp;:,&nbsp;None]&nbsp;&nbsp;#&nbsp;shape&nbsp;(2,ncells,ncells)&nbsp;#for&nbsp;each&nbsp;cells&nbsp;coordinates&nbsp;-&nbsp;row1:&nbsp;cell1-cell1,&nbsp;cell2-cell1,&nbsp;cell3-cell1&nbsp;cell4-cell1</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1733">1733</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unitary_vectors&nbsp;=&nbsp;self.embedding.T[:,&nbsp;None,&nbsp;:]&nbsp;-&nbsp;self.embedding.T[:,&nbsp;:,&nbsp;None]&nbsp;&nbsp;#&nbsp;shape&nbsp;(2,ncells,ncells)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1734">1734</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;np.errstate(divide='ignore',&nbsp;invalid='ignore'):</td><td class="diff_next"></td><td class="diff_header" id="to0_2329">2329</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;np.errstate(divide='ignore',&nbsp;invalid='ignore'):</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1735">1735</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unitary_vectors&nbsp;/=&nbsp;np.linalg.norm(unitary_vectors,&nbsp;ord=2,&nbsp;axis=0)&nbsp;&nbsp;#&nbsp;divide&nbsp;by&nbsp;L2</td><td class="diff_next"></td><td class="diff_header" id="to0_2330">2330</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unitary_vectors&nbsp;/=&nbsp;np.linalg.norm(unitary_vectors,&nbsp;ord=2,&nbsp;axis=0)&nbsp;&nbsp;#&nbsp;divide&nbsp;by&nbsp;L2</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__89"><a href="#difflib_chg_to0__89">n</a></td><td class="diff_header" id="from0_1736">1736</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.fill_diagonal(unitary_vectors[0,&nbsp;...],&nbsp;0)&nbsp;&nbsp;#&nbsp;fix&nbsp;nans</td><td class="diff_next"><a href="#difflib_chg_to0__89">n</a></td><td class="diff_header" id="to0_2331">2331</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.fill_diagonal(unitary_vectors[0,&nbsp;...],&nbsp;0)&nbsp;&nbsp;#&nbsp;fix&nbsp;nans<span class="diff_add">&nbsp;replace&nbsp;NAN&nbsp;with&nbsp;0</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1737">1737</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.fill_diagonal(unitary_vectors[1,&nbsp;...],&nbsp;0)</td><td class="diff_next"></td><td class="diff_header" id="to0_2332">2332</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.fill_diagonal(unitary_vectors[1,&nbsp;...],&nbsp;0)<span class="diff_add">&nbsp;#embedding&nbsp;comes&nbsp;from&nbsp;the&nbsp;tSNE</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1738">1738</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2333">2333</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_embedding&nbsp;=&nbsp;(self.transition_prob&nbsp;*&nbsp;unitary_vectors).sum(2)&nbsp;#.A&nbsp;means&nbsp;change&nbsp;the&nbsp;data&nbsp;type&nbsp;from&nbsp;a&nbsp;matrix&nbsp;to&nbsp;an&nbsp;array&nbsp;#unit&nbsp;vector*transition&nbsp;probability</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1739">1739</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_embedding&nbsp;=&nbsp;(self.transition_prob&nbsp;*&nbsp;unitary_vectors).sum(2)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__90"></td><td class="diff_header" id="from0_1740">1740</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_embedding&nbsp;-=&nbsp;(self.embedding_knn.A&nbsp;*&nbsp;unitary_vectors).sum(2)&nbsp;/&nbsp;self.embedding_knn.sum(1).A.T</td><td class="diff_next"></td><td class="diff_header" id="to0_2334">2334</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_embedding&nbsp;-=&nbsp;(self.embedding_knn.A&nbsp;*&nbsp;unitary_vectors).sum(2)&nbsp;/&nbsp;self.embedding_knn.sum(1).A.T</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__90">n</a></td><td class="diff_header" id="from0_1741">1741</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_embedding&nbsp;=&nbsp;self.delta_embedding.T</td><td class="diff_next"><a href="#difflib_chg_to0__90">n</a></td><td class="diff_header" id="to0_2335">2335</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_embedding&nbsp;=&nbsp;self.delta_embedding.T<span class="diff_add">&nbsp;#transposes&nbsp;the&nbsp;vector</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1742">1742</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1743">1743</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;expression_scaling:</td><td class="diff_next"></td><td class="diff_header" id="to0_2336">2336</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;expression_scaling:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1744">1744</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim&nbsp;=&nbsp;getattr(self,&nbsp;self.which_hidim)</td><td class="diff_next"></td><td class="diff_header" id="to0_2337">2337</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hi_dim&nbsp;=&nbsp;getattr(self,&nbsp;self.which_hidim)</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__91">n</a></td><td class="diff_header" id="from0_1745">1745</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;estim_delta&nbsp;=&nbsp;hi_dim.dot(self.transition_prob.T)&nbsp;-&nbsp;hi_dim.dot((self.embedding_knn.A&nbsp;/&nbsp;self.embedding_knn.sum(1).A).T)</td><td class="diff_next"><a href="#difflib_chg_to0__91">n</a></td><td class="diff_header" id="to0_2338">2338</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;estim_delta&nbsp;=&nbsp;hi_dim.dot(self.transition_prob.T)&nbsp;-&nbsp;hi_dim.dot((self.embedding_knn.A&nbsp;/&nbsp;self.embedding_knn.sum(1).A).T)<span class="diff_add">&nbsp;#this&nbsp;is&nbsp;the&nbsp;same&nbsp;problem&nbsp;as&nbsp;above</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1746">1746</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos_proj&nbsp;=&nbsp;(self.delta_S&nbsp;*&nbsp;estim_delta).sum(0)&nbsp;/&nbsp;np.sqrt((estim_delta**2).sum(0))</td><td class="diff_next"></td><td class="diff_header" id="to0_2339">2339</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos_proj&nbsp;=&nbsp;(self.delta_S&nbsp;*&nbsp;estim_delta).sum(0)&nbsp;/&nbsp;np.sqrt((estim_delta**2).sum(0))</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1747">1747</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.scaling&nbsp;=&nbsp;np.clip(cos_proj&nbsp;/&nbsp;scaling_penalty,&nbsp;0,&nbsp;1)</td><td class="diff_next"></td><td class="diff_header" id="to0_2340">2340</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.scaling&nbsp;=&nbsp;np.clip(cos_proj&nbsp;/&nbsp;scaling_penalty,&nbsp;0,&nbsp;1)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1748">1748</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_embedding&nbsp;=&nbsp;self.delta_embedding&nbsp;*&nbsp;self.scaling[:,&nbsp;None]</td><td class="diff_next"></td><td class="diff_header" id="to0_2341">2341</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_embedding&nbsp;=&nbsp;self.delta_embedding&nbsp;*&nbsp;self.scaling[:,&nbsp;None]</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__91"></td><td class="diff_header" id="from0_1749">1749</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2342">2342</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1750">1750</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;hasattr(self,&nbsp;"corrcoef_random"):</td><td class="diff_next"></td><td class="diff_header" id="to0_2343">2343</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;hasattr(self,&nbsp;"corrcoef_random"):</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1751">1751</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_embedding_random&nbsp;=&nbsp;(self.transition_prob_random&nbsp;*&nbsp;unitary_vectors).sum(2)</td><td class="diff_next"></td><td class="diff_header" id="to0_2344">2344</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_embedding_random&nbsp;=&nbsp;(self.transition_prob_random&nbsp;*&nbsp;unitary_vectors).sum(2)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1752">1752</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_embedding_random&nbsp;-=&nbsp;(self.embedding_knn.A&nbsp;*&nbsp;unitary_vectors).sum(2)&nbsp;/&nbsp;self.embedding_knn.sum(1).A.T</td><td class="diff_next"></td><td class="diff_header" id="to0_2345">2345</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_embedding_random&nbsp;-=&nbsp;(self.embedding_knn.A&nbsp;*&nbsp;unitary_vectors).sum(2)&nbsp;/&nbsp;self.embedding_knn.sum(1).A.T</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1753">1753</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_embedding_random&nbsp;=&nbsp;self.delta_embedding_random.T</td><td class="diff_next"></td><td class="diff_header" id="to0_2346">2346</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_embedding_random&nbsp;=&nbsp;self.delta_embedding_random.T</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__92">n</a></td><td class="diff_header" id="from0_1754">1754</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__92">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1755">1755</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;expression_scaling:</td><td class="diff_next"></td><td class="diff_header" id="to0_2347">2347</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;expression_scaling:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1756">1756</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;estim_delta_rndm&nbsp;=&nbsp;hi_dim.dot(self.transition_prob_random.T)&nbsp;-&nbsp;hi_dim.dot((self.embedding_knn.A&nbsp;/&nbsp;self.embedding_knn.sum(1).A).T)</td><td class="diff_next"></td><td class="diff_header" id="to0_2348">2348</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;estim_delta_rndm&nbsp;=&nbsp;hi_dim.dot(self.transition_prob_random.T)&nbsp;-&nbsp;hi_dim.dot((self.embedding_knn.A&nbsp;/&nbsp;self.embedding_knn.sum(1).A).T)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1757">1757</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos_proj_rndm&nbsp;=&nbsp;(self.delta_S_rndm&nbsp;*&nbsp;estim_delta_rndm).sum(0)&nbsp;/&nbsp;np.sqrt((estim_delta_rndm**2).sum(0))</td><td class="diff_next"></td><td class="diff_header" id="to0_2349">2349</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos_proj_rndm&nbsp;=&nbsp;(self.delta_S_rndm&nbsp;*&nbsp;estim_delta_rndm).sum(0)&nbsp;/&nbsp;np.sqrt((estim_delta_rndm**2).sum(0))</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__92"></td><td class="diff_header" id="from0_1758">1758</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.scaling_rndm&nbsp;=&nbsp;np.clip(cos_proj_rndm&nbsp;/&nbsp;scaling_penalty,&nbsp;0,&nbsp;1)</td><td class="diff_next"></td><td class="diff_header" id="to0_2350">2350</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.scaling_rndm&nbsp;=&nbsp;np.clip(cos_proj_rndm&nbsp;/&nbsp;scaling_penalty,&nbsp;0,&nbsp;1)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1759">1759</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_embedding_random&nbsp;=&nbsp;self.delta_embedding_random&nbsp;*&nbsp;self.scaling_rndm[:,&nbsp;None]</td><td class="diff_next"></td><td class="diff_header" id="to0_2351">2351</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_embedding_random&nbsp;=&nbsp;self.delta_embedding_random&nbsp;*&nbsp;self.scaling_rndm[:,&nbsp;None]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1760">1760</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_2352">2352</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1761">1761</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;NOTE&nbsp;should&nbsp;implement&nbsp;a&nbsp;version&nbsp;with&nbsp;cython</td><td class="diff_next"></td><td class="diff_header" id="to0_2353">2353</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;NOTE&nbsp;should&nbsp;implement&nbsp;a&nbsp;version&nbsp;with&nbsp;cython</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1762">1762</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;NotImplementedError(f"Weird&nbsp;value&nbsp;self.corr_calc={self.corr_calc}")</td><td class="diff_next"></td><td class="diff_header" id="to0_2354">2354</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;NotImplementedError(f"Weird&nbsp;value&nbsp;self.corr_calc={self.corr_calc}")</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__93">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to0__93">n</a></td><td class="diff_header" id="to0_2355">2355</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colnames_cells&nbsp;=&nbsp;list(self.ca["Patients"])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2356">2356</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genes_embedding&nbsp;=&nbsp;np.array(self.delta_embedding)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2357">2357</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spliced_df&nbsp;=&nbsp;pd.DataFrame(genes_embedding,&nbsp;columns=["x",&nbsp;"y"],&nbsp;index=colnames_cells)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2358">2358</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"Delta_embedding_NN"&nbsp;+&nbsp;str(Myneighbours)&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(extraNNvalue)&nbsp;+&nbsp;"_tSNE.csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2359">2359</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(DE_location)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2360">2360</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#spliced_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2361">2361</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genes_embedding&nbsp;=&nbsp;np.array(self.corrcoef)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2362">2362</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spliced_df&nbsp;=&nbsp;pd.DataFrame(genes_embedding,&nbsp;columns=colnames_cells,&nbsp;index=colnames_cells)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2363">2363</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"selfCC_NN"&nbsp;+&nbsp;str(Myneighbours)&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(extraNNvalue)&nbsp;+&nbsp;"_tSNE.csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2364">2364</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(selfCC_folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2365">2365</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spliced_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2366">2366</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genes_embedding&nbsp;=&nbsp;np.array(unitary_vectors[0])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2367">2367</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spliced_df&nbsp;=&nbsp;pd.DataFrame(genes_embedding,&nbsp;columns=colnames_cells,&nbsp;index=colnames_cells)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2368">2368</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"UnVecX_NN"&nbsp;+&nbsp;str(Myneighbours)&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(extraNNvalue)&nbsp;+&nbsp;"_tSNE.csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2369">2369</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(VecX_location)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2370">2370</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#spliced_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2371">2371</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genes_embedding&nbsp;=&nbsp;np.array(unitary_vectors[1])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2372">2372</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spliced_df&nbsp;=&nbsp;pd.DataFrame(genes_embedding,&nbsp;columns=colnames_cells,&nbsp;index=colnames_cells)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2373">2373</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"UnVecY_NN"&nbsp;+&nbsp;str(Myneighbours)&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(extraNNvalue)&nbsp;+&nbsp;"_tSNE.csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2374">2374</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(VecY_loc)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2375">2375</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#spliced_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2376">2376</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp&nbsp;=&nbsp;np.array(self.transition_prob)&nbsp;#number&nbsp;of&nbsp;samples&nbsp;x&nbsp;number&nbsp;of&nbsp;samples</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2377">2377</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp_df&nbsp;=&nbsp;pd.DataFrame(tp,&nbsp;columns=colnames_cells,&nbsp;index=colnames_cells)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2378">2378</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;"Transition_Probability_NN"&nbsp;+&nbsp;str(Myneighbours)&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(extraNNvalue)&nbsp;+&nbsp;"_tSNE.csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2379">2379</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(TP_folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2380">2380</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp_df.to_csv(file_name,&nbsp;sep=",",&nbsp;header=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2381">2381</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#####RUN&nbsp;TP&nbsp;code&nbsp;here################################</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2382">2382</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#note:&nbsp;the&nbsp;following&nbsp;requires&nbsp;these&nbsp;R&nbsp;packages&nbsp;to&nbsp;be&nbsp;installed:&nbsp;&nbsp;'gtools',&nbsp;'reshape2',&nbsp;ggplot2',&nbsp;grid'&nbsp;and&nbsp;'tidyverse'</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2383">2383</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#to&nbsp;code&nbsp;to&nbsp;install&nbsp;them&nbsp;has&nbsp;been&nbsp;commented&nbsp;out&nbsp;but&nbsp;is&nbsp;below:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2384">2384</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;import&nbsp;rpy2.robjects&nbsp;as&nbsp;ro</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2385">2385</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;rpy2.robjects.packages&nbsp;import&nbsp;importr</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2386">2386</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;utils&nbsp;=&nbsp;importr('utils')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2387">2387</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('gtools')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2388">2388</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('reshape2')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2389">2389</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('ggplot2')&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2390">2390</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('grid')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2391">2391</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('tidyverse')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2392">2392</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gtools&nbsp;=&nbsp;importr("gtools")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2393">2393</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reshape2&nbsp;=&nbsp;importr("reshape2")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2394">2394</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ggplot2&nbsp;=&nbsp;importr("ggplot2")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2395">2395</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grid&nbsp;=&nbsp;importr("grid")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2396">2396</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tidyverse&nbsp;=&nbsp;importr("tidyverse")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2397">2397</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path=pathToTransitionProbabilityCode</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2398">2398</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;version&nbsp;=&nbsp;"SampleGroup1"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2399">2399</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;RunTransitionProbabilityCode(filename,&nbsp;selfremoved,&nbsp;location,&nbsp;metaGroup,&nbsp;outputdir,&nbsp;grouptype,&nbsp;version,&nbsp;Randomsampling):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2400">2400</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r=ro.r</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2401">2401</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r.source(path+"TransitionProbability.R")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2402">2402</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p=r.TransitionProbability(filename,&nbsp;selfremoved,&nbsp;location,&nbsp;metaGroup,&nbsp;outputdir,&nbsp;grouptype,&nbsp;version,&nbsp;Randomsampling)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2403">2403</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;p</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2404">2404</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#a=RunTransitionProbabilityCode(file_name,&nbsp;"TRUE",&nbsp;TP_folder,&nbsp;metadataToUse,&nbsp;tSNE_GroupLevelTP,&nbsp;grouptype,&nbsp;version,&nbsp;Randomsampling)&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2405">2405</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b=RunTransitionProbabilityCode(file_name,&nbsp;"FALSE",&nbsp;TP_folder,&nbsp;metadataToUse,&nbsp;tSNE_GroupLevelTP,&nbsp;grouptype,&nbsp;version,&nbsp;Randomsampling)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2406">2406</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;manyfeatures&nbsp;==&nbsp;"True":</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__93"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2407">2407</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;version&nbsp;=&nbsp;"SampleGroup2"&nbsp;#secondgroup</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2408">2408</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c=RunTransitionProbabilityCode(file_name,&nbsp;"TRUE",&nbsp;TP_folder,&nbsp;secondgroup,&nbsp;tSNE_GroupLevelTP,&nbsp;grouptype2,&nbsp;version,&nbsp;Randomsampling)&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2409">2409</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d=RunTransitionProbabilityCode(file_name,&nbsp;"FALSE",&nbsp;TP_folder,&nbsp;secondgroup,&nbsp;tSNE_GroupLevelTP,&nbsp;grouptype2,&nbsp;version,&nbsp;Randomsampling)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2410">2410</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__94"></td><td class="diff_header" id="from0_1763">1763</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2411">2411</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__94">n</a></td><td class="diff_header" id="from0_1764">1764</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__94">n</a></td><td class="diff_header" id="to0_2412">2412</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__95"></td><td class="diff_header" id="from0_1765">1765</td><td nowrap="nowrap"><span class="diff_sub">[docs]</span>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;calculate_grid_arrows(self,&nbsp;embed:&nbsp;str="embedding",&nbsp;smooth:&nbsp;float=0.5,&nbsp;steps:&nbsp;Tuple=(40,&nbsp;40),</td><td class="diff_next"></td><td class="diff_header" id="to0_2413">2413</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;calculate_grid_arrows(self,&nbsp;embed:&nbsp;str="embedding",&nbsp;smooth:&nbsp;float=0.5,&nbsp;steps:&nbsp;Tuple=(40,&nbsp;40),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1766">1766</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_neighbors:&nbsp;int=100,&nbsp;n_jobs:&nbsp;int=4)&nbsp;-&gt;&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_2414">2414</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_neighbors:&nbsp;int=100,&nbsp;n_jobs:&nbsp;int=4)&nbsp;-&gt;&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1767">1767</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Calculate&nbsp;the&nbsp;velocity&nbsp;using&nbsp;a&nbsp;points&nbsp;on&nbsp;a&nbsp;regular&nbsp;grid&nbsp;and&nbsp;a&nbsp;gaussian&nbsp;kernel</td><td class="diff_next"></td><td class="diff_header" id="to0_2415">2415</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Calculate&nbsp;the&nbsp;velocity&nbsp;using&nbsp;a&nbsp;points&nbsp;on&nbsp;a&nbsp;regular&nbsp;grid&nbsp;and&nbsp;a&nbsp;gaussian&nbsp;kernel</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__95">n</a></td><td class="diff_header" id="from0_1768">1768</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__95">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1769">1769</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note:&nbsp;the&nbsp;function&nbsp;should&nbsp;work&nbsp;also&nbsp;for&nbsp;n-dimensional&nbsp;grid</td><td class="diff_next"></td><td class="diff_header" id="to0_2416">2416</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note:&nbsp;the&nbsp;function&nbsp;should&nbsp;work&nbsp;also&nbsp;for&nbsp;n-dimensional&nbsp;grid</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__96">n</a></td><td class="diff_header" id="from0_1770">1770</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__96">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1771">1771</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td><td class="diff_next"></td><td class="diff_header" id="to0_2417">2417</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1772">1772</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td><td class="diff_next"></td><td class="diff_header" id="to0_2418">2418</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1773">1773</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;embed:&nbsp;str,&nbsp;default=embedding</td><td class="diff_next"></td><td class="diff_header" id="to0_2419">2419</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;embed:&nbsp;str,&nbsp;default=embedding</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1774">1774</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;attribute&nbsp;containing&nbsp;the&nbsp;embedding.&nbsp;It&nbsp;will&nbsp;be&nbsp;retrieved&nbsp;as&nbsp;getattr(self,&nbsp;embed)</td><td class="diff_next"></td><td class="diff_header" id="to0_2420">2420</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;attribute&nbsp;containing&nbsp;the&nbsp;embedding.&nbsp;It&nbsp;will&nbsp;be&nbsp;retrieved&nbsp;as&nbsp;getattr(self,&nbsp;embed)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1775">1775</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;difference&nbsp;vector&nbsp;is&nbsp;getattr(self,&nbsp;'delta'&nbsp;+&nbsp;'_'&nbsp;+&nbsp;embed)</td><td class="diff_next"></td><td class="diff_header" id="to0_2421">2421</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;difference&nbsp;vector&nbsp;is&nbsp;getattr(self,&nbsp;'delta'&nbsp;+&nbsp;'_'&nbsp;+&nbsp;embed)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1776">1776</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smooth:&nbsp;float,&nbsp;smooth=0.5</td><td class="diff_next"></td><td class="diff_header" id="to0_2422">2422</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smooth:&nbsp;float,&nbsp;smooth=0.5</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1777">1777</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Higher&nbsp;value&nbsp;correspond&nbsp;to&nbsp;taking&nbsp;in&nbsp;consideration&nbsp;further&nbsp;points</td><td class="diff_next"></td><td class="diff_header" id="to0_2423">2423</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Higher&nbsp;value&nbsp;correspond&nbsp;to&nbsp;taking&nbsp;in&nbsp;consideration&nbsp;further&nbsp;points</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1778">1778</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;standard&nbsp;deviation&nbsp;of&nbsp;the&nbsp;gaussian&nbsp;kernel&nbsp;is&nbsp;smooth&nbsp;*&nbsp;stepsize</td><td class="diff_next"></td><td class="diff_header" id="to0_2424">2424</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;standard&nbsp;deviation&nbsp;of&nbsp;the&nbsp;gaussian&nbsp;kernel&nbsp;is&nbsp;smooth&nbsp;*&nbsp;stepsize</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1779">1779</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;steps:&nbsp;tuple,&nbsp;default</td><td class="diff_next"></td><td class="diff_header" id="to0_2425">2425</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;steps:&nbsp;tuple,&nbsp;default</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1780">1780</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;number&nbsp;of&nbsp;steps&nbsp;in&nbsp;the&nbsp;grid&nbsp;for&nbsp;each&nbsp;axis</td><td class="diff_next"></td><td class="diff_header" id="to0_2426">2426</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;number&nbsp;of&nbsp;steps&nbsp;in&nbsp;the&nbsp;grid&nbsp;for&nbsp;each&nbsp;axis</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1781">1781</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_neighbors:</td><td class="diff_next"></td><td class="diff_header" id="to0_2427">2427</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_neighbors:</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__96"></td><td class="diff_header" id="from0_1782">1782</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;neighbors&nbsp;to&nbsp;use&nbsp;in&nbsp;the&nbsp;calculation,&nbsp;bigger&nbsp;number&nbsp;should&nbsp;not&nbsp;change&nbsp;too&nbsp;much&nbsp;the&nbsp;results..</td><td class="diff_next"></td><td class="diff_header" id="to0_2428">2428</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;neighbors&nbsp;to&nbsp;use&nbsp;in&nbsp;the&nbsp;calculation,&nbsp;bigger&nbsp;number&nbsp;should&nbsp;not&nbsp;change&nbsp;too&nbsp;much&nbsp;the&nbsp;results..</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1783">1783</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...as&nbsp;soon&nbsp;as&nbsp;smooth&nbsp;is&nbsp;small</td><td class="diff_next"></td><td class="diff_header" id="to0_2429">2429</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...as&nbsp;soon&nbsp;as&nbsp;smooth&nbsp;is&nbsp;small</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1784">1784</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Higher&nbsp;value&nbsp;correspond&nbsp;to&nbsp;slower&nbsp;execution&nbsp;time</td><td class="diff_next"></td><td class="diff_header" id="to0_2430">2430</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Higher&nbsp;value&nbsp;correspond&nbsp;to&nbsp;slower&nbsp;execution&nbsp;time</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1785">1785</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_jobs:</td><td class="diff_next"></td><td class="diff_header" id="to0_2431">2431</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_jobs:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1786">1786</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;processes&nbsp;for&nbsp;parallel&nbsp;computing</td><td class="diff_next"></td><td class="diff_header" id="to0_2432">2432</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;processes&nbsp;for&nbsp;parallel&nbsp;computing</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__97">n</a></td><td class="diff_header" id="from0_1787">1787</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__97">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1788">1788</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td><td class="diff_next"></td><td class="diff_header" id="to0_2433">2433</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1789">1789</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td><td class="diff_next"></td><td class="diff_header" id="to0_2434">2434</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1790">1790</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;but&nbsp;it&nbsp;sets&nbsp;the&nbsp;attributes:</td><td class="diff_next"></td><td class="diff_header" id="to0_2435">2435</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;but&nbsp;it&nbsp;sets&nbsp;the&nbsp;attributes:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1791">1791</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flow_embedding:&nbsp;np.ndarray</td><td class="diff_next"></td><td class="diff_header" id="to0_2436">2436</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flow_embedding:&nbsp;np.ndarray</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1792">1792</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;coordinates&nbsp;of&nbsp;the&nbsp;embedding</td><td class="diff_next"></td><td class="diff_header" id="to0_2437">2437</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;coordinates&nbsp;of&nbsp;the&nbsp;embedding</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1793">1793</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flow_grid:&nbsp;np.ndarray</td><td class="diff_next"></td><td class="diff_header" id="to0_2438">2438</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flow_grid:&nbsp;np.ndarray</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1794">1794</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;gridpoints</td><td class="diff_next"></td><td class="diff_header" id="to0_2439">2439</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;gridpoints</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1795">1795</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flow:&nbsp;np.ndarray</td><td class="diff_next"></td><td class="diff_header" id="to0_2440">2440</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flow:&nbsp;np.ndarray</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__97"></td><td class="diff_header" id="from0_1796">1796</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vector&nbsp;field&nbsp;coordinates</td><td class="diff_next"></td><td class="diff_header" id="to0_2441">2441</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vector&nbsp;field&nbsp;coordinates</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1797">1797</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flow_magnitude:&nbsp;np.ndarray</td><td class="diff_next"></td><td class="diff_header" id="to0_2442">2442</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flow_magnitude:&nbsp;np.ndarray</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1798">1798</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;magnitude&nbsp;of&nbsp;each&nbsp;vector&nbsp;on&nbsp;the&nbsp;grid</td><td class="diff_next"></td><td class="diff_header" id="to0_2443">2443</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;magnitude&nbsp;of&nbsp;each&nbsp;vector&nbsp;on&nbsp;the&nbsp;grid</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1799">1799</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total_p_mass:&nbsp;np.ndarray</td><td class="diff_next"></td><td class="diff_header" id="to0_2444">2444</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total_p_mass:&nbsp;np.ndarray</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1800">1800</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;density&nbsp;at&nbsp;each&nbsp;point&nbsp;of&nbsp;the&nbsp;grid</td><td class="diff_next"></td><td class="diff_header" id="to0_2445">2445</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;density&nbsp;at&nbsp;each&nbsp;point&nbsp;of&nbsp;the&nbsp;grid</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__98">n</a></td><td class="diff_header" id="from0_1801">1801</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__98">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1802">1802</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_2446">2446</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1803">1803</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;embedding&nbsp;=&nbsp;getattr(self,&nbsp;embed)</td><td class="diff_next"></td><td class="diff_header" id="to0_2447">2447</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;embedding&nbsp;=&nbsp;getattr(self,&nbsp;embed)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1804">1804</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;hasattr(self,&nbsp;f"delta_{embed}"):</td><td class="diff_next"></td><td class="diff_header" id="to0_2448">2448</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;hasattr(self,&nbsp;f"delta_{embed}"):</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1805">1805</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_embedding&nbsp;=&nbsp;getattr(self,&nbsp;f"delta_{embed}")</td><td class="diff_next"></td><td class="diff_header" id="to0_2449">2449</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_embedding&nbsp;=&nbsp;getattr(self,&nbsp;f"delta_{embed}")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1806">1806</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;hasattr(self,&nbsp;"corrcoef_random"):</td><td class="diff_next"></td><td class="diff_header" id="to0_2450">2450</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;hasattr(self,&nbsp;"corrcoef_random"):</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1807">1807</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_embedding_random&nbsp;=&nbsp;getattr(self,&nbsp;f"delta_{embed}_random")</td><td class="diff_next"></td><td class="diff_header" id="to0_2451">2451</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta_embedding_random&nbsp;=&nbsp;getattr(self,&nbsp;f"delta_{embed}_random")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1808">1808</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_2452">2452</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1809">1809</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;KeyError("This&nbsp;embedding&nbsp;does&nbsp;not&nbsp;have&nbsp;a&nbsp;delta_*")</td><td class="diff_next"></td><td class="diff_header" id="to0_2453">2453</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;KeyError("This&nbsp;embedding&nbsp;does&nbsp;not&nbsp;have&nbsp;a&nbsp;delta_*")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1810">1810</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Prepare&nbsp;the&nbsp;grid</td><td class="diff_next"></td><td class="diff_header" id="to0_2454">2454</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Prepare&nbsp;the&nbsp;grid</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1811">1811</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grs&nbsp;=&nbsp;[]</td><td class="diff_next"></td><td class="diff_header" id="to0_2455">2455</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grs&nbsp;=&nbsp;[]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1812">1812</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;dim_i&nbsp;in&nbsp;range(embedding.shape[1]):</td><td class="diff_next"></td><td class="diff_header" id="to0_2456">2456</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;dim_i&nbsp;in&nbsp;range(embedding.shape[1]):</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__98"></td><td class="diff_header" id="from0_1813">1813</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m,&nbsp;M&nbsp;=&nbsp;np.min(embedding[:,&nbsp;dim_i]),&nbsp;np.max(embedding[:,&nbsp;dim_i])</td><td class="diff_next"></td><td class="diff_header" id="to0_2457">2457</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m,&nbsp;M&nbsp;=&nbsp;np.min(embedding[:,&nbsp;dim_i]),&nbsp;np.max(embedding[:,&nbsp;dim_i])</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1814">1814</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;=&nbsp;m&nbsp;-&nbsp;0.025&nbsp;*&nbsp;np.abs(M&nbsp;-&nbsp;m)</td><td class="diff_next"></td><td class="diff_header" id="to0_2458">2458</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;=&nbsp;m&nbsp;-&nbsp;0.025&nbsp;*&nbsp;np.abs(M&nbsp;-&nbsp;m)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1815">1815</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M&nbsp;=&nbsp;M&nbsp;+&nbsp;0.025&nbsp;*&nbsp;np.abs(M&nbsp;-&nbsp;m)</td><td class="diff_next"></td><td class="diff_header" id="to0_2459">2459</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M&nbsp;=&nbsp;M&nbsp;+&nbsp;0.025&nbsp;*&nbsp;np.abs(M&nbsp;-&nbsp;m)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1816">1816</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gr&nbsp;=&nbsp;np.linspace(m,&nbsp;M,&nbsp;steps[dim_i])</td><td class="diff_next"></td><td class="diff_header" id="to0_2460">2460</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gr&nbsp;=&nbsp;np.linspace(m,&nbsp;M,&nbsp;steps[dim_i])</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1817">1817</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grs.append(gr)</td><td class="diff_next"></td><td class="diff_header" id="to0_2461">2461</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grs.append(gr)</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__99">n</a></td><td class="diff_header" id="from0_1818">1818</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__99">n</a></td><td class="diff_header" id="to0_2462">2462</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1819">1819</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;meshes_tuple&nbsp;=&nbsp;np.meshgrid(*grs)</td><td class="diff_next"></td><td class="diff_header" id="to0_2463">2463</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;meshes_tuple&nbsp;=&nbsp;np.meshgrid(*grs)</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__99"></td><td class="diff_header" id="from0_1820">1820</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gridpoints_coordinates&nbsp;=&nbsp;np.vstack([i.flat&nbsp;for&nbsp;i&nbsp;in&nbsp;meshes_tuple]).T</td><td class="diff_next"></td><td class="diff_header" id="to0_2464">2464</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gridpoints_coordinates&nbsp;=&nbsp;np.vstack([i.flat&nbsp;for&nbsp;i&nbsp;in&nbsp;meshes_tuple]).T</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1821">1821</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2465">2465</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__100"></td><td class="diff_header" id="from0_1822">1822</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nn&nbsp;=&nbsp;NearestNeighbors(n_neighbors=n_neighbors,&nbsp;n_jobs=n_jobs)</td><td class="diff_next"></td><td class="diff_header" id="to0_2466">2466</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nn&nbsp;=&nbsp;NearestNeighbors(n_neighbors=n_neighbors,&nbsp;n_jobs=n_jobs)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1823">1823</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nn.fit(embedding)</td><td class="diff_next"></td><td class="diff_header" id="to0_2467">2467</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nn.fit(embedding)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1824">1824</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dists,&nbsp;neighs&nbsp;=&nbsp;nn.kneighbors(gridpoints_coordinates)</td><td class="diff_next"></td><td class="diff_header" id="to0_2468">2468</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dists,&nbsp;neighs&nbsp;=&nbsp;nn.kneighbors(gridpoints_coordinates)</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__101"><a href="#difflib_chg_to0__100">n</a></td><td class="diff_header" id="from0_1825">1825</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__100">n</a></td><td class="diff_header" id="to0_2469">2469</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1826">1826</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std&nbsp;=&nbsp;np.mean([(g[1]&nbsp;-&nbsp;g[0])&nbsp;for&nbsp;g&nbsp;in&nbsp;grs])</td><td class="diff_next"></td><td class="diff_header" id="to0_2470">2470</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std&nbsp;=&nbsp;np.mean([(g[1]&nbsp;-&nbsp;g[0])&nbsp;for&nbsp;g&nbsp;in&nbsp;grs])</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__101">n</a></td><td class="diff_header" id="from0_1827">1827</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#<span class="diff_sub">&nbsp;</span>isotropic&nbsp;gaussian&nbsp;kernel</td><td class="diff_next"><a href="#difflib_chg_to0__101">n</a></td><td class="diff_header" id="to0_2471">2471</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#isotropic&nbsp;gaussian&nbsp;kernel</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__102"></td><td class="diff_header" id="from0_1828">1828</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gaussian_w&nbsp;=&nbsp;normal.pdf(loc=0,&nbsp;scale=smooth&nbsp;*&nbsp;std,&nbsp;x=dists)</td><td class="diff_next"></td><td class="diff_header" id="to0_2472">2472</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gaussian_w&nbsp;=&nbsp;normal.pdf(loc=0,&nbsp;scale=smooth&nbsp;*&nbsp;std,&nbsp;x=dists)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1829">1829</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.total_p_mass&nbsp;=&nbsp;gaussian_w.sum(1)</td><td class="diff_next"></td><td class="diff_header" id="to0_2473">2473</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.total_p_mass&nbsp;=&nbsp;gaussian_w.sum(1)</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__102">n</a></td><td class="diff_header" id="from0_1830">1830</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__102">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1831">1831</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UZ&nbsp;=&nbsp;(delta_embedding[neighs]&nbsp;*&nbsp;gaussian_w[:,&nbsp;:,&nbsp;None]).sum(1)&nbsp;/&nbsp;np.maximum(1,&nbsp;self.total_p_mass)[:,&nbsp;None]&nbsp;&nbsp;#&nbsp;weighed&nbsp;average</td><td class="diff_next"></td><td class="diff_header" id="to0_2474">2474</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UZ&nbsp;=&nbsp;(delta_embedding[neighs]&nbsp;*&nbsp;gaussian_w[:,&nbsp;:,&nbsp;None]).sum(1)&nbsp;/&nbsp;np.maximum(1,&nbsp;self.total_p_mass)[:,&nbsp;None]&nbsp;&nbsp;#&nbsp;weighed&nbsp;average<span class="diff_add">,&nbsp;delta_embedding&nbsp;is&nbsp;calculated&nbsp;by&nbsp;calculate&nbsp;embedding&nbsp;shift</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1832">1832</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;magnitude&nbsp;=&nbsp;np.linalg.norm(UZ,&nbsp;axis=1)</td><td class="diff_next"></td><td class="diff_header" id="to0_2475">2475</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;magnitude&nbsp;=&nbsp;np.linalg.norm(UZ,&nbsp;axis=1)</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__103"><a href="#difflib_chg_to0__103">n</a></td><td class="diff_header" id="from0_1833">1833</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#<span class="diff_sub">&nbsp;</span>Assign&nbsp;attributes</td><td class="diff_next"><a href="#difflib_chg_to0__103">n</a></td><td class="diff_header" id="to0_2476">2476</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Assign&nbsp;attributes</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1834">1834</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.flow_embedding&nbsp;=&nbsp;embedding</td><td class="diff_next"></td><td class="diff_header" id="to0_2477">2477</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.flow_embedding&nbsp;=&nbsp;embedding</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1835">1835</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.flow_grid&nbsp;=&nbsp;gridpoints_coordinates</td><td class="diff_next"></td><td class="diff_header" id="to0_2478">2478</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.flow_grid&nbsp;=&nbsp;gridpoints_coordinates</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1836">1836</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.flow&nbsp;=&nbsp;UZ</td><td class="diff_next"></td><td class="diff_header" id="to0_2479">2479</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.flow&nbsp;=&nbsp;UZ</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1837">1837</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.flow_norm&nbsp;=&nbsp;UZ&nbsp;/&nbsp;np.percentile(magnitude,&nbsp;99.5)</td><td class="diff_next"></td><td class="diff_header" id="to0_2480">2480</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.flow_norm&nbsp;=&nbsp;UZ&nbsp;/&nbsp;np.percentile(magnitude,&nbsp;99.5)</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__104"><a href="#difflib_chg_to0__104">n</a></td><td class="diff_header" id="from0_1838">1838</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.flow_norm_magnitude&nbsp;=&nbsp;np.linalg.norm(self.flow_norm,&nbsp;axis=1)</td><td class="diff_next"><a href="#difflib_chg_to0__104">n</a></td><td class="diff_header" id="to0_2481">2481</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.flow_norm_magnitude&nbsp;=&nbsp;np.linalg.norm(self.flow_norm,&nbsp;axis=1)<span class="diff_add">&nbsp;#1600&nbsp;length</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1839">1839</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1840">1840</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;hasattr(self,&nbsp;"corrcoef_random"):</td><td class="diff_next"></td><td class="diff_header" id="to0_2482">2482</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;hasattr(self,&nbsp;"corrcoef_random"):</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1841">1841</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UZ_rndm&nbsp;=&nbsp;(delta_embedding_random[neighs]&nbsp;*&nbsp;gaussian_w[:,&nbsp;:,&nbsp;None]).sum(1)&nbsp;/&nbsp;np.maximum(1,&nbsp;self.total_p_mass)[:,&nbsp;None]&nbsp;&nbsp;#&nbsp;weighed&nbsp;average</td><td class="diff_next"></td><td class="diff_header" id="to0_2483">2483</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UZ_rndm&nbsp;=&nbsp;(delta_embedding_random[neighs]&nbsp;*&nbsp;gaussian_w[:,&nbsp;:,&nbsp;None]).sum(1)&nbsp;/&nbsp;np.maximum(1,&nbsp;self.total_p_mass)[:,&nbsp;None]&nbsp;&nbsp;#&nbsp;weighed&nbsp;average</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1842">1842</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;magnitude_rndm&nbsp;=&nbsp;np.linalg.norm(UZ,&nbsp;axis=1)</td><td class="diff_next"></td><td class="diff_header" id="to0_2484">2484</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;magnitude_rndm&nbsp;=&nbsp;np.linalg.norm(UZ,&nbsp;axis=1)</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__105"><a href="#difflib_chg_to0__105">n</a></td><td class="diff_header" id="from0_1843">1843</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#<span class="diff_sub">&nbsp;</span>Assign&nbsp;attributes</td><td class="diff_next"><a href="#difflib_chg_to0__105">n</a></td><td class="diff_header" id="to0_2485">2485</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Assign&nbsp;attributes</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1844">1844</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.flow_rndm&nbsp;=&nbsp;UZ_rndm</td><td class="diff_next"></td><td class="diff_header" id="to0_2486">2486</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.flow_rndm&nbsp;=&nbsp;UZ_rndm</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1845">1845</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.flow_norm_rndm&nbsp;=&nbsp;UZ_rndm&nbsp;/&nbsp;np.percentile(magnitude_rndm,&nbsp;99.5)</td><td class="diff_next"></td><td class="diff_header" id="to0_2487">2487</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.flow_norm_rndm&nbsp;=&nbsp;UZ_rndm&nbsp;/&nbsp;np.percentile(magnitude_rndm,&nbsp;99.5)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1846">1846</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.flow_norm_magnitude_rndm&nbsp;=&nbsp;np.linalg.norm(self.flow_norm_rndm,&nbsp;axis=1)</td><td class="diff_next"></td><td class="diff_header" id="to0_2488">2488</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.flow_norm_magnitude_rndm&nbsp;=&nbsp;np.linalg.norm(self.flow_norm_rndm,&nbsp;axis=1)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1847">1847</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2489">2489</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__106">n</a></td><td class="diff_header" id="from0_1848">1848</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__106">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1849">1849</td><td nowrap="nowrap"><span class="diff_sub">[docs]</span>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;prepare_markov(self,&nbsp;sigma_D:&nbsp;np.ndarray,&nbsp;sigma_W:&nbsp;np.ndarray,&nbsp;direction:&nbsp;str="forward",&nbsp;cells_ixs:&nbsp;np.ndarray=None)&nbsp;-&gt;&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_2490">2490</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;prepare_markov(self,&nbsp;sigma_D:&nbsp;np.ndarray,&nbsp;sigma_W:&nbsp;np.ndarray,&nbsp;direction:&nbsp;str="forward",&nbsp;cells_ixs:&nbsp;np.ndarray=None)&nbsp;-&gt;&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1850">1850</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Prepare&nbsp;a&nbsp;transition&nbsp;probability&nbsp;for&nbsp;Markov&nbsp;process</td><td class="diff_next"></td><td class="diff_header" id="to0_2491">2491</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Prepare&nbsp;a&nbsp;transition&nbsp;probability&nbsp;for&nbsp;Markov&nbsp;process</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1851">1851</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2492">2492</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1852">1852</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td><td class="diff_next"></td><td class="diff_header" id="to0_2493">2493</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1853">1853</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td><td class="diff_next"></td><td class="diff_header" id="to0_2494">2494</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1854">1854</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma_D:&nbsp;float</td><td class="diff_next"></td><td class="diff_header" id="to0_2495">2495</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma_D:&nbsp;float</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1855">1855</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;standard&nbsp;deviation&nbsp;used&nbsp;on&nbsp;the&nbsp;locality-limiting&nbsp;component</td><td class="diff_next"></td><td class="diff_header" id="to0_2496">2496</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;standard&nbsp;deviation&nbsp;used&nbsp;on&nbsp;the&nbsp;locality-limiting&nbsp;component</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1856">1856</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma_W:&nbsp;float</td><td class="diff_next"></td><td class="diff_header" id="to0_2497">2497</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma_W:&nbsp;float</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__106"></td><td class="diff_header" id="from0_1857">1857</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;standard&nbsp;deviation&nbsp;used&nbsp;on&nbsp;the&nbsp;noise&nbsp;component</td><td class="diff_next"></td><td class="diff_header" id="to0_2498">2498</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;standard&nbsp;deviation&nbsp;used&nbsp;on&nbsp;the&nbsp;noise&nbsp;component</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1858">1858</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;direction:&nbsp;str,&nbsp;default="backwards"</td><td class="diff_next"></td><td class="diff_header" id="to0_2499">2499</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;direction:&nbsp;str,&nbsp;default="backwards"</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1859">1859</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whether&nbsp;to&nbsp;diffuse&nbsp;forward&nbsp;of&nbsp;backwards</td><td class="diff_next"></td><td class="diff_header" id="to0_2500">2500</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whether&nbsp;to&nbsp;diffuse&nbsp;forward&nbsp;of&nbsp;backwards</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1860">1860</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cells_ixs:&nbsp;np.ndarray,&nbsp;default=None</td><td class="diff_next"></td><td class="diff_header" id="to0_2501">2501</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cells_ixs:&nbsp;np.ndarray,&nbsp;default=None</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1861">1861</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cells&nbsp;to&nbsp;use,&nbsp;if&nbsp;None&nbsp;all&nbsp;the&nbsp;cells&nbsp;will&nbsp;be&nbsp;considered.</td><td class="diff_next"></td><td class="diff_header" id="to0_2502">2502</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cells&nbsp;to&nbsp;use,&nbsp;if&nbsp;None&nbsp;all&nbsp;the&nbsp;cells&nbsp;will&nbsp;be&nbsp;considered.</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__107">n</a></td><td class="diff_header" id="from0_1862">1862</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__107">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__107"></td><td class="diff_header" id="from0_1863">1863</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td><td class="diff_next"></td><td class="diff_header" id="to0_2503">2503</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1864">1864</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td><td class="diff_next"></td><td class="diff_header" id="to0_2504">2504</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1865">1865</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;but&nbsp;it&nbsp;creates&nbsp;the&nbsp;following&nbsp;attributes:</td><td class="diff_next"></td><td class="diff_header" id="to0_2505">2505</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;but&nbsp;it&nbsp;creates&nbsp;the&nbsp;following&nbsp;attributes:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1866">1866</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tr:&nbsp;np.ndarray</td><td class="diff_next"></td><td class="diff_header" id="to0_2506">2506</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tr:&nbsp;np.ndarray</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1867">1867</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;transition&nbsp;probability&nbsp;matrix</td><td class="diff_next"></td><td class="diff_header" id="to0_2507">2507</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;transition&nbsp;probability&nbsp;matrix</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__108">n</a></td><td class="diff_header" id="from0_1868">1868</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__108">n</a></td><td class="diff_header" id="to0_2508">2508</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1869">1869</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_2509">2509</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1870">1870</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;cells_ixs&nbsp;is&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_2510">2510</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;cells_ixs&nbsp;is&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1871">1871</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cells_ixs&nbsp;=&nbsp;np.arange(self.transition_prob.shape[0])</td><td class="diff_next"></td><td class="diff_header" id="to0_2511">2511</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cells_ixs&nbsp;=&nbsp;np.arange(self.transition_prob.shape[0])</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1872">1872</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2512">2512</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1873">1873</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;NOTE:&nbsp;This&nbsp;implementation&nbsp;is&nbsp;not&nbsp;speed&nbsp;optimized&nbsp;to&nbsp;improve&nbsp;the&nbsp;speed&nbsp;of&nbsp;the&nbsp;implementation:</td><td class="diff_next"></td><td class="diff_header" id="to0_2513">2513</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;NOTE:&nbsp;This&nbsp;implementation&nbsp;is&nbsp;not&nbsp;speed&nbsp;optimized&nbsp;to&nbsp;improve&nbsp;the&nbsp;speed&nbsp;of&nbsp;the&nbsp;implementation:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1874">1874</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;-&nbsp;the&nbsp;C/Fortran&nbsp;contiguity&nbsp;of&nbsp;the&nbsp;transition&nbsp;matrix&nbsp;should&nbsp;be&nbsp;taken&nbsp;into&nbsp;account</td><td class="diff_next"></td><td class="diff_header" id="to0_2514">2514</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;-&nbsp;the&nbsp;C/Fortran&nbsp;contiguity&nbsp;of&nbsp;the&nbsp;transition&nbsp;matrix&nbsp;should&nbsp;be&nbsp;taken&nbsp;into&nbsp;account</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1875">1875</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;-&nbsp;a&nbsp;knn&nbsp;implementation&nbsp;would&nbsp;reduce&nbsp;computation</td><td class="diff_next"></td><td class="diff_header" id="to0_2515">2515</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;-&nbsp;a&nbsp;knn&nbsp;implementation&nbsp;would&nbsp;reduce&nbsp;computation</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1876">1876</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;-&nbsp;should&nbsp;avoid&nbsp;transformation&nbsp;to&nbsp;and&nbsp;from&nbsp;dense-sparse&nbsp;formats</td><td class="diff_next"></td><td class="diff_header" id="to0_2516">2516</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;-&nbsp;should&nbsp;avoid&nbsp;transformation&nbsp;to&nbsp;and&nbsp;from&nbsp;dense-sparse&nbsp;formats</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1877">1877</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;direction&nbsp;==&nbsp;"forward":</td><td class="diff_next"></td><td class="diff_header" id="to0_2517">2517</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;direction&nbsp;==&nbsp;"forward":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1878">1878</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.tr&nbsp;=&nbsp;np.array(self.transition_prob[cells_ixs,&nbsp;:][:,&nbsp;cells_ixs])</td><td class="diff_next"></td><td class="diff_header" id="to0_2518">2518</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.tr&nbsp;=&nbsp;np.array(self.transition_prob[cells_ixs,&nbsp;:][:,&nbsp;cells_ixs])</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1879">1879</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;direction&nbsp;==&nbsp;"backwards":</td><td class="diff_next"></td><td class="diff_header" id="to0_2519">2519</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;direction&nbsp;==&nbsp;"backwards":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1880">1880</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.tr&nbsp;=&nbsp;np.array((self.transition_prob[cells_ixs,&nbsp;:][:,&nbsp;cells_ixs]).T,&nbsp;order="C")</td><td class="diff_next"></td><td class="diff_header" id="to0_2520">2520</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.tr&nbsp;=&nbsp;np.array((self.transition_prob[cells_ixs,&nbsp;:][:,&nbsp;cells_ixs]).T,&nbsp;order="C")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1881">1881</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_2521">2521</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1882">1882</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;NotImplementedError(f"{direction}&nbsp;is&nbsp;not&nbsp;an&nbsp;implemented&nbsp;direction")</td><td class="diff_next"></td><td class="diff_header" id="to0_2522">2522</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;NotImplementedError(f"{direction}&nbsp;is&nbsp;not&nbsp;an&nbsp;implemented&nbsp;direction")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1883">1883</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dist_matrix&nbsp;=&nbsp;squareform(pdist(self.embedding[cells_ixs,&nbsp;:]))</td><td class="diff_next"></td><td class="diff_header" id="to0_2523">2523</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dist_matrix&nbsp;=&nbsp;squareform(pdist(self.embedding[cells_ixs,&nbsp;:]))</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__108"></td><td class="diff_header" id="from0_1884">1884</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K_D&nbsp;=&nbsp;gaussian_kernel(dist_matrix,&nbsp;sigma=sigma_D)</td><td class="diff_next"></td><td class="diff_header" id="to0_2524">2524</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K_D&nbsp;=&nbsp;gaussian_kernel(dist_matrix,&nbsp;sigma=sigma_D)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1885">1885</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.tr&nbsp;=&nbsp;self.tr&nbsp;*&nbsp;K_D</td><td class="diff_next"></td><td class="diff_header" id="to0_2525">2525</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.tr&nbsp;=&nbsp;self.tr&nbsp;*&nbsp;K_D</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1886">1886</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Fill&nbsp;diagonal&nbsp;with&nbsp;max&nbsp;or&nbsp;the&nbsp;row&nbsp;and&nbsp;sum=1&nbsp;normalize</td><td class="diff_next"></td><td class="diff_header" id="to0_2526">2526</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Fill&nbsp;diagonal&nbsp;with&nbsp;max&nbsp;or&nbsp;the&nbsp;row&nbsp;and&nbsp;sum=1&nbsp;normalize</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1887">1887</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.fill_diagonal(self.tr,&nbsp;self.tr.max(1))</td><td class="diff_next"></td><td class="diff_header" id="to0_2527">2527</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.fill_diagonal(self.tr,&nbsp;self.tr.max(1))</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1888">1888</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.tr&nbsp;=&nbsp;self.tr&nbsp;/&nbsp;self.tr.sum(1)[:,&nbsp;None]</td><td class="diff_next"></td><td class="diff_header" id="to0_2528">2528</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.tr&nbsp;=&nbsp;self.tr&nbsp;/&nbsp;self.tr.sum(1)[:,&nbsp;None]</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__109">n</a></td><td class="diff_header" id="from0_1889">1889</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__109">n</a></td><td class="diff_header" id="to0_2529">2529</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1890">1890</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K_W&nbsp;=&nbsp;gaussian_kernel(dist_matrix,&nbsp;sigma=sigma_W)</td><td class="diff_next"></td><td class="diff_header" id="to0_2530">2530</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K_W&nbsp;=&nbsp;gaussian_kernel(dist_matrix,&nbsp;sigma=sigma_W)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1891">1891</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K_W&nbsp;=&nbsp;K_W&nbsp;/&nbsp;K_W.sum(1)[:,&nbsp;None]</td><td class="diff_next"></td><td class="diff_header" id="to0_2531">2531</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K_W&nbsp;=&nbsp;K_W&nbsp;/&nbsp;K_W.sum(1)[:,&nbsp;None]</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__109"></td><td class="diff_header" id="from0_1892">1892</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.tr&nbsp;=&nbsp;0.8&nbsp;*&nbsp;self.tr&nbsp;+&nbsp;0.2&nbsp;*&nbsp;K_W</td><td class="diff_next"></td><td class="diff_header" id="to0_2532">2532</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.tr&nbsp;=&nbsp;0.8&nbsp;*&nbsp;self.tr&nbsp;+&nbsp;0.2&nbsp;*&nbsp;K_W</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1893">1893</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.tr&nbsp;=&nbsp;self.tr&nbsp;/&nbsp;self.tr.sum(1)[:,&nbsp;None]</td><td class="diff_next"></td><td class="diff_header" id="to0_2533">2533</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.tr&nbsp;=&nbsp;self.tr&nbsp;/&nbsp;self.tr.sum(1)[:,&nbsp;None]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1894">1894</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.tr&nbsp;=&nbsp;scipy.sparse.csr_matrix(self.tr)</td><td class="diff_next"></td><td class="diff_header" id="to0_2534">2534</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.tr&nbsp;=&nbsp;scipy.sparse.csr_matrix(self.tr)</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__110"></td><td class="diff_header" id="from0_1895">1895</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2535">2535</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1896">1896</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2536">2536</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__110">n</a></td><td class="diff_header" id="from0_1897">1897</td><td nowrap="nowrap"><span class="diff_sub">[docs]</span>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;run_markov(self,&nbsp;starting_p:&nbsp;np.ndarray=None,&nbsp;n_steps:&nbsp;int=2500,&nbsp;mode:&nbsp;str="time_evolution")&nbsp;-&gt;&nbsp;None:</td><td class="diff_next"><a href="#difflib_chg_to0__110">n</a></td><td class="diff_header" id="to0_2537">2537</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;run_markov(self,&nbsp;starting_p:&nbsp;np.ndarray=None,&nbsp;n_steps:&nbsp;int=2500,&nbsp;mode:&nbsp;str="time_evolution")&nbsp;-&gt;&nbsp;None:<span class="diff_add">&nbsp;#cd2514&nbsp;not&nbsp;currently&nbsp;being&nbsp;used&nbsp;but&nbsp;could&nbsp;be&nbsp;useful</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1898">1898</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_chg">&nbsp;&nbsp;&nbsp;&nbsp;"""</span>Run&nbsp;a&nbsp;Markov&nbsp;process</td><td class="diff_next"></td><td class="diff_header" id="to0_2538">2538</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_chg">#&nbsp;&nbsp;&nbsp;&nbsp;</span>Run&nbsp;a&nbsp;Markov&nbsp;process</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1899">1899</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2539">2539</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__111">n</a></td><td class="diff_header" id="from0_1900">1900</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td><td class="diff_next"><a href="#difflib_chg_to0__111">n</a></td><td class="diff_header" id="to0_2540">2540</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_add">#</span>&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1901">1901</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td><td class="diff_next"></td><td class="diff_header" id="to0_2541">2541</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_add">#</span>&nbsp;&nbsp;&nbsp;&nbsp;---------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1902">1902</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;starting_p:&nbsp;np.ndarray,&nbsp;default=None</td><td class="diff_next"></td><td class="diff_header" id="to0_2542">2542</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_add">#</span>&nbsp;&nbsp;&nbsp;&nbsp;starting_p:&nbsp;np.ndarray,&nbsp;default=None</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1903">1903</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;specifies&nbsp;the&nbsp;starting&nbsp;density</td><td class="diff_next"></td><td class="diff_header" id="to0_2543">2543</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_add">#</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;specifies&nbsp;the&nbsp;starting&nbsp;density</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1904">1904</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;None&nbsp;is&nbsp;passed&nbsp;an&nbsp;array&nbsp;of&nbsp;1/self.tr.shape[0]&nbsp;will&nbsp;be&nbsp;created</td><td class="diff_next"></td><td class="diff_header" id="to0_2544">2544</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_add">#</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;None&nbsp;is&nbsp;passed&nbsp;an&nbsp;array&nbsp;of&nbsp;1/self.tr.shape[0]&nbsp;will&nbsp;be&nbsp;created</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__111"></td><td class="diff_header" id="from0_1905">1905</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_steps:&nbsp;np.ndarray,&nbsp;default=2500</td><td class="diff_next"></td><td class="diff_header" id="to0_2545">2545</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_add">#</span>&nbsp;&nbsp;&nbsp;&nbsp;n_steps:&nbsp;np.ndarray,&nbsp;default=2500</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1906">1906</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Numbers&nbsp;of&nbsp;steps&nbsp;to&nbsp;be&nbsp;performed</td><td class="diff_next"></td><td class="diff_header" id="to0_2546">2546</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_add">#</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Numbers&nbsp;of&nbsp;steps&nbsp;to&nbsp;be&nbsp;performed</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1907">1907</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode:&nbsp;str,&nbsp;default="time_evolution"</td><td class="diff_next"></td><td class="diff_header" id="to0_2547">2547</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_add">#</span>&nbsp;&nbsp;&nbsp;&nbsp;mode:&nbsp;str,&nbsp;default="time_evolution"</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1908">1908</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this&nbsp;argument&nbsp;is&nbsp;passed&nbsp;to&nbsp;the&nbsp;Diffusion.diffuse&nbsp;call</td><td class="diff_next"></td><td class="diff_header" id="to0_2548">2548</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_add">#</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this&nbsp;argument&nbsp;is&nbsp;passed&nbsp;to&nbsp;the&nbsp;Diffusion.diffuse&nbsp;call</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1909">1909</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2549">2549</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__112">n</a></td><td class="diff_header" id="from0_1910">1910</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td><td class="diff_next"><a href="#difflib_chg_to0__112">n</a></td><td class="diff_header" id="to0_2550">2550</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_add">#</span>&nbsp;&nbsp;&nbsp;&nbsp;Returns</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1911">1911</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td><td class="diff_next"></td><td class="diff_header" id="to0_2551">2551</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_add">#</span>&nbsp;&nbsp;&nbsp;&nbsp;-------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1912">1912</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;but&nbsp;it&nbsp;creates&nbsp;the&nbsp;attribute:</td><td class="diff_next"></td><td class="diff_header" id="to0_2552">2552</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_add">#</span>&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;but&nbsp;it&nbsp;creates&nbsp;the&nbsp;attribute:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1913">1913</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;diffused:&nbsp;np.ndarray</td><td class="diff_next"></td><td class="diff_header" id="to0_2553">2553</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_add">#</span>&nbsp;&nbsp;&nbsp;&nbsp;diffused:&nbsp;np.ndarray</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1914">1914</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;probability&nbsp;to&nbsp;be&nbsp;found&nbsp;at&nbsp;any&nbsp;of&nbsp;the&nbsp;states</td><td class="diff_next"></td><td class="diff_header" id="to0_2554">2554</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_add">#</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;probability&nbsp;to&nbsp;be&nbsp;found&nbsp;at&nbsp;any&nbsp;of&nbsp;the&nbsp;states</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__112"></td><td class="diff_header" id="from0_1915">1915</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1916">1916</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;starting_p&nbsp;is&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_2555">2555</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;starting_p&nbsp;is&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1917">1917</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;starting_p&nbsp;=&nbsp;np.ones(self.tr.shape[0])&nbsp;/&nbsp;self.tr.shape[0]</td><td class="diff_next"></td><td class="diff_header" id="to0_2556">2556</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;starting_p&nbsp;=&nbsp;np.ones(self.tr.shape[0])&nbsp;/&nbsp;self.tr.shape[0]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1918">1918</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;diffusor&nbsp;=&nbsp;Diffusion()</td><td class="diff_next"></td><td class="diff_header" id="to0_2557">2557</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;diffusor&nbsp;=&nbsp;Diffusion()</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1919">1919</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.diffused&nbsp;=&nbsp;diffusor.diffuse(starting_p,&nbsp;self.tr,&nbsp;n_steps=n_steps,&nbsp;mode=mode)[0]</td><td class="diff_next"></td><td class="diff_header" id="to0_2558">2558</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.diffused&nbsp;=&nbsp;diffusor.diffuse(starting_p,&nbsp;self.tr,&nbsp;n_steps=n_steps,&nbsp;mode=mode)[0]</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__113">n</a></td><td class="diff_header" id="from0_1920">1920</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__113">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1921">1921</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1922">1922</td><td nowrap="nowrap"><span class="diff_sub">[docs]&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;default_filter_and_norm(self,&nbsp;min_expr_counts:&nbsp;int=None,&nbsp;min_cells_express:&nbsp;int=None,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1923">1923</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N:&nbsp;int=None,&nbsp;min_avg_U:&nbsp;float=None,&nbsp;min_avg_S:&nbsp;float=None)&nbsp;-&gt;&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1924">1924</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Useful&nbsp;function&nbsp;to&nbsp;get&nbsp;started&nbsp;with&nbsp;velocyto:&nbsp;it&nbsp;performs&nbsp;initial&nbsp;filtering&nbsp;and&nbsp;feature&nbsp;selection,&nbsp;it&nbsp;uses&nbsp;some&nbsp;heuristics&nbsp;to&nbsp;determine&nbsp;the&nbsp;thresholds,&nbsp;results&nbsp;might&nbsp;be&nbsp;suboptimal.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1925">1925</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1926">1926</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;See&nbsp;`the&nbsp;analysis&nbsp;quick&nbsp;start&nbsp;guide&nbsp;&lt;http://velocyto.org/velocyto.py/tutorial/analysis.html&gt;`_&nbsp;for&nbsp;further&nbsp;info.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1927">1927</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1928">1928</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1929">1929</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1930">1930</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_expr_counts:&nbsp;int,&nbsp;default=None</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1931">1931</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filtering&nbsp;condition:&nbsp;the&nbsp;minimum&nbsp;spliced&nbsp;counts</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1932">1932</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_cells_express:&nbsp;int,&nbsp;default=None</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1933">1933</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filtering&nbsp;condition:&nbsp;the&nbsp;minimum&nbsp;number&nbsp;of&nbsp;cells&nbsp;expressing&nbsp;the&nbsp;gene</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1934">1934</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N:&nbsp;int,&nbsp;default=None</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1935">1935</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;genes&nbsp;selected&nbsp;by&nbsp;the&nbsp;feature&nbsp;selection&nbsp;procedure</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1936">1936</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_avg_U:&nbsp;float,&nbsp;default=None</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1937">1937</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;cluster&nbsp;have&nbsp;been&nbsp;specified&nbsp;beforehand&nbsp;(using&nbsp;the&nbsp;function&nbsp;set_clusters)&nbsp;then&nbsp;this&nbsp;is&nbsp;the&nbsp;minimum&nbsp;average&nbsp;unspliced&nbsp;molecules&nbsp;per&nbsp;cluster</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1938">1938</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_avg_S:&nbsp;float,&nbsp;default=None</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1939">1939</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;cluster&nbsp;have&nbsp;been&nbsp;specified&nbsp;beforehand&nbsp;(using&nbsp;the&nbsp;function&nbsp;set_clusters)&nbsp;then&nbsp;this&nbsp;is&nbsp;the&nbsp;minimum&nbsp;average&nbsp;spliced&nbsp;molecules&nbsp;per&nbsp;cluster</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1940">1940</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1941">1941</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warning("DEPRECATION&nbsp;WARNING&nbsp;-&nbsp;the&nbsp;current&nbsp;function&nbsp;is&nbsp;deprecated.&nbsp;Please&nbsp;refer&nbsp;to&nbsp;documentation&nbsp;for&nbsp;default&nbsp;parameters&nbsp;usage")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1942">1942</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;min_expr_counts&nbsp;is&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1943">1943</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_expr_counts&nbsp;=&nbsp;max(20,&nbsp;min(100,&nbsp;self.S.shape[1]&nbsp;*&nbsp;2.25e-3))</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1944">1944</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;min_cells_express&nbsp;is&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1945">1945</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_cells_express&nbsp;=&nbsp;max(10,&nbsp;min(50,&nbsp;self.S.shape[1]&nbsp;*&nbsp;1.5e-3))</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1946">1946</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;N&nbsp;is&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1947">1947</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N&nbsp;=&nbsp;max(1000,&nbsp;min(int((self.S.shape[1]&nbsp;/&nbsp;1000)**(1&nbsp;/&nbsp;3)&nbsp;/&nbsp;0.0008),&nbsp;5000))</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1948">1948</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;min_avg_U&nbsp;is&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1949">1949</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_avg_U&nbsp;=&nbsp;0.01</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1950">1950</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;min_avg_S&nbsp;is&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1951">1951</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_avg_S&nbsp;=&nbsp;0.08</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1952">1952</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1953">1953</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;This&nbsp;is&nbsp;called&nbsp;just&nbsp;to&nbsp;compute&nbsp;the&nbsp;initial&nbsp;cell&nbsp;size,&nbsp;normalized&nbsp;value&nbsp;will&nbsp;be&nbsp;recalculated</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1954">1954</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.normalize("S",&nbsp;size=True,&nbsp;log=False)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1955">1955</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.normalize("U",&nbsp;size=True,&nbsp;log=False)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1956">1956</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1957">1957</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.score_detection_levels(min_expr_counts=min_expr_counts,&nbsp;min_cells_express=min_cells_express)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1958">1958</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.filter_genes(by_detection_levels=True)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1959">1959</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1960">1960</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.score_cv_vs_mean(N=N,&nbsp;max_expr_avg=40)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1961">1961</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.filter_genes(by_cv_vs_mean=True)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1962">1962</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1963">1963</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.score_detection_levels(min_expr_counts=0,&nbsp;min_cells_express=0,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1964">1964</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_expr_counts_U=int(min_expr_counts&nbsp;/&nbsp;2)&nbsp;+&nbsp;1,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1965">1965</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_cells_express_U=int(min_cells_express&nbsp;/&nbsp;2)&nbsp;+&nbsp;1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1966">1966</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1967">1967</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;hasattr(self,&nbsp;"cluster_labels"):</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1968">1968</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.score_cluster_expression(min_avg_U=min_avg_U,&nbsp;min_avg_S=min_avg_S)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1969">1969</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.filter_genes(by_detection_levels=True,&nbsp;by_cluster_expression=True)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1970">1970</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1971">1971</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.filter_genes(by_detection_levels=True)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1972">1972</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.normalize_by_total()</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1973">1973</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.adjust_totS_totU(normalize_total=True)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1974">1974</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1975">1975</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1976">1976</td><td nowrap="nowrap"><span class="diff_sub">[docs]&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;default_fit_preparation(self,&nbsp;k:&nbsp;int=None,&nbsp;n_comps:&nbsp;int=None)&nbsp;-&gt;&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1977">1977</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Useful&nbsp;function&nbsp;to&nbsp;get&nbsp;started&nbsp;with&nbsp;velocyto:&nbsp;it&nbsp;performs&nbsp;PCA&nbsp;and&nbsp;kNN&nbsp;smoothing,&nbsp;it&nbsp;uses&nbsp;some&nbsp;heuristics&nbsp;to&nbsp;determine&nbsp;the&nbsp;parameters,&nbsp;results&nbsp;might&nbsp;be&nbsp;suboptimal.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1978">1978</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1979">1979</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;See&nbsp;`the&nbsp;analysis&nbsp;quick&nbsp;start&nbsp;guide&nbsp;&lt;http://velocyto.org/velocyto.py/tutorial/analysis.html&gt;`_&nbsp;for&nbsp;further&nbsp;info.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1980">1980</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1981">1981</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1982">1982</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1983">1983</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k:&nbsp;int,&nbsp;default=None</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1984">1984</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k&nbsp;in&nbsp;k-NearestNeighbors&nbsp;smoothing</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1985">1985</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_comps:&nbsp;int,&nbsp;default=None</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1986">1986</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numbed&nbsp;of&nbsp;components&nbsp;in&nbsp;pca</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1987">1987</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1988">1988</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warning("DEPRECATION&nbsp;WARNING&nbsp;-&nbsp;the&nbsp;current&nbsp;function&nbsp;is&nbsp;deprecated.&nbsp;Please&nbsp;refer&nbsp;to&nbsp;documetation&nbsp;for&nbsp;default&nbsp;parameters&nbsp;usage")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1989">1989</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.perform_PCA()</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1990">1990</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Choose&nbsp;the&nbsp;number&nbsp;of&nbsp;components&nbsp;to&nbsp;use&nbsp;for&nbsp;the&nbsp;kNN&nbsp;graph</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1991">1991</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n_comps&nbsp;is&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1992">1992</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_comps&nbsp;=&nbsp;int(np.where(np.diff(np.diff(np.cumsum(self.pca.explained_variance_ratio_))&nbsp;&gt;&nbsp;0.002))[0][0])</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1993">1993</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;k&nbsp;is&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1994">1994</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k&nbsp;=&nbsp;int(min(1000,&nbsp;max(10,&nbsp;np.ceil(self.S.shape[1]&nbsp;*&nbsp;0.02))))</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1995">1995</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.knn_imputation(n_pca_dims=n_comps,&nbsp;k=k,&nbsp;balanced=True,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1996">1996</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b_sight=int(min(k&nbsp;*&nbsp;8,&nbsp;self.S.shape[1]&nbsp;-&nbsp;1)),</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1997">1997</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b_maxl=int(min(k&nbsp;*&nbsp;4,&nbsp;self.S.shape[1]&nbsp;-&nbsp;1)))</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1998">1998</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.normalize_median()</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_1999">1999</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2000">2000</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2559">2559</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2001">2001</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;_plot_phase_portrait(self,&nbsp;gene:&nbsp;str,&nbsp;gs_i:&nbsp;Any=None)&nbsp;-&gt;&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_2560">2560</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;_plot_phase_portrait(self,&nbsp;gene:&nbsp;str,&nbsp;gs_i:&nbsp;Any=None)&nbsp;-&gt;&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2002">2002</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Plot&nbsp;spliced-unspliced&nbsp;scatterplot&nbsp;resembling&nbsp;phase&nbsp;portrait</td><td class="diff_next"></td><td class="diff_header" id="to0_2561">2561</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Plot&nbsp;spliced-unspliced&nbsp;scatterplot&nbsp;resembling&nbsp;phase&nbsp;portrait</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__113"></td><td class="diff_header" id="from0_2003">2003</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_2562">2562</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2004">2004</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;gene&nbsp;is&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_2563">2563</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;gene&nbsp;is&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2005">2005</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.subplot(111)</td><td class="diff_next"></td><td class="diff_header" id="to0_2564">2564</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.subplot(111)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2006">2006</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_2565">2565</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2007">2007</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.subplot(gs_i)</td><td class="diff_next"></td><td class="diff_header" id="to0_2566">2566</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.subplot(gs_i)</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__114">n</a></td><td class="diff_header" id="from0_2008">2008</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ix&nbsp;=&nbsp;np.where(self.ra["Gene"]&nbsp;==&nbsp;gene)[0][0]</td><td class="diff_next"><a href="#difflib_chg_to0__114">n</a></td><td class="diff_header" id="to0_2567">2567</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ix&nbsp;=&nbsp;np.where(self.ra["Gene<span class="diff_add">s</span>"]&nbsp;==&nbsp;gene)[0][0]</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__114"></td><td class="diff_header" id="from0_2009">2009</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scatter_viz(self.Sx_sz[ix,&nbsp;:],&nbsp;self.Ux_sz[ix,&nbsp;:],&nbsp;c=self.colorandum,&nbsp;s=5,&nbsp;alpha=0.4)</td><td class="diff_next"></td><td class="diff_header" id="to0_2568">2568</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scatter_viz(self.Sx_sz[ix,&nbsp;:],&nbsp;self.Ux_sz[ix,&nbsp;:],&nbsp;c=self.colorandum,&nbsp;s=5,&nbsp;alpha=0.4)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2010">2010</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.title(gene)</td><td class="diff_next"></td><td class="diff_header" id="to0_2569">2569</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.title(gene)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2011">2011</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xnew&nbsp;=&nbsp;np.linspace(0,&nbsp;self.Sx_sz[ix,&nbsp;:].max())</td><td class="diff_next"></td><td class="diff_header" id="to0_2570">2570</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xnew&nbsp;=&nbsp;np.linspace(0,&nbsp;self.Sx_sz[ix,&nbsp;:].max())</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2012">2012</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.plot(xnew,&nbsp;self.gammas[ix]&nbsp;*&nbsp;xnew&nbsp;+&nbsp;self.q[ix],&nbsp;c="k")</td><td class="diff_next"></td><td class="diff_header" id="to0_2571">2571</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.plot(xnew,&nbsp;self.gammas[ix]&nbsp;*&nbsp;xnew&nbsp;+&nbsp;self.q[ix],&nbsp;c="k")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2013">2013</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2572">2572</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__115">n</a></td><td class="diff_header" id="from0_2014">2014</td><td nowrap="nowrap"><span class="diff_sub">[docs]</span>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;plot_phase_portraits(self,&nbsp;genes:&nbsp;List[str])&nbsp;-&gt;&nbsp;None:</td><td class="diff_next"><a href="#difflib_chg_to0__115">n</a></td><td class="diff_header" id="to0_2573">2573</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;plot_phase_portraits(self,&nbsp;genes:&nbsp;List[str])&nbsp;-&gt;&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2015">2015</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Plot&nbsp;spliced-unspliced&nbsp;scatterplots&nbsp;resembling&nbsp;phase&nbsp;portraits</td><td class="diff_next"></td><td class="diff_header" id="to0_2574">2574</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Plot&nbsp;spliced-unspliced&nbsp;scatterplots&nbsp;resembling&nbsp;phase&nbsp;portraits</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2016">2016</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2575">2575</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__115"></td><td class="diff_header" id="from0_2017">2017</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td><td class="diff_next"></td><td class="diff_header" id="to0_2576">2576</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2018">2018</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td><td class="diff_next"></td><td class="diff_header" id="to0_2577">2577</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2019">2019</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genes:&nbsp;List[str]</td><td class="diff_next"></td><td class="diff_header" id="to0_2578">2578</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genes:&nbsp;List[str]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2020">2020</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;list&nbsp;of&nbsp;gene&nbsp;symbols.</td><td class="diff_next"></td><td class="diff_header" id="to0_2579">2579</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;list&nbsp;of&nbsp;gene&nbsp;symbols.</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2021">2021</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_2580">2580</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__116">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to0__116">n</a></td><td class="diff_header" id="to0_2581">2581</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genes&nbsp;=&nbsp;self.ra["Genes"]</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__116"></td><td class="diff_header" id="from0_2022">2022</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;=&nbsp;len(genes)</td><td class="diff_next"></td><td class="diff_header" id="to0_2582">2582</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;=&nbsp;len(genes)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2023">2023</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqrtn&nbsp;=&nbsp;int(np.ceil(np.sqrt(n)))</td><td class="diff_next"></td><td class="diff_header" id="to0_2583">2583</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqrtn&nbsp;=&nbsp;int(np.ceil(np.sqrt(n)))</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2024">2024</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs&nbsp;=&nbsp;plt.GridSpec(sqrtn,&nbsp;int(np.ceil(n&nbsp;/&nbsp;sqrtn)))</td><td class="diff_next"></td><td class="diff_header" id="to0_2584">2584</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs&nbsp;=&nbsp;plt.GridSpec(sqrtn,&nbsp;int(np.ceil(n&nbsp;/&nbsp;sqrtn)))</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__117"></td><td class="diff_header" id="from0_2025">2025</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i,&nbsp;gn&nbsp;in&nbsp;enumerate(genes):</td><td class="diff_next"></td><td class="diff_header" id="to0_2585">2585</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i,&nbsp;gn&nbsp;in&nbsp;enumerate(genes):</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2026">2026</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._plot_phase_portrait(gn,&nbsp;gs[i])</td><td class="diff_next"></td><td class="diff_header" id="to0_2586">2586</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._plot_phase_portrait(gn,&nbsp;gs[i])</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__117">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to0__117">n</a></td><td class="diff_header" id="to0_2587">2587</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig("phase_portraits.pdf")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2588">2588</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2027">2027</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2589">2589</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__118">n</a></td><td class="diff_header" id="from0_2028">2028</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__118">n</a></td><td class="diff_header" id="to0_2590">2590</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;one_arrow(self,&nbsp;numberNeighb,&nbsp;typegroup:&nbsp;str="integers",&nbsp;extraNNvalue:&nbsp;int=5):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2591">2591</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(None,(16,10))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2592">2592</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quiver_scale&nbsp;=&nbsp;60</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2593">2593</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_markers&nbsp;=&nbsp;self.ca["Markers"]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2594">2594</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mark&nbsp;=&nbsp;sorted(set(my_markers))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2595">2595</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;corresp&nbsp;=&nbsp;["o",&nbsp;"P",&nbsp;"D",&nbsp;"1",&nbsp;"2",&nbsp;"3",&nbsp;"p",&nbsp;"D",&nbsp;"d",&nbsp;"4",&nbsp;"|",&nbsp;"-",&nbsp;"X",&nbsp;"x",&nbsp;"*",&nbsp;"+",&nbsp;"&gt;",&nbsp;"&lt;"]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2596">2596</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;0</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2597">2597</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_types&nbsp;=&nbsp;{}</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2598">2598</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;the_type&nbsp;in&nbsp;mark:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2599">2599</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_types[the_type]&nbsp;=&nbsp;corresp[count]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2600">2600</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;count&nbsp;+&nbsp;1</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2601">2601</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;markers&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2602">2602</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;mar&nbsp;in&nbsp;my_markers:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2603">2603</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;markers.append(my_types.get(mar))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2604">2604</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;randn(10)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2605">2605</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#ax&nbsp;=&nbsp;fig.add_subplot(111,&nbsp;projection='3d')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2606">2606</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(0,&nbsp;len(markers)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2607">2607</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.scatter(self.embedding[i,&nbsp;0],&nbsp;self.embedding[i,&nbsp;1],c="0.8",&nbsp;alpha=1,&nbsp;s=120,&nbsp;edgecolor="")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2608">2608</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.scatter(self.embedding[i,&nbsp;0],&nbsp;self.embedding[i,&nbsp;1],&nbsp;marker=markers[i],&nbsp;c=self.colorandum[i],&nbsp;alpha=1,&nbsp;s=120,&nbsp;edgecolor=(0,0,0,1),&nbsp;lw=0.3,&nbsp;rasterized=True)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2609">2609</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quiver_kwargs=dict(headaxislength=7,&nbsp;headlength=13,&nbsp;headwidth=10,linewidths=0.5,&nbsp;width=0.005,edgecolors="k",&nbsp;color="black",&nbsp;alpha=1,&nbsp;angles='xy')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2610">2610</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.quiver(self.embedding[i,&nbsp;0],&nbsp;self.embedding[i,&nbsp;1],&nbsp;self.delta_embedding[i,&nbsp;0],&nbsp;self.delta_embedding[i,&nbsp;1],&nbsp;scale=quiver_scale,&nbsp;**quiver_kwargs)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2611">2611</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexy_codes&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2612">2612</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_keys&nbsp;=&nbsp;[k&nbsp;&nbsp;for&nbsp;&nbsp;k&nbsp;in&nbsp;&nbsp;self.cluster_colors_dict.keys()]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2613">2613</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_my_keys&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2614">2614</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;my_keys:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2615">2615</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_my_keys.append(str(item,'utf-8'))&nbsp;#int()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2616">2616</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmap2&nbsp;=&nbsp;cm.get_cmap('Paired')&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;PiYG</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2617">2617</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(cmap2.N):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2618">2618</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rgb&nbsp;=&nbsp;cmap2(i)[:3]&nbsp;#&nbsp;will&nbsp;return&nbsp;rgba,&nbsp;we&nbsp;take&nbsp;only&nbsp;first&nbsp;3&nbsp;so&nbsp;we&nbsp;get&nbsp;rgb</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2619">2619</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexy_codes.append(matplotlib.colors.rgb2hex(rgb))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2620">2620</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;legend_elements&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2621">2621</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined&nbsp;=&nbsp;list(zip(decoded_my_keys,&nbsp;hexy_codes))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2622">2622</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined&nbsp;=&nbsp;sorted(combined,&nbsp;key=itemgetter(0))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2623">2623</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(typegroup&nbsp;!=&nbsp;"Strings"):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2624">2624</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;timepoints&nbsp;=&nbsp;[int(i[0])&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2625">2625</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colys&nbsp;=&nbsp;[i[1]&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2626">2626</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tempDF&nbsp;=&nbsp;pd.DataFrame({'Group':timepoints,&nbsp;'colours':colys})</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2627">2627</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tempDF&nbsp;=&nbsp;tempDF.sort_values('Group')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2628">2628</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;groupys2&nbsp;=&nbsp;tempDF['Group'].tolist()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2629">2629</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cols2&nbsp;=&nbsp;tempDF['colours'].tolist()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2630">2630</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined&nbsp;=&nbsp;list(zip(groupys2,&nbsp;cols2))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2631">2631</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_my_keys&nbsp;=&nbsp;[i[0]&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2632">2632</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexy_codes&nbsp;=&nbsp;[i[1]&nbsp;for&nbsp;i&nbsp;in&nbsp;combined]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2633">2633</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;sample_type&nbsp;in&nbsp;range(0,&nbsp;len(decoded_my_keys)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2634">2634</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to_add&nbsp;=&nbsp;Line2D([0],&nbsp;[0],&nbsp;marker='s',&nbsp;color='w',&nbsp;label=str(decoded_my_keys[sample_type]).strip('"'),&nbsp;markerfacecolor=str(hexy_codes[sample_type]),&nbsp;markersize=7)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2635">2635</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;legend_elements.append(to_add)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2636">2636</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;sample_type&nbsp;in&nbsp;range(0,&nbsp;len(mark)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2637">2637</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to_add&nbsp;=&nbsp;Line2D([0],&nbsp;[0],&nbsp;marker=[*my_types.values()][sample_type],&nbsp;color='w',&nbsp;label=str([*my_types.keys()][sample_type]).strip('"'),&nbsp;markerfacecolor='black',&nbsp;markersize=7)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2638">2638</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;legend_elements.append(to_add)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2639">2639</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.legend(handles=legend_elements,&nbsp;fancybox=True,&nbsp;framealpha=1,&nbsp;borderpad=1,&nbsp;loc=(1.01,0.5),&nbsp;title='Key')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2640">2640</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#ax.set_xlim(0,&nbsp;10)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2641">2641</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#plt.axis("off")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2642">2642</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.xlabel(r"$t$-SNE1",&nbsp;fontsize=12)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2643">2643</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.ylabel(r"$t$-SNE2",&nbsp;fontsize=12)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2644">2644</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;figure_name&nbsp;=&nbsp;'tSNE_Arrows_NN'&nbsp;+&nbsp;str(numberNeighb)&nbsp;+&nbsp;"_"&nbsp;+&nbsp;str(extraNNvalue)&nbsp;+&nbsp;'.pdf'</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2645">2645</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(figure_name)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2646">2646</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#plt.show()</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__118"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2647">2647</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2648">2648</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2029">2029</td><td nowrap="nowrap"><span class="diff_sub">[docs]</span>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;plot_grid_arrows(self,&nbsp;quiver_scale:&nbsp;Union[str,&nbsp;float]="auto",&nbsp;scale_type:&nbsp;str=&nbsp;"relative",&nbsp;min_mass:&nbsp;float=<span class="diff_chg">1</span>,&nbsp;min_magnitude:&nbsp;float=<span class="diff_chg">None</span>,</td><td class="diff_next"></td><td class="diff_header" id="to0_2649">2649</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;plot_grid_arrows(self,&nbsp;quiver_scale:&nbsp;Union[str,&nbsp;float]="auto",&nbsp;scale_type:&nbsp;str=&nbsp;"relative",&nbsp;min_mass:&nbsp;float=<span class="diff_chg">0.0</span>,&nbsp;min_magnitude:&nbsp;float=<span class="diff_chg">0.0</span>,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2030">2030</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scatter_kwargs_dict:&nbsp;Dict=&nbsp;None,&nbsp;plot_dots:&nbsp;bool=False,&nbsp;plot_random:&nbsp;bool=False,&nbsp;**quiver_kwargs:&nbsp;Any)&nbsp;-&gt;&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_2650">2650</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scatter_kwargs_dict:&nbsp;Dict=&nbsp;None,&nbsp;plot_dots:&nbsp;bool=False,&nbsp;plot_random:&nbsp;bool=False,&nbsp;**quiver_kwargs:&nbsp;Any)&nbsp;-&gt;&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2031">2031</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Plots&nbsp;vector&nbsp;field&nbsp;averaging&nbsp;velocity&nbsp;vectors&nbsp;on&nbsp;a&nbsp;grid</td><td class="diff_next"></td><td class="diff_header" id="to0_2651">2651</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Plots&nbsp;vector&nbsp;field&nbsp;averaging&nbsp;velocity&nbsp;vectors&nbsp;on&nbsp;a&nbsp;grid</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__119">n</a></td><td class="diff_header" id="from0_2032">2032</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__119">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2033">2033</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td><td class="diff_next"></td><td class="diff_header" id="to0_2652">2652</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2034">2034</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td><td class="diff_next"></td><td class="diff_header" id="to0_2653">2653</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2035">2035</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quiver_scale:&nbsp;float,&nbsp;default="auto"</td><td class="diff_next"></td><td class="diff_header" id="to0_2654">2654</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quiver_scale:&nbsp;float,&nbsp;default="auto"</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2036">2036</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rescaling&nbsp;factor&nbsp;applied&nbsp;to&nbsp;the&nbsp;arrow&nbsp;field&nbsp;to&nbsp;enhance&nbsp;visibility</td><td class="diff_next"></td><td class="diff_header" id="to0_2655">2655</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rescaling&nbsp;factor&nbsp;applied&nbsp;to&nbsp;the&nbsp;arrow&nbsp;field&nbsp;to&nbsp;enhance&nbsp;visibility</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2037">2037</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;"auto"&nbsp;the&nbsp;scale&nbsp;is&nbsp;selected&nbsp;using&nbsp;the&nbsp;randomized&nbsp;(negative)&nbsp;control&nbsp;(even&nbsp;if&nbsp;`plot_random`=False)</td><td class="diff_next"></td><td class="diff_header" id="to0_2656">2656</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;"auto"&nbsp;the&nbsp;scale&nbsp;is&nbsp;selected&nbsp;using&nbsp;the&nbsp;randomized&nbsp;(negative)&nbsp;control&nbsp;(even&nbsp;if&nbsp;`plot_random`=False)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2038">2038</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;a&nbsp;float&nbsp;is&nbsp;provided&nbsp;the&nbsp;interpretation&nbsp;of&nbsp;the&nbsp;value&nbsp;depends&nbsp;on&nbsp;the&nbsp;parameter&nbsp;`scale_type`,&nbsp;see&nbsp;below.</td><td class="diff_next"></td><td class="diff_header" id="to0_2657">2657</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;a&nbsp;float&nbsp;is&nbsp;provided&nbsp;the&nbsp;interpretation&nbsp;of&nbsp;the&nbsp;value&nbsp;depends&nbsp;on&nbsp;the&nbsp;parameter&nbsp;`scale_type`,&nbsp;see&nbsp;below.</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2039">2039</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOTE:&nbsp;In&nbsp;the&nbsp;situation&nbsp;where&nbsp;"auto"&nbsp;is&nbsp;resulting&nbsp;in&nbsp;very&nbsp;small&nbsp;or&nbsp;big&nbsp;velocities,&nbsp;pass&nbsp;a&nbsp;float&nbsp;to&nbsp;this&nbsp;parameter</td><td class="diff_next"></td><td class="diff_header" id="to0_2658">2658</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOTE:&nbsp;In&nbsp;the&nbsp;situation&nbsp;where&nbsp;"auto"&nbsp;is&nbsp;resulting&nbsp;in&nbsp;very&nbsp;small&nbsp;or&nbsp;big&nbsp;velocities,&nbsp;pass&nbsp;a&nbsp;float&nbsp;to&nbsp;this&nbsp;parameter</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2040">2040</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;float&nbsp;will&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;a&nbsp;scaling,&nbsp;importantly&nbsp;both&nbsp;the&nbsp;data&nbsp;and&nbsp;the&nbsp;control&nbsp;will&nbsp;be&nbsp;scaled</td><td class="diff_next"></td><td class="diff_header" id="to0_2659">2659</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;float&nbsp;will&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;a&nbsp;scaling,&nbsp;importantly&nbsp;both&nbsp;the&nbsp;data&nbsp;and&nbsp;the&nbsp;control&nbsp;will&nbsp;be&nbsp;scaled</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2041">2041</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;this&nbsp;way&nbsp;you&nbsp;can&nbsp;rescale&nbsp;the&nbsp;velocity&nbsp;arbitrarily&nbsp;without&nbsp;the&nbsp;risk&nbsp;of&nbsp;observing&nbsp;just&nbsp;an&nbsp;overfit&nbsp;of&nbsp;the&nbsp;noise</td><td class="diff_next"></td><td class="diff_header" id="to0_2660">2660</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;this&nbsp;way&nbsp;you&nbsp;can&nbsp;rescale&nbsp;the&nbsp;velocity&nbsp;arbitrarily&nbsp;without&nbsp;the&nbsp;risk&nbsp;of&nbsp;observing&nbsp;just&nbsp;an&nbsp;overfit&nbsp;of&nbsp;the&nbsp;noise</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2042">2042</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scale_type:&nbsp;str,&nbsp;default="relative"</td><td class="diff_next"></td><td class="diff_header" id="to0_2661">2661</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scale_type:&nbsp;str,&nbsp;default="relative"</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2043">2043</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;How&nbsp;to&nbsp;interpret&nbsp;`quiver_scale`:</td><td class="diff_next"></td><td class="diff_header" id="to0_2662">2662</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;How&nbsp;to&nbsp;interpret&nbsp;`quiver_scale`:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2044">2044</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;"relative"&nbsp;(default)&nbsp;the&nbsp;value&nbsp;will&nbsp;be&nbsp;used&nbsp;as&nbsp;a&nbsp;scaling&nbsp;factor&nbsp;and&nbsp;multiplied&nbsp;by&nbsp;the&nbsp;value&nbsp;from&nbsp;"auto"</td><td class="diff_next"></td><td class="diff_header" id="to0_2663">2663</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;"relative"&nbsp;(default)&nbsp;the&nbsp;value&nbsp;will&nbsp;be&nbsp;used&nbsp;as&nbsp;a&nbsp;scaling&nbsp;factor&nbsp;and&nbsp;multiplied&nbsp;by&nbsp;the&nbsp;value&nbsp;from&nbsp;"auto"</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2045">2045</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(it&nbsp;follows&nbsp;that&nbsp;quiver_scale="auto"&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;quiver_scale=1)</td><td class="diff_next"></td><td class="diff_header" id="to0_2664">2664</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(it&nbsp;follows&nbsp;that&nbsp;quiver_scale="auto"&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;quiver_scale=1)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2046">2046</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;"absolute"&nbsp;the&nbsp;value&nbsp;will&nbsp;be&nbsp;passed&nbsp;to&nbsp;the&nbsp;matplotlib&nbsp;quiver&nbsp;function&nbsp;(not&nbsp;recommended&nbsp;if&nbsp;you&nbsp;are&nbsp;not&nbsp;sure&nbsp;what&nbsp;this&nbsp;implies)</td><td class="diff_next"></td><td class="diff_header" id="to0_2665">2665</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;"absolute"&nbsp;the&nbsp;value&nbsp;will&nbsp;be&nbsp;passed&nbsp;to&nbsp;the&nbsp;matplotlib&nbsp;quiver&nbsp;function&nbsp;(not&nbsp;recommended&nbsp;if&nbsp;you&nbsp;are&nbsp;not&nbsp;sure&nbsp;what&nbsp;this&nbsp;implies)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2047">2047</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_mass:&nbsp;float,&nbsp;default=1</td><td class="diff_next"></td><td class="diff_header" id="to0_2666">2666</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_mass:&nbsp;float,&nbsp;default=1</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2048">2048</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;minimum&nbsp;density&nbsp;around&nbsp;a&nbsp;grid&nbsp;point&nbsp;for&nbsp;it&nbsp;to&nbsp;be&nbsp;considered&nbsp;and&nbsp;plotted</td><td class="diff_next"></td><td class="diff_header" id="to0_2667">2667</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;minimum&nbsp;density&nbsp;around&nbsp;a&nbsp;grid&nbsp;point&nbsp;for&nbsp;it&nbsp;to&nbsp;be&nbsp;considered&nbsp;and&nbsp;plotted</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2049">2049</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_magnitude:&nbsp;float,&nbsp;default=None</td><td class="diff_next"></td><td class="diff_header" id="to0_2668">2668</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_magnitude:&nbsp;float,&nbsp;default=None</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2050">2050</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;minimum&nbsp;magnitude&nbsp;of&nbsp;the&nbsp;velocity&nbsp;for&nbsp;it&nbsp;to&nbsp;be&nbsp;considered&nbsp;and&nbsp;plotted</td><td class="diff_next"></td><td class="diff_header" id="to0_2669">2669</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;minimum&nbsp;magnitude&nbsp;of&nbsp;the&nbsp;velocity&nbsp;for&nbsp;it&nbsp;to&nbsp;be&nbsp;considered&nbsp;and&nbsp;plotted</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2051">2051</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scatter_kwargs_dict:&nbsp;dict,&nbsp;default=None</td><td class="diff_next"></td><td class="diff_header" id="to0_2670">2670</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scatter_kwargs_dict:&nbsp;dict,&nbsp;default=None</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2052">2052</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;dictionary&nbsp;of&nbsp;keyword&nbsp;arguments&nbsp;to&nbsp;pass&nbsp;to&nbsp;scatter</td><td class="diff_next"></td><td class="diff_header" id="to0_2671">2671</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;dictionary&nbsp;of&nbsp;keyword&nbsp;arguments&nbsp;to&nbsp;pass&nbsp;to&nbsp;scatter</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2053">2053</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by&nbsp;default&nbsp;the&nbsp;following&nbsp;are&nbsp;passed:&nbsp;s=20,&nbsp;zorder=-1,&nbsp;alpha=0.2,&nbsp;lw=0,&nbsp;c=self.colorandum.&nbsp;But&nbsp;they&nbsp;can&nbsp;be&nbsp;overridden.</td><td class="diff_next"></td><td class="diff_header" id="to0_2672">2672</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by&nbsp;default&nbsp;the&nbsp;following&nbsp;are&nbsp;passed:&nbsp;s=20,&nbsp;zorder=-1,&nbsp;alpha=0.2,&nbsp;lw=0,&nbsp;c=self.colorandum.&nbsp;But&nbsp;they&nbsp;can&nbsp;be&nbsp;overridden.</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2054">2054</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plot_dots:&nbsp;bool,&nbsp;default=True</td><td class="diff_next"></td><td class="diff_header" id="to0_2673">2673</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plot_dots:&nbsp;bool,&nbsp;default=True</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2055">2055</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whether&nbsp;to&nbsp;plot&nbsp;dots&nbsp;in&nbsp;correspondence&nbsp;of&nbsp;all&nbsp;low&nbsp;velocity&nbsp;grid&nbsp;points</td><td class="diff_next"></td><td class="diff_header" id="to0_2674">2674</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whether&nbsp;to&nbsp;plot&nbsp;dots&nbsp;in&nbsp;correspondence&nbsp;of&nbsp;all&nbsp;low&nbsp;velocity&nbsp;grid&nbsp;points</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2056">2056</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plot_random:&nbsp;bool,&nbsp;default=True</td><td class="diff_next"></td><td class="diff_header" id="to0_2675">2675</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plot_random:&nbsp;bool,&nbsp;default=True</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2057">2057</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whether&nbsp;to&nbsp;plot&nbsp;the&nbsp;randomized&nbsp;control&nbsp;next&nbsp;to&nbsp;the&nbsp;plot</td><td class="diff_next"></td><td class="diff_header" id="to0_2676">2676</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whether&nbsp;to&nbsp;plot&nbsp;the&nbsp;randomized&nbsp;control&nbsp;next&nbsp;to&nbsp;the&nbsp;plot</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2058">2058</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**quiver_kwargs:&nbsp;dict</td><td class="diff_next"></td><td class="diff_header" id="to0_2677">2677</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**quiver_kwargs:&nbsp;dict</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2059">2059</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keyword&nbsp;arguments&nbsp;to&nbsp;pass&nbsp;to&nbsp;quiver</td><td class="diff_next"></td><td class="diff_header" id="to0_2678">2678</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keyword&nbsp;arguments&nbsp;to&nbsp;pass&nbsp;to&nbsp;quiver</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__119"></td><td class="diff_header" id="from0_2060">2060</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;By&nbsp;default&nbsp;the&nbsp;following&nbsp;are&nbsp;passed&nbsp;angles='xy',&nbsp;scale_units='xy',&nbsp;minlength=1.5.&nbsp;But&nbsp;they&nbsp;can&nbsp;be&nbsp;overridden.</td><td class="diff_next"></td><td class="diff_header" id="to0_2679">2679</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;By&nbsp;default&nbsp;the&nbsp;following&nbsp;are&nbsp;passed&nbsp;angles='xy',&nbsp;scale_units='xy',&nbsp;minlength=1.5.&nbsp;But&nbsp;they&nbsp;can&nbsp;be&nbsp;overridden.</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2061">2061</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_2680">2680</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2062">2062</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;plt.figure(figsize=(10,&nbsp;10))</td><td class="diff_next"></td><td class="diff_header" id="to0_2681">2681</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;plt.figure(figsize=(10,&nbsp;10))</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2063">2063</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_quiver_kwargs&nbsp;=&nbsp;{"angles":&nbsp;'xy',&nbsp;"scale_units":&nbsp;'xy',&nbsp;"minlength":&nbsp;1.5}</td><td class="diff_next"></td><td class="diff_header" id="to0_2682">2682</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_quiver_kwargs&nbsp;=&nbsp;{"angles":&nbsp;'xy',&nbsp;"scale_units":&nbsp;'xy',&nbsp;"minlength":&nbsp;1.5}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2064">2064</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_quiver_kwargs.update(quiver_kwargs)</td><td class="diff_next"></td><td class="diff_header" id="to0_2683">2683</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_quiver_kwargs.update(quiver_kwargs)</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__120">n</a></td><td class="diff_header" id="from0_2065">2065</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__120">n</a></td><td class="diff_header" id="to0_2684">2684</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2066">2066</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scatter_dict&nbsp;=&nbsp;{"s":&nbsp;20,&nbsp;"zorder":&nbsp;-1,&nbsp;"alpha":&nbsp;0.2,&nbsp;"lw":&nbsp;0,&nbsp;"c":&nbsp;self.colorandum}</td><td class="diff_next"></td><td class="diff_header" id="to0_2685">2685</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scatter_dict&nbsp;=&nbsp;{"s":&nbsp;20,&nbsp;"zorder":&nbsp;-1,&nbsp;"alpha":&nbsp;0.2,&nbsp;"lw":&nbsp;0,&nbsp;"c":&nbsp;self.colorandum}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2067">2067</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;scatter_kwargs_dict&nbsp;is&nbsp;not&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_2686">2686</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;scatter_kwargs_dict&nbsp;is&nbsp;not&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2068">2068</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scatter_dict.update(scatter_kwargs_dict)</td><td class="diff_next"></td><td class="diff_header" id="to0_2687">2687</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scatter_dict.update(scatter_kwargs_dict)</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__120"></td><td class="diff_header" id="from0_2069">2069</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2688">2688</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2070">2070</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Determine&nbsp;quiver&nbsp;scale</td><td class="diff_next"></td><td class="diff_header" id="to0_2689">2689</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Determine&nbsp;quiver&nbsp;scale</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2071">2071</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;scale_type&nbsp;==&nbsp;"relative":</td><td class="diff_next"></td><td class="diff_header" id="to0_2690">2690</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;scale_type&nbsp;==&nbsp;"relative":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2072">2072</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;hasattr(self,&nbsp;"flow_rndm"):</td><td class="diff_next"></td><td class="diff_header" id="to0_2691">2691</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;hasattr(self,&nbsp;"flow_rndm"):</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2073">2073</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plot_scale&nbsp;=&nbsp;np.linalg.norm(np.max(self.flow_grid,&nbsp;0)&nbsp;-&nbsp;np.min(self.flow_grid,&nbsp;0),&nbsp;2)&nbsp;&nbsp;#&nbsp;Diagonal&nbsp;of&nbsp;the&nbsp;plot</td><td class="diff_next"></td><td class="diff_header" id="to0_2692">2692</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plot_scale&nbsp;=&nbsp;np.linalg.norm(np.max(self.flow_grid,&nbsp;0)&nbsp;-&nbsp;np.min(self.flow_grid,&nbsp;0),&nbsp;2)&nbsp;&nbsp;#&nbsp;Diagonal&nbsp;of&nbsp;the&nbsp;plot</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__121">n</a></td><td class="diff_header" id="from0_2074">2074</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arrows_scale&nbsp;=&nbsp;np.percentile(np.linalg.norm(self.flow_rndm[self.total_p_mass&nbsp;&gt;=&nbsp;min_mass,&nbsp;:],&nbsp;2,&nbsp;1),&nbsp;90)&nbsp;&nbsp;#&nbsp;T<span class="diff_chg">i</span>pical&nbsp;lenght&nbsp;of&nbsp;an&nbsp;arrow</td><td class="diff_next"><a href="#difflib_chg_to0__121">n</a></td><td class="diff_header" id="to0_2693">2693</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arrows_scale&nbsp;=&nbsp;np.percentile(np.linalg.norm(self.flow_rndm[self.total_p_mass&nbsp;&gt;=&nbsp;min_mass,&nbsp;:],&nbsp;2,&nbsp;1),&nbsp;90)&nbsp;&nbsp;#&nbsp;T<span class="diff_chg">y</span>pical&nbsp;lenght&nbsp;of&nbsp;an&nbsp;arrow</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2075">2075</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;quiver_scale&nbsp;==&nbsp;"auto":</td><td class="diff_next"></td><td class="diff_header" id="to0_2694">2694</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;quiver_scale&nbsp;==&nbsp;"auto":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2076">2076</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quiver_scale&nbsp;=&nbsp;arrows_scale&nbsp;/&nbsp;(plot_scale&nbsp;*&nbsp;0.0025)</td><td class="diff_next"></td><td class="diff_header" id="to0_2695">2695</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quiver_scale&nbsp;=&nbsp;arrows_scale&nbsp;/&nbsp;(plot_scale&nbsp;*&nbsp;0.0025)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2077">2077</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_2696">2696</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2078">2078</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quiver_scale&nbsp;=&nbsp;quiver_scale&nbsp;*&nbsp;arrows_scale&nbsp;/&nbsp;(plot_scale&nbsp;*&nbsp;0.0025)</td><td class="diff_next"></td><td class="diff_header" id="to0_2697">2697</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quiver_scale&nbsp;=&nbsp;quiver_scale&nbsp;*&nbsp;arrows_scale&nbsp;/&nbsp;(plot_scale&nbsp;*&nbsp;0.0025)</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__121"></td><td class="diff_header" id="from0_2079">2079</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_2698">2698</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2080">2080</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;ValueError(""""`scale_type`&nbsp;was&nbsp;set&nbsp;to&nbsp;'relative'&nbsp;but&nbsp;the&nbsp;randomized&nbsp;control&nbsp;was&nbsp;not&nbsp;computed&nbsp;when&nbsp;running&nbsp;estimate_transition_prob</td><td class="diff_next"></td><td class="diff_header" id="to0_2699">2699</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;ValueError(""""`scale_type`&nbsp;was&nbsp;set&nbsp;to&nbsp;'relative'&nbsp;but&nbsp;the&nbsp;randomized&nbsp;control&nbsp;was&nbsp;not&nbsp;computed&nbsp;when&nbsp;running&nbsp;estimate_transition_prob</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2081">2081</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Please&nbsp;run&nbsp;estimate_transition_prob&nbsp;or&nbsp;set&nbsp;`scale_type`&nbsp;to&nbsp;`absolute`""")</td><td class="diff_next"></td><td class="diff_header" id="to0_2700">2700</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Please&nbsp;run&nbsp;estimate_transition_prob&nbsp;or&nbsp;set&nbsp;`scale_type`&nbsp;to&nbsp;`absolute`""")</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__122"></td><td class="diff_header" id="from0_2082">2082</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_2701">2701</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2083">2083</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warning("The&nbsp;arrow&nbsp;scale&nbsp;was&nbsp;set&nbsp;to&nbsp;be&nbsp;'absolute'&nbsp;make&nbsp;sure&nbsp;you&nbsp;know&nbsp;how&nbsp;to&nbsp;properly&nbsp;interpret&nbsp;the&nbsp;plots")</td><td class="diff_next"></td><td class="diff_header" id="to0_2702">2702</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warning("The&nbsp;arrow&nbsp;scale&nbsp;was&nbsp;set&nbsp;to&nbsp;be&nbsp;'absolute'&nbsp;make&nbsp;sure&nbsp;you&nbsp;know&nbsp;how&nbsp;to&nbsp;properly&nbsp;interpret&nbsp;the&nbsp;plots")</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__122">n</a></td><td class="diff_header" id="from0_2084">2084</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__122">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2085">2085</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mass_filter&nbsp;=&nbsp;self.total_p_mass&nbsp;&lt;&nbsp;min_mass</td><td class="diff_next"></td><td class="diff_header" id="to0_2703">2703</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mass_filter&nbsp;=&nbsp;self.total_p_mass&nbsp;&lt;&nbsp;min_mass</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2086">2086</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;min_magnitude&nbsp;is&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_2704">2704</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;min_magnitude&nbsp;is&nbsp;None:</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__123">n</a></td><td class="diff_header" id="from0_2087">2087</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XY,&nbsp;UV&nbsp;=&nbsp;np.copy(self.flow_grid),&nbsp;np.copy(self.flow)</span></td><td class="diff_next"><a href="#difflib_chg_to0__123">n</a></td><td class="diff_header" id="to0_2705">2705</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XY,&nbsp;UV&nbsp;=&nbsp;np.copy(self.flow_grid),&nbsp;np.copy(self.flow)&nbsp;#flow&nbsp;grid&nbsp;has&nbsp;current&nbsp;x,&nbsp;y&nbsp;coordinates,&nbsp;flow&nbsp;or&nbsp;flow_norm&nbsp;has&nbsp;the&nbsp;thing&nbsp;to&nbsp;be&nbsp;added&nbsp;on</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2088">2088</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;plot_dots:</td><td class="diff_next"></td><td class="diff_header" id="to0_2706">2706</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;plot_dots:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2089">2089</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UV&nbsp;=&nbsp;UV[~mass_filter,&nbsp;:]</td><td class="diff_next"></td><td class="diff_header" id="to0_2707">2707</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UV&nbsp;=&nbsp;UV[~mass_filter,&nbsp;:]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2090">2090</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XY&nbsp;=&nbsp;XY[~mass_filter,&nbsp;:]</td><td class="diff_next"></td><td class="diff_header" id="to0_2708">2708</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XY&nbsp;=&nbsp;XY[~mass_filter,&nbsp;:]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2091">2091</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_2709">2709</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2092">2092</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UV[mass_filter,&nbsp;:]&nbsp;=&nbsp;0</td><td class="diff_next"></td><td class="diff_header" id="to0_2710">2710</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UV[mass_filter,&nbsp;:]&nbsp;=&nbsp;0</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2093">2093</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_2711">2711</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2094">2094</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XY,&nbsp;UV&nbsp;=&nbsp;np.copy(self.flow_grid),&nbsp;np.copy(self.flow_norm)</td><td class="diff_next"></td><td class="diff_header" id="to0_2712">2712</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XY,&nbsp;UV&nbsp;=&nbsp;np.copy(self.flow_grid),&nbsp;np.copy(self.flow_norm)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2095">2095</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;plot_dots:</td><td class="diff_next"></td><td class="diff_header" id="to0_2713">2713</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;plot_dots:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2096">2096</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UV&nbsp;=&nbsp;UV[~(mass_filter&nbsp;|&nbsp;(self.flow_norm_magnitude&nbsp;&lt;&nbsp;min_magnitude)),&nbsp;:]</td><td class="diff_next"></td><td class="diff_header" id="to0_2714">2714</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UV&nbsp;=&nbsp;UV[~(mass_filter&nbsp;|&nbsp;(self.flow_norm_magnitude&nbsp;&lt;&nbsp;min_magnitude)),&nbsp;:]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2097">2097</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XY&nbsp;=&nbsp;XY[~(mass_filter&nbsp;|&nbsp;(self.flow_norm_magnitude&nbsp;&lt;&nbsp;min_magnitude)),&nbsp;:]</td><td class="diff_next"></td><td class="diff_header" id="to0_2715">2715</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XY&nbsp;=&nbsp;XY[~(mass_filter&nbsp;|&nbsp;(self.flow_norm_magnitude&nbsp;&lt;&nbsp;min_magnitude)),&nbsp;:]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2098">2098</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_2716">2716</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2099">2099</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UV[mass_filter&nbsp;|&nbsp;(self.flow_norm_magnitude&nbsp;&lt;&nbsp;min_magnitude),&nbsp;:]&nbsp;=&nbsp;0</td><td class="diff_next"></td><td class="diff_header" id="to0_2717">2717</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UV[mass_filter&nbsp;|&nbsp;(self.flow_norm_magnitude&nbsp;&lt;&nbsp;min_magnitude),&nbsp;:]&nbsp;=&nbsp;0</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2100">2100</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2718">2718</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2101">2101</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;plot_random:</td><td class="diff_next"></td><td class="diff_header" id="to0_2719">2719</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;plot_random:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2102">2102</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;min_magnitude&nbsp;is&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_2720">2720</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;min_magnitude&nbsp;is&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2103">2103</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XY,&nbsp;UV_rndm&nbsp;=&nbsp;np.copy(self.flow_grid),&nbsp;np.copy(self.flow_rndm)</td><td class="diff_next"></td><td class="diff_header" id="to0_2721">2721</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XY,&nbsp;UV_rndm&nbsp;=&nbsp;np.copy(self.flow_grid),&nbsp;np.copy(self.flow_rndm)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2104">2104</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;plot_dots:</td><td class="diff_next"></td><td class="diff_header" id="to0_2722">2722</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;plot_dots:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2105">2105</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UV_rndm&nbsp;=&nbsp;UV_rndm[~mass_filter,&nbsp;:]</td><td class="diff_next"></td><td class="diff_header" id="to0_2723">2723</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UV_rndm&nbsp;=&nbsp;UV_rndm[~mass_filter,&nbsp;:]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2106">2106</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XY&nbsp;=&nbsp;XY[~mass_filter,&nbsp;:]</td><td class="diff_next"></td><td class="diff_header" id="to0_2724">2724</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XY&nbsp;=&nbsp;XY[~mass_filter,&nbsp;:]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2107">2107</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_2725">2725</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2108">2108</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UV_rndm[mass_filter,&nbsp;:]&nbsp;=&nbsp;0</td><td class="diff_next"></td><td class="diff_header" id="to0_2726">2726</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UV_rndm[mass_filter,&nbsp;:]&nbsp;=&nbsp;0</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2109">2109</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_2727">2727</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2110">2110</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XY,&nbsp;UV_rndm&nbsp;=&nbsp;np.copy(self.flow_grid),&nbsp;np.copy(self.flow_norm_rndm)</td><td class="diff_next"></td><td class="diff_header" id="to0_2728">2728</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XY,&nbsp;UV_rndm&nbsp;=&nbsp;np.copy(self.flow_grid),&nbsp;np.copy(self.flow_norm_rndm)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2111">2111</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;plot_dots:</td><td class="diff_next"></td><td class="diff_header" id="to0_2729">2729</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;plot_dots:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2112">2112</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UV_rndm&nbsp;=&nbsp;UV_rndm[~(mass_filter&nbsp;|&nbsp;(self.flow_norm_magnitude_rndm&nbsp;&lt;&nbsp;min_magnitude)),&nbsp;:]</td><td class="diff_next"></td><td class="diff_header" id="to0_2730">2730</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UV_rndm&nbsp;=&nbsp;UV_rndm[~(mass_filter&nbsp;|&nbsp;(self.flow_norm_magnitude_rndm&nbsp;&lt;&nbsp;min_magnitude)),&nbsp;:]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2113">2113</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XY&nbsp;=&nbsp;XY[~(mass_filter&nbsp;|&nbsp;(self.flow_norm_magnitude_rndm&nbsp;&lt;&nbsp;min_magnitude)),&nbsp;:]</td><td class="diff_next"></td><td class="diff_header" id="to0_2731">2731</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XY&nbsp;=&nbsp;XY[~(mass_filter&nbsp;|&nbsp;(self.flow_norm_magnitude_rndm&nbsp;&lt;&nbsp;min_magnitude)),&nbsp;:]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2114">2114</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_2732">2732</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2115">2115</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UV_rndm[mass_filter&nbsp;|&nbsp;(self.flow_norm_magnitude_rndm&nbsp;&lt;&nbsp;min_magnitude),&nbsp;:]&nbsp;=&nbsp;0</td><td class="diff_next"></td><td class="diff_header" id="to0_2733">2733</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UV_rndm[mass_filter&nbsp;|&nbsp;(self.flow_norm_magnitude_rndm&nbsp;&lt;&nbsp;min_magnitude),&nbsp;:]&nbsp;=&nbsp;0</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__123"></td><td class="diff_header" id="from0_2116">2116</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2734">2734</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2117">2117</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.subplot(122)</td><td class="diff_next"></td><td class="diff_header" id="to0_2735">2735</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.subplot(122)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2118">2118</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.title("Randomized")</td><td class="diff_next"></td><td class="diff_header" id="to0_2736">2736</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.title("Randomized")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2119">2119</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.scatter(self.flow_embedding[:,&nbsp;0],&nbsp;self.flow_embedding[:,&nbsp;1],&nbsp;**scatter_dict)</td><td class="diff_next"></td><td class="diff_header" id="to0_2737">2737</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.scatter(self.flow_embedding[:,&nbsp;0],&nbsp;self.flow_embedding[:,&nbsp;1],&nbsp;**scatter_dict)</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__124"></td><td class="diff_header" id="from0_2120">2120</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.quiver(XY[:,&nbsp;0],&nbsp;XY[:,&nbsp;1],&nbsp;UV_rndm[:,&nbsp;0],&nbsp;UV_rndm[:,&nbsp;1],</td><td class="diff_next"></td><td class="diff_header" id="to0_2738">2738</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.quiver(XY[:,&nbsp;0],&nbsp;XY[:,&nbsp;1],&nbsp;UV_rndm[:,&nbsp;0],&nbsp;UV_rndm[:,&nbsp;1],</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__124">n</a></td><td class="diff_header" id="from0_2121">2121</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scale=quiver_scale,&nbsp;zorder=20000,&nbsp;**_quiver_kwargs)</span></td><td class="diff_next"><a href="#difflib_chg_to0__124">n</a></td><td class="diff_header" id="to0_2739">2739</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scale=quiver_scale,&nbsp;zorder=20000,&nbsp;**_quiver_kwargs)&nbsp;#XY[:,&nbsp;0]&nbsp;+&nbsp;UV_rndm[:,&nbsp;0]&nbsp;=&nbsp;end&nbsp;of&nbsp;arrow&nbsp;x&nbsp;coordinate,&nbsp;XY[:,&nbsp;1]&nbsp;+&nbsp;UV_rndm[:,&nbsp;1]&nbsp;=&nbsp;end&nbsp;of&nbsp;arrow&nbsp;y&nbsp;coordinate</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2122">2122</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.axis("off")</td><td class="diff_next"></td><td class="diff_header" id="to0_2740">2740</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.axis("off")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2123">2123</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.subplot(121)</td><td class="diff_next"></td><td class="diff_header" id="to0_2741">2741</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.subplot(121)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2124">2124</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.title("Data")</td><td class="diff_next"></td><td class="diff_header" id="to0_2742">2742</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.title("Data")</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__125">n</a></td><td class="diff_header" id="from0_2125">2125</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__125">n</a></td><td class="diff_header" id="to0_2743">2743</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#will&nbsp;need&nbsp;third&nbsp;coordinate&nbsp;to&nbsp;be&nbsp;added&nbsp;to&nbsp;embedding</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2744">2744</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#ax&nbsp;=&nbsp;fig.add_subplot(111,&nbsp;projection='3d')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2745">2745</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#ax.scatter()</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__125"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2746">2746</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#ax.set_xlabel('x-tSNE')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2747">2747</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#ax.set_ylabel('y-tSNE')</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__126"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2748">2748</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#ax.set_zlabel('z-tSNE')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2126">2126</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.scatter(self.flow_embedding[:,&nbsp;0],&nbsp;self.flow_embedding[:,&nbsp;1],&nbsp;**scatter_dict)</td><td class="diff_next"></td><td class="diff_header" id="to0_2749">2749</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.scatter(self.flow_embedding[:,&nbsp;0],&nbsp;self.flow_embedding[:,&nbsp;1],&nbsp;**scatter_dict)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2127">2127</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.quiver(XY[:,&nbsp;0],&nbsp;XY[:,&nbsp;1],&nbsp;UV[:,&nbsp;0],&nbsp;UV[:,&nbsp;1],</td><td class="diff_next"></td><td class="diff_header" id="to0_2750">2750</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.quiver(XY[:,&nbsp;0],&nbsp;XY[:,&nbsp;1],&nbsp;UV[:,&nbsp;0],&nbsp;UV[:,&nbsp;1],</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__126">n</a></td><td class="diff_header" id="from0_2128">2128</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scale=quiver_scale,&nbsp;zorder=20000,&nbsp;**_quiver_kwargs)</span></td><td class="diff_next"><a href="#difflib_chg_to0__126">n</a></td><td class="diff_header" id="to0_2751">2751</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scale=quiver_scale,&nbsp;zorder=20000,&nbsp;**_quiver_kwargs)&nbsp;&nbsp;#XY[:,&nbsp;0]&nbsp;+&nbsp;UV[:,&nbsp;0]&nbsp;=&nbsp;end&nbsp;of&nbsp;arrow&nbsp;x&nbsp;coordinate,&nbsp;XY[:,&nbsp;1]&nbsp;+&nbsp;UV[:,&nbsp;1]&nbsp;=&nbsp;end&nbsp;of&nbsp;arrow&nbsp;y&nbsp;coordinate&nbsp;scale:&nbsp;scale&nbsp;:&nbsp;None,&nbsp;float,&nbsp;optional&nbsp;#Number&nbsp;of&nbsp;data&nbsp;units&nbsp;per&nbsp;arrow&nbsp;length&nbsp;unit,&nbsp;e.g.,&nbsp;m/s&nbsp;per&nbsp;plot&nbsp;width;&nbsp;a&nbsp;smaller&nbsp;scale&nbsp;parameter&nbsp;makes&nbsp;the&nbsp;arrow&nbsp;longer.&nbsp;Default&nbsp;is&nbsp;None.</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__127"></td><td class="diff_header" id="from0_2129">2129</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.axis("off")</td><td class="diff_next"></td><td class="diff_header" id="to0_2752">2752</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.axis("off")</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__127">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to0__127">n</a></td><td class="diff_header" id="to0_2753">2753</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig("2d_tsne.pdf")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2754">2754</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#plt.show()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2130">2130</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2755">2755</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__128"></td><td class="diff_header" id="from0_2131">2131</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2756">2756</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__128">n</a></td><td class="diff_header" id="from0_2132">2132</td><td nowrap="nowrap"><span class="diff_sub">[docs]</span>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;plot_arrows_embedding(self,&nbsp;choice:&nbsp;Union[str,&nbsp;int]=<span class="diff_chg">"auto"</span>,&nbsp;quiver_scale:&nbsp;Union[str,&nbsp;float]=<span class="diff_chg">"</span>auto<span class="diff_chg">"</span>,&nbsp;scale_type:&nbsp;str="relative",</td><td class="diff_next"><a href="#difflib_chg_to0__128">n</a></td><td class="diff_header" id="to0_2757">2757</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;plot_arrows_embedding(self,&nbsp;choice:&nbsp;Union[str,&nbsp;int]=<span class="diff_chg">10</span>,&nbsp;quiver_scale:&nbsp;Union[str,&nbsp;float]=<span class="diff_chg">'</span>auto<span class="diff_chg">'</span>,&nbsp;scale_type:&nbsp;str="relative",</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2133">2133</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plot_scatter:&nbsp;bool=False,&nbsp;scatter_kwargs:&nbsp;Dict={},&nbsp;color_arrow:&nbsp;str="cluster",</td><td class="diff_next"></td><td class="diff_header" id="to0_2758">2758</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plot_scatter:&nbsp;bool=False,&nbsp;scatter_kwargs:&nbsp;Dict={},&nbsp;color_arrow:&nbsp;str="cluster",</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2134">2134</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_fig:&nbsp;bool=False,&nbsp;plot_random:&nbsp;bool=True,&nbsp;**quiver_kwargs:&nbsp;Any)&nbsp;-&gt;&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_2759">2759</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_fig:&nbsp;bool=False,&nbsp;plot_random:&nbsp;bool=True,&nbsp;**quiver_kwargs:&nbsp;Any)&nbsp;-&gt;&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2135">2135</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Plots&nbsp;velocity&nbsp;on&nbsp;the&nbsp;embedding&nbsp;cell-wise</td><td class="diff_next"></td><td class="diff_header" id="to0_2760">2760</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Plots&nbsp;velocity&nbsp;on&nbsp;the&nbsp;embedding&nbsp;cell-wise</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__129">n</a></td><td class="diff_header" id="from0_2136">2136</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__129">n</a></td><td class="diff_header" id="to0_2761">2761</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2137">2137</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td><td class="diff_next"></td><td class="diff_header" id="to0_2762">2762</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2138">2138</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td><td class="diff_next"></td><td class="diff_header" id="to0_2763">2763</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__129"></td><td class="diff_header" id="from0_2139">2139</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;choice:&nbsp;int,&nbsp;default&nbsp;=&nbsp;"auto"</td><td class="diff_next"></td><td class="diff_header" id="to0_2764">2764</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;choice:&nbsp;int,&nbsp;default&nbsp;=&nbsp;"auto"</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2140">2140</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;number&nbsp;of&nbsp;cells&nbsp;to&nbsp;randomly&nbsp;pick&nbsp;to&nbsp;plot&nbsp;the&nbsp;arrows&nbsp;(To&nbsp;avoid&nbsp;overcrowding)</td><td class="diff_next"></td><td class="diff_header" id="to0_2765">2765</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;number&nbsp;of&nbsp;cells&nbsp;to&nbsp;randomly&nbsp;pick&nbsp;to&nbsp;plot&nbsp;the&nbsp;arrows&nbsp;(To&nbsp;avoid&nbsp;overcrowding)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2141">2141</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quiver_scale:&nbsp;float,&nbsp;default="auto"</td><td class="diff_next"></td><td class="diff_header" id="to0_2766">2766</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quiver_scale:&nbsp;float,&nbsp;default="auto"</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2142">2142</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rescaling&nbsp;factor&nbsp;applied&nbsp;to&nbsp;the&nbsp;arrow&nbsp;field&nbsp;to&nbsp;enhance&nbsp;visibility</td><td class="diff_next"></td><td class="diff_header" id="to0_2767">2767</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rescaling&nbsp;factor&nbsp;applied&nbsp;to&nbsp;the&nbsp;arrow&nbsp;field&nbsp;to&nbsp;enhance&nbsp;visibility</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2143">2143</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;"auto"&nbsp;the&nbsp;scale&nbsp;is&nbsp;selected&nbsp;using&nbsp;the&nbsp;randomized&nbsp;(negative)&nbsp;control&nbsp;(even&nbsp;if&nbsp;`plot_random`=False)</td><td class="diff_next"></td><td class="diff_header" id="to0_2768">2768</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;"auto"&nbsp;the&nbsp;scale&nbsp;is&nbsp;selected&nbsp;using&nbsp;the&nbsp;randomized&nbsp;(negative)&nbsp;control&nbsp;(even&nbsp;if&nbsp;`plot_random`=False)</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__130">n</a></td><td class="diff_header" id="from0_2144">2144</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;a&nbsp;float&nbsp;is&nbsp;provided&nbsp;the&nbsp;interpretation&nbsp;of&nbsp;the&nbsp;value&nbsp;depends&nbsp;on&nbsp;the&nbsp;parameter&nbsp;`scale_type`,&nbsp;see&nbsp;below.</td><td class="diff_next"><a href="#difflib_chg_to0__130">n</a></td><td class="diff_header" id="to0_2769">2769</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;a&nbsp;float&nbsp;is&nbsp;provided&nbsp;the&nbsp;interpretation&nbsp;of&nbsp;the&nbsp;value&nbsp;depends&nbsp;on&nbsp;the&nbsp;parameter&nbsp;`<span class="diff_add">plt.sho</span>scale_type`,&nbsp;see&nbsp;below.</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2145">2145</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOTE:&nbsp;Despite&nbsp;a&nbsp;similar&nbsp;option&nbsp;than&nbsp;plot_grid_arrows,&nbsp;here&nbsp;there&nbsp;is&nbsp;no&nbsp;strong&nbsp;motivation&nbsp;to&nbsp;calculate&nbsp;the&nbsp;scale&nbsp;relative&nbsp;to&nbsp;the&nbsp;randomized&nbsp;control</td><td class="diff_next"></td><td class="diff_header" id="to0_2770">2770</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOTE:&nbsp;Despite&nbsp;a&nbsp;similar&nbsp;option&nbsp;than&nbsp;plot_grid_arrows,&nbsp;here&nbsp;there&nbsp;is&nbsp;no&nbsp;strong&nbsp;motivation&nbsp;to&nbsp;calculate&nbsp;the&nbsp;scale&nbsp;relative&nbsp;to&nbsp;the&nbsp;randomized&nbsp;control</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2146">2146</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;is&nbsp;because&nbsp;the&nbsp;randomized&nbsp;doesn't&nbsp;have&nbsp;to&nbsp;have&nbsp;smaller&nbsp;velocity&nbsp;cell-wise,&nbsp;there&nbsp;might&nbsp;be&nbsp;for&nbsp;example</td><td class="diff_next"></td><td class="diff_header" id="to0_2771">2771</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;is&nbsp;because&nbsp;the&nbsp;randomized&nbsp;doesn't&nbsp;have&nbsp;to&nbsp;have&nbsp;smaller&nbsp;velocity&nbsp;cell-wise,&nbsp;there&nbsp;might&nbsp;be&nbsp;for&nbsp;example</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2147">2147</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scattered&nbsp;cells&nbsp;that&nbsp;will&nbsp;have&nbsp;strong&nbsp;velocity&nbsp;but&nbsp;they&nbsp;will,&nbsp;correctly&nbsp;just&nbsp;average&nbsp;out&nbsp;when&nbsp;calculating&nbsp;the&nbsp;average&nbsp;velocity&nbsp;field.</td><td class="diff_next"></td><td class="diff_header" id="to0_2772">2772</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scattered&nbsp;cells&nbsp;that&nbsp;will&nbsp;have&nbsp;strong&nbsp;velocity&nbsp;but&nbsp;they&nbsp;will,&nbsp;correctly&nbsp;just&nbsp;average&nbsp;out&nbsp;when&nbsp;calculating&nbsp;the&nbsp;average&nbsp;velocity&nbsp;field.</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2148">2148</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scale_type:&nbsp;str,&nbsp;default="relative"</td><td class="diff_next"></td><td class="diff_header" id="to0_2773">2773</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scale_type:&nbsp;str,&nbsp;default="relative"</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2149">2149</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;How&nbsp;to&nbsp;interpret&nbsp;`quiver_scale`:</td><td class="diff_next"></td><td class="diff_header" id="to0_2774">2774</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;How&nbsp;to&nbsp;interpret&nbsp;`quiver_scale`:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2150">2150</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;"relative"&nbsp;(default)&nbsp;the&nbsp;value&nbsp;will&nbsp;be&nbsp;used&nbsp;as&nbsp;a&nbsp;scaling&nbsp;factor&nbsp;and&nbsp;multiplied&nbsp;by&nbsp;the&nbsp;value&nbsp;from&nbsp;"auto"</td><td class="diff_next"></td><td class="diff_header" id="to0_2775">2775</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;"relative"&nbsp;(default)&nbsp;the&nbsp;value&nbsp;will&nbsp;be&nbsp;used&nbsp;as&nbsp;a&nbsp;scaling&nbsp;factor&nbsp;and&nbsp;multiplied&nbsp;by&nbsp;the&nbsp;value&nbsp;from&nbsp;"auto"</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2151">2151</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(it&nbsp;follows&nbsp;that&nbsp;quiver_scale="auto"&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;quiver_scale=1)</td><td class="diff_next"></td><td class="diff_header" id="to0_2776">2776</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(it&nbsp;follows&nbsp;that&nbsp;quiver_scale="auto"&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;quiver_scale=1)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2152">2152</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;"absolute"&nbsp;the&nbsp;value&nbsp;will&nbsp;be&nbsp;passed&nbsp;to&nbsp;the&nbsp;matplotlib&nbsp;quiver&nbsp;function</td><td class="diff_next"></td><td class="diff_header" id="to0_2777">2777</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;"absolute"&nbsp;the&nbsp;value&nbsp;will&nbsp;be&nbsp;passed&nbsp;to&nbsp;the&nbsp;matplotlib&nbsp;quiver&nbsp;function</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2153">2153</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plot_scatter:&nbsp;bool,&nbsp;default&nbsp;=&nbsp;False</td><td class="diff_next"></td><td class="diff_header" id="to0_2778">2778</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plot_scatter:&nbsp;bool,&nbsp;default&nbsp;=&nbsp;False</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2154">2154</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whether&nbsp;to&nbsp;plot&nbsp;the&nbsp;points</td><td class="diff_next"></td><td class="diff_header" id="to0_2779">2779</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whether&nbsp;to&nbsp;plot&nbsp;the&nbsp;points</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2155">2155</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scatter_kwargs:&nbsp;Dict</td><td class="diff_next"></td><td class="diff_header" id="to0_2780">2780</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scatter_kwargs:&nbsp;Dict</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2156">2156</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;dictionary&nbsp;containing&nbsp;all&nbsp;the&nbsp;keywords&nbsp;arguments&nbsp;to&nbsp;pass&nbsp;to&nbsp;matplotlib&nbsp;scatter</td><td class="diff_next"></td><td class="diff_header" id="to0_2781">2781</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;dictionary&nbsp;containing&nbsp;all&nbsp;the&nbsp;keywords&nbsp;arguments&nbsp;to&nbsp;pass&nbsp;to&nbsp;matplotlib&nbsp;scatter</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2157">2157</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by&nbsp;default&nbsp;the&nbsp;following&nbsp;are&nbsp;passed:&nbsp;c="0.8",&nbsp;alpha=0.4,&nbsp;s=10,&nbsp;edgecolor=(0,&nbsp;0,&nbsp;0,&nbsp;1),&nbsp;lw=0.3.&nbsp;But&nbsp;they&nbsp;can&nbsp;be&nbsp;overridden.</td><td class="diff_next"></td><td class="diff_header" id="to0_2782">2782</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by&nbsp;default&nbsp;the&nbsp;following&nbsp;are&nbsp;passed:&nbsp;c="0.8",&nbsp;alpha=0.4,&nbsp;s=10,&nbsp;edgecolor=(0,&nbsp;0,&nbsp;0,&nbsp;1),&nbsp;lw=0.3.&nbsp;But&nbsp;they&nbsp;can&nbsp;be&nbsp;overridden.</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2158">2158</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_arrow:&nbsp;str,&nbsp;default&nbsp;=&nbsp;"cluster"</td><td class="diff_next"></td><td class="diff_header" id="to0_2783">2783</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_arrow:&nbsp;str,&nbsp;default&nbsp;=&nbsp;"cluster"</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2159">2159</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;color&nbsp;of&nbsp;the&nbsp;arrows,&nbsp;if&nbsp;"cluster"&nbsp;the&nbsp;arrows&nbsp;are&nbsp;colored&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;cluster</td><td class="diff_next"></td><td class="diff_header" id="to0_2784">2784</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;color&nbsp;of&nbsp;the&nbsp;arrows,&nbsp;if&nbsp;"cluster"&nbsp;the&nbsp;arrows&nbsp;are&nbsp;colored&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;cluster</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2160">2160</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_fig:&nbsp;bool,&nbsp;default=False</td><td class="diff_next"></td><td class="diff_header" id="to0_2785">2785</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_fig:&nbsp;bool,&nbsp;default=False</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2161">2161</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whether&nbsp;to&nbsp;create&nbsp;a&nbsp;new&nbsp;figure</td><td class="diff_next"></td><td class="diff_header" id="to0_2786">2786</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whether&nbsp;to&nbsp;create&nbsp;a&nbsp;new&nbsp;figure</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2162">2162</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plot_random:&nbsp;bool,&nbsp;default=True</td><td class="diff_next"></td><td class="diff_header" id="to0_2787">2787</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plot_random:&nbsp;bool,&nbsp;default=True</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2163">2163</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whether&nbsp;to&nbsp;plot&nbsp;the&nbsp;randomized&nbsp;control&nbsp;next&nbsp;to&nbsp;the&nbsp;plot</td><td class="diff_next"></td><td class="diff_header" id="to0_2788">2788</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whether&nbsp;to&nbsp;plot&nbsp;the&nbsp;randomized&nbsp;control&nbsp;next&nbsp;to&nbsp;the&nbsp;plot</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2164">2164</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**quiver_kwargs:&nbsp;dict</td><td class="diff_next"></td><td class="diff_header" id="to0_2789">2789</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**quiver_kwargs:&nbsp;dict</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2165">2165</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keyword&nbsp;arguments&nbsp;to&nbsp;pass&nbsp;to&nbsp;quiver</td><td class="diff_next"></td><td class="diff_header" id="to0_2790">2790</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keyword&nbsp;arguments&nbsp;to&nbsp;pass&nbsp;to&nbsp;quiver</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2166">2166</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;By&nbsp;default&nbsp;the&nbsp;following&nbsp;are&nbsp;passed&nbsp;angles='xy',&nbsp;scale_units='xy',&nbsp;minlength=1.5.&nbsp;But&nbsp;they&nbsp;can&nbsp;be&nbsp;overridden.</td><td class="diff_next"></td><td class="diff_header" id="to0_2791">2791</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;By&nbsp;default&nbsp;the&nbsp;following&nbsp;are&nbsp;passed&nbsp;angles='xy',&nbsp;scale_units='xy',&nbsp;minlength=1.5.&nbsp;But&nbsp;they&nbsp;can&nbsp;be&nbsp;overridden.</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2167">2167</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2792">2792</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2168">2168</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td><td class="diff_next"></td><td class="diff_header" id="to0_2793">2793</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2169">2169</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td><td class="diff_next"></td><td class="diff_header" id="to0_2794">2794</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2170">2170</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing,&nbsp;just&nbsp;plots&nbsp;the&nbsp;tsne&nbsp;with&nbsp;arrows</td><td class="diff_next"></td><td class="diff_header" id="to0_2795">2795</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing,&nbsp;just&nbsp;plots&nbsp;the&nbsp;tsne&nbsp;with&nbsp;arrows</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2171">2171</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_2796">2796</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2172">2172</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;choice&nbsp;==&nbsp;"auto":</td><td class="diff_next"></td><td class="diff_header" id="to0_2797">2797</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;choice&nbsp;==&nbsp;"auto":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2173">2173</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;choice&nbsp;=&nbsp;int(self.S.shape[1]&nbsp;/&nbsp;3)</td><td class="diff_next"></td><td class="diff_header" id="to0_2798">2798</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;choice&nbsp;=&nbsp;int(self.S.shape[1]&nbsp;/&nbsp;3)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2174">2174</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warning(f"Only&nbsp;{choice}&nbsp;arrows&nbsp;will&nbsp;be&nbsp;shown&nbsp;to&nbsp;avoid&nbsp;overcrowding,&nbsp;you&nbsp;can&nbsp;choose&nbsp;the&nbsp;exact&nbsp;number&nbsp;setting&nbsp;the&nbsp;`choice`&nbsp;argument")</td><td class="diff_next"></td><td class="diff_header" id="to0_2799">2799</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warning(f"Only&nbsp;{choice}&nbsp;arrows&nbsp;will&nbsp;be&nbsp;shown&nbsp;to&nbsp;avoid&nbsp;overcrowding,&nbsp;you&nbsp;can&nbsp;choose&nbsp;the&nbsp;exact&nbsp;number&nbsp;setting&nbsp;the&nbsp;`choice`&nbsp;argument")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2175">2175</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_quiver_kwargs&nbsp;=&nbsp;{"angles":&nbsp;'xy',&nbsp;"scale_units":&nbsp;'xy',&nbsp;"minlength":&nbsp;1.5}</td><td class="diff_next"></td><td class="diff_header" id="to0_2800">2800</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_quiver_kwargs&nbsp;=&nbsp;{"angles":&nbsp;'xy',&nbsp;"scale_units":&nbsp;'xy',&nbsp;"minlength":&nbsp;1.5}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2176">2176</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_scatter_kwargs&nbsp;=&nbsp;dict(c="0.8",&nbsp;alpha=0.4,&nbsp;s=10,&nbsp;edgecolor=(0,&nbsp;0,&nbsp;0,&nbsp;1),&nbsp;lw=0.3)</td><td class="diff_next"></td><td class="diff_header" id="to0_2801">2801</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_scatter_kwargs&nbsp;=&nbsp;dict(c="0.8",&nbsp;alpha=0.4,&nbsp;s=10,&nbsp;edgecolor=(0,&nbsp;0,&nbsp;0,&nbsp;1),&nbsp;lw=0.3)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2177">2177</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_scatter_kwargs.update(scatter_kwargs)</td><td class="diff_next"></td><td class="diff_header" id="to0_2802">2802</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_scatter_kwargs.update(scatter_kwargs)</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__130"></td><td class="diff_header" id="from0_2178">2178</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;new_fig:</td><td class="diff_next"></td><td class="diff_header" id="to0_2803">2803</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;new_fig:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2179">2179</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;plot_random&nbsp;and&nbsp;hasattr(self,&nbsp;"delta_embedding_random"):</td><td class="diff_next"></td><td class="diff_header" id="to0_2804">2804</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;plot_random&nbsp;and&nbsp;hasattr(self,&nbsp;"delta_embedding_random"):</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2180">2180</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(figsize=(22,&nbsp;12))</td><td class="diff_next"></td><td class="diff_header" id="to0_2805">2805</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(figsize=(22,&nbsp;12))</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2181">2181</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_2806">2806</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2182">2182</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(figsize=(14,&nbsp;14))</td><td class="diff_next"></td><td class="diff_header" id="to0_2807">2807</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(figsize=(14,&nbsp;14))</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__131">n</a></td><td class="diff_header" id="from0_2183">2183</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__131">n</a></td><td class="diff_header" id="to0_2808">2808</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2184">2184</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ix_choice&nbsp;=&nbsp;np.random.choice(self.embedding.shape[0],&nbsp;size=choice,&nbsp;replace=False)</td><td class="diff_next"></td><td class="diff_header" id="to0_2809">2809</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_add">#</span>ix_choice&nbsp;=&nbsp;np.random.choice(self.embedding.shape[0],&nbsp;size=choice,&nbsp;replace=False)</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__131"></td><td class="diff_header" id="from0_2185">2185</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2810">2810</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ix_choice&nbsp;=&nbsp;np.arange(0,choice)*1+0</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2186">2186</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Determine&nbsp;quiver&nbsp;scale</td><td class="diff_next"></td><td class="diff_header" id="to0_2811">2811</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Determine&nbsp;quiver&nbsp;scale</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2187">2187</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;scale_type&nbsp;==&nbsp;"relative":</td><td class="diff_next"></td><td class="diff_header" id="to0_2812">2812</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;scale_type&nbsp;==&nbsp;"relative":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2188">2188</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;hasattr(self,&nbsp;"delta_embedding_random"):</td><td class="diff_next"></td><td class="diff_header" id="to0_2813">2813</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;hasattr(self,&nbsp;"delta_embedding_random"):</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2189">2189</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plot_scale&nbsp;=&nbsp;np.linalg.norm(np.max(self.flow_grid,&nbsp;0)&nbsp;-&nbsp;np.min(self.flow_grid,&nbsp;0),&nbsp;2)&nbsp;&nbsp;#&nbsp;Diagonal&nbsp;of&nbsp;the&nbsp;plot</td><td class="diff_next"></td><td class="diff_header" id="to0_2814">2814</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plot_scale&nbsp;=&nbsp;np.linalg.norm(np.max(self.flow_grid,&nbsp;0)&nbsp;-&nbsp;np.min(self.flow_grid,&nbsp;0),&nbsp;2)&nbsp;&nbsp;#&nbsp;Diagonal&nbsp;of&nbsp;the&nbsp;plot</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__132">n</a></td><td class="diff_header" id="from0_2190">2190</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arrows_scale&nbsp;=&nbsp;np.percentile(np.linalg.norm(self.delta_embedding_random,&nbsp;2,&nbsp;1),&nbsp;80)&nbsp;&nbsp;#&nbsp;T<span class="diff_chg">i</span>pical&nbsp;length&nbsp;of&nbsp;an&nbsp;arrow</td><td class="diff_next"><a href="#difflib_chg_to0__132">n</a></td><td class="diff_header" id="to0_2815">2815</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arrows_scale&nbsp;=&nbsp;np.percentile(np.linalg.norm(self.delta_embedding_random,&nbsp;2,&nbsp;1),&nbsp;80)&nbsp;&nbsp;#&nbsp;T<span class="diff_chg">y</span>pical&nbsp;length&nbsp;of&nbsp;an&nbsp;arrow</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2191">2191</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;quiver_scale&nbsp;==&nbsp;"auto":</td><td class="diff_next"></td><td class="diff_header" id="to0_2816">2816</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;quiver_scale&nbsp;==&nbsp;"auto":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2192">2192</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quiver_scale&nbsp;=&nbsp;arrows_scale&nbsp;/&nbsp;(plot_scale&nbsp;*&nbsp;0.005)</td><td class="diff_next"></td><td class="diff_header" id="to0_2817">2817</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quiver_scale&nbsp;=&nbsp;arrows_scale&nbsp;/&nbsp;(plot_scale&nbsp;*&nbsp;0.005)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2193">2193</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_2818">2818</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2194">2194</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quiver_scale&nbsp;=&nbsp;quiver_scale&nbsp;*&nbsp;arrows_scale&nbsp;/&nbsp;(plot_scale&nbsp;*&nbsp;0.005)</td><td class="diff_next"></td><td class="diff_header" id="to0_2819">2819</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quiver_scale&nbsp;=&nbsp;quiver_scale&nbsp;*&nbsp;arrows_scale&nbsp;/&nbsp;(plot_scale&nbsp;*&nbsp;0.005)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2195">2195</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_2820">2820</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2196">2196</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;ValueError("""`scale_type`&nbsp;was&nbsp;set&nbsp;to&nbsp;'relative'&nbsp;but&nbsp;the&nbsp;randomized&nbsp;control&nbsp;was&nbsp;not&nbsp;computed&nbsp;when&nbsp;running&nbsp;estimate_transition_prob</td><td class="diff_next"></td><td class="diff_header" id="to0_2821">2821</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;ValueError("""`scale_type`&nbsp;was&nbsp;set&nbsp;to&nbsp;'relative'&nbsp;but&nbsp;the&nbsp;randomized&nbsp;control&nbsp;was&nbsp;not&nbsp;computed&nbsp;when&nbsp;running&nbsp;estimate_transition_prob</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2197">2197</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Please&nbsp;run&nbsp;estimate_transition_prob&nbsp;or&nbsp;set&nbsp;`scale_type`&nbsp;to&nbsp;`absolute`""")</td><td class="diff_next"></td><td class="diff_header" id="to0_2822">2822</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Please&nbsp;run&nbsp;estimate_transition_prob&nbsp;or&nbsp;set&nbsp;`scale_type`&nbsp;to&nbsp;`absolute`""")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2198">2198</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_2823">2823</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2199">2199</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warning("The&nbsp;arrow&nbsp;scale&nbsp;was&nbsp;set&nbsp;to&nbsp;be&nbsp;'absolute'&nbsp;make&nbsp;sure&nbsp;you&nbsp;know&nbsp;how&nbsp;to&nbsp;properly&nbsp;interpret&nbsp;the&nbsp;plots")</td><td class="diff_next"></td><td class="diff_header" id="to0_2824">2824</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.warning("The&nbsp;arrow&nbsp;scale&nbsp;was&nbsp;set&nbsp;to&nbsp;be&nbsp;'absolute'&nbsp;make&nbsp;sure&nbsp;you&nbsp;know&nbsp;how&nbsp;to&nbsp;properly&nbsp;interpret&nbsp;the&nbsp;plots")</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__132"></td><td class="diff_header" id="from0_2200">2200</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2825">2825</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2201">2201</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;color_arrow&nbsp;==&nbsp;"cluster":</td><td class="diff_next"></td><td class="diff_header" id="to0_2826">2826</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;color_arrow&nbsp;==&nbsp;"cluster":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2202">2202</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colorandum&nbsp;=&nbsp;self.colorandum[ix_choice,&nbsp;:]</td><td class="diff_next"></td><td class="diff_header" id="to0_2827">2827</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colorandum&nbsp;=&nbsp;self.colorandum[ix_choice,&nbsp;:]</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__133"></td><td class="diff_header" id="from0_2203">2203</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_2828">2828</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2204">2204</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colorandum&nbsp;=&nbsp;color_arrow</td><td class="diff_next"></td><td class="diff_header" id="to0_2829">2829</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colorandum&nbsp;=&nbsp;color_arrow</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__133">n</a></td><td class="diff_header" id="from0_2205">2205</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__133">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2206">2206</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_quiver_kwargs.update({"color":&nbsp;colorandum})</td><td class="diff_next"></td><td class="diff_header" id="to0_2830">2830</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_quiver_kwargs.update({"color":&nbsp;colorandum})</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2207">2207</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_quiver_kwargs.update(quiver_kwargs)</td><td class="diff_next"></td><td class="diff_header" id="to0_2831">2831</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_quiver_kwargs.update(quiver_kwargs)</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__134">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to0__134">n</a></td><td class="diff_header" id="to0_2832">2832</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2833">2833</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2208">2208</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2834">2834</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2209">2209</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;plot_random&nbsp;and&nbsp;hasattr(self,&nbsp;"delta_embedding_random"):</td><td class="diff_next"></td><td class="diff_header" id="to0_2835">2835</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;plot_random&nbsp;and&nbsp;hasattr(self,&nbsp;"delta_embedding_random"):</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2210">2210</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.subplot(122)</td><td class="diff_next"></td><td class="diff_header" id="to0_2836">2836</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.subplot(122)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2211">2211</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.title("Randomized")</td><td class="diff_next"></td><td class="diff_header" id="to0_2837">2837</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.title("Randomized")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2212">2212</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;plot_scatter:</td><td class="diff_next"></td><td class="diff_header" id="to0_2838">2838</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;plot_scatter:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2213">2213</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.scatter(self.embedding[:,&nbsp;0],&nbsp;self.embedding[:,&nbsp;1],&nbsp;**_scatter_kwargs)</td><td class="diff_next"></td><td class="diff_header" id="to0_2839">2839</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.scatter(self.embedding[:,&nbsp;0],&nbsp;self.embedding[:,&nbsp;1],&nbsp;**_scatter_kwargs)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2214">2214</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.quiver(self.embedding[ix_choice,&nbsp;0],&nbsp;self.embedding[ix_choice,&nbsp;1],</td><td class="diff_next"></td><td class="diff_header" id="to0_2840">2840</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.quiver(self.embedding[ix_choice,&nbsp;0],&nbsp;self.embedding[ix_choice,&nbsp;1],</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__134"></td><td class="diff_header" id="from0_2215">2215</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_embedding_random[ix_choice,&nbsp;0],&nbsp;self.delta_embedding_random[ix_choice,&nbsp;1],</td><td class="diff_next"></td><td class="diff_header" id="to0_2841">2841</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_embedding_random[ix_choice,&nbsp;0],&nbsp;self.delta_embedding_random[ix_choice,&nbsp;1],</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2216">2216</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scale=quiver_scale,&nbsp;**_quiver_kwargs)</td><td class="diff_next"></td><td class="diff_header" id="to0_2842">2842</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scale=quiver_scale,&nbsp;**_quiver_kwargs)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2217">2217</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.axis("off")</td><td class="diff_next"></td><td class="diff_header" id="to0_2843">2843</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.axis("off")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2218">2218</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.subplot(121)</td><td class="diff_next"></td><td class="diff_header" id="to0_2844">2844</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.subplot(121)</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__135"></td><td class="diff_header" id="from0_2219">2219</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.title("Data")</td><td class="diff_next"></td><td class="diff_header" id="to0_2845">2845</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.title("Data")</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__135">n</a></td><td class="diff_header" id="from0_2220">2220</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__135">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2221">2221</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;plot_scatter:</td><td class="diff_next"></td><td class="diff_header" id="to0_2846">2846</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;plot_scatter:</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__136"></td><td class="diff_header" id="from0_2222">2222</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.scatter(self.embedding[:,&nbsp;0],&nbsp;self.embedding[:,&nbsp;1],&nbsp;**_scatter_kwargs)</td><td class="diff_next"></td><td class="diff_header" id="to0_2847">2847</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.scatter(self.embedding[:,&nbsp;0],&nbsp;self.embedding[:,&nbsp;1],&nbsp;**_scatter_kwargs)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2223">2223</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2848">2848</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__136">n</a></td><td class="diff_header" id="from0_2224">2224</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.quiver(self.embedding[ix_choice,&nbsp;0],&nbsp;self.embedding[ix_choice,&nbsp;1],</span></td><td class="diff_next"><a href="#difflib_chg_to0__136">n</a></td><td class="diff_header" id="to0_2849">2849</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.quiver(self.embedding[ix_choice,&nbsp;0],&nbsp;self.embedding[ix_choice,&nbsp;1],&nbsp;#self.embedding[ix_choice,&nbsp;0]&nbsp;+&nbsp;self.delta_embedding[ix_choice,&nbsp;0]&nbsp;=&nbsp;new&nbsp;coordinate&nbsp;(end&nbsp;of&nbsp;arrow)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2225">2225</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_embedding[ix_choice,&nbsp;0],&nbsp;self.delta_embedding[ix_choice,&nbsp;1],</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2850">2850</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_embedding[ix_choice,&nbsp;0],&nbsp;self.delta_embedding[ix_choice,&nbsp;1],&nbsp;#self.embedding[ix_choice,&nbsp;1]&nbsp;+&nbsp;self.delta_embedding[ix_choice,&nbsp;1]&nbsp;=&nbsp;new&nbsp;coordinate</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__137"></td><td class="diff_header" id="from0_2226">2226</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scale=quiver_scale,&nbsp;**_quiver_kwargs)</td><td class="diff_next"></td><td class="diff_header" id="to0_2851">2851</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scale=quiver_scale,&nbsp;**_quiver_kwargs)</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__137">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to0__137">n</a></td><td class="diff_header" id="to0_2852">2852</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#plt.savefig("with_arrows.pdf")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2853">2853</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.ylabel('y-tSNE')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2854">2854</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.xlabel('x-tSNE')</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__138"></td><td class="diff_header" id="from0_2227">2227</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.axis("off")</td><td class="diff_next"></td><td class="diff_header" id="to0_2855">2855</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.axis("off")</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__138">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to0__138">n</a></td><td class="diff_header" id="to0_2856">2856</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig("tSNE.pdf")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2857">2857</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#plt.show()</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__139"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2858">2858</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#plt.close()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2228">2228</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2859">2859</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__139">n</a></td><td class="diff_header" id="from0_2229">2229</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__139">n</a></td><td class="diff_header" id="to0_2860">2860</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2230">2230</td><td nowrap="nowrap"><span class="diff_sub">[docs]</span>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;plot_cell_transitions(self,&nbsp;cell_ix:&nbsp;int=0,&nbsp;alpha:&nbsp;float=0.1,&nbsp;alpha_neigh:&nbsp;float=0.2,</td><td class="diff_next"></td><td class="diff_header" id="to0_2861">2861</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;plot_cell_transitions(self,&nbsp;cell_ix:&nbsp;int=0,&nbsp;alpha:&nbsp;float=0.1,&nbsp;alpha_neigh:&nbsp;float=0.2,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2231">2231</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmap_name:&nbsp;str="RdBu_r",&nbsp;plot_arrow:&nbsp;bool=True,</td><td class="diff_next"></td><td class="diff_header" id="to0_2862">2862</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmap_name:&nbsp;str="RdBu_r",&nbsp;plot_arrow:&nbsp;bool=True,</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__140">n</a></td><td class="diff_header" id="from0_2232">2232</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mark_cell:&nbsp;bool=True,&nbsp;head_width:&nbsp;int=<span class="diff_chg">3</span>)&nbsp;-&gt;&nbsp;None:</td><td class="diff_next"><a href="#difflib_chg_to0__140">n</a></td><td class="diff_header" id="to0_2863">2863</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mark_cell:&nbsp;bool=True,&nbsp;head_width:&nbsp;int=<span class="diff_chg">1</span>)&nbsp;-&gt;&nbsp;None:</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__140"></td><td class="diff_header" id="from0_2233">2233</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Plot&nbsp;the&nbsp;probability&nbsp;of&nbsp;a&nbsp;cell&nbsp;to&nbsp;transition&nbsp;to&nbsp;any&nbsp;other&nbsp;cell</td><td class="diff_next"></td><td class="diff_header" id="to0_2864">2864</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Plot&nbsp;the&nbsp;probability&nbsp;of&nbsp;a&nbsp;cell&nbsp;to&nbsp;transition&nbsp;to&nbsp;any&nbsp;other&nbsp;cell</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2234">2234</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2865">2865</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2235">2235</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;function&nbsp;is&nbsp;untested</td><td class="diff_next"></td><td class="diff_header" id="to0_2866">2866</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;function&nbsp;is&nbsp;untested</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2236">2236</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_2867">2867</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2237">2237</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmap&nbsp;=&nbsp;plt.cm.get_cmap(name=cmap_name)</td><td class="diff_next"></td><td class="diff_header" id="to0_2868">2868</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmap&nbsp;=&nbsp;plt.cm.get_cmap(name=cmap_name)</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__141">n</a></td><td class="diff_header" id="from0_2238">2238</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colorandum&nbsp;=&nbsp;np.ones((self.embedding.shape[0],&nbsp;4))</td><td class="diff_next"><a href="#difflib_chg_to0__141">n</a></td><td class="diff_header" id="to0_2869">2869</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_add">#</span>colorandum&nbsp;=&nbsp;np.ones((self.embedding.shape[0],&nbsp;4))</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2239">2239</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colorandum&nbsp;*=&nbsp;0.3</td><td class="diff_next"></td><td class="diff_header" id="to0_2870">2870</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_add">#</span>colorandum&nbsp;*=&nbsp;0.3</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2240">2240</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colorandum[:,&nbsp;-1]&nbsp;=&nbsp;alpha</td><td class="diff_next"></td><td class="diff_header" id="to0_2871">2871</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_add">#</span>colorandum[:,&nbsp;-1]&nbsp;=&nbsp;alpha</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2241">2241</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2872">2872</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ix_choice&nbsp;=&nbsp;np.random.choice(self.embedding.shape[0],&nbsp;size=int(self.embedding.shape[0]/1.),&nbsp;replace=False)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2242">2242</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.scatter(self.embedding[:,&nbsp;0],&nbsp;self.embedding[:,&nbsp;1],</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2873">2873</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colorandum&nbsp;=&nbsp;self.colorandum[ix_choice,&nbsp;:]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2243">2243</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c=colorandum,&nbsp;s=50,&nbsp;edgecolor="")</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2874">2874</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.scatter(self.embedding[:,&nbsp;0],&nbsp;self.embedding[:,&nbsp;1],&nbsp;c=colorandum,&nbsp;s=50,&nbsp;edgecolor="")#self.embedding[:,&nbsp;0],&nbsp;self.embedding[:,&nbsp;1]&nbsp;are&nbsp;the&nbsp;x&nbsp;and&nbsp;y&nbsp;coordinates&nbsp;of&nbsp;each&nbsp;point&nbsp;on&nbsp;the&nbsp;tsne&nbsp;graph</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2875">2875</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.axis("off")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2876">2876</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#plt.xlabel("x-tSNE")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2877">2877</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#plt.ylabel("y-tSNE")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2244">2244</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;mark_cell:</td><td class="diff_next"></td><td class="diff_header" id="to0_2878">2878</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;mark_cell:</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__141"></td><td class="diff_header" id="from0_2245">2245</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.scatter(self.embedding[cell_ix,&nbsp;0],&nbsp;self.embedding[cell_ix,&nbsp;1],</td><td class="diff_next"></td><td class="diff_header" id="to0_2879">2879</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.scatter(self.embedding[cell_ix,&nbsp;0],&nbsp;self.embedding[cell_ix,&nbsp;1],</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2246">2246</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;facecolor="none",&nbsp;s=100,&nbsp;edgecolor="k")</td><td class="diff_next"></td><td class="diff_header" id="to0_2880">2880</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;facecolor="none",&nbsp;s=100,&nbsp;edgecolor="k")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2247">2247</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;plot_arrow:</td><td class="diff_next"></td><td class="diff_header" id="to0_2881">2881</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;plot_arrow:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2248">2248</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.arrow(self.embedding[cell_ix,&nbsp;0],&nbsp;self.embedding[cell_ix,&nbsp;1],</td><td class="diff_next"></td><td class="diff_header" id="to0_2882">2882</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.arrow(self.embedding[cell_ix,&nbsp;0],&nbsp;self.embedding[cell_ix,&nbsp;1],</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2249">2249</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_embedding[cell_ix,&nbsp;0],&nbsp;self.delta_embedding[cell_ix,&nbsp;1],</td><td class="diff_next"></td><td class="diff_header" id="to0_2883">2883</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.delta_embedding[cell_ix,&nbsp;0],&nbsp;self.delta_embedding[cell_ix,&nbsp;1],</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__142"><a href="#difflib_chg_to0__142">n</a></td><td class="diff_header" id="from0_2250">2250</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;head_width=head_width,&nbsp;length_includes_head=True)</td><td class="diff_next"><a href="#difflib_chg_to0__142">n</a></td><td class="diff_header" id="to0_2884">2884</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;head_width=head_width,&nbsp;length_includes_head=True)<span class="diff_add">&nbsp;#x,y&nbsp;coordinates&nbsp;of&nbsp;arrow</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2885">2885</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig("tSNE_cell_transitions.pdf")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2886">2886</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#plt.show()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2887">2887</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2251">2251</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2888">2888</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__143">n</a></td><td class="diff_header" id="from0_2252">2252</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__143">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2253">2253</td><td nowrap="nowrap"><span class="diff_sub">[docs]</span>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;plot_velocity_as_color(self,&nbsp;gene_name:&nbsp;str=None,&nbsp;cmap:&nbsp;Any=&nbsp;plt.cm.RdBu_r,</td><td class="diff_next"></td><td class="diff_header" id="to0_2889">2889</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;plot_velocity_as_color(self,&nbsp;gene_name:&nbsp;str=None,&nbsp;cmap:&nbsp;Any=&nbsp;plt.cm.RdBu_r,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2254">2254</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs:&nbsp;Any=None,&nbsp;which_tsne:&nbsp;str="ts",&nbsp;**kwargs:&nbsp;Dict)&nbsp;-&gt;&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_2890">2890</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs:&nbsp;Any=None,&nbsp;which_tsne:&nbsp;str="ts",&nbsp;**kwargs:&nbsp;Dict)&nbsp;-&gt;&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2255">2255</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Plot&nbsp;velocity&nbsp;as&nbsp;color&nbsp;on&nbsp;the&nbsp;Tsne&nbsp;embedding</td><td class="diff_next"></td><td class="diff_header" id="to0_2891">2891</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Plot&nbsp;velocity&nbsp;as&nbsp;color&nbsp;on&nbsp;the&nbsp;Tsne&nbsp;embedding</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2256">2256</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2892">2892</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2257">2257</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td><td class="diff_next"></td><td class="diff_header" id="to0_2893">2893</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2258">2258</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td><td class="diff_next"></td><td class="diff_header" id="to0_2894">2894</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2259">2259</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gene_name:&nbsp;str</td><td class="diff_next"></td><td class="diff_header" id="to0_2895">2895</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gene_name:&nbsp;str</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2260">2260</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;gene,&nbsp;should&nbsp;be&nbsp;present&nbsp;in&nbsp;self.S</td><td class="diff_next"></td><td class="diff_header" id="to0_2896">2896</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;gene,&nbsp;should&nbsp;be&nbsp;present&nbsp;in&nbsp;self.S</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2261">2261</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmap:&nbsp;maplotlib.cm.Colormap,&nbsp;default=maplotlib.cm.RdBu_r</td><td class="diff_next"></td><td class="diff_header" id="to0_2897">2897</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmap:&nbsp;maplotlib.cm.Colormap,&nbsp;default=maplotlib.cm.RdBu_r</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2262">2262</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Colormap&nbsp;to&nbsp;use,&nbsp;divergent&nbsp;ones&nbsp;are&nbsp;better,&nbsp;RdBu_r&nbsp;is&nbsp;default</td><td class="diff_next"></td><td class="diff_header" id="to0_2898">2898</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Colormap&nbsp;to&nbsp;use,&nbsp;divergent&nbsp;ones&nbsp;are&nbsp;better,&nbsp;RdBu_r&nbsp;is&nbsp;default</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2263">2263</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Notice&nbsp;that&nbsp;0&nbsp;will&nbsp;be&nbsp;always&nbsp;set&nbsp;as&nbsp;the&nbsp;center&nbsp;of&nbsp;the&nbsp;colormap.&nbsp;(e.g.&nbsp;white&nbsp;in&nbsp;RdBu_r)</td><td class="diff_next"></td><td class="diff_header" id="to0_2899">2899</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Notice&nbsp;that&nbsp;0&nbsp;will&nbsp;be&nbsp;always&nbsp;set&nbsp;as&nbsp;the&nbsp;center&nbsp;of&nbsp;the&nbsp;colormap.&nbsp;(e.g.&nbsp;white&nbsp;in&nbsp;RdBu_r)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2264">2264</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs:&nbsp;Gridspec&nbsp;subplot</td><td class="diff_next"></td><td class="diff_header" id="to0_2900">2900</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs:&nbsp;Gridspec&nbsp;subplot</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2265">2265</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gridspec&nbsp;subplot&nbsp;to&nbsp;plot&nbsp;on.</td><td class="diff_next"></td><td class="diff_header" id="to0_2901">2901</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gridspec&nbsp;subplot&nbsp;to&nbsp;plot&nbsp;on.</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2266">2266</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;which_tsne:&nbsp;str,&nbsp;default="ts"</td><td class="diff_next"></td><td class="diff_header" id="to0_2902">2902</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;which_tsne:&nbsp;str,&nbsp;default="ts"</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2267">2267</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;attributed&nbsp;where&nbsp;the&nbsp;desired&nbsp;embedding&nbsp;is&nbsp;stored</td><td class="diff_next"></td><td class="diff_header" id="to0_2903">2903</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;attributed&nbsp;where&nbsp;the&nbsp;desired&nbsp;embedding&nbsp;is&nbsp;stored</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2268">2268</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**kwargs:&nbsp;dict</td><td class="diff_next"></td><td class="diff_header" id="to0_2904">2904</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**kwargs:&nbsp;dict</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2269">2269</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;other&nbsp;keywords&nbsp;arguments&nbsp;will&nbsp;be&nbsp;passed&nbsp;to&nbsp;the&nbsp;plt.scatter&nbsp;call</td><td class="diff_next"></td><td class="diff_header" id="to0_2905">2905</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;other&nbsp;keywords&nbsp;arguments&nbsp;will&nbsp;be&nbsp;passed&nbsp;to&nbsp;the&nbsp;plt.scatter&nbsp;call</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__143"></td><td class="diff_header" id="from0_2270">2270</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2906">2906</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2271">2271</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td><td class="diff_next"></td><td class="diff_header" id="to0_2907">2907</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2272">2272</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td><td class="diff_next"></td><td class="diff_header" id="to0_2908">2908</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2273">2273</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing</td><td class="diff_next"></td><td class="diff_header" id="to0_2909">2909</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2274">2274</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_2910">2910</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__144">n</a></td><td class="diff_header" id="from0_2275">2275</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__144">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2276">2276</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ix&nbsp;=&nbsp;np.where(self.ra["Gene"]&nbsp;==&nbsp;gene_name)[0][0]</td><td class="diff_next"></td><td class="diff_header" id="to0_2911">2911</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ix&nbsp;=&nbsp;np.where(self.ra["Gene<span class="diff_add">s</span>"]&nbsp;==&nbsp;gene_name)[0][0]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2277">2277</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kwarg_plot&nbsp;=&nbsp;{"alpha":&nbsp;0.5,&nbsp;"s":&nbsp;8,&nbsp;"edgecolor":&nbsp;"0.8",&nbsp;"lw":&nbsp;0.15}</td><td class="diff_next"></td><td class="diff_header" id="to0_2912">2912</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kwarg_plot&nbsp;=&nbsp;{"alpha":&nbsp;0.5,&nbsp;"s":&nbsp;8,&nbsp;"edgecolor":&nbsp;"0.8",&nbsp;"lw":&nbsp;0.15}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2278">2278</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kwarg_plot.update(kwargs)</td><td class="diff_next"></td><td class="diff_header" id="to0_2913">2913</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kwarg_plot.update(kwargs)</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__144"></td><td class="diff_header" id="from0_2279">2279</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;gs&nbsp;is&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_2914">2914</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;gs&nbsp;is&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2280">2280</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fig&nbsp;=&nbsp;plt.figure(figsize=(10,&nbsp;10))</td><td class="diff_next"></td><td class="diff_header" id="to0_2915">2915</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fig&nbsp;=&nbsp;plt.figure(figsize=(10,&nbsp;10))</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2281">2281</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.subplot(111)</td><td class="diff_next"></td><td class="diff_header" id="to0_2916">2916</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.subplot(111)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2282">2282</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_2917">2917</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2283">2283</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.subplot(gs)</td><td class="diff_next"></td><td class="diff_header" id="to0_2918">2918</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.subplot(gs)</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__145">n</a></td><td class="diff_header" id="from0_2284">2284</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__145">n</a></td><td class="diff_header" id="to0_2919">2919</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2285">2285</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tsne&nbsp;=&nbsp;getattr(self,&nbsp;which_tsne)</td><td class="diff_next"></td><td class="diff_header" id="to0_2920">2920</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tsne&nbsp;=&nbsp;getattr(self,&nbsp;which_tsne)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2286">2286</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.which_S_for_pred&nbsp;==&nbsp;"Sx_sz":</td><td class="diff_next"></td><td class="diff_header" id="to0_2921">2921</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.which_S_for_pred&nbsp;==&nbsp;"Sx_sz":</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2287">2287</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_colorandum&nbsp;=&nbsp;self.Sx_sz_t[ix,&nbsp;:]&nbsp;-&nbsp;self.Sx_sz[ix,&nbsp;:]</td><td class="diff_next"></td><td class="diff_header" id="to0_2922">2922</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_colorandum&nbsp;=&nbsp;self.Sx_sz_t[ix,&nbsp;:]&nbsp;-&nbsp;self.Sx_sz[ix,&nbsp;:]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2288">2288</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_2923">2923</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2289">2289</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_colorandum&nbsp;=&nbsp;self.Sx_t[ix,&nbsp;:]&nbsp;-&nbsp;self.Sx[ix,&nbsp;:]</td><td class="diff_next"></td><td class="diff_header" id="to0_2924">2924</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_colorandum&nbsp;=&nbsp;self.Sx_t[ix,&nbsp;:]&nbsp;-&nbsp;self.Sx[ix,&nbsp;:]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2290">2290</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(np.abs(tmp_colorandum)&nbsp;&gt;&nbsp;0.00005).sum()&nbsp;&lt;&nbsp;10:&nbsp;&nbsp;#&nbsp;If&nbsp;S&nbsp;vs&nbsp;U&nbsp;scatterplot&nbsp;it&nbsp;is&nbsp;flat</td><td class="diff_next"></td><td class="diff_header" id="to0_2925">2925</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(np.abs(tmp_colorandum)&nbsp;&gt;&nbsp;0.00005).sum()&nbsp;&lt;&nbsp;10:&nbsp;&nbsp;#&nbsp;If&nbsp;S&nbsp;vs&nbsp;U&nbsp;scatterplot&nbsp;it&nbsp;is&nbsp;flat</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2291">2291</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("S&nbsp;vs&nbsp;U&nbsp;scatterplot&nbsp;it&nbsp;is&nbsp;flat")</td><td class="diff_next"></td><td class="diff_header" id="to0_2926">2926</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("S&nbsp;vs&nbsp;U&nbsp;scatterplot&nbsp;it&nbsp;is&nbsp;flat")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2292">2292</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return</td><td class="diff_next"></td><td class="diff_header" id="to0_2927">2927</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2293">2293</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;limit&nbsp;=&nbsp;np.max(np.abs(np.percentile(tmp_colorandum,&nbsp;[1,&nbsp;99])))&nbsp;&nbsp;#&nbsp;upper&nbsp;and&nbsp;lowe&nbsp;limit&nbsp;/&nbsp;saturation</td><td class="diff_next"></td><td class="diff_header" id="to0_2928">2928</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;limit&nbsp;=&nbsp;np.max(np.abs(np.percentile(tmp_colorandum,&nbsp;[1,&nbsp;99])))&nbsp;&nbsp;#&nbsp;upper&nbsp;and&nbsp;lowe&nbsp;limit&nbsp;/&nbsp;saturation</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2294">2294</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_colorandum&nbsp;=&nbsp;tmp_colorandum&nbsp;+&nbsp;limit&nbsp;&nbsp;#&nbsp;that&nbsp;is:&nbsp;tmp_colorandum&nbsp;-&nbsp;(-limit)</td><td class="diff_next"></td><td class="diff_header" id="to0_2929">2929</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_colorandum&nbsp;=&nbsp;tmp_colorandum&nbsp;+&nbsp;limit&nbsp;&nbsp;#&nbsp;that&nbsp;is:&nbsp;tmp_colorandum&nbsp;-&nbsp;(-limit)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2295">2295</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_colorandum&nbsp;=&nbsp;tmp_colorandum&nbsp;/&nbsp;(2&nbsp;*&nbsp;limit)&nbsp;&nbsp;#&nbsp;that&nbsp;is:&nbsp;tmp_colorandum&nbsp;/&nbsp;(limit&nbsp;-&nbsp;(-limit))</td><td class="diff_next"></td><td class="diff_header" id="to0_2930">2930</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_colorandum&nbsp;=&nbsp;tmp_colorandum&nbsp;/&nbsp;(2&nbsp;*&nbsp;limit)&nbsp;&nbsp;#&nbsp;that&nbsp;is:&nbsp;tmp_colorandum&nbsp;/&nbsp;(limit&nbsp;-&nbsp;(-limit))</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2296">2296</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_colorandum&nbsp;=&nbsp;np.clip(tmp_colorandum,&nbsp;0,&nbsp;1)</td><td class="diff_next"></td><td class="diff_header" id="to0_2931">2931</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_colorandum&nbsp;=&nbsp;np.clip(tmp_colorandum,&nbsp;0,&nbsp;1)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2297">2297</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2932">2932</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2298">2298</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scatter_viz(tsne[:,&nbsp;0],&nbsp;tsne[:,&nbsp;1],</td><td class="diff_next"></td><td class="diff_header" id="to0_2933">2933</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scatter_viz(tsne[:,&nbsp;0],&nbsp;tsne[:,&nbsp;1],</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__145"></td><td class="diff_header" id="from0_2299">2299</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c=cmap(tmp_colorandum),&nbsp;**kwarg_plot)</td><td class="diff_next"></td><td class="diff_header" id="to0_2934">2934</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c=cmap(tmp_colorandum),&nbsp;**kwarg_plot)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2300">2300</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.axis("off")</td><td class="diff_next"></td><td class="diff_header" id="to0_2935">2935</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.axis("off")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2301">2301</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.title(f"{gene_name}")</td><td class="diff_next"></td><td class="diff_header" id="to0_2936">2936</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.title(f"{gene_name}")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2302">2302</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2937">2937</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2303">2303</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2938">2938</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__146">n</a></td><td class="diff_header" id="from0_2304">2304</td><td nowrap="nowrap"><span class="diff_sub">[docs]&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;plot_expression_as_color(self,&nbsp;gene_name:&nbsp;str=None,&nbsp;imputed:&nbsp;bool=&nbsp;True,&nbsp;cmap:&nbsp;Any=&nbsp;plt.cm.Greens,</span></td><td class="diff_next"><a href="#difflib_chg_to0__146">n</a></td><td class="diff_header" id="to0_2939">2939</td><td nowrap="nowrap"><span class="diff_add">def&nbsp;array_to_rmatrix(X):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2305">2305</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs:&nbsp;Any=None,&nbsp;which_tsne:&nbsp;str="ts",&nbsp;**kwargs:&nbsp;Dict)&nbsp;-&gt;&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2940">2940</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;import&nbsp;rpy2.robjects&nbsp;as&nbsp;robj</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__146"></td><td class="diff_header" id="from0_2306">2306</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Plot&nbsp;expression&nbsp;as&nbsp;color&nbsp;on&nbsp;the&nbsp;Tsne&nbsp;embedding</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2941">2941</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;nr,&nbsp;nc&nbsp;=&nbsp;X.shape</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2942">2942</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;xvec&nbsp;=&nbsp;robj.FloatVector(X.transpose().reshape((X.size)))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2943">2943</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;xr&nbsp;=&nbsp;robj.r.matrix(xvec,&nbsp;nrow=nr,&nbsp;ncol=nc)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2944">2944</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;xr</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2307">2307</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2945">2945</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__147">n</a></td><td class="diff_header" id="from0_2308">2308</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</span></td><td class="diff_next"><a href="#difflib_chg_to0__147">n</a></td><td class="diff_header" id="to0_2946">2946</td><td nowrap="nowrap"><span class="diff_add">def&nbsp;principal_curve(X,&nbsp;pca=True):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2309">2309</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2310">2310</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gene_name:&nbsp;str</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2311">2311</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;gene,&nbsp;should&nbsp;be&nbsp;present&nbsp;in&nbsp;self.S</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2312">2312</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imputed:&nbsp;bool,&nbsp;default=True</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2313">2313</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whether&nbsp;to&nbsp;plot&nbsp;the&nbsp;smoothed&nbsp;or&nbsp;the&nbsp;raw&nbsp;data</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2314">2314</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmap:&nbsp;maplotlib.cm.Colormap,&nbsp;default=maplotlib.cm.Greens</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2315">2315</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Colormap&nbsp;to&nbsp;use.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2316">2316</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs:&nbsp;Gridspec&nbsp;subplot</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2317">2317</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gridspec&nbsp;subplot&nbsp;to&nbsp;plot&nbsp;on.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2318">2318</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;which_tsne:&nbsp;str,&nbsp;default="ts"</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2319">2319</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;attributed&nbsp;where&nbsp;the&nbsp;desired&nbsp;embedding&nbsp;is&nbsp;stored</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2320">2320</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**kwargs:&nbsp;dict</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2321">2321</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;other&nbsp;keywords&nbsp;arguments&nbsp;will&nbsp;be&nbsp;passed&nbsp;to&nbsp;the&nbsp;plt.scatter&nbsp;call</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2322">2322</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2323">2323</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2324">2324</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2325">2325</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2326">2326</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_2947">2947</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2327">2327</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ix&nbsp;=&nbsp;np.where(self.ra["Gene"]&nbsp;==&nbsp;gene_name)[0][0]</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2948">2948</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;input&nbsp;:&nbsp;numpy.array</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2328">2328</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kwarg_plot&nbsp;=&nbsp;{"alpha":&nbsp;0.5,&nbsp;"s":&nbsp;8,&nbsp;"edgecolor":&nbsp;"0.8",&nbsp;"lw":&nbsp;0.15}</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2949">2949</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;returns:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2329">2329</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kwarg_plot.update(kwargs)</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2950">2950</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;Result::Object</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2330">2330</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;gs&nbsp;is&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2331">2331</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fig&nbsp;=&nbsp;plt.figure(figsize=(10,&nbsp;10))</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2332">2332</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.subplot(111)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2333">2333</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e<span class="diff_chg">l</span>s<span class="diff_sub">e</span>:</td><td class="diff_next"></td><td class="diff_header" id="to0_2951">2951</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_add">M</span>e<span class="diff_chg">thod</span>s:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2334">2334</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.subplot(gs)</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2952">2952</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;projections&nbsp;-&nbsp;the&nbsp;matrix&nbsp;of&nbsp;the&nbsp;projectiond</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2335">2335</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2953">2953</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ixsort&nbsp;-&nbsp;the&nbsp;order&nbsp;ot&nbsp;the&nbsp;points&nbsp;(as&nbsp;in&nbsp;argsort)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2336">2336</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tsne&nbsp;=&nbsp;getattr(self,&nbsp;which_tsne)</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2954">2954</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arclength&nbsp;-&nbsp;the&nbsp;lenght&nbsp;of&nbsp;the&nbsp;arc&nbsp;from&nbsp;the&nbsp;beginning&nbsp;to&nbsp;the&nbsp;point</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2337">2337</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;imputed:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2338">2338</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.which_S_for_pred&nbsp;==&nbsp;"Sx_sz":</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2339">2339</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_colorandum&nbsp;=&nbsp;self.Sx_sz[ix,&nbsp;:]</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2340">2340</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2341">2341</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_colorandum&nbsp;=&nbsp;self.Sx[ix,&nbsp;:]</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2342">2342</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2343">2343</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_colorandum&nbsp;=&nbsp;self.S_sz[ix,&nbsp;:]</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2344">2344</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2345">2345</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_colorandum&nbsp;=&nbsp;tmp_colorandum&nbsp;/&nbsp;np.percentile(tmp_colorandum,&nbsp;99)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2346">2346</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;tmp_colorandum&nbsp;=&nbsp;np.log2(tmp_colorandum+1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2347">2347</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_colorandum&nbsp;=&nbsp;np.clip(tmp_colorandum,&nbsp;0,&nbsp;1)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2348">2348</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2349">2349</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scatter_viz(tsne[:,&nbsp;0],&nbsp;tsne[:,&nbsp;1],</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2350">2350</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c=cmap(tmp_colorandum),&nbsp;**kwarg_plot)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2351">2351</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.axis("off")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2352">2352</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.title(f"{gene_name}")</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2353">2353</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2354">2354</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2355">2355</td><td nowrap="nowrap"><span class="diff_sub">[docs]&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;reload_raw(self,&nbsp;substitute:&nbsp;bool=False)&nbsp;-&gt;&nbsp;None:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2356">2356</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""Reload&nbsp;raw&nbsp;data&nbsp;as&nbsp;it&nbsp;was&nbsp;before&nbsp;filtering&nbsp;steps</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2357">2357</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2358">2358</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2359">2359</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2360">2360</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;substitute:&nbsp;bool=False</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2361">2361</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;True&nbsp;`S,&nbsp;U,&nbsp;A,&nbsp;ca,&nbsp;ra`&nbsp;will&nbsp;be&nbsp;all&nbsp;overwritten</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2362">2362</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;False&nbsp;`S,&nbsp;U,&nbsp;A,&nbsp;ca,&nbsp;ra`&nbsp;will&nbsp;be&nbsp;loaded&nbsp;separately&nbsp;as&nbsp;`raw_S,&nbsp;raw_U,&nbsp;raw_A,&nbsp;raw_ca,&nbsp;raw_ra`</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2363">2363</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_2955">2955</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2364">2364</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;substitute:</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2956">2956</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;convert&nbsp;array&nbsp;to&nbsp;R&nbsp;matrix</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2365">2365</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ds&nbsp;=&nbsp;loompy.connect(self.loom_filepath)</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2957">2957</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;xr&nbsp;=&nbsp;array_to_rmatrix(X)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2366">2366</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.S&nbsp;=&nbsp;ds.layer["spliced"][:,&nbsp;:]</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2958">2958</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;pca:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2367">2367</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.U&nbsp;=&nbsp;ds.layer["unspliced"][:,&nbsp;:]</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2959">2959</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#perform&nbsp;pca</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2368">2368</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.A&nbsp;=&nbsp;ds.layer["ambiguous"][:,&nbsp;:]</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2960">2960</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;import&nbsp;rpy2.robjects&nbsp;as&nbsp;robj</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2369">2369</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.initial_cell_size&nbsp;=&nbsp;self.S.sum(0)</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2961">2961</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t&nbsp;=&nbsp;robj.r.prcomp(xr)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2370">2370</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.initial_Ucell_size&nbsp;=&nbsp;self.U.sum(0)</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2962">2962</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#determine&nbsp;dimensionality&nbsp;reduction</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2371">2371</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ca&nbsp;=&nbsp;dict(ds.col_attrs.items())</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2963">2963</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;usedcomp&nbsp;=&nbsp;max(&nbsp;sum(&nbsp;np.array(t[t.names.index('sdev')])&nbsp;&gt;&nbsp;1.1)&nbsp;,&nbsp;4)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2372">2372</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ra&nbsp;=&nbsp;dict(ds.row_attrs.items())</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2964">2964</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;usedcomp&nbsp;=&nbsp;min([usedcomp,&nbsp;sum(&nbsp;np.array(t[t.names.index('sdev')])&nbsp;&gt;&nbsp;0.25),&nbsp;X.shape[0]])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2373">2373</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ds.close()</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2965">2965</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Xpc&nbsp;=&nbsp;np.array(t[t.names.index('x')])[:,:usedcomp]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2374">2374</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2966">2966</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;convert&nbsp;array&nbsp;to&nbsp;R&nbsp;matrix</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2375">2375</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ds&nbsp;=&nbsp;loompy.connect(self.loom_filepath)</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2967">2967</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xr&nbsp;=&nbsp;array_to_rmatrix(Xpc)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2376">2376</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.raw_S&nbsp;=&nbsp;ds.layer["spliced"][:,&nbsp;:]</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2968">2968</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;#import&nbsp;the&nbsp;correct&nbsp;namespace</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2377">2377</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.raw_U&nbsp;=&nbsp;ds.layer["unspliced"][:,&nbsp;:]</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2969">2969</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;#utils&nbsp;=&nbsp;importr('utils')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2378">2378</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.raw_A&nbsp;=&nbsp;ds.layer["ambiguous"][:,&nbsp;:]</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2970">2970</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('princurve')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2379">2379</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.raw_initial_cell_size&nbsp;=&nbsp;self.raw_S.sum(0)</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2971">2971</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;princurve&nbsp;=&nbsp;importr("princurve",&nbsp;on_conflict="warn")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2380">2380</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.raw_initial_Ucell_size&nbsp;=&nbsp;self.raw_U.sum(0)</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2972">2972</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;#call&nbsp;the&nbsp;function</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2381">2381</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.raw_ca&nbsp;=&nbsp;dict(ds.col_attrs.items())</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2973">2973</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;fit1&nbsp;=&nbsp;princurve.principal_curve(xr)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2382">2382</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.raw_ra&nbsp;=&nbsp;dict(ds.row_attrs.items())</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2974">2974</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;#extract&nbsp;the&nbsp;outputs</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2383">2383</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ds.close()</span></td><td class="diff_next"></td><td class="diff_header" id="to0_2975">2975</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;class&nbsp;Results:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2976">2976</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pass</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2977">2977</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;results&nbsp;=&nbsp;Results()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2978">2978</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;results.projections&nbsp;=&nbsp;np.array(&nbsp;fit1[0]&nbsp;)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2979">2979</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;results.ixsort&nbsp;=&nbsp;np.array(&nbsp;fit1[1]&nbsp;)&nbsp;-&nbsp;1&nbsp;#&nbsp;R&nbsp;is&nbsp;1&nbsp;indexed</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__147"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2980">2980</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;results.arclength&nbsp;=&nbsp;np.array(&nbsp;fit1[2]&nbsp;)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2981">2981</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;results.dist&nbsp;=&nbsp;np.array(&nbsp;fit1[3]&nbsp;)</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__148"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2982">2982</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;pca:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2983">2983</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;results.PCs&nbsp;=&nbsp;np.array(xr)&nbsp;#only&nbsp;the&nbsp;used&nbsp;components</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2384">2384</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2984">2984</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__148">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to0__148">n</a></td><td class="diff_header" id="to0_2985">2985</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;results</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2385">2385</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2986">2986</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__149">n</a></td><td class="diff_header" id="from0_2386">2386</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__149">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2387">2387</td><td nowrap="nowrap"><span class="diff_sub">[docs]</span>def&nbsp;scatter_viz(x:&nbsp;np.ndarray,&nbsp;y:&nbsp;np.ndarray,&nbsp;*args:&nbsp;Any,&nbsp;**kwargs:&nbsp;Any)&nbsp;-&gt;&nbsp;Any:</td><td class="diff_next"></td><td class="diff_header" id="to0_2987">2987</td><td nowrap="nowrap">def&nbsp;scatter_viz(x:&nbsp;np.ndarray,&nbsp;y:&nbsp;np.ndarray,&nbsp;*args:&nbsp;Any,&nbsp;**kwargs:&nbsp;Any)&nbsp;-&gt;&nbsp;Any:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2388">2388</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;"""A&nbsp;wrapper&nbsp;of&nbsp;scatter&nbsp;plot&nbsp;that&nbsp;guarantees&nbsp;that&nbsp;every&nbsp;point&nbsp;is&nbsp;visible&nbsp;in&nbsp;a&nbsp;very&nbsp;crowded&nbsp;scatterplot</td><td class="diff_next"></td><td class="diff_header" id="to0_2988">2988</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;"""A&nbsp;wrapper&nbsp;of&nbsp;scatter&nbsp;plot&nbsp;that&nbsp;guarantees&nbsp;that&nbsp;every&nbsp;point&nbsp;is&nbsp;visible&nbsp;in&nbsp;a&nbsp;very&nbsp;crowded&nbsp;scatterplot</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2389">2389</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2989">2989</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2390">2390</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;Args</td><td class="diff_next"></td><td class="diff_header" id="to0_2990">2990</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;Args</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2391">2391</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;----</td><td class="diff_next"></td><td class="diff_header" id="to0_2991">2991</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;----</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2392">2392</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;x:&nbsp;np.ndarray</td><td class="diff_next"></td><td class="diff_header" id="to0_2992">2992</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;x:&nbsp;np.ndarray</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2393">2393</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;axis&nbsp;coordinates</td><td class="diff_next"></td><td class="diff_header" id="to0_2993">2993</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;axis&nbsp;coordinates</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2394">2394</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;y:&nbsp;np.ndarray</td><td class="diff_next"></td><td class="diff_header" id="to0_2994">2994</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;y:&nbsp;np.ndarray</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2395">2395</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;axis&nbsp;coordinates</td><td class="diff_next"></td><td class="diff_header" id="to0_2995">2995</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;axis&nbsp;coordinates</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2396">2396</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;args&nbsp;and&nbsp;kwargs:</td><td class="diff_next"></td><td class="diff_header" id="to0_2996">2996</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;args&nbsp;and&nbsp;kwargs:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2397">2397</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;positional&nbsp;and&nbsp;keyword&nbsp;arguments&nbsp;as&nbsp;in&nbsp;matplotplib.pyplot.scatter</td><td class="diff_next"></td><td class="diff_header" id="to0_2997">2997</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;positional&nbsp;and&nbsp;keyword&nbsp;arguments&nbsp;as&nbsp;in&nbsp;matplotplib.pyplot.scatter</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2398">2398</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_2998">2998</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2399">2399</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;Returns</td><td class="diff_next"></td><td class="diff_header" id="to0_2999">2999</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;Returns</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2400">2400</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;-------</td><td class="diff_next"></td><td class="diff_header" id="to0_3000">3000</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;-------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2401">2401</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;Plots&nbsp;the&nbsp;graph&nbsp;and&nbsp;returns&nbsp;the&nbsp;axes&nbsp;object</td><td class="diff_next"></td><td class="diff_header" id="to0_3001">3001</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;Plots&nbsp;the&nbsp;graph&nbsp;and&nbsp;returns&nbsp;the&nbsp;axes&nbsp;object</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2402">2402</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_3002">3002</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2403">2403</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;ix_x_sort&nbsp;=&nbsp;np.argsort(x,&nbsp;kind="mergesort")</td><td class="diff_next"></td><td class="diff_header" id="to0_3003">3003</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;ix_x_sort&nbsp;=&nbsp;np.argsort(x,&nbsp;kind="mergesort")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2404">2404</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;ix_yx_sort&nbsp;=&nbsp;np.argsort(y[ix_x_sort],&nbsp;kind="mergesort")</td><td class="diff_next"></td><td class="diff_header" id="to0_3004">3004</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;ix_yx_sort&nbsp;=&nbsp;np.argsort(y[ix_x_sort],&nbsp;kind="mergesort")</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2405">2405</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;args_new&nbsp;=&nbsp;[]</td><td class="diff_next"></td><td class="diff_header" id="to0_3005">3005</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;args_new&nbsp;=&nbsp;[]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2406">2406</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;kwargs_new&nbsp;=&nbsp;{}</td><td class="diff_next"></td><td class="diff_header" id="to0_3006">3006</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;kwargs_new&nbsp;=&nbsp;{}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2407">2407</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;arg&nbsp;in&nbsp;args:</td><td class="diff_next"></td><td class="diff_header" id="to0_3007">3007</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;arg&nbsp;in&nbsp;args:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2408">2408</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;type(arg)&nbsp;is&nbsp;np.ndarray:</td><td class="diff_next"></td><td class="diff_header" id="to0_3008">3008</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;type(arg)&nbsp;is&nbsp;np.ndarray:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2409">2409</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args_new.append(arg[ix_x_sort][ix_yx_sort])</td><td class="diff_next"></td><td class="diff_header" id="to0_3009">3009</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args_new.append(arg[ix_x_sort][ix_yx_sort])</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2410">2410</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_3010">3010</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2411">2411</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args_new.append(arg)</td><td class="diff_next"></td><td class="diff_header" id="to0_3011">3011</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args_new.append(arg)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2412">2412</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;karg,&nbsp;varg&nbsp;in&nbsp;kwargs.items():</td><td class="diff_next"></td><td class="diff_header" id="to0_3012">3012</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;karg,&nbsp;varg&nbsp;in&nbsp;kwargs.items():</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2413">2413</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;type(varg)&nbsp;is&nbsp;np.ndarray:</td><td class="diff_next"></td><td class="diff_header" id="to0_3013">3013</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;type(varg)&nbsp;is&nbsp;np.ndarray:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2414">2414</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kwargs_new[karg]&nbsp;=&nbsp;varg[ix_x_sort][ix_yx_sort]</td><td class="diff_next"></td><td class="diff_header" id="to0_3014">3014</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kwargs_new[karg]&nbsp;=&nbsp;varg[ix_x_sort][ix_yx_sort]</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__149"></td><td class="diff_header" id="from0_2415">2415</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td><td class="diff_next"></td><td class="diff_header" id="to0_3015">3015</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2416">2416</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kwargs_new[karg]&nbsp;=&nbsp;varg</td><td class="diff_next"></td><td class="diff_header" id="to0_3016">3016</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kwargs_new[karg]&nbsp;=&nbsp;varg</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2417">2417</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;ax&nbsp;=&nbsp;plt.scatter(x[ix_x_sort][ix_yx_sort],&nbsp;y[ix_x_sort][ix_yx_sort],&nbsp;*args_new,&nbsp;**kwargs_new)</td><td class="diff_next"></td><td class="diff_header" id="to0_3017">3017</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;ax&nbsp;=&nbsp;plt.scatter(x[ix_x_sort][ix_yx_sort],&nbsp;y[ix_x_sort][ix_yx_sort],&nbsp;*args_new,&nbsp;**kwargs_new)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2418">2418</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ax</td><td class="diff_next"></td><td class="diff_header" id="to0_3018">3018</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ax</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2419">2419</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3019">3019</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__150">n</a></td><td class="diff_header" id="from0_2420">2420</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__150">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2421">2421</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2422">2422</td><td nowrap="nowrap"><span class="diff_sub">[docs]</span>def&nbsp;ixs_thatsort_a2b(a:&nbsp;np.ndarray,&nbsp;b:&nbsp;np.ndarray,&nbsp;check_content:&nbsp;bool=True)&nbsp;-&gt;&nbsp;np.ndarray:</td><td class="diff_next"></td><td class="diff_header" id="to0_3020">3020</td><td nowrap="nowrap">def&nbsp;ixs_thatsort_a2b(a:&nbsp;np.ndarray,&nbsp;b:&nbsp;np.ndarray,&nbsp;check_content:&nbsp;bool=True)&nbsp;-&gt;&nbsp;np.ndarray:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2423">2423</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;"This&nbsp;is&nbsp;super&nbsp;duper&nbsp;magic&nbsp;sauce&nbsp;to&nbsp;make&nbsp;the&nbsp;order&nbsp;of&nbsp;one&nbsp;list&nbsp;to&nbsp;be&nbsp;like&nbsp;another"</td><td class="diff_next"></td><td class="diff_header" id="to0_3021">3021</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;"This&nbsp;is&nbsp;super&nbsp;duper&nbsp;magic&nbsp;sauce&nbsp;to&nbsp;make&nbsp;the&nbsp;order&nbsp;of&nbsp;one&nbsp;list&nbsp;to&nbsp;be&nbsp;like&nbsp;another"</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2424">2424</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;check_content:</td><td class="diff_next"></td><td class="diff_header" id="to0_3022">3022</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;check_content:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2425">2425</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assert&nbsp;len(np.intersect1d(a,&nbsp;b))&nbsp;==&nbsp;len(a),&nbsp;f"The&nbsp;two&nbsp;arrays&nbsp;are&nbsp;not&nbsp;matching"</td><td class="diff_next"></td><td class="diff_header" id="to0_3023">3023</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assert&nbsp;len(np.intersect1d(a,&nbsp;b))&nbsp;==&nbsp;len(a),&nbsp;f"The&nbsp;two&nbsp;arrays&nbsp;are&nbsp;not&nbsp;matching"</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2426">2426</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;np.argsort(a)[np.argsort(np.argsort(b))]</td><td class="diff_next"></td><td class="diff_header" id="to0_3024">3024</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;np.argsort(a)[np.argsort(np.argsort(b))]</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__150"></td><td class="diff_header" id="from0_2427">2427</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3025">3025</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2428">2428</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3026">3026</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2429">2429</td><td nowrap="nowrap">colors20&nbsp;=&nbsp;np.vstack((plt.cm.tab20b(np.linspace(0.,&nbsp;1,&nbsp;20))[::2],&nbsp;plt.cm.tab20c(np.linspace(0,&nbsp;1,&nbsp;20))[1::2]))</td><td class="diff_next"></td><td class="diff_header" id="to0_3027">3027</td><td nowrap="nowrap">colors20&nbsp;=&nbsp;np.vstack((plt.cm.tab20b(np.linspace(0.,&nbsp;1,&nbsp;20))[::2],&nbsp;plt.cm.tab20c(np.linspace(0,&nbsp;1,&nbsp;20))[1::2]))</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2430">2430</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3028">3028</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2431">2431</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3029">3029</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__151">n</a></td><td class="diff_header" id="from0_2432">2432</td><td nowrap="nowrap"><span class="diff_sub">[docs]</span>def&nbsp;colormap_fun(x:&nbsp;np.ndarray)&nbsp;-&gt;&nbsp;np.ndarray:</td><td class="diff_next"><a href="#difflib_chg_to0__151">n</a></td><td class="diff_header" id="to0_3030">3030</td><td nowrap="nowrap">def&nbsp;colormap_fun(x:&nbsp;np.ndarray)&nbsp;-&gt;&nbsp;np.ndarray:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2433">2433</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;colors20[np.mod(x,&nbsp;20)]</td><td class="diff_next"></td><td class="diff_header" id="to0_3031">3031</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;colors20[np.mod(x,&nbsp;20)]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2434">2434</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3032">3032</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2435">2435</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3033">3033</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2436">2436</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3034">3034</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2437">2437</td><td nowrap="nowrap">@jit("float64[:](float64[:],&nbsp;int32[:],&nbsp;int32[:],&nbsp;float64[:])",&nbsp;nopython=True)</td><td class="diff_next"></td><td class="diff_header" id="to0_3035">3035</td><td nowrap="nowrap">@jit("float64[:](float64[:],&nbsp;int32[:],&nbsp;int32[:],&nbsp;float64[:])",&nbsp;nopython=True)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2438">2438</td><td nowrap="nowrap">def&nbsp;_scale_to_match_median(data:&nbsp;np.ndarray,&nbsp;indices:&nbsp;np.ndarray,</td><td class="diff_next"></td><td class="diff_header" id="to0_3036">3036</td><td nowrap="nowrap">def&nbsp;_scale_to_match_median(data:&nbsp;np.ndarray,&nbsp;indices:&nbsp;np.ndarray,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2439">2439</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;indptr:&nbsp;np.ndarray,&nbsp;genes_total:&nbsp;np.ndarray)&nbsp;-&gt;&nbsp;np.ndarray:</td><td class="diff_next"></td><td class="diff_header" id="to0_3037">3037</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;indptr:&nbsp;np.ndarray,&nbsp;genes_total:&nbsp;np.ndarray)&nbsp;-&gt;&nbsp;np.ndarray:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2440">2440</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Helper&nbsp;function&nbsp;that&nbsp;operates&nbsp;directly&nbsp;on&nbsp;the&nbsp;.data&nbsp;array&nbsp;of&nbsp;a&nbsp;sparse&nbsp;matrix&nbsp;object</td><td class="diff_next"></td><td class="diff_header" id="to0_3038">3038</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Helper&nbsp;function&nbsp;that&nbsp;operates&nbsp;directly&nbsp;on&nbsp;the&nbsp;.data&nbsp;array&nbsp;of&nbsp;a&nbsp;sparse&nbsp;matrix&nbsp;object</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2441">2441</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;new_data&nbsp;=&nbsp;np.zeros(data.shape)</td><td class="diff_next"></td><td class="diff_header" id="to0_3039">3039</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;new_data&nbsp;=&nbsp;np.zeros(data.shape)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2442">2442</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Loop&nbsp;through&nbsp;the&nbsp;columns</td><td class="diff_next"></td><td class="diff_header" id="to0_3040">3040</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Loop&nbsp;through&nbsp;the&nbsp;columns</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2443">2443</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(genes_total.shape[0]):</td><td class="diff_next"></td><td class="diff_header" id="to0_3041">3041</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(genes_total.shape[0]):</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2444">2444</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Retrieve&nbsp;the&nbsp;values</td><td class="diff_next"></td><td class="diff_header" id="to0_3042">3042</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Retrieve&nbsp;the&nbsp;values</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2445">2445</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;non_zero_genes_total&nbsp;=&nbsp;genes_total[indices[indptr[i]:indptr[i&nbsp;+&nbsp;1]]]</td><td class="diff_next"></td><td class="diff_header" id="to0_3043">3043</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;non_zero_genes_total&nbsp;=&nbsp;genes_total[indices[indptr[i]:indptr[i&nbsp;+&nbsp;1]]]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2446">2446</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Find&nbsp;the&nbsp;normalization&nbsp;factor</td><td class="diff_next"></td><td class="diff_header" id="to0_3044">3044</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Find&nbsp;the&nbsp;normalization&nbsp;factor</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__151"></td><td class="diff_header" id="from0_2447">2447</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;=&nbsp;np.minimum(1,&nbsp;np.median(non_zero_genes_total)&nbsp;/&nbsp;non_zero_genes_total)</td><td class="diff_next"></td><td class="diff_header" id="to0_3045">3045</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;=&nbsp;np.minimum(1,&nbsp;np.median(non_zero_genes_total)&nbsp;/&nbsp;non_zero_genes_total)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2448">2448</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_data[indptr[i]:indptr[i&nbsp;+&nbsp;1]]&nbsp;=&nbsp;w&nbsp;*&nbsp;data[indptr[i]:indptr[i&nbsp;+&nbsp;1]]</td><td class="diff_next"></td><td class="diff_header" id="to0_3046">3046</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_data[indptr[i]:indptr[i&nbsp;+&nbsp;1]]&nbsp;=&nbsp;w&nbsp;*&nbsp;data[indptr[i]:indptr[i&nbsp;+&nbsp;1]]</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2449">2449</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new_data</td><td class="diff_next"></td><td class="diff_header" id="to0_3047">3047</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new_data</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2450">2450</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3048">3048</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2451">2451</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3049">3049</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__152">n</a></td><td class="diff_header" id="from0_2452">2452</td><td nowrap="nowrap"><span class="diff_sub">[docs]</span>@jit(nopython=True)</td><td class="diff_next"><a href="#difflib_chg_to0__152">n</a></td><td class="diff_header" id="to0_3050">3050</td><td nowrap="nowrap">@jit(nopython=True)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2453">2453</td><td nowrap="nowrap">def&nbsp;numba_random_seed(value:&nbsp;int)&nbsp;-&gt;&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_3051">3051</td><td nowrap="nowrap">def&nbsp;numba_random_seed(value:&nbsp;int)&nbsp;-&gt;&nbsp;None:</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__152"></td><td class="diff_header" id="from0_2454">2454</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;"""Same&nbsp;as&nbsp;np.random.seed&nbsp;but&nbsp;for&nbsp;numba"""</td><td class="diff_next"></td><td class="diff_header" id="to0_3052">3052</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;"""Same&nbsp;as&nbsp;np.random.seed&nbsp;but&nbsp;for&nbsp;numba"""</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2455">2455</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;np.random.seed(value)</td><td class="diff_next"></td><td class="diff_header" id="to0_3053">3053</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;np.random.seed(value)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2456">2456</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3054">3054</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2457">2457</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3055">3055</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2458">2458</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3056">3056</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__153">n</a></td><td class="diff_header" id="from0_2459">2459</td><td nowrap="nowrap"><span class="diff_sub">[docs]</span>@jit(nopython=True)</td><td class="diff_next"><a href="#difflib_chg_to0__153">n</a></td><td class="diff_header" id="to0_3057">3057</td><td nowrap="nowrap">@jit(nopython=True)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2460">2460</td><td nowrap="nowrap">def&nbsp;permute_rows_nsign(A:&nbsp;np.ndarray)&nbsp;-&gt;&nbsp;None:</td><td class="diff_next"></td><td class="diff_header" id="to0_3058">3058</td><td nowrap="nowrap">def&nbsp;permute_rows_nsign(A:&nbsp;np.ndarray)&nbsp;-&gt;&nbsp;None:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2461">2461</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;"""Permute&nbsp;in&nbsp;place&nbsp;the&nbsp;entries&nbsp;and&nbsp;randomly&nbsp;switch&nbsp;the&nbsp;sign&nbsp;for&nbsp;each&nbsp;row&nbsp;of&nbsp;a&nbsp;matrix&nbsp;independently.</td><td class="diff_next"></td><td class="diff_header" id="to0_3059">3059</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;"""Permute&nbsp;in&nbsp;place&nbsp;the&nbsp;entries&nbsp;and&nbsp;randomly&nbsp;switch&nbsp;the&nbsp;sign&nbsp;for&nbsp;each&nbsp;row&nbsp;of&nbsp;a&nbsp;matrix&nbsp;independently.</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2462">2462</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_3060">3060</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__153"></td><td class="diff_header" id="from0_2463">2463</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;plmi&nbsp;=&nbsp;np.array([+1,&nbsp;-1])</td><td class="diff_next"></td><td class="diff_header" id="to0_3061">3061</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;plmi&nbsp;=&nbsp;np.array([+1,&nbsp;-1])</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2464">2464</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(A.shape[0]):</td><td class="diff_next"></td><td class="diff_header" id="to0_3062">3062</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(A.shape[0]):</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2465">2465</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.random.shuffle(A[i,&nbsp;:])</td><td class="diff_next"></td><td class="diff_header" id="to0_3063">3063</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.random.shuffle(A[i,&nbsp;:])</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2466">2466</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A[i,&nbsp;:]&nbsp;=&nbsp;A[i,&nbsp;:]&nbsp;*&nbsp;np.random.choice(plmi,&nbsp;size=A.shape[1])</td><td class="diff_next"></td><td class="diff_header" id="to0_3064">3064</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A[i,&nbsp;:]&nbsp;=&nbsp;A[i,&nbsp;:]&nbsp;*&nbsp;np.random.choice(plmi,&nbsp;size=A.shape[1])</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__154"></td><td class="diff_header" id="from0_2467">2467</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3065">3065</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__154">n</a></td><td class="diff_header" id="from0_2468">2468</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__154">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2469">2469</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2470">2470</td><td nowrap="nowrap"><span class="diff_sub">[docs]</span>def&nbsp;scale_to_match_median(sparse_matrix:&nbsp;sparse.csr_matrix,&nbsp;genes_total:&nbsp;np.ndarray)&nbsp;-&gt;&nbsp;sparse.csr_matrix:</td><td class="diff_next"></td><td class="diff_header" id="to0_3066">3066</td><td nowrap="nowrap">def&nbsp;scale_to_match_median(sparse_matrix:&nbsp;sparse.csr_matrix,&nbsp;genes_total:&nbsp;np.ndarray)&nbsp;-&gt;&nbsp;sparse.csr_matrix:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2471">2471</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;"""Normalize&nbsp;contribution&nbsp;of&nbsp;different&nbsp;neighbor&nbsp;genes&nbsp;to&nbsp;match&nbsp;the&nbsp;median&nbsp;totals</td><td class="diff_next"></td><td class="diff_header" id="to0_3067">3067</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;"""Normalize&nbsp;contribution&nbsp;of&nbsp;different&nbsp;neighbor&nbsp;genes&nbsp;to&nbsp;match&nbsp;the&nbsp;median&nbsp;totals</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__155"><a href="#difflib_chg_to0__155">n</a></td><td class="diff_header" id="from0_2472">2472</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__155">n</a></td><td class="diff_header" id="to0_3068">3068</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2473">2473</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td><td class="diff_next"></td><td class="diff_header" id="to0_3069">3069</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;Arguments</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2474">2474</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;---------</td><td class="diff_next"></td><td class="diff_header" id="to0_3070">3070</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;---------</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__156"></td><td class="diff_header" id="from0_2475">2475</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;sparse_matrix:&nbsp;sparse.csr_matrix</td><td class="diff_next"></td><td class="diff_header" id="to0_3071">3071</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;sparse_matrix:&nbsp;sparse.csr_matrix</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2476">2476</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights&nbsp;matrix</td><td class="diff_next"></td><td class="diff_header" id="to0_3072">3072</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights&nbsp;matrix</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__156">n</a></td><td class="diff_header" id="from0_2477">2477</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__156">n</a></td><td class="diff_header" id="to0_3073">3073</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2478">2478</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;genes_total:&nbsp;sparse.csr_matrix&nbsp;shape=(sparse_matrix.shape[0])</td><td class="diff_next"></td><td class="diff_header" id="to0_3074">3074</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;genes_total:&nbsp;sparse.csr_matrix&nbsp;shape=(sparse_matrix.shape[0])</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2479">2479</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array&nbsp;of&nbsp;the&nbsp;total&nbsp;molecules&nbsp;detected&nbsp;for&nbsp;each&nbsp;gene</td><td class="diff_next"></td><td class="diff_header" id="to0_3075">3075</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array&nbsp;of&nbsp;the&nbsp;total&nbsp;molecules&nbsp;detected&nbsp;for&nbsp;each&nbsp;gene</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__157"><a href="#difflib_chg_to0__157">n</a></td><td class="diff_header" id="from0_2480">2480</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__157">n</a></td><td class="diff_header" id="to0_3076">3076</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2481">2481</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;Returns</td><td class="diff_next"></td><td class="diff_header" id="to0_3077">3077</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;Returns</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2482">2482</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;-------</td><td class="diff_next"></td><td class="diff_header" id="to0_3078">3078</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;-------</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2483">2483</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;knn_weights:&nbsp;sparse.csr_matrix</td><td class="diff_next"></td><td class="diff_header" id="to0_3079">3079</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;knn_weights:&nbsp;sparse.csr_matrix</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2484">2484</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sparse_matrix&nbsp;after&nbsp;the&nbsp;normalization</td><td class="diff_next"></td><td class="diff_header" id="to0_3080">3080</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sparse_matrix&nbsp;after&nbsp;the&nbsp;normalization</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__158">n</a></td><td class="diff_header" id="from0_2485">2485</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__158">n</a></td><td class="diff_header" id="to0_3081">3081</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2486">2486</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;NOTE,&nbsp;since&nbsp;the&nbsp;use&nbsp;I&nbsp;made&nbsp;of&nbsp;this&nbsp;later&nbsp;I&nbsp;could&nbsp;have&nbsp;changed&nbsp;sparse_matrix&nbsp;in&nbsp;place</td><td class="diff_next"></td><td class="diff_header" id="to0_3082">3082</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;NOTE,&nbsp;since&nbsp;the&nbsp;use&nbsp;I&nbsp;made&nbsp;of&nbsp;this&nbsp;later&nbsp;I&nbsp;could&nbsp;have&nbsp;changed&nbsp;sparse_matrix&nbsp;in&nbsp;place</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2487">2487</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;"""</td><td class="diff_next"></td><td class="diff_header" id="to0_3083">3083</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;"""</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2488">2488</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;newdata&nbsp;=&nbsp;_scale_to_match_median(sparse_matrix.data,&nbsp;sparse_matrix.indices,&nbsp;sparse_matrix.indptr,&nbsp;genes_total)</td><td class="diff_next"></td><td class="diff_header" id="to0_3084">3084</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;newdata&nbsp;=&nbsp;_scale_to_match_median(sparse_matrix.data,&nbsp;sparse_matrix.indices,&nbsp;sparse_matrix.indptr,&nbsp;genes_total)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2489">2489</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;sparse.csc_matrix((newdata,</td><td class="diff_next"></td><td class="diff_header" id="to0_3085">3085</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;sparse.csc_matrix((newdata,</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__158"></td><td class="diff_header" id="from0_2490">2490</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sparse_matrix.indices,</td><td class="diff_next"></td><td class="diff_header" id="to0_3086">3086</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sparse_matrix.indices,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2491">2491</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sparse_matrix.indptr),</td><td class="diff_next"></td><td class="diff_header" id="to0_3087">3087</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sparse_matrix.indptr),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2492">2492</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shape=sparse_matrix.shape,</td><td class="diff_next"></td><td class="diff_header" id="to0_3088">3088</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shape=sparse_matrix.shape,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2493">2493</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;copy=True)</td><td class="diff_next"></td><td class="diff_header" id="to0_3089">3089</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;copy=True)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2494">2494</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3090">3090</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__159">n</a></td><td class="diff_header" id="from0_2495">2495</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"><a href="#difflib_chg_to0__159">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__159"></td><td class="diff_header" id="from0_2496">2496</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2497">2497</td><td nowrap="nowrap"><span class="diff_sub">[docs]</span>def&nbsp;gaussian_kernel(X:&nbsp;np.ndarray,&nbsp;mu:&nbsp;float=0,&nbsp;sigma:&nbsp;float=1)&nbsp;-&gt;&nbsp;np.ndarray:</td><td class="diff_next"></td><td class="diff_header" id="to0_3091">3091</td><td nowrap="nowrap">def&nbsp;gaussian_kernel(X:&nbsp;np.ndarray,&nbsp;mu:&nbsp;float=0,&nbsp;sigma:&nbsp;float=1)&nbsp;-&gt;&nbsp;np.ndarray:</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2498">2498</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;"""Compute&nbsp;gaussian&nbsp;kernel"""</td><td class="diff_next"></td><td class="diff_header" id="to0_3092">3092</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;"""Compute&nbsp;gaussian&nbsp;kernel"""</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2499">2499</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;np.exp(-(X&nbsp;-&nbsp;mu)**2&nbsp;/&nbsp;(2&nbsp;*&nbsp;sigma**2))&nbsp;/&nbsp;np.sqrt(2&nbsp;*&nbsp;np.pi&nbsp;*&nbsp;sigma**2)</td><td class="diff_next"></td><td class="diff_header" id="to0_3093">3093</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;np.exp(-(X&nbsp;-&nbsp;mu)**2&nbsp;/&nbsp;(2&nbsp;*&nbsp;sigma**2))&nbsp;/&nbsp;np.sqrt(2&nbsp;*&nbsp;np.pi&nbsp;*&nbsp;sigma**2)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2500">2500</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3094">3094</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__160">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to0__160">n</a></td><td class="diff_header" id="to0_3095">3095</td><td nowrap="nowrap"><span class="diff_add">#read&nbsp;in&nbsp;the&nbsp;csv&nbsp;file&nbsp;of&nbsp;RNA-Seq&nbsp;data</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3096">3096</td><td nowrap="nowrap"><span class="diff_add">matrix&nbsp;=&nbsp;np.genfromtxt(sys.argv[5],&nbsp;delimiter=',',&nbsp;dtype=None)&nbsp;#main&nbsp;matrix&nbsp;mm10_pberghei_ercc_mouse_</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3097">3097</td><td nowrap="nowrap"><span class="diff_add">col_gene_name_attribute&nbsp;=&nbsp;matrix[:,[0]]</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__160"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3098">3098</td><td nowrap="nowrap"><span class="diff_add">genes&nbsp;=&nbsp;[]&nbsp;#row&nbsp;attribute,&nbsp;extract&nbsp;the&nbsp;gene&nbsp;names&nbsp;from&nbsp;the&nbsp;file,&nbsp;delete&nbsp;and&nbsp;add&nbsp;back&nbsp;as&nbsp;a&nbsp;row&nbsp;attribute&nbsp;(ra)&nbsp;later</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3099">3099</td><td nowrap="nowrap"><span class="diff_add">for&nbsp;gene_num&nbsp;in&nbsp;range(1,&nbsp;len(col_gene_name_attribute)):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3100">3100</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gene&nbsp;=&nbsp;col_gene_name_attribute[gene_num]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3101">3101</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genes.append(str(gene,&nbsp;'utf-8'))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2501">2501</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3102">3102</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__161">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to0__161">n</a></td><td class="diff_header" id="to0_3103">3103</td><td nowrap="nowrap"><span class="diff_add">matrix&nbsp;=&nbsp;np.delete(matrix,&nbsp;0,&nbsp;1)&nbsp;&nbsp;#1&nbsp;=&nbsp;col,&nbsp;0&nbsp;=&nbsp;row</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3104">3104</td><td nowrap="nowrap"><span class="diff_add">row_patient_name_attribute&nbsp;=&nbsp;matrix[[0],&nbsp;:]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3105">3105</td><td nowrap="nowrap"><span class="diff_add">patients&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3106">3106</td><td nowrap="nowrap"><span class="diff_add">for&nbsp;patient&nbsp;in&nbsp;row_patient_name_attribute:&nbsp;#column&nbsp;attribute,&nbsp;extract&nbsp;the&nbsp;patient/sample&nbsp;IDs&nbsp;from&nbsp;the&nbsp;file,&nbsp;delete&nbsp;and&nbsp;add&nbsp;back&nbsp;as&nbsp;a&nbsp;column&nbsp;attribute&nbsp;(ca)&nbsp;later&nbsp;when&nbsp;the&nbsp;file&nbsp;is&nbsp;made</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__161"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3107">3107</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;word&nbsp;in&nbsp;patient:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3108">3108</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded&nbsp;=&nbsp;str(word,&nbsp;'utf-8')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3109">3109</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_final&nbsp;=&nbsp;decoded.replace('"',&nbsp;"")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3110">3110</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;patients.append(decoded_final)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2502">2502</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3111">3111</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__162">n</a></td><td class="diff_header" id="from0_2503">2503</td><td nowrap="nowrap"><span class="diff_sub">[docs]def&nbsp;load_velocyto_hdf5(filename:&nbsp;str)&nbsp;-&gt;&nbsp;VelocytoLoom:</span></td><td class="diff_next"><a href="#difflib_chg_to0__162">n</a></td><td class="diff_header" id="to0_3112">3112</td><td nowrap="nowrap"><span class="diff_add">matrix&nbsp;=&nbsp;np.delete(matrix,&nbsp;0,&nbsp;0)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2504">2504</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;"""Loads&nbsp;a&nbsp;Velocyto&nbsp;loom&nbsp;object&nbsp;from&nbsp;an&nbsp;hdf5&nbsp;file</span></td><td class="diff_next"></td><td class="diff_header" id="to0_3113">3113</td><td nowrap="nowrap"><span class="diff_add">my_matrix&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__162"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3114">3114</td><td nowrap="nowrap"><span class="diff_add">for&nbsp;row&nbsp;in&nbsp;matrix:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3115">3115</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rows&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3116">3116</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;value&nbsp;in&nbsp;row:&nbsp;#remove&nbsp;the&nbsp;encoding&nbsp;added&nbsp;and&nbsp;ensure&nbsp;all&nbsp;the&nbsp;matrix&nbsp;values&nbsp;are&nbsp;integers</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3117">3117</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rows.append(float(str(value,&nbsp;'utf-8')))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2505">2505</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3118">3118</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__163">n</a></td><td class="diff_header" id="from0_2506">2506</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;Arguments</span></td><td class="diff_next"><a href="#difflib_chg_to0__163">n</a></td><td class="diff_header" id="to0_3119">3119</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_matrix.append(rows)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2507">2507</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;---------</span></td><td class="diff_next"></td><td class="diff_header" id="to0_3120">3120</td><td nowrap="nowrap"><span class="diff_add">my_shape&nbsp;=&nbsp;np.array(my_matrix).shape</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2508">2508</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;filename:&nbsp;str</span></td><td class="diff_next"></td><td class="diff_header" id="to0_3121">3121</td><td nowrap="nowrap"><span class="diff_add">ncols&nbsp;=&nbsp;my_shape[0]&nbsp;#number&nbsp;of&nbsp;genes</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2509">2509</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;serialized&nbsp;file</span></td><td class="diff_next"></td><td class="diff_header" id="to0_3122">3122</td><td nowrap="nowrap"><span class="diff_add">nrows&nbsp;=&nbsp;my_shape[1]&nbsp;#number&nbsp;of&nbsp;cells</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3123">3123</td><td nowrap="nowrap"><span class="diff_add">my_matrix&nbsp;=&nbsp;np.array(my_matrix).reshape(ncols,nrows)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3124">3124</td><td nowrap="nowrap"><span class="diff_add">print("Your&nbsp;data&nbsp;contains",&nbsp;ncols,&nbsp;"genes&nbsp;and",&nbsp;nrows,&nbsp;"samples")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3125">3125</td><td nowrap="nowrap"><span class="diff_add">#get&nbsp;the&nbsp;clinical&nbsp;complications&nbsp;as&nbsp;the&nbsp;clusters</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__163"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3126">3126</td><td nowrap="nowrap"><span class="diff_add">metadata&nbsp;=&nbsp;np.genfromtxt(sys.argv[7],&nbsp;delimiter=',',&nbsp;dtype=None)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3127">3127</td><td nowrap="nowrap"><span class="diff_add">metadatanames&nbsp;=&nbsp;list(metadata[:,0])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3128">3128</td><td nowrap="nowrap"><span class="diff_add">metadatanames.pop(0)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3129">3129</td><td nowrap="nowrap"><span class="diff_add">metadata&nbsp;=&nbsp;list(metadata[:,1])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2510">2510</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3130">3130</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__164">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to0__164">n</a></td><td class="diff_header" id="to0_3131">3131</td><td nowrap="nowrap"><span class="diff_add">metadata.pop(0)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3132">3132</td><td nowrap="nowrap"><span class="diff_add">clusters&nbsp;=&nbsp;[]&nbsp;#,'utf-8')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3133">3133</td><td nowrap="nowrap"><span class="diff_add">for&nbsp;meta&nbsp;in&nbsp;metadata:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3134">3134</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;clusters.append(str(meta,&nbsp;'utf-8'))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3135">3135</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3136">3136</td><td nowrap="nowrap"><span class="diff_add">metadata&nbsp;=&nbsp;np.genfromtxt(sys.argv[8],&nbsp;delimiter=',',&nbsp;dtype=None)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3137">3137</td><td nowrap="nowrap"><span class="diff_add">metadatanames2&nbsp;=&nbsp;list(metadata[:,0])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3138">3138</td><td nowrap="nowrap"><span class="diff_add">metadatanames2.pop(0)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3139">3139</td><td nowrap="nowrap"><span class="diff_add">metadata&nbsp;=&nbsp;list(metadata[:,1])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3140">3140</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3141">3141</td><td nowrap="nowrap"><span class="diff_add">metadata.pop(0)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3142">3142</td><td nowrap="nowrap"><span class="diff_add">MarkerData&nbsp;=&nbsp;[]&nbsp;#,'utf-8')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3143">3143</td><td nowrap="nowrap"><span class="diff_add">for&nbsp;meta&nbsp;in&nbsp;metadata:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3144">3144</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;MarkerData.append(str(meta,&nbsp;'utf-8'))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3145">3145</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3146">3146</td><td nowrap="nowrap"><span class="diff_add">#check&nbsp;both&nbsp;metadata&nbsp;first&nbsp;column&nbsp;matches&nbsp;first&nbsp;column&nbsp;of&nbsp;spliced&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3147">3147</td><td nowrap="nowrap"><span class="diff_add">metadatanames_s&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3148">3148</td><td nowrap="nowrap"><span class="diff_add">for&nbsp;sample&nbsp;in&nbsp;metadatanames:&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3149">3149</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded&nbsp;=&nbsp;str(sample,&nbsp;'utf-8')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3150">3150</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_final&nbsp;=&nbsp;decoded.replace('"',&nbsp;"")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3151">3151</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;metadatanames_s.append(decoded_final)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3152">3152</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3153">3153</td><td nowrap="nowrap"><span class="diff_add">metadatanames2_s&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3154">3154</td><td nowrap="nowrap"><span class="diff_add">for&nbsp;patienty&nbsp;in&nbsp;metadatanames2:&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3155">3155</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded&nbsp;=&nbsp;str(patienty,&nbsp;'utf-8')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3156">3156</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoded_final&nbsp;=&nbsp;decoded.replace('"',&nbsp;"")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3157">3157</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;metadatanames2_s.append(decoded_final)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3158">3158</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3159">3159</td><td nowrap="nowrap"><span class="diff_add">if&nbsp;(metadatanames_s&nbsp;==&nbsp;patients):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3160">3160</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;print("Congratulations&nbsp;-&nbsp;The&nbsp;sample&nbsp;names&nbsp;of&nbsp;the&nbsp;expression&nbsp;data&nbsp;match&nbsp;that&nbsp;of&nbsp;the&nbsp;first&nbsp;metadata!")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3161">3161</td><td nowrap="nowrap"><span class="diff_add">else:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3162">3162</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;print("The&nbsp;sample&nbsp;names&nbsp;of&nbsp;the&nbsp;expression&nbsp;data&nbsp;DO&nbsp;NOT&nbsp;match&nbsp;that&nbsp;of&nbsp;the&nbsp;first&nbsp;metadata&nbsp;-&nbsp;please&nbsp;make&nbsp;sure&nbsp;they&nbsp;do&nbsp;and&nbsp;restart&nbsp;the&nbsp;analysis!")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3163">3163</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;print("The&nbsp;sample&nbsp;names&nbsp;of&nbsp;the&nbsp;expression&nbsp;data:")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3164">3164</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;print(patients)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3165">3165</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;print("....do&nbsp;not&nbsp;match&nbsp;the&nbsp;first&nbsp;metadata&nbsp;file&nbsp;sample&nbsp;names:")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3166">3166</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;print(metadatanames_s)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3167">3167</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;sys.exit()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3168">3168</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3169">3169</td><td nowrap="nowrap"><span class="diff_add">if&nbsp;(metadatanames2_s&nbsp;==&nbsp;patients):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3170">3170</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;print("Congratulations&nbsp;-&nbsp;The&nbsp;sample&nbsp;names&nbsp;of&nbsp;the&nbsp;expression&nbsp;data&nbsp;match&nbsp;that&nbsp;of&nbsp;the&nbsp;second&nbsp;metadata&nbsp;file!")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3171">3171</td><td nowrap="nowrap"><span class="diff_add">else:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3172">3172</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;print("The&nbsp;sample&nbsp;names&nbsp;of&nbsp;the&nbsp;expression&nbsp;data&nbsp;DO&nbsp;NOT&nbsp;match&nbsp;that&nbsp;of&nbsp;the&nbsp;second&nbsp;metadata&nbsp;-&nbsp;please&nbsp;make&nbsp;sure&nbsp;they&nbsp;do&nbsp;and&nbsp;restart&nbsp;the&nbsp;analysis!")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3173">3173</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;print("The&nbsp;sample&nbsp;names&nbsp;of&nbsp;the&nbsp;expression&nbsp;data:")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3174">3174</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;print(patients)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3175">3175</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;print("....do&nbsp;not&nbsp;match&nbsp;the&nbsp;second&nbsp;metadata&nbsp;file&nbsp;sample&nbsp;names:")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3176">3176</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;print(metadatanames2_s)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3177">3177</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;sys.exit()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3178">3178</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3179">3179</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3180">3180</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3181">3181</td><td nowrap="nowrap"><span class="diff_add">#clusters&nbsp;=&nbsp;["cluster1"]*nrows&nbsp;#assign&nbsp;all&nbsp;to&nbsp;the&nbsp;same&nbsp;cluster</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3182">3182</td><td nowrap="nowrap"><span class="diff_add">#for&nbsp;patient&nbsp;in&nbsp;range(1,&nbsp;nrows+1):&nbsp;#assign&nbsp;each&nbsp;to&nbsp;their&nbsp;own&nbsp;unique&nbsp;cluster:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3183">3183</td><td nowrap="nowrap"><span class="diff_add">#&nbsp;&nbsp;&nbsp;&nbsp;clusters.append("cluster"+str(patient))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3184">3184</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3185">3185</td><td nowrap="nowrap"><span class="diff_add">#print(loompy_file[:,&nbsp;:])&nbsp;#returns&nbsp;the&nbsp;matrix</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3186">3186</td><td nowrap="nowrap"><span class="diff_add">spliced_reads&nbsp;=&nbsp;np.genfromtxt(sys.argv[3],&nbsp;delimiter=',',&nbsp;dtype=None)&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3187">3187</td><td nowrap="nowrap"><span class="diff_add">spliced_reads&nbsp;=&nbsp;np.delete(spliced_reads,&nbsp;0,&nbsp;1)&nbsp;&nbsp;#sample&nbsp;names&nbsp;#1&nbsp;=&nbsp;col,&nbsp;0&nbsp;=&nbsp;row</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3188">3188</td><td nowrap="nowrap"><span class="diff_add">spliced_reads&nbsp;=&nbsp;np.delete(spliced_reads,&nbsp;0,&nbsp;0)&nbsp;&nbsp;#gene&nbsp;names</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3189">3189</td><td nowrap="nowrap"><span class="diff_add">spl&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3190">3190</td><td nowrap="nowrap"><span class="diff_add">for&nbsp;row&nbsp;in&nbsp;spliced_reads:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3191">3191</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rows&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3192">3192</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;value&nbsp;in&nbsp;row:&nbsp;#remove&nbsp;the&nbsp;encoding&nbsp;added&nbsp;and&nbsp;ensure&nbsp;all&nbsp;the&nbsp;matrix&nbsp;values&nbsp;are&nbsp;integers</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3193">3193</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rows.append(float(str(value,&nbsp;'utf-8')))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3194">3194</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spl.append(rows)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3195">3195</td><td nowrap="nowrap"><span class="diff_add">spl&nbsp;=&nbsp;np.array(spl).reshape(ncols,nrows)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3196">3196</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3197">3197</td><td nowrap="nowrap"><span class="diff_add">unspliced_reads&nbsp;=&nbsp;np.genfromtxt(sys.argv[4],&nbsp;delimiter=',',&nbsp;dtype=None)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3198">3198</td><td nowrap="nowrap"><span class="diff_add">unspliced_reads&nbsp;=&nbsp;np.delete(unspliced_reads,&nbsp;0,&nbsp;1)&nbsp;&nbsp;#1&nbsp;=&nbsp;col,&nbsp;0&nbsp;=&nbsp;row</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3199">3199</td><td nowrap="nowrap"><span class="diff_add">unspliced_reads&nbsp;=&nbsp;np.delete(unspliced_reads,&nbsp;0,&nbsp;0)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3200">3200</td><td nowrap="nowrap"><span class="diff_add">unspl&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3201">3201</td><td nowrap="nowrap"><span class="diff_add">for&nbsp;row&nbsp;in&nbsp;unspliced_reads:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3202">3202</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rows&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3203">3203</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;value&nbsp;in&nbsp;row:&nbsp;#remove&nbsp;the&nbsp;encoding&nbsp;added&nbsp;and&nbsp;ensure&nbsp;all&nbsp;the&nbsp;matrix&nbsp;values&nbsp;are&nbsp;integers</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3204">3204</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rows.append(float(str(value,&nbsp;'utf-8')))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3205">3205</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unspl.append(rows)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3206">3206</td><td nowrap="nowrap"><span class="diff_add">unspl&nbsp;=&nbsp;np.array(unspl).reshape(ncols,nrows)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3207">3207</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3208">3208</td><td nowrap="nowrap"><span class="diff_add">ambig_reads&nbsp;=&nbsp;np.genfromtxt(sys.argv[6],&nbsp;delimiter=',',&nbsp;dtype=None)&nbsp;#mm10_pberghei_ercc_mouse_&nbsp;mm10_pchabaudi_ercc_mouse_</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3209">3209</td><td nowrap="nowrap"><span class="diff_add">ambig_reads&nbsp;=&nbsp;np.delete(ambig_reads,&nbsp;0,&nbsp;1)&nbsp;&nbsp;#1&nbsp;=&nbsp;col,&nbsp;0&nbsp;=&nbsp;row</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3210">3210</td><td nowrap="nowrap"><span class="diff_add">ambig_reads&nbsp;=&nbsp;np.delete(ambig_reads,&nbsp;0,&nbsp;0)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3211">3211</td><td nowrap="nowrap"><span class="diff_add">ambig&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3212">3212</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3213">3213</td><td nowrap="nowrap"><span class="diff_add">for&nbsp;row&nbsp;in&nbsp;ambig_reads:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3214">3214</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rows&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3215">3215</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;value&nbsp;in&nbsp;row:&nbsp;#remove&nbsp;the&nbsp;encoding&nbsp;added&nbsp;and&nbsp;ensure&nbsp;all&nbsp;the&nbsp;matrix&nbsp;values&nbsp;are&nbsp;integers</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3216">3216</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rows.append(float(0))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3217">3217</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ambig.append(rows)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3218">3218</td><td nowrap="nowrap"><span class="diff_add">ambig&nbsp;=&nbsp;np.array(ambig).reshape(ncols,nrows)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3219">3219</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3220">3220</td><td nowrap="nowrap"><span class="diff_add">#feature_selection_practise(spl,&nbsp;0.1,&nbsp;"variance",&nbsp;unspl,&nbsp;ambig,&nbsp;my_matrix,&nbsp;genes)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3221">3221</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3222">3222</td><td nowrap="nowrap"><span class="diff_add">filename&nbsp;=&nbsp;"test.loom"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3223">3223</td><td nowrap="nowrap"><span class="diff_add">row_attrs&nbsp;=&nbsp;{&nbsp;"Genes":&nbsp;np.array(genes)&nbsp;}&nbsp;#genes&nbsp;are&nbsp;the&nbsp;rows,&nbsp;cells&nbsp;are&nbsp;the&nbsp;columns</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3224">3224</td><td nowrap="nowrap"><span class="diff_add">col_attrs&nbsp;=&nbsp;{&nbsp;"Patients":&nbsp;np.array(patients),&nbsp;"ClusterName":&nbsp;np.array(clusters),&nbsp;"Markers":&nbsp;np.array(MarkerData)&nbsp;}</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3225">3225</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3226">3226</td><td nowrap="nowrap"><span class="diff_add">loompy.create(filename,&nbsp;my_matrix,&nbsp;row_attrs,&nbsp;col_attrs)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3227">3227</td><td nowrap="nowrap"><span class="diff_add">#loompy_file&nbsp;=&nbsp;loompy.connect("test.loom")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3228">3228</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3229">3229</td><td nowrap="nowrap"><span class="diff_add">#Make&nbsp;subdirectories&nbsp;for&nbsp;high-throughput&nbsp;analysis&nbsp;(many&nbsp;sample&nbsp;runs&nbsp;for&nbsp;a&nbsp;single&nbsp;dataset&nbsp;like&nbsp;FEAST)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3230">3230</td><td nowrap="nowrap"><span class="diff_add">PCA_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Fate_Maps/PCA/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3231">3231</td><td nowrap="nowrap"><span class="diff_add">UMAP_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Fate_Maps/UMAP_2D/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3232">3232</td><td nowrap="nowrap"><span class="diff_add">tSNE_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Fate_Maps/tSNE/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3233">3233</td><td nowrap="nowrap"><span class="diff_add">UMAP_3D_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Fate_Maps/UMAP_3D/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3234">3234</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3235">3235</td><td nowrap="nowrap"><span class="diff_add">VelocityValues_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Files/Velocity_Values/"&nbsp;+&nbsp;str(sys.argv[30])+&nbsp;"/")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3236">3236</td><td nowrap="nowrap"><span class="diff_add">Predicted_Unspiced_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Files/Predicted_Unspiced/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3237">3237</td><td nowrap="nowrap"><span class="diff_add">FutureSpliced_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Files/Future_Spliced/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3238">3238</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3239">3239</td><td nowrap="nowrap"><span class="diff_add">UMAP_3D_Delta_embedding_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Files/UMAP_3D/Delta_Embedding/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3240">3240</td><td nowrap="nowrap"><span class="diff_add">UMAP_3D_selfCC_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Files/UMAP_3D/Self_Correlation_Coefficients/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3241">3241</td><td nowrap="nowrap"><span class="diff_add">UMAP_3D_UnVecX_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Files/UMAP_3D/Unitary_Vector_X/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3242">3242</td><td nowrap="nowrap"><span class="diff_add">UMAP_3D_UnVecY_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Files/UMAP_3D/Unitary_Vector_Y/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3243">3243</td><td nowrap="nowrap"><span class="diff_add">UMAP_3D_UnVecZ_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Files/UMAP_3D/Unitary_Vector_Z/"&nbsp;+&nbsp;str(sys.argv[30])+&nbsp;"/")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3244">3244</td><td nowrap="nowrap"><span class="diff_add">UMAP_3D_Transition_Probability_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Files/UMAP_3D/Transition_Probability/Sample_Level/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3245">3245</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3246">3246</td><td nowrap="nowrap"><span class="diff_add">UMAP_2D_Delta_embedding_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Files/UMAP_2D/Delta_Embedding/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3247">3247</td><td nowrap="nowrap"><span class="diff_add">UMAP_2D_selfCC_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Files/UMAP_2D/Self_Correlation_Coefficients/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3248">3248</td><td nowrap="nowrap"><span class="diff_add">UMAP_2D_UnVecX_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Files/UMAP_2D/Unitary_Vector_X/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3249">3249</td><td nowrap="nowrap"><span class="diff_add">UMAP_2D_UnVecY_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Files/UMAP_2D/Unitary_Vector_Y/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3250">3250</td><td nowrap="nowrap"><span class="diff_add">UMAP_2D_Transition_Probability_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Files/UMAP_2D/Transition_Probability/Sample_Level/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3251">3251</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3252">3252</td><td nowrap="nowrap"><span class="diff_add">tSNE_Delta_embedding_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Files/tSNE/Delta_Embedding/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3253">3253</td><td nowrap="nowrap"><span class="diff_add">tSNE_selfCC_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Files/tSNE/Self_Correlation_Coefficients/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3254">3254</td><td nowrap="nowrap"><span class="diff_add">tSNE_UnVecX_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Files/tSNE/Unitary_Vector_X/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3255">3255</td><td nowrap="nowrap"><span class="diff_add">tSNE_UnVecY_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Files/tSNE/Unitary_Vector_Y/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3256">3256</td><td nowrap="nowrap"><span class="diff_add">tSNE_Transition_Probability_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Files/tSNE/Transition_Probability/Sample_Level/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3257">3257</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3258">3258</td><td nowrap="nowrap"><span class="diff_add">UMAP_2D_GroupLevelTP_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Files/UMAP_2D/Transition_Probability/Group_Level/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3259">3259</td><td nowrap="nowrap"><span class="diff_add">UMAP_3D_GroupLevelTP_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Files/UMAP_3D/Transition_Probability/Group_Level/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3260">3260</td><td nowrap="nowrap"><span class="diff_add">tSNE_GroupLevelTP_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Files/tSNE/Transition_Probability/Group_Level/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3261">3261</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3262">3262</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3263">3263</td><td nowrap="nowrap"><span class="diff_add">CI_UMAP_2D_GroupLevelTP_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Files/UMAP_2D/Transition_Probability/Group_Level/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")&nbsp;+&nbsp;"Confidence_Interval/"&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3264">3264</td><td nowrap="nowrap"><span class="diff_add">CI_UMAP_3D_GroupLevelTP_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Files/UMAP_3D/Transition_Probability/Group_Level/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")&nbsp;+&nbsp;"Confidence_Interval/"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3265">3265</td><td nowrap="nowrap"><span class="diff_add">CI_tSNE_GroupLevelTP_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Files/tSNE/Transition_Probability/Group_Level/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")&nbsp;+&nbsp;"Confidence_Interval/"&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3266">3266</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3267">3267</td><td nowrap="nowrap"><span class="diff_add">BS_UMAP_2D_GroupLevelTP_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Files/UMAP_2D/Transition_Probability/Group_Level/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")&nbsp;+&nbsp;"Bootstrapping/"&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3268">3268</td><td nowrap="nowrap"><span class="diff_add">BS_UMAP_3D_GroupLevelTP_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Files/UMAP_3D/Transition_Probability/Group_Level/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")&nbsp;+&nbsp;"Bootstrapping/"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3269">3269</td><td nowrap="nowrap"><span class="diff_add">BS_tSNE_GroupLevelTP_Folder&nbsp;=&nbsp;str(sys.argv[2]&nbsp;+&nbsp;sys.argv[10]&nbsp;+&nbsp;"Files/tSNE/Transition_Probability/Group_Level/"&nbsp;+&nbsp;str(sys.argv[30])&nbsp;+&nbsp;"/")&nbsp;+&nbsp;"Bootstrapping/"&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3270">3270</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3271">3271</td><td nowrap="nowrap"><span class="diff_add">#choose&nbsp;the&nbsp;colour&nbsp;scheme:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3272">3272</td><td nowrap="nowrap"><span class="diff_add">import&nbsp;matplotlib&nbsp;as&nbsp;mpl</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3273">3273</td><td nowrap="nowrap"><span class="diff_add">import&nbsp;matplotlib.cm&nbsp;as&nbsp;cm</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3274">3274</td><td nowrap="nowrap"><span class="diff_add">#norm&nbsp;=&nbsp;mpl.colors.Normalize(vmin=-20,&nbsp;vmax=10)&nbsp;#convert&nbsp;to&nbsp;greyscake</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3275">3275</td><td nowrap="nowrap"><span class="diff_add">cmap&nbsp;=&nbsp;cm.Paired&nbsp;#https://matplotlib.org/users/colormaps.html</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3276">3276</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3277">3277</td><td nowrap="nowrap"><span class="diff_add">#from&nbsp;pylab&nbsp;import&nbsp;*</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3278">3278</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3279">3279</td><td nowrap="nowrap"><span class="diff_add">#set1:&nbsp;#e41a1c&nbsp;#377eb8&nbsp;#4daf4a&nbsp;#984ea3&nbsp;#ff7f00&nbsp;#ffff33&nbsp;#a65628&nbsp;#f781bf&nbsp;#999999</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3280">3280</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3281">3281</td><td nowrap="nowrap"><span class="diff_add">#Running&nbsp;the&nbsp;pipeline</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3282">3282</td><td nowrap="nowrap"><span class="diff_add">vlm&nbsp;=&nbsp;VelocytoLoom("test.loom")&nbsp;#still&nbsp;requires&nbsp;a&nbsp;loom&nbsp;file&nbsp;as&nbsp;input,&nbsp;The&nbsp;input&nbsp;bam&nbsp;file&nbsp;needs&nbsp;to&nbsp;be&nbsp;sorted&nbsp;by&nbsp;position:&nbsp;samtools&nbsp;sort&nbsp;mybam.bam&nbsp;-o&nbsp;sorted_bam.bam</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3283">3283</td><td nowrap="nowrap"><span class="diff_add">location&nbsp;=&nbsp;sys.argv[2]&nbsp;+&nbsp;sys.argv[10]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3284">3284</td><td nowrap="nowrap"><span class="diff_add">os.chdir(location)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3285">3285</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3286">3286</td><td nowrap="nowrap"><span class="diff_add">##vlm.plot_fractions("plot.pdf")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3287">3287</td><td nowrap="nowrap"><span class="diff_add">vlm.set_clusters(vlm.ca["ClusterName"],&nbsp;colormap=cmap)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3288">3288</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3289">3289</td><td nowrap="nowrap"><span class="diff_add">if&nbsp;sys.argv[12]&nbsp;==&nbsp;"False":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3290">3290</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;scaling_to_DO&nbsp;=&nbsp;False</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3291">3291</td><td nowrap="nowrap"><span class="diff_add">else:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3292">3292</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;scaling_to_DO&nbsp;=&nbsp;True</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3293">3293</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3294">3294</td><td nowrap="nowrap"><span class="diff_add">if&nbsp;sys.argv[17]&nbsp;==&nbsp;"False":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3295">3295</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;makegifs&nbsp;=&nbsp;False</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3296">3296</td><td nowrap="nowrap"><span class="diff_add">else:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3297">3297</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;makegifs&nbsp;=&nbsp;True</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3298">3298</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3299">3299</td><td nowrap="nowrap"><span class="diff_add">if&nbsp;int(sys.argv[26])&nbsp;==&nbsp;3:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3300">3300</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;make&nbsp;=&nbsp;[0,1,2]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3301">3301</td><td nowrap="nowrap"><span class="diff_add">if&nbsp;int(sys.argv[26])&nbsp;==&nbsp;2:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3302">3302</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;make&nbsp;=&nbsp;[0,1]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3303">3303</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3304">3304</td><td nowrap="nowrap"><span class="diff_add">#performs&nbsp;PCA:&nbsp;smoothing&nbsp;the&nbsp;data&nbsp;using&nbsp;kNN&nbsp;neighbours&nbsp;pooling</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3305">3305</td><td nowrap="nowrap"><span class="diff_add">PCA_FileName1&nbsp;=&nbsp;"_"&nbsp;+&nbsp;str(sys.argv[3]).split('_')[1]&nbsp;+&nbsp;"_PCA_Original"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3306">3306</td><td nowrap="nowrap"><span class="diff_add">PCA_FileName2&nbsp;=&nbsp;"_"&nbsp;+&nbsp;str(sys.argv[3]).split('_')[1]&nbsp;+&nbsp;"_PCA_FS"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3307">3307</td><td nowrap="nowrap"><span class="diff_add">grouptype&nbsp;=&nbsp;sys.argv[16]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3308">3308</td><td nowrap="nowrap"><span class="diff_add">os.chdir(PCA_Folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3309">3309</td><td nowrap="nowrap"><span class="diff_add">vlm.perform_PCA(n_components=int(sys.argv[26]))&nbsp;#must&nbsp;be&nbsp;performed&nbsp;on&nbsp;normalised&nbsp;data,&nbsp;Barnes&nbsp;hut&nbsp;approximation</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3310">3310</td><td nowrap="nowrap"><span class="diff_add">vlm.plot_pca(dim=make,&nbsp;make_gify=makegifs,&nbsp;Filename=PCA_FileName1,&nbsp;typegroup=grouptype)&nbsp;#plots&nbsp;3D&nbsp;PCA,&nbsp;need&nbsp;to&nbsp;change</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3311">3311</td><td nowrap="nowrap"><span class="diff_add">if&nbsp;sys.argv[9]&nbsp;==&nbsp;"PCAVar":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3312">3312</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;location2&nbsp;=&nbsp;sys.argv[2]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3313">3313</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(location2)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3314">3314</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;vlm.PCAVariationFS(n_pca_dims=int(sys.argv[26]),&nbsp;spliced_file=sys.argv[3],&nbsp;resuts_directory=PCA_Folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3315">3315</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(PCA_Folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3316">3316</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;vlm.perform_PCA(n_components=int(sys.argv[26]))&nbsp;#must&nbsp;be&nbsp;performed&nbsp;on&nbsp;normalised&nbsp;data,&nbsp;Barnes&nbsp;hut&nbsp;approximation</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3317">3317</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;vlm.plot_pca(dim=make,&nbsp;make_gify=makegifs,&nbsp;Filename=PCA_FileName2,&nbsp;typegroup=grouptype)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3318">3318</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;print("PCA&nbsp;feature&nbsp;selection")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3319">3319</td><td nowrap="nowrap"><span class="diff_add">else:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3320">3320</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;print("No&nbsp;PCA&nbsp;feature&nbsp;selection")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3321">3321</td><td nowrap="nowrap"><span class="diff_add">if&nbsp;sys.argv[11]&nbsp;==&nbsp;"CoorelationCoeff":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3322">3322</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(location2)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3323">3323</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;vlm.CorrelationCoefficentFS(clusters)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3324">3324</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(PCA_Folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3325">3325</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;vlm.perform_PCA(n_components=int(sys.argv[26]))&nbsp;#must&nbsp;be&nbsp;performed&nbsp;on&nbsp;normalised&nbsp;data,&nbsp;Barnes&nbsp;hut&nbsp;approximation</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3326">3326</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;vlm.plot_pca(dim=make,&nbsp;make_gify=makegifs,&nbsp;Filename="CCFS",&nbsp;typegroup=grouptype)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3327">3327</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;print("Correlation&nbsp;coefficient&nbsp;feature&nbsp;selection")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3328">3328</td><td nowrap="nowrap"><span class="diff_add">else:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3329">3329</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;print("No&nbsp;correlation&nbsp;coefficient&nbsp;feature&nbsp;selection")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3330">3330</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3331">3331</td><td nowrap="nowrap"><span class="diff_add">number_neighbous&nbsp;=&nbsp;int(sys.argv[1])&nbsp;#has&nbsp;to&nbsp;be&nbsp;2&nbsp;or&nbsp;greater&nbsp;for&nbsp;UMAP</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3332">3332</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3333">3333</td><td nowrap="nowrap"><span class="diff_add">#Estimating&nbsp;Velocity:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3334">3334</td><td nowrap="nowrap"><span class="diff_add">vlm.fit_gammas(weighted=True)&nbsp;#apply&nbsp;a&nbsp;gamma&nbsp;fit</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3335">3335</td><td nowrap="nowrap"><span class="diff_add">my_genes&nbsp;=&nbsp;[]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3336">3336</td><td nowrap="nowrap"><span class="diff_add">#RNA&nbsp;velocity&nbsp;calculation</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3337">3337</td><td nowrap="nowrap"><span class="diff_add">vlm.predict_U()</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3338">3338</td><td nowrap="nowrap"><span class="diff_add">vlm.calculate_velocity(Myneighbours=number_neighbous,&nbsp;VelocityFolder=VelocityValues_Folder,&nbsp;UnsplicedFolder=Predicted_Unspiced_Folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3339">3339</td><td nowrap="nowrap"><span class="diff_add">vlm.calculate_shift(assumption="constant_velocity")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3340">3340</td><td nowrap="nowrap"><span class="diff_add">vlm.extrapolate_cell_at_t(delta_t=1.,&nbsp;Myneighbours=number_neighbous,&nbsp;location=FutureSpliced_Folder)&nbsp;#delta_t=1???</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3341">3341</td><td nowrap="nowrap"><span class="diff_add">#or&nbsp;under&nbsp;constant&nbsp;unspliced&nbsp;assumption:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3342">3342</td><td nowrap="nowrap"><span class="diff_add">#vlm.calculate_shift(assumption="constant_unspliced",&nbsp;delta_t=1.0)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3343">3343</td><td nowrap="nowrap"><span class="diff_add">#vlm.extrapolate_cell_at_t(delta_t=1.,&nbsp;Myneighbours=number_neighbous,&nbsp;location=FutureSpliced_Folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3344">3344</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3345">3345</td><td nowrap="nowrap"><span class="diff_add">metaloc&nbsp;=&nbsp;sys.argv[7]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3346">3346</td><td nowrap="nowrap"><span class="diff_add">metadataGroup2&nbsp;=&nbsp;sys.argv[8]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3347">3347</td><td nowrap="nowrap"><span class="diff_add">R_Transition_Probability_Code&nbsp;=&nbsp;sys.argv[15]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3348">3348</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3349">3349</td><td nowrap="nowrap"><span class="diff_add">#Embedding&nbsp;under&nbsp;UMAP</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3350">3350</td><td nowrap="nowrap"><span class="diff_add">#UMAP</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3351">3351</td><td nowrap="nowrap"><span class="diff_add">if&nbsp;str(sys.argv[24])&nbsp;==&nbsp;"True":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3352">3352</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(UMAP_Folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3353">3353</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;vlm.basicUMAP(number_neighbous,&nbsp;make_gify=makegifs,&nbsp;distance=float(sys.argv[13]),&nbsp;metric_method=sys.argv[14],&nbsp;typegroup=grouptype,&nbsp;do3D=str(sys.argv[25]),&nbsp;UMAP_3D_loc=UMAP_3D_Folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3354">3354</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;#Fit&nbsp;to&nbsp;2&nbsp;dimensions:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3355">3355</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;#####do&nbsp;independent&nbsp;runs&nbsp;here</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3356">3356</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(int(sys.argv[27]),&nbsp;int(sys.argv[28]),&nbsp;int(sys.argv[29])):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3357">3357</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(UMAP_Folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3358">3358</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vlm.estimate_transition_probUMAP(hidim="Sx_sz",&nbsp;embed="UMAPembed",&nbsp;transform="sqrt",&nbsp;psc=None,&nbsp;n_neighbors=i,&nbsp;knn_random=False,&nbsp;sampled_fraction=0.5)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3359">3359</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vlm.calculate_embedding_shiftUMAP(sigma_corr&nbsp;=&nbsp;0.05,&nbsp;expression_scaling=scaling_to_DO,&nbsp;Myneighbours=number_neighbous,&nbsp;metadataToUse=metaloc,&nbsp;pathToTransitionProbabilityCode&nbsp;=&nbsp;R_Transition_Probability_Code,&nbsp;grouptype=grouptype,&nbsp;secondgroup=metadataGroup2,&nbsp;manyfeatures=str(sys.argv[18]),&nbsp;grouptype2=str(sys.argv[19]),&nbsp;Randomsampling=str(sys.argv[20]),&nbsp;extraNNvalue=i,&nbsp;DE_location=UMAP_2D_Delta_embedding_Folder,&nbsp;selfCC_folder=UMAP_2D_selfCC_Folder,&nbsp;VecX_location=UMAP_2D_UnVecX_Folder,&nbsp;VecY_loc=UMAP_2D_UnVecY_Folder,&nbsp;TP_folder=UMAP_2D_Transition_Probability_Folder,&nbsp;UMAP_2D_GroupLevelTP=UMAP_2D_GroupLevelTP_Folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3360">3360</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(UMAP_Folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3361">3361</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vlm.UMAPwithArrows2D(UMAPembedding="UMAPembed",&nbsp;UMAP_Arrows="MY_ARROWS_umap",&nbsp;numberNeighb=number_neighbous,&nbsp;typegroup=grouptype,&nbsp;extraNNvalue=i)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3362">3362</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close("all")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3363">3363</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Fit&nbsp;to&nbsp;3&nbsp;dimensions</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3364">3364</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;str(sys.argv[25])&nbsp;==&nbsp;"True":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3365">3365</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(UMAP_3D_Folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3366">3366</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vlm.estimate_transition_probUMAP3D(hidim="Sx_sz",&nbsp;embed="UMAPembed3d",&nbsp;transform="sqrt",&nbsp;psc=None,&nbsp;n_neighbors=i,&nbsp;knn_random=False,&nbsp;sampled_fraction=0.5)&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3367">3367</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vlm.calculate_embedding_shiftUMAP3D(sigma_corr&nbsp;=&nbsp;0.05,&nbsp;expression_scaling=scaling_to_DO,&nbsp;Myneighbours=number_neighbous,&nbsp;metadataToUse=metaloc,&nbsp;pathToTransitionProbabilityCode&nbsp;=&nbsp;R_Transition_Probability_Code,&nbsp;grouptype=grouptype,&nbsp;secondgroup=metadataGroup2,&nbsp;manyfeatures=str(sys.argv[18]),&nbsp;grouptype2=str(sys.argv[19]),&nbsp;Randomsampling=str(sys.argv[20]),&nbsp;extraNNvalue=i,&nbsp;DE_location=UMAP_3D_Delta_embedding_Folder,&nbsp;selfCC_folder=UMAP_3D_selfCC_Folder,&nbsp;VecX_location=UMAP_3D_UnVecX_Folder,&nbsp;VecY_loc=UMAP_3D_UnVecY_Folder,&nbsp;VecZ_loc=UMAP_3D_UnVecZ_Folder,&nbsp;TP_folder=UMAP_3D_Transition_Probability_Folder,&nbsp;UMAP_3D_GroupLevelTP=UMAP_3D_GroupLevelTP_Folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3368">3368</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(UMAP_3D_Folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3369">3369</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vlm.UMAPwithArrows3D(UMAPembedding="UMAPembed3d",&nbsp;UMAP_Arrows="MY_ARROWS_umap_3d",&nbsp;make_gify=makegifs,&nbsp;numberNeighb=number_neighbous,&nbsp;typegroup=grouptype,&nbsp;extraNNvalue=i)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3370">3370</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close("all")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3371">3371</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3372">3372</td><td nowrap="nowrap"><span class="diff_add">#tSNE</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3373">3373</td><td nowrap="nowrap"><span class="diff_add">if&nbsp;&nbsp;str(sys.argv[23])&nbsp;==&nbsp;"True":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3374">3374</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(tSNE_Folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3375">3375</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;bh_tsne&nbsp;=&nbsp;TSNE(perplexity=number_neighbous)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3376">3376</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;###indpeendent&nbsp;runs&nbsp;here</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3377">3377</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;vlm.ts&nbsp;=&nbsp;bh_tsne.fit_transform(vlm.pcs[:,&nbsp;:int(sys.argv[26])])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3378">3378</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(int(sys.argv[27]),&nbsp;int(sys.argv[28]),&nbsp;int(sys.argv[29])):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3379">3379</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vlm.estimate_transition_prob(hidim="Sx_sz",&nbsp;embed="ts",&nbsp;transform="sqrt",&nbsp;psc=None,&nbsp;n_neighbors=i,&nbsp;knn_random=False,&nbsp;sampled_fraction=0.5)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3380">3380</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vlm.calculate_embedding_shift(sigma_corr&nbsp;=&nbsp;0.05,&nbsp;expression_scaling=scaling_to_DO,&nbsp;Myneighbours=number_neighbous,&nbsp;metadataToUse=metaloc,&nbsp;pathToTransitionProbabilityCode&nbsp;=&nbsp;R_Transition_Probability_Code,&nbsp;grouptype=grouptype,&nbsp;secondgroup=metadataGroup2,&nbsp;manyfeatures=str(sys.argv[18]),&nbsp;grouptype2=str(sys.argv[19]),&nbsp;Randomsampling=str(sys.argv[20]),&nbsp;extraNNvalue=i,&nbsp;DE_location=tSNE_Delta_embedding_Folder,&nbsp;selfCC_folder=tSNE_selfCC_Folder,&nbsp;VecX_location=tSNE_UnVecX_Folder,&nbsp;VecY_loc=tSNE_UnVecY_Folder,&nbsp;TP_folder=tSNE_Transition_Probability_Folder,&nbsp;tSNE_GroupLevelTP=tSNE_GroupLevelTP_Folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3381">3381</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.chdir(tSNE_Folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3382">3382</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vlm.one_arrow(numberNeighb=number_neighbous,&nbsp;typegroup=grouptype,&nbsp;extraNNvalue=i)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3383">3383</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close("all")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3384">3384</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3385">3385</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3386">3386</td><td nowrap="nowrap"><span class="diff_add">os.chdir(sys.argv[2])</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3387">3387</td><td nowrap="nowrap"><span class="diff_add">os.remove("test.loom")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3388">3388</td><td nowrap="nowrap"><span class="diff_add">"""</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3389">3389</td><td nowrap="nowrap"><span class="diff_add">mylocytSNE&nbsp;=&nbsp;tSNE_GroupLevelTP_Folder&nbsp;+&nbsp;"SummaryTable*"&nbsp;+&nbsp;"NN"&nbsp;+&nbsp;str(number_neighbous)&nbsp;+&nbsp;"*"&nbsp;+&nbsp;"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3390">3390</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3391">3391</td><td nowrap="nowrap"><span class="diff_add">"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3392">3392</td><td nowrap="nowrap"><span class="diff_add">for&nbsp;Summaryfile&nbsp;in&nbsp;glob.glob(mylocytSNE):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3393">3393</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;vlm.TransitionProbabilityScatterplots(filename=Summaryfile,&nbsp;make_gify=makegifs)&nbsp;#makes&nbsp;nice&nbsp;presentations&nbsp;of&nbsp;the&nbsp;transition&nbsp;probabilities</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3394">3394</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3395">3395</td><td nowrap="nowrap"><span class="diff_add">mylocyUMAP2D&nbsp;=&nbsp;UMAP_2D_GroupLevelTP_Folder&nbsp;+&nbsp;"SummaryTable*"&nbsp;+&nbsp;"NN"&nbsp;+&nbsp;str(number_neighbous)&nbsp;+&nbsp;"*"&nbsp;+&nbsp;".csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3396">3396</td><td nowrap="nowrap"><span class="diff_add">for&nbsp;Summaryfile&nbsp;in&nbsp;glob.glob(mylocyUMAP2D):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3397">3397</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;vlm.TransitionProbabilityScatterplots(filename=Summaryfile,&nbsp;make_gify=makegifs)&nbsp;#makes&nbsp;nice&nbsp;presentations&nbsp;of&nbsp;the&nbsp;transition&nbsp;probabilities</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3398">3398</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3399">3399</td><td nowrap="nowrap"><span class="diff_add">mylocyUMAP3D&nbsp;=&nbsp;UMAP_3D_GroupLevelTP_Folder&nbsp;+&nbsp;"SummaryTable*"&nbsp;+&nbsp;"NN"&nbsp;+&nbsp;str(number_neighbous)&nbsp;+&nbsp;"*"&nbsp;+&nbsp;".csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3400">3400</td><td nowrap="nowrap"><span class="diff_add">for&nbsp;Summaryfile&nbsp;in&nbsp;glob.glob(mylocyUMAP3D):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3401">3401</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;vlm.TransitionProbabilityScatterplots(filename=Summaryfile,&nbsp;make_gify=makegifs)&nbsp;#makes&nbsp;nice&nbsp;presentations&nbsp;of&nbsp;the&nbsp;transition&nbsp;probabilities</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3402">3402</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3403">3403</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3404">3404</td><td nowrap="nowrap"><span class="diff_add">import&nbsp;rpy2.robjects&nbsp;as&nbsp;ro</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3405">3405</td><td nowrap="nowrap"><span class="diff_add">from&nbsp;rpy2.robjects.packages&nbsp;import&nbsp;importr</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3406">3406</td><td nowrap="nowrap"><span class="diff_add">utils&nbsp;=&nbsp;importr('utils')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3407">3407</td><td nowrap="nowrap"><span class="diff_add">path&nbsp;=&nbsp;R_Transition_Probability_Code</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3408">3408</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3409">3409</td><td nowrap="nowrap"><span class="diff_add">def&nbsp;RunTransitionTypeEstimates(filename,&nbsp;location):&nbsp;#estimates&nbsp;the&nbsp;%&nbsp;future,&nbsp;self&nbsp;and&nbsp;past&nbsp;estimates&nbsp;for&nbsp;linear&nbsp;data</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3410">3410</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;r=ro.r</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3411">3411</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;r.source(path+"TransitionTypeEstimates.R")</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to0__164"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3412">3412</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;p=r.TransitionTypeEstimates(filename,&nbsp;location)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2511">2511</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_chg">R</span>eturn<span class="diff_chg">s</span></td><td class="diff_next"></td><td class="diff_header" id="to0_3413">3413</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_chg">r</span>eturn<span class="diff_chg">&nbsp;p</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2512">2512</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;-------</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2513">2513</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;VelocytoLoom&nbsp;object</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2514">2514</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3414">3414</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to0__top">t</a></td><td class="diff_header" id="from0_2515">2515</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;Note</span></td><td class="diff_next"><a href="#difflib_chg_to0__top">t</a></td><td class="diff_header" id="to0_3415">3415</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2516">2516</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;----</span></td><td class="diff_next"></td><td class="diff_header" id="to0_3416">3416</td><td nowrap="nowrap"><span class="diff_add">mylocytsNE1&nbsp;=&nbsp;tSNE_GroupLevelTP_Folder&nbsp;+&nbsp;"SummaryTable*"&nbsp;+&nbsp;"NN"&nbsp;+&nbsp;str(number_neighbous)&nbsp;+&nbsp;"*"&nbsp;+&nbsp;"SampleGroup1"&nbsp;+&nbsp;"*"&nbsp;+&nbsp;".csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2517">2517</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;hdf5&nbsp;file&nbsp;must&nbsp;have&nbsp;been&nbsp;created&nbsp;using&nbsp;``VelocytoLoom.to_hdf5``&nbsp;or&nbsp;the&nbsp;``dump_hdf5``&nbsp;function</span></td><td class="diff_next"></td><td class="diff_header" id="to0_3417">3417</td><td nowrap="nowrap"><span class="diff_add">for&nbsp;Summaryfile&nbsp;in&nbsp;glob.glob(mylocytsNE1):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2518">2518</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;"""</span></td><td class="diff_next"></td><td class="diff_header" id="to0_3418">3418</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;grouptype&nbsp;==&nbsp;"integers":&nbsp;#and&nbsp;integers&nbsp;like&nbsp;time-course</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from0_2519">2519</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;load_hdf5(filename,&nbsp;obj_class=VelocytoLoom)</span></td><td class="diff_next"></td><td class="diff_header" id="to0_3419">3419</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f=RunTransitionTypeEstimates(Summaryfile,&nbsp;tSNE_GroupLevelTP_Folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3420">3420</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3421">3421</td><td nowrap="nowrap"><span class="diff_add">mylocyUMAP2D1&nbsp;=&nbsp;UMAP_2D_GroupLevelTP_Folder&nbsp;+&nbsp;"SummaryTable*"&nbsp;+&nbsp;"NN"&nbsp;+&nbsp;str(number_neighbous)&nbsp;+&nbsp;"*"&nbsp;+&nbsp;"SampleGroup1"&nbsp;+&nbsp;"*"&nbsp;+&nbsp;".csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3422">3422</td><td nowrap="nowrap"><span class="diff_add">for&nbsp;Summaryfile&nbsp;in&nbsp;glob.glob(mylocyUMAP2D1):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3423">3423</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;grouptype&nbsp;==&nbsp;"integers":&nbsp;#and&nbsp;integers&nbsp;like&nbsp;time-course</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3424">3424</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f=RunTransitionTypeEstimates(Summaryfile,&nbsp;UMAP_2D_GroupLevelTP_Folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3425">3425</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3426">3426</td><td nowrap="nowrap"><span class="diff_add">mylocyUMAP3D1&nbsp;=&nbsp;UMAP_3D_GroupLevelTP_Folder&nbsp;+&nbsp;"SummaryTable*"&nbsp;+&nbsp;"NN"&nbsp;+&nbsp;str(number_neighbous)&nbsp;+&nbsp;"*"&nbsp;+&nbsp;"SampleGroup1"&nbsp;+&nbsp;"*"&nbsp;+&nbsp;".csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3427">3427</td><td nowrap="nowrap"><span class="diff_add">for&nbsp;Summaryfile&nbsp;in&nbsp;glob.glob(mylocyUMAP3D1):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3428">3428</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;grouptype&nbsp;==&nbsp;"integers":&nbsp;#and&nbsp;integers&nbsp;like&nbsp;time-course</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3429">3429</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f=RunTransitionTypeEstimates(Summaryfile,&nbsp;UMAP_3D_GroupLevelTP_Folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3430">3430</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3431">3431</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3432">3432</td><td nowrap="nowrap"><span class="diff_add">if&nbsp;str(sys.argv[18])&nbsp;==&nbsp;"True":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3433">3433</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;mylocytSNE2&nbsp;=&nbsp;tSNE_GroupLevelTP_Folder&nbsp;+&nbsp;"SummaryTable*"&nbsp;+&nbsp;"NN"&nbsp;+&nbsp;str(number_neighbous)&nbsp;+&nbsp;"*"&nbsp;+&nbsp;"SampleGroup2"&nbsp;+&nbsp;"*"&nbsp;+&nbsp;".csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3434">3434</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;Summaryfile&nbsp;in&nbsp;glob.glob(mylocytSNE2):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3435">3435</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;str(sys.argv[19])&nbsp;==&nbsp;"integers":&nbsp;#and&nbsp;integers&nbsp;like&nbsp;time-course</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3436">3436</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f=RunTransitionTypeEstimates(Summaryfile,&nbsp;tSNE_GroupLevelTP_Folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3437">3437</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close("all")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3438">3438</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;mylocyUMAP2D2&nbsp;=&nbsp;UMAP_2D_GroupLevelTP_Folder&nbsp;+&nbsp;"SummaryTable*"&nbsp;+&nbsp;"NN"&nbsp;+&nbsp;str(number_neighbous)&nbsp;+&nbsp;"*"&nbsp;+&nbsp;"SampleGroup2"&nbsp;+&nbsp;"*"&nbsp;+&nbsp;".csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3439">3439</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;Summaryfile&nbsp;in&nbsp;glob.glob(mylocyUMAP2D2):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3440">3440</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;str(sys.argv[19])&nbsp;==&nbsp;"integers":&nbsp;#and&nbsp;integers&nbsp;like&nbsp;time-course</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3441">3441</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f=RunTransitionTypeEstimates(Summaryfile,&nbsp;UMAP_2D_GroupLevelTP_Folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3442">3442</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close("all")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3443">3443</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;mylocyUMAP3D2&nbsp;=&nbsp;UMAP_3D_GroupLevelTP_Folder&nbsp;+&nbsp;"SummaryTable*"&nbsp;+&nbsp;"NN"&nbsp;+&nbsp;str(number_neighbous)&nbsp;+&nbsp;"*"&nbsp;+&nbsp;"SampleGroup2"&nbsp;+&nbsp;"*"&nbsp;+&nbsp;".csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3444">3444</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;Summaryfile&nbsp;in&nbsp;glob.glob(mylocyUMAP3D2):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3445">3445</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;str(sys.argv[19])&nbsp;==&nbsp;"integers":&nbsp;#and&nbsp;integers&nbsp;like&nbsp;time-course</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3446">3446</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f=RunTransitionTypeEstimates(Summaryfile,&nbsp;UMAP_3D_GroupLevelTP_Folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3447">3447</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close("all")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3448">3448</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3449">3449</td><td nowrap="nowrap"><span class="diff_add">#Run&nbsp;Confidence&nbsp;Interval&nbsp;calculation&nbsp;for&nbsp;each&nbsp;sample&nbsp;to&nbsp;each&nbsp;groups&nbsp;transition&nbsp;probability&nbsp;values&nbsp;across&nbsp;TP&nbsp;NN&nbsp;values!</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3450">3450</td><td nowrap="nowrap"><span class="diff_add">import&nbsp;rpy2.robjects&nbsp;as&nbsp;ro</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3451">3451</td><td nowrap="nowrap"><span class="diff_add">from&nbsp;rpy2.robjects.packages&nbsp;import&nbsp;importr</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3452">3452</td><td nowrap="nowrap"><span class="diff_add">utils&nbsp;=&nbsp;importr('utils')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3453">3453</td><td nowrap="nowrap"><span class="diff_add">boot&nbsp;=&nbsp;importr('ggplot2')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3454">3454</td><td nowrap="nowrap"><span class="diff_add">boot&nbsp;=&nbsp;importr('Rmisc')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3455">3455</td><td nowrap="nowrap"><span class="diff_add">print("Performing&nbsp;Confidence&nbsp;Interval&nbsp;Calculations&nbsp;across&nbsp;the&nbsp;transition&nbsp;probability&nbsp;NN&nbsp;values!")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3456">3456</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3457">3457</td><td nowrap="nowrap"><span class="diff_add">def&nbsp;ConfidenceIntervalsAcrossTPNN(wd,&nbsp;MainPattern,&nbsp;NN,&nbsp;embedType,&nbsp;outdir):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3458">3458</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;r=ro.r</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3459">3459</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;r.source(path+"ConfidenceIntervalsAcrossTPNN.R")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3460">3460</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;l=r.ConfidenceIntervalsAcrossTPNN(wd,&nbsp;MainPattern,&nbsp;NN,&nbsp;embedType,&nbsp;outdir)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3461">3461</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;l</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3462">3462</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3463">3463</td><td nowrap="nowrap"><span class="diff_add">NNval&nbsp;=&nbsp;"_NN"+&nbsp;str(number_neighbous)&nbsp;+&nbsp;"_"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3464">3464</td><td nowrap="nowrap"><span class="diff_add">my_Filelist&nbsp;=&nbsp;["SummaryTable_Sum_SelfRemoved",&nbsp;"SummaryTable_Mean_SelfNotRemoved",&nbsp;"SummaryTable_Mean_SelfRemoved"]</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3465">3465</td><td nowrap="nowrap"><span class="diff_add">for&nbsp;Summaryfile&nbsp;in&nbsp;my_Filelist:</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3466">3466</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;j=ConfidenceIntervalsAcrossTPNN(UMAP_2D_GroupLevelTP_Folder,&nbsp;Summaryfile,&nbsp;NNval,&nbsp;"UMAPSample",&nbsp;CI_UMAP_2D_GroupLevelTP_Folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3467">3467</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;plt.close("all")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3468">3468</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;k=ConfidenceIntervalsAcrossTPNN(UMAP_3D_GroupLevelTP_Folder,&nbsp;Summaryfile,&nbsp;NNval,&nbsp;"UMAP3DSample",&nbsp;CI_UMAP_3D_GroupLevelTP_Folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3469">3469</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;plt.close("all")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3470">3470</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;l=ConfidenceIntervalsAcrossTPNN(tSNE_GroupLevelTP_Folder,&nbsp;Summaryfile,&nbsp;NNval,&nbsp;"tSNESample",&nbsp;CI_tSNE_GroupLevelTP_Folder)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3471">3471</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;plt.close("all")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3472">3472</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3473">3473</td><td nowrap="nowrap"><span class="diff_add">#Confidence&nbsp;Interval&nbsp;via&nbsp;bootstrapping&nbsp;Calculation&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3474">3474</td><td nowrap="nowrap"><span class="diff_add">if&nbsp;str(sys.argv[21])&nbsp;==&nbsp;"True":</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3475">3475</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;import&nbsp;rpy2.robjects&nbsp;as&nbsp;ro</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3476">3476</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;rpy2.robjects.packages&nbsp;import&nbsp;importr</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3477">3477</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;utils&nbsp;=&nbsp;importr('utils')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3478">3478</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('boot')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3479">3479</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('tidyverse')&nbsp;#library(foreach);&nbsp;library(doParallel);&nbsp;library(parallel)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3480">3480</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('reshape2')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3481">3481</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('Rmisc')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3482">3482</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;#utils.install_packages('gridExtra')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3483">3483</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;boot&nbsp;=&nbsp;importr('boot')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3484">3484</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;boot&nbsp;=&nbsp;importr('tidyverse')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3485">3485</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;boot&nbsp;=&nbsp;importr('reshape2')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3486">3486</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;boot&nbsp;=&nbsp;importr('Rmisc')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3487">3487</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;boot&nbsp;=&nbsp;importr('gridExtra')</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3488">3488</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;RunInternalBootStrappingTransitonProbabilities(filename,&nbsp;selfremoved,&nbsp;location,&nbsp;metaloc,&nbsp;outputdir,&nbsp;grouptype,&nbsp;numberofIterations):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3489">3489</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r=ro.r</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3490">3490</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r.source(path+"InternalBootStrappingTransitionProbabilitiesOriginal.R")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3491">3491</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l=r.InternalBootStrappingTransitonProbabilities(filename,&nbsp;selfremoved,&nbsp;location,&nbsp;metaloc,&nbsp;outputdir,&nbsp;grouptype,&nbsp;numberofIterations)</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3492">3492</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;l</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3493">3493</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;mylocy3&nbsp;=&nbsp;"Transition_Probability_NN"&nbsp;+&nbsp;str(number_neighbous)&nbsp;+&nbsp;"_*.csv"</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3494">3494</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;print("Performing&nbsp;Confidence&nbsp;Interval&nbsp;Calculations")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3495">3495</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;Summaryfile&nbsp;in&nbsp;glob.glob(mylocy3):</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3496">3496</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j=RunInternalBootStrappingTransitonProbabilities(Summaryfile,&nbsp;"FALSE",&nbsp;BS_UMAP_2D_GroupLevelTP_Folder,&nbsp;metaloc,&nbsp;UMAP_2D_GroupLevelTP_Folder,&nbsp;grouptype,&nbsp;int(sys.argv[22]))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3497">3497</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close("all")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3498">3498</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k=RunInternalBootStrappingTransitonProbabilities(Summaryfile,&nbsp;"TRUE",&nbsp;BS_UMAP_2D_GroupLevelTP_Folder,&nbsp;metaloc,&nbsp;UMAP_2D_GroupLevelTP_Folder,&nbsp;grouptype,&nbsp;int(sys.argv[22]))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3499">3499</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close("all")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3500">3500</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l=RunInternalBootStrappingTransitonProbabilities(Summaryfile,&nbsp;"FALSE",&nbsp;BS_UMAP_3D_GroupLevelTP_Folder,&nbsp;metaloc,&nbsp;UMAP_3D_GroupLevelTP_Folder,&nbsp;grouptype,&nbsp;int(sys.argv[22]))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3501">3501</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close("all")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3502">3502</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m=RunInternalBootStrappingTransitonProbabilities(Summaryfile,&nbsp;"TRUE",&nbsp;BS_UMAP_3D_GroupLevelTP_Folder,&nbsp;metaloc,&nbsp;UMAP_3D_GroupLevelTP_Folder,&nbsp;grouptype,&nbsp;int(sys.argv[22]))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3503">3503</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close("all")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3504">3504</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n=RunInternalBootStrappingTransitonProbabilities(Summaryfile,&nbsp;"FALSE",&nbsp;BS_tSNE_GroupLevelTP_Folder,&nbsp;metaloc,&nbsp;tSNE_GroupLevelTP_Folder,&nbsp;grouptype,&nbsp;int(sys.argv[22]))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3505">3505</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close("all")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3506">3506</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o=RunInternalBootStrappingTransitonProbabilities(Summaryfile,&nbsp;"TRUE",&nbsp;BS_tSNE_GroupLevelTP_Folder,&nbsp;metaloc,&nbsp;tSNE_GroupLevelTP_Folder,&nbsp;grouptype,&nbsp;int(sys.argv[22]))</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3507">3507</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close("all")</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to0_3508">3508</td><td nowrap="nowrap"><span class="diff_add">"""</span></td></tr>
        </tbody>
    </table>
    <table class="diff" summary="Legends">
        <tr> <th colspan="2"> Legends </th> </tr>
        <tr> <td> <table border="" summary="Colors">
                      <tr><th> Colors </th> </tr>
                      <tr><td class="diff_add">&nbsp;Added&nbsp;</td></tr>
                      <tr><td class="diff_chg">Changed</td> </tr>
                      <tr><td class="diff_sub">Deleted</td> </tr>
                  </table></td>
             <td> <table border="" summary="Links">
                      <tr><th colspan="2"> Links </th> </tr>
                      <tr><td>(f)irst change</td> </tr>
                      <tr><td>(n)ext change</td> </tr>
                      <tr><td>(t)op</td> </tr>
                  </table></td> </tr>
    </table>
</body>

</html>